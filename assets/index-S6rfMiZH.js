var qa=Object.defineProperty;var Ha=(K,o,l)=>o in K?qa(K,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):K[o]=l;var $e=(K,o,l)=>(Ha(K,typeof o!="symbol"?o+"":o,l),l),Sa=(K,o,l)=>{if(!o.has(K))throw TypeError("Cannot "+l)};var N=(K,o,l)=>(Sa(K,o,"read from private field"),l?l.call(K):o.get(K)),Te=(K,o,l)=>{if(o.has(K))throw TypeError("Cannot add the same private member more than once");o instanceof WeakSet?o.add(K):o.set(K,l)},Se=(K,o,l,R)=>(Sa(K,o,"write to private field"),R?R.call(K,l):o.set(K,l),l);var ga=(K,o,l,R)=>({set _(L){Se(K,o,L,l)},get _(){return N(K,o,R)}}),er=(K,o,l)=>(Sa(K,o,"access private method"),l);(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const L of document.querySelectorAll('link[rel="modulepreload"]'))R(L);new MutationObserver(L=>{for(const Q of L)if(Q.type==="childList")for(const X of Q.addedNodes)X.tagName==="LINK"&&X.rel==="modulepreload"&&R(X)}).observe(document,{childList:!0,subtree:!0});function l(L){const Q={};return L.integrity&&(Q.integrity=L.integrity),L.referrerPolicy&&(Q.referrerPolicy=L.referrerPolicy),L.crossOrigin==="use-credentials"?Q.credentials="include":L.crossOrigin==="anonymous"?Q.credentials="omit":Q.credentials="same-origin",Q}function R(L){if(L.ep)return;L.ep=!0;const Q=l(L);fetch(L.href,Q)}})();var kt,Qr,Zr,Kn,bt,jt,Mr,Et,Yn,Da,zn,La,Qn,Ba,Zn,Ia,Vt,qn,Tt,vn,yn,wa,Jn,Oa,pn,Pa,$n,Ma,Wt,Hn,dn,xa;const mn=class mn{constructor(){Te(this,Yn);Te(this,zn);Te(this,Qn);Te(this,Zn);Te(this,Vt);Te(this,Tt);Te(this,yn);Te(this,Jn);Te(this,pn);Te(this,$n);Te(this,Wt);Te(this,dn);$e(this,"input",{moveLeft:!1,moveRight:!1,hardDrop:!1,softDrop:!1,hold:!1,rotateClockwise:!1,rotateAnticlockwise:!1});$e(this,"numRows",21);$e(this,"graceTimerDuration",.5);$e(this,"gameTickTime",1/30);$e(this,"pieceMap",new Map);$e(this,"gameState",{isPaused:!1,gameOver:!0,gridData:new Uint32Array(this.numRows),playerPiece:null,pieceQueue:[],heldPiece:null,ghostBlocks:[[0,0],[0,0],[0,0],[0,0]],linesCleared:0,speedLevel:1,score:0});Te(this,kt,15);Te(this,Qr,!0);Te(this,Zr,0);Te(this,Kn,!1);Te(this,bt,-1);Te(this,jt,0);Te(this,Mr,!1);Te(this,Et,!1);er(this,Vt,qn).call(this),er(this,Tt,vn).call(this),er(this,Wt,Hn).call(this),Se(this,kt,15),this.pieceMap.set("Z",1),this.pieceMap.set("S",2),this.pieceMap.set("O",3),this.pieceMap.set("J",4),this.pieceMap.set("T",5),this.pieceMap.set("I",6),this.pieceMap.set("L",7),this.gameState.isPaused=!0}get isStateChanged(){const o=N(this,Qr);return Se(this,Qr,!1),o}runTick(){if(this.gameState.isPaused)return;let o=!1;if(N(this,Et)){this.animationCount==null||this.rowCount==null?(this.animationCount=0,this.rowCount=0):(this.animationCount++,this.rowCount<this.numRows&&this.animationCount%4==0?(this.clearRow(0),this.rowCount++,Se(this,Qr,!0)):this.rowCount==this.numRows&&(this.rowCount++,this.gameState.gameOver=!0));return}if(this.input.hardDrop)this.hardDropPlayerPiece(),this.finishWithPiece(),o=!0;else if(this.input.hold)this.holdPiece(),o=!0;else{N(this,Mr)&&er(this,Jn,Oa).call(this,this.gameTickTime),this.input.softDrop&&(o=this.tryMovePiece(0,-1)||o);let l=0;this.input.rotateClockwise&&(l+=1),this.input.rotateAnticlockwise&&(l-=1),l!=0&&(o=this.tryRotatePiece(l==1)||o);let R=0;if(this.input.moveLeft&&(R-=1),this.input.moveRight&&(R+=1),R!=0&&(o=this.tryMovePiece(R,0)||o),ga(this,Zr)._++,N(this,Zr)>=N(this,kt)){let L=!this.tryMovePiece(0,-1);o||(o=!L),Se(this,Zr,0),L&&!N(this,Mr)&&er(this,yn,wa).call(this)}if(N(this,Mr)&&N(this,bt)<=0){let L=!this.tryMovePiece(0,-1);o=!0,L&&this.finishWithPiece()}else if(!N(this,Mr)){let L=!1;for(const Q of this.gameState.playerPiece.blocks)L=L||this.isBlockHere(Q[0],Q[1]-1);L&&er(this,yn,wa).call(this)}}o&&(er(this,Wt,Hn).call(this),Se(this,Qr,!0)),this.input={moveLeft:!1,moveRight:!1,hardDrop:!1,softDrop:!1,hold:!1,rotateClockwise:!1,rotateAnticlockwise:!1}}pauseGame(o){this.gameState.isPaused=o}startNewGame(){this.gameState.gameOver=!1,this.gameState.isPaused=!1,Se(this,Et,!1),this.animationCount=null,this.rowCount=null;for(let o=0;o<this.gameState.gridData.length;o++)this.gameState.gridData[o]=0;this.gameState.linesCleared=0,this.gameState.speedLevel=0,this.gameState.score=0,this.gameState.pieceQueue=[],this.gameState.heldPiece=null,er(this,Vt,qn).call(this),er(this,Tt,vn).call(this),er(this,Wt,Hn).call(this),er(this,dn,xa).call(this)}tryMovePiece(o,l){let R=!0;for(let L=0;L<4&&R;L++){let Q=this.gameState.playerPiece.blocks[L][0]+o,X=this.gameState.playerPiece.blocks[L][1]+l;this.isBlockHere(Q,X)&&(R=!1)}return R&&(er(this,zn,La).call(this,o,l),o!=0&&er(this,pn,Pa).call(this),l!=0&&Se(this,Mr,!1)),R}hardDropPlayerPiece(){for(;this.tryMovePiece(0,-1););}tryRotatePiece(o){let l=er(this,Qn,Ba).call(this,o);return l&&er(this,pn,Pa).call(this),l}holdPiece(){if(this.gameState.heldPiece==null)this.gameState.heldPiece=this.gameState.playerPiece.shape,er(this,Tt,vn).call(this),Se(this,Qr,!0),Se(this,Zr,0);else if(!this.gameState.playerPiece.wasHeld){let o=this.gameState.heldPiece;this.gameState.heldPiece=this.gameState.playerPiece.shape,this.gameState.playerPiece=new it(o),this.gameState.playerPiece.wasHeld=!0,Se(this,Qr,!0),Se(this,Zr,0),this.isPlayerPieceValid()||(this.gameState.playerPiece.active=!1,Se(this,Et,!0))}}finishWithPiece(){const o=this.gameState.linesCleared;this.gameState.playerPiece.shape=="T"&&Se(this,Kn,!0),er(this,Zn,Ia).call(this),er(this,Tt,vn).call(this),Se(this,Mr,!1),er(this,$n,Ma).call(this),this.gameState.linesCleared!=o&&(er(this,dn,xa).call(this),this.gameState.score+=Math.pow(this.gameState.linesCleared-o,2)*100)}clearRow(o){for(let l=o;l<this.numRows-1;l++)this.gameState.gridData[l]=this.gameState.gridData[l+1];this.gameState.gridData[this.numRows-1]=0}isBlockHere(o,l){if(o<0||l<0||o>=10||l>=this.numRows)return!0;const R=this.gameState.gridData[l],L=7<<32-(3+3*o);return(R&L)!=0}getBlockData(o,l){const R=this.gameState.gridData[l],L=32-(3+3*o),Q=7<<L;return(R&Q)>>>L}isPlayerPieceValid(){let o=!0;for(let l=0;l<4&&o;l++)this.isBlockHere(this.gameState.playerPiece.blocks[l][0],this.gameState.playerPiece.blocks[l][1])&&(o=!1);return o}};kt=new WeakMap,Qr=new WeakMap,Zr=new WeakMap,Kn=new WeakMap,bt=new WeakMap,jt=new WeakMap,Mr=new WeakMap,Et=new WeakMap,Yn=new WeakSet,Da=function(o,l,R){const Q=~(7<<32-(3+3*o));this.gameState.gridData[l]&=Q;const X=R<<32-(3+3*o);this.gameState.gridData[l]|=X},zn=new WeakSet,La=function(o,l){for(let R=0;R<4;R++)this.gameState.playerPiece.blocks[R][0]+=o,this.gameState.playerPiece.blocks[R][1]+=l},Qn=new WeakSet,Ba=function(o){let l=(this.gameState.playerPiece.rotationIndex+4+(o?1:-1))%4,R=[...this.gameState.playerPiece.blocks[0]],L=[];for(let te=0;te<4;te++)L.push([...this.gameState.playerPiece.blocks[te]]);let Q=1,X=1;o?X=-1:Q=-1;let u;for(let te=0;te<4;te++)L[te][0]-=R[0],L[te][1]-=R[1],u=L[te][0],L[te][0]=Q*L[te][1],L[te][1]=X*u,L[te][0]+=R[0],L[te][1]+=R[1];let Y;switch(this.gameState.playerPiece.shape){case"O":Y=it.offsets.O;break;case"I":Y=it.offsets.I;break;default:Y=it.offsets.OTHER;break}let ee,k,se=!1;for(let te=0;te<5&&!se;te++){ee=Y[te],k=[ee[this.gameState.playerPiece.rotationIndex][0]-ee[l][0],ee[this.gameState.playerPiece.rotationIndex][1]-ee[l][1]],se=!0;for(let W=0;W<4;W++)L[W][0]+=k[0],L[W][1]+=k[1],this.isBlockHere(L[W][0],L[W][1])&&(se=!1);if(!se)for(let W=0;W<4;W++)L[W][0]-=k[0],L[W][1]-=k[1]}if(se){for(let te=0;te<4;te++)this.gameState.playerPiece.blocks[te]=[...L[te]];this.gameState.playerPiece.rotationIndex=l}return se},Zn=new WeakSet,Ia=function(){let o,l,R=this.pieceMap.get(this.gameState.playerPiece.shape);for(let L=0;L<4;L++)o=this.gameState.playerPiece.blocks[L][0],l=this.gameState.playerPiece.blocks[L][1],er(this,Yn,Da).call(this,o,l,R)},Vt=new WeakSet,qn=function(){let o=["O","I","T","J","L","S","Z"],l;for(let R=0;R<7;R++)l=Math.floor(Math.random()*o.length),this.gameState.pieceQueue.push(o[l]),o.splice(l,1)},Tt=new WeakSet,vn=function(){let o=this.gameState.pieceQueue[0];this.gameState.pieceQueue.splice(0,1),this.gameState.pieceQueue.length<7&&er(this,Vt,qn).call(this),delete this.gameState.playerPiece,this.gameState.playerPiece=new it(o),this.isPlayerPieceValid()||(this.gameState.playerPiece.active=!1,Se(this,Et,!0)),Se(this,Zr,0)},yn=new WeakSet,wa=function(){Se(this,bt,this.graceTimerDuration),Se(this,Mr,!0),Se(this,jt,0)},Jn=new WeakSet,Oa=function(o){Se(this,bt,N(this,bt)-o)},pn=new WeakSet,Pa=function(){N(this,Mr)&&N(this,jt)<30&&(Se(this,bt,this.graceTimerDuration),ga(this,jt)._++)},$n=new WeakSet,Ma=function(){for(let o=0;o<this.numRows;o++){let l=!0;for(let R=0;R<10&&l;R++)this.isBlockHere(R,o)||(l=!1);l&&(this.clearRow(o),this.gameState.linesCleared++,o--)}},Wt=new WeakSet,Hn=function(){for(let l=0;l<4;l++)this.gameState.ghostBlocks[l]=[...this.gameState.playerPiece.blocks[l]];let o=!1;for(;!o;){for(let l=0;l<4;l++)this.isBlockHere(this.gameState.ghostBlocks[l][0],this.gameState.ghostBlocks[l][1]-1)&&(o=!0);if(!o)for(let l=0;l<4;l++)this.gameState.ghostBlocks[l][1]-=1}},dn=new WeakSet,xa=function(){this.gameState.speedLevel=Math.min(Math.floor(this.gameState.linesCleared/10)+1,mn.levels.max),Se(this,kt,mn.levels[this.gameState.speedLevel])},$e(mn,"levels",{1:25,2:20,3:16,4:12,5:10,6:8,7:6,8:5,9:4,10:2,11:1,max:11});let _a=mn;const Lr=class Lr{constructor(o){this.blocks=[],this.shape=o,this.rotationIndex=0,this.active=!0,this.wasHeld=!1;let l=Lr.getBaseShape(o);for(let R=0;R<4;R++)this.blocks.push([...l[R]]),this.blocks[R][0]+=3,this.blocks[R][1]+=19}static getBaseShape(o){let l;switch(o){case"O":l=Lr.pieces.O;break;case"I":l=Lr.pieces.I;break;case"L":l=Lr.pieces.L;break;case"J":l=Lr.pieces.J;break;case"T":l=Lr.pieces.T;break;case"S":l=Lr.pieces.S;break;case"Z":l=Lr.pieces.Z;break;default:l=[[0,0],[0,0],[0,0],[0,0]]}return l}};$e(Lr,"offsets",{O:[[[0,0],[0,-1],[-1,-1],[-1,0]]],I:[[[0,0],[-1,0],[-1,1],[0,1]],[[-1,0],[0,0],[1,1],[0,1]],[[2,0],[0,0],[-2,1],[0,1]],[[-1,0],[0,1],[1,0],[0,-1]],[[2,0],[0,-2],[-2,0],[0,2]]],OTHER:[[[0,0],[0,0],[0,0],[0,0]],[[0,0],[1,0],[0,0],[-1,0]],[[0,0],[1,-1],[0,0],[-1,-1]],[[0,0],[0,2],[0,0],[0,2]],[[0,0],[1,2],[0,0],[-1,2]]]}),$e(Lr,"pieces",{O:[[1,0],[1,1],[2,1],[2,0]],I:[[1,0],[0,0],[2,0],[3,0]],L:[[1,0],[0,0],[2,0],[2,1]],J:[[1,0],[0,0],[0,1],[2,0]],T:[[1,0],[0,0],[2,0],[1,1]],S:[[1,0],[0,0],[1,1],[2,1]],Z:[[1,0],[2,0],[1,1],[0,1]]});let it=Lr;class Ka{constructor(){$e(this,"selectedKey","");$e(this,"originalKeybind","");$e(this,"selectedAction","");$e(this,"selectedSpan",null);this.actionStates=new Map,this.actionStates.set("hardDrop",!1),this.actionStates.set("softDrop",!1),this.actionStates.set("moveLeft",!1),this.actionStates.set("moveRight",!1),this.actionStates.set("hold",!1),this.actionStates.set("rotateClockwise",!1),this.actionStates.set("rotateAnticlockwise",!1),this.actionStates.set("pause",!1),this.inputKeys=new Map,this.inputKeys.set("A","moveLeft"),this.inputKeys.set("D","moveRight"),this.inputKeys.set("W","hardDrop"),this.inputKeys.set("S","softDrop"),this.inputKeys.set("E","hold"),this.inputKeys.set("ArrowLeft","rotateAnticlockwise"),this.inputKeys.set("ArrowRight","rotateClockwise"),this.inputKeys.set("Escape","pause"),this.counters=new Map,this.counters.set("moveLeft",0),this.counters.set("moveRight",0),this.counters.set("rotateClockwise",0),this.counters.set("rotateAnticlockwise",0),this.counters.set("hardDrop",0),this.counters.set("hold",0),this.counters.set("pause",0)}keyToState(o){return o.length==1&&(o=o.toUpperCase()),this.inputKeys.get(o)}actionToKey(o){let l="";return this.inputKeys.forEach(function(R,L,Q){R==o&&(l=L)}),l}rebindControl(o,l){let R=!1,L="";return this.inputKeys.forEach(function(Q,X,u){Q==o&&(L=X)}),L!=""&&(this.inputKeys.has(l)&&l!=L||(this.inputKeys.delete(L),this.inputKeys.set(l,o),R=!0)),R}setInputState(o,l){let R=this.keyToState(o);R!=null&&this.actionStates.set(R,l)}getInputState(o){return this.actionStates.has(o)?this.actionStates.get(o):(console.log("ERROR: trying to access an input action that doesn't exist ("+o+"). The allowed options are:"),this.actionStates.forEach(function(l,R,L){console.log("    - "+R)}),null)}updateCounters(){for(const[o,l]of this.counters)this.getInputState(o)?this.counters.set(o,l+1):this.counters.set(o,0)}getCounter(o){return this.counters.has(o)?this.counters.get(o):(console.log("ERROR: trying to access input action that doesn't have a counter ("+o+"). The counters are:"),this.counters.forEach(function(l,R,L){console.log("    - "+R+": "+l)}),null)}}var Ya=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Na={exports:{}};/*!
 * @license twgl.js 5.5.4 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
 * Available via the MIT license.
 * see: http://github.com/greggman/twgl.js for details
 */(function(K,o){(function(R,L){K.exports=L()})(typeof self<"u"?self:Ya,()=>(()=>{var l={"./src/attributes.js":(X,u,Y)=>{function ee(v){"@babel/helpers - typeof";return ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},ee(v)}u.__esModule=!0,u.createAttribsFromArrays=cr,u.createBufferFromArray=c,u.createBufferFromTypedArray=ye,u.createBufferInfoFromArrays=f,u.createBuffersFromArrays=E,u.getArray_=U,u.getNumComponents_=Ce,u.setAttribInfoBufferFromArray=ar,u.setAttributeDefaults_=ur,u.setAttributePrefix=or;var k=W(Y("./src/typedarrays.js")),se=W(Y("./src/helper.js"));function te(v){if(typeof WeakMap!="function")return null;var i=new WeakMap,a=new WeakMap;return(te=function(h){return h?a:i})(v)}function W(v,i){if(!i&&v&&v.__esModule)return v;if(v===null||ee(v)!="object"&&typeof v!="function")return{default:v};var a=te(i);if(a&&a.has(v))return a.get(v);var m={__proto__:null},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var T in v)if(T!=="default"&&Object.prototype.hasOwnProperty.call(v,T)){var _=h?Object.getOwnPropertyDescriptor(v,T):null;_&&(_.get||_.set)?Object.defineProperty(m,T,_):m[T]=v[T]}return m.default=v,a&&a.set(v,m),m}var me=35044,ne=34962,ge=34963,C=34660,H=5120,z=5121,P=5122,j=5123,oe=5124,he=5125,Ne=5126,_e={attribPrefix:""};function or(v){_e.attribPrefix=v}function ur(v){se.copyExistingProperties(v,_e)}function rr(v,i,a,m,h){v.bindBuffer(i,a),v.bufferData(i,m,h||me)}function ye(v,i,a,m){if(se.isBuffer(v,i))return i;a=a||ne;var h=v.createBuffer();return rr(v,a,h,i,m),h}function x(v){return v==="indices"}function B(v){return v===Int8Array||v===Uint8Array}function U(v){return v.length?v:v.data}var A=/coord|texture/i,be=/color|colour/i;function we(v,i){var a;if(A.test(v)?a=2:be.test(v)?a=4:a=3,i%a>0)throw new Error("Can not guess numComponents for attribute '".concat(v,"'. Tried ").concat(a," but ").concat(i," values is not evenly divisible by ").concat(a,". You should specify it."));return a}function Ce(v,i,a){return v.numComponents||v.size||we(i,a||U(v).length)}function We(v,i){if(k.isArrayBuffer(v))return v;if(k.isArrayBuffer(v.data))return v.data;Array.isArray(v)&&(v={data:v});var a=v.type?Ze(v.type):void 0;return a||(x(i)?a=Uint16Array:a=Float32Array),new a(v.data)}function Ge(v){return typeof v=="number"?v:v?k.getGLTypeForTypedArrayType(v):Ne}function Ze(v){return typeof v=="number"?k.getTypedArrayTypeForGLType(v):v||Float32Array}function He(v,i){return{buffer:i.buffer,numValues:24,type:Ge(i.type),arrayType:Ze(i.type)}}function fr(v,i){var a=i.data||i,m=Ze(i.type),h=a*m.BYTES_PER_ELEMENT,T=v.createBuffer();return v.bindBuffer(ne,T),v.bufferData(ne,h,i.drawType||me),{buffer:T,numValues:a,type:k.getGLTypeForTypedArrayType(m),arrayType:m}}function Tr(v,i,a){var m=We(i,a);return{arrayType:m.constructor,buffer:ye(v,m,void 0,i.drawType),type:k.getGLTypeForTypedArray(m),numValues:0}}function cr(v,i){var a={};return Object.keys(i).forEach(function(m){if(!x(m)){var h=i[m],T=h.attrib||h.name||h.attribName||_e.attribPrefix+m;if(h.value){if(!Array.isArray(h.value)&&!k.isArrayBuffer(h.value))throw new Error("array.value is not array or typedarray");a[T]={value:h.value}}else{var _;h.buffer&&h.buffer instanceof WebGLBuffer?_=He:typeof h=="number"||typeof h.data=="number"?_=fr:_=Tr;var I=_(v,h,m),O=I.buffer,q=I.type,Z=I.numValues,$=I.arrayType,ie=h.normalize!==void 0?h.normalize:B($),ae=Ce(h,m,Z);a[T]={buffer:O,numComponents:ae,type:q,normalize:ie,stride:h.stride||0,offset:h.offset||0,divisor:h.divisor===void 0?void 0:h.divisor,drawType:h.drawType}}}}),v.bindBuffer(ne,null),a}function ar(v,i,a,m){a=We(a),m!==void 0?(v.bindBuffer(ne,i.buffer),v.bufferSubData(ne,m,a)):rr(v,ne,i.buffer,a,i.drawType)}function vr(v,i){return i===H||i===z?1:i===P||i===j?2:i===oe||i===he||i===Ne?4:0}var Sr=["position","positions","a_position"];function fe(v){var i,a;for(a=0;a<Sr.length&&(i=Sr[a],!(i in v));++a);a===Sr.length&&(i=Object.keys(v)[0]);var m=v[i],h=U(m).length;if(h===void 0)return 1;var T=Ce(m,i),_=h/T;if(h%T>0)throw new Error("numComponents ".concat(T," not correct for length ").concat(h));return _}function r(v,i){var a,m;for(m=0;m<Sr.length&&(a=Sr[m],!(a in i||(a=_e.attribPrefix+a,a in i)));++m);m===Sr.length&&(a=Object.keys(i)[0]);var h=i[a];if(!h.buffer)return 1;v.bindBuffer(ne,h.buffer);var T=v.getBufferParameter(ne,C);v.bindBuffer(ne,null);var _=vr(v,h.type),I=T/_,O=h.numComponents||h.size,q=I/O;if(q%1!==0)throw new Error("numComponents ".concat(O," not correct for length ").concat(length));return q}function f(v,i,a){var m=cr(v,i),h=Object.assign({},a||{});h.attribs=Object.assign({},a?a.attribs:{},m);var T=i.indices;if(T){var _=We(T,"indices");h.indices=ye(v,_,ge),h.numElements=_.length,h.elementType=k.getGLTypeForTypedArray(_)}else h.numElements||(h.numElements=r(v,h.attribs));return h}function c(v,i,a){var m=a==="indices"?ge:ne,h=We(i,a);return ye(v,h,m)}function E(v,i){var a={};return Object.keys(i).forEach(function(m){a[m]=c(v,i[m],m)}),i.indices?(a.numElements=i.indices.length,a.elementType=k.getGLTypeForTypedArray(We(i.indices),"indices")):a.numElements=fe(i),a}},"./src/draw.js":(X,u,Y)=>{function ee(C){"@babel/helpers - typeof";return ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(H){return typeof H}:function(H){return H&&typeof Symbol=="function"&&H.constructor===Symbol&&H!==Symbol.prototype?"symbol":typeof H},ee(C)}u.__esModule=!0,u.drawBufferInfo=ne,u.drawObjectList=ge;var k=te(Y("./src/programs.js"));function se(C){if(typeof WeakMap!="function")return null;var H=new WeakMap,z=new WeakMap;return(se=function(j){return j?z:H})(C)}function te(C,H){if(!H&&C&&C.__esModule)return C;if(C===null||ee(C)!="object"&&typeof C!="function")return{default:C};var z=se(H);if(z&&z.has(C))return z.get(C);var P={__proto__:null},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var oe in C)if(oe!=="default"&&Object.prototype.hasOwnProperty.call(C,oe)){var he=j?Object.getOwnPropertyDescriptor(C,oe):null;he&&(he.get||he.set)?Object.defineProperty(P,oe,he):P[oe]=C[oe]}return P.default=C,z&&z.set(C,P),P}var W=4,me=5123;function ne(C,H,z,P,j,oe){z=z===void 0?W:z;var he=H.indices,Ne=H.elementType,_e=P===void 0?H.numElements:P;j=j===void 0?0:j,Ne||he?oe!==void 0?C.drawElementsInstanced(z,_e,Ne===void 0?me:H.elementType,j,oe):C.drawElements(z,_e,Ne===void 0?me:H.elementType,j):oe!==void 0?C.drawArraysInstanced(z,j,_e,oe):C.drawArrays(z,j,_e)}function ge(C,H){var z=null,P=null;H.forEach(function(j){if(j.active!==!1){var oe=j.programInfo,he=j.vertexArrayInfo||j.bufferInfo,Ne=!1,_e=j.type===void 0?W:j.type;oe!==z&&(z=oe,C.useProgram(oe.program),Ne=!0),(Ne||he!==P)&&(P&&P.vertexArrayObject&&!he.vertexArrayObject&&C.bindVertexArray(null),P=he,k.setBuffersAndAttributes(C,oe,he)),k.setUniforms(oe,j.uniforms),ne(C,he,_e,j.count,j.offset,j.instanceCount)}}),P&&P.vertexArrayObject&&C.bindVertexArray(null)}},"./src/framebuffers.js":(X,u,Y)=>{function ee(fe){"@babel/helpers - typeof";return ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ee(fe)}u.__esModule=!0,u.bindFramebufferInfo=Sr,u.createFramebufferInfo=ar,u.resizeFramebufferInfo=vr;var k=W(Y("./src/textures.js")),se=W(Y("./src/helper.js"));function te(fe){if(typeof WeakMap!="function")return null;var r=new WeakMap,f=new WeakMap;return(te=function(E){return E?f:r})(fe)}function W(fe,r){if(!r&&fe&&fe.__esModule)return fe;if(fe===null||ee(fe)!="object"&&typeof fe!="function")return{default:fe};var f=te(r);if(f&&f.has(fe))return f.get(fe);var c={__proto__:null},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in fe)if(v!=="default"&&Object.prototype.hasOwnProperty.call(fe,v)){var i=E?Object.getOwnPropertyDescriptor(fe,v):null;i&&(i.get||i.set)?Object.defineProperty(c,v,i):c[v]=fe[v]}return c.default=fe,f&&f.set(fe,c),c}var me=36160,ne=36161,ge=3553,C=5121,H=6402,z=6408,P=33190,j=36012,oe=35056,he=36013,Ne=32854,_e=32855,or=36194,ur=33189,rr=6401,ye=36168,x=34041,B=36064,U=36096,A=36128,be=33306,we=33071,Ce=9729,We=[{format:z,type:C,min:Ce,wrap:we},{format:x}],Ge={};Ge[x]=be,Ge[rr]=A,Ge[ye]=A,Ge[H]=U,Ge[ur]=U,Ge[P]=U,Ge[j]=U,Ge[oe]=be,Ge[he]=be;function Ze(fe,r){return Ge[fe]||Ge[r]}var He={};He[Ne]=!0,He[_e]=!0,He[or]=!0,He[x]=!0,He[ur]=!0,He[rr]=!0,He[ye]=!0;function fr(fe){return He[fe]}var Tr=32;function cr(fe){return fe>=B&&fe<B+Tr}function ar(fe,r,f,c){var E=me,v=fe.createFramebuffer();fe.bindFramebuffer(E,v),f=f||fe.drawingBufferWidth,c=c||fe.drawingBufferHeight,r=r||We;var i=[],a={framebuffer:v,attachments:[],width:f,height:c};return r.forEach(function(m,h){var T=m.attachment,_=m.samples,I=m.format,O=m.attachmentPoint||Ze(I,m.internalFormat);if(O||(O=B+h),cr(O)&&i.push(O),!T)if(_!==void 0||fr(I))T=fe.createRenderbuffer(),fe.bindRenderbuffer(ne,T),_>1?fe.renderbufferStorageMultisample(ne,_,I,f,c):fe.renderbufferStorage(ne,I,f,c);else{var q=Object.assign({},m);q.width=f,q.height=c,q.auto===void 0&&(q.auto=!1,q.min=q.min||q.minMag||Ce,q.mag=q.mag||q.minMag||Ce,q.wrapS=q.wrapS||q.wrap||we,q.wrapT=q.wrapT||q.wrap||we),T=k.createTexture(fe,q)}if(se.isRenderbuffer(fe,T))fe.framebufferRenderbuffer(E,O,ne,T);else if(se.isTexture(fe,T))m.layer!==void 0?fe.framebufferTextureLayer(E,O,T,m.level||0,m.layer):fe.framebufferTexture2D(E,O,m.target||ge,T,m.level||0);else throw new Error("unknown attachment type");a.attachments.push(T)}),fe.drawBuffers&&fe.drawBuffers(i),a}function vr(fe,r,f,c,E){c=c||fe.drawingBufferWidth,E=E||fe.drawingBufferHeight,r.width=c,r.height=E,f=f||We,f.forEach(function(v,i){var a=r.attachments[i],m=v.format,h=v.samples;if(h!==void 0||se.isRenderbuffer(fe,a))fe.bindRenderbuffer(ne,a),h>1?fe.renderbufferStorageMultisample(ne,h,m,c,E):fe.renderbufferStorage(ne,m,c,E);else if(se.isTexture(fe,a))k.resizeTexture(fe,a,v,c,E);else throw new Error("unknown attachment type")})}function Sr(fe,r,f){f=f||me,r?(fe.bindFramebuffer(f,r.framebuffer),fe.viewport(0,0,r.width,r.height)):(fe.bindFramebuffer(f,null),fe.viewport(0,0,fe.drawingBufferWidth,fe.drawingBufferHeight))}},"./src/helper.js":(X,u)=>{u.__esModule=!0,u.copyExistingProperties=k,u.copyNamedProperties=ee,u.error=se,u.isBuffer=ne,u.isRenderbuffer=ge,u.isSampler=z,u.isShader=C,u.isTexture=H,u.warn=te;function Y(P){"@babel/helpers - typeof";return Y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(j){return typeof j}:function(j){return j&&typeof Symbol=="function"&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j},Y(P)}function ee(P,j,oe){P.forEach(function(he){var Ne=j[he];Ne!==void 0&&(oe[he]=Ne)})}function k(P,j){Object.keys(j).forEach(function(oe){j.hasOwnProperty(oe)&&P.hasOwnProperty(oe)&&(j[oe]=P[oe])})}function se(){var P;(P=console).error.apply(P,arguments)}function te(){var P;(P=console).warn.apply(P,arguments)}var W=new Map;function me(P,j){if(!P||Y(P)!=="object")return!1;var oe=W.get(j);oe||(oe=new WeakMap,W.set(j,oe));var he=oe.get(P);if(he===void 0){var Ne=Object.prototype.toString.call(P);he=Ne.substring(8,Ne.length-1)===j,oe.set(P,he)}return he}function ne(P,j){return typeof WebGLBuffer<"u"&&me(j,"WebGLBuffer")}function ge(P,j){return typeof WebGLRenderbuffer<"u"&&me(j,"WebGLRenderbuffer")}function C(P,j){return typeof WebGLShader<"u"&&me(j,"WebGLShader")}function H(P,j){return typeof WebGLTexture<"u"&&me(j,"WebGLTexture")}function z(P,j){return typeof WebGLSampler<"u"&&me(j,"WebGLSampler")}},"./src/m4.js":(X,u,Y)=>{function ee(r){"@babel/helpers - typeof";return ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},ee(r)}u.__esModule=!0,u.axisRotate=Tr,u.axisRotation=fr,u.copy=C,u.create=ge,u.frustum=rr,u.getAxis=Ne,u.getTranslation=he,u.identity=H,u.inverse=P,u.lookAt=U,u.multiply=j,u.negate=ne,u.ortho=ur,u.perspective=or,u.rotateX=Ce,u.rotateY=Ge,u.rotateZ=He,u.rotationX=we,u.rotationY=We,u.rotationZ=Ze,u.scale=ar,u.scaling=cr,u.setAxis=_e,u.setDefaultType=me,u.setTranslation=oe,u.transformDirection=Sr,u.transformNormal=fe,u.transformPoint=vr,u.translate=be,u.translation=A,u.transpose=z;var k=te(Y("./src/v3.js"));function se(r){if(typeof WeakMap!="function")return null;var f=new WeakMap,c=new WeakMap;return(se=function(v){return v?c:f})(r)}function te(r,f){if(!f&&r&&r.__esModule)return r;if(r===null||ee(r)!="object"&&typeof r!="function")return{default:r};var c=se(f);if(c&&c.has(r))return c.get(r);var E={__proto__:null},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in r)if(i!=="default"&&Object.prototype.hasOwnProperty.call(r,i)){var a=v?Object.getOwnPropertyDescriptor(r,i):null;a&&(a.get||a.set)?Object.defineProperty(E,i,a):E[i]=r[i]}return E.default=r,c&&c.set(r,E),E}var W=Float32Array;function me(r){var f=W;return W=r,f}function ne(r,f){return f=f||new W(16),f[0]=-r[0],f[1]=-r[1],f[2]=-r[2],f[3]=-r[3],f[4]=-r[4],f[5]=-r[5],f[6]=-r[6],f[7]=-r[7],f[8]=-r[8],f[9]=-r[9],f[10]=-r[10],f[11]=-r[11],f[12]=-r[12],f[13]=-r[13],f[14]=-r[14],f[15]=-r[15],f}function ge(){return new W(16).fill(0)}function C(r,f){return f=f||new W(16),f[0]=r[0],f[1]=r[1],f[2]=r[2],f[3]=r[3],f[4]=r[4],f[5]=r[5],f[6]=r[6],f[7]=r[7],f[8]=r[8],f[9]=r[9],f[10]=r[10],f[11]=r[11],f[12]=r[12],f[13]=r[13],f[14]=r[14],f[15]=r[15],f}function H(r){return r=r||new W(16),r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function z(r,f){if(f=f||new W(16),f===r){var c;return c=r[1],r[1]=r[4],r[4]=c,c=r[2],r[2]=r[8],r[8]=c,c=r[3],r[3]=r[12],r[12]=c,c=r[6],r[6]=r[9],r[9]=c,c=r[7],r[7]=r[13],r[13]=c,c=r[11],r[11]=r[14],r[14]=c,f}var E=r[0*4+0],v=r[0*4+1],i=r[0*4+2],a=r[0*4+3],m=r[1*4+0],h=r[1*4+1],T=r[1*4+2],_=r[1*4+3],I=r[2*4+0],O=r[2*4+1],q=r[2*4+2],Z=r[2*4+3],$=r[3*4+0],ie=r[3*4+1],ae=r[3*4+2],le=r[3*4+3];return f[0]=E,f[1]=m,f[2]=I,f[3]=$,f[4]=v,f[5]=h,f[6]=O,f[7]=ie,f[8]=i,f[9]=T,f[10]=q,f[11]=ae,f[12]=a,f[13]=_,f[14]=Z,f[15]=le,f}function P(r,f){f=f||new W(16);var c=r[0*4+0],E=r[0*4+1],v=r[0*4+2],i=r[0*4+3],a=r[1*4+0],m=r[1*4+1],h=r[1*4+2],T=r[1*4+3],_=r[2*4+0],I=r[2*4+1],O=r[2*4+2],q=r[2*4+3],Z=r[3*4+0],$=r[3*4+1],ie=r[3*4+2],ae=r[3*4+3],le=O*ae,ve=ie*q,re=h*ae,de=ie*T,Oe=h*q,Ke=O*T,ke=v*ae,Ve=ie*i,Pe=v*q,De=O*i,Qe=v*T,Xe=h*i,ze=_*$,qe=Z*I,Je=a*$,Le=Z*m,Ue=a*I,yr=_*m,lr=c*$,gr=Z*E,_r=c*I,Ir=_*E,Ur=c*m,Gr=a*E,$r=le*m+de*I+Oe*$-(ve*m+re*I+Ke*$),At=ve*E+ke*I+De*$-(le*E+Ve*I+Pe*$),_t=re*E+Ve*m+Qe*$-(de*E+ke*m+Xe*$),wt=Ke*E+Pe*m+Xe*I-(Oe*E+De*m+Qe*I),hr=1/(c*$r+a*At+_*_t+Z*wt);return f[0]=hr*$r,f[1]=hr*At,f[2]=hr*_t,f[3]=hr*wt,f[4]=hr*(ve*a+re*_+Ke*Z-(le*a+de*_+Oe*Z)),f[5]=hr*(le*c+Ve*_+Pe*Z-(ve*c+ke*_+De*Z)),f[6]=hr*(de*c+ke*a+Xe*Z-(re*c+Ve*a+Qe*Z)),f[7]=hr*(Oe*c+De*a+Qe*_-(Ke*c+Pe*a+Xe*_)),f[8]=hr*(ze*T+Le*q+Ue*ae-(qe*T+Je*q+yr*ae)),f[9]=hr*(qe*i+lr*q+Ir*ae-(ze*i+gr*q+_r*ae)),f[10]=hr*(Je*i+gr*T+Ur*ae-(Le*i+lr*T+Gr*ae)),f[11]=hr*(yr*i+_r*T+Gr*q-(Ue*i+Ir*T+Ur*q)),f[12]=hr*(Je*O+yr*ie+qe*h-(Ue*ie+ze*h+Le*O)),f[13]=hr*(_r*ie+ze*v+gr*O-(lr*O+Ir*ie+qe*v)),f[14]=hr*(lr*h+Gr*ie+Le*v-(Ur*ie+Je*v+gr*h)),f[15]=hr*(Ur*O+Ue*v+Ir*h-(_r*h+Gr*O+yr*v)),f}function j(r,f,c){c=c||new W(16);var E=r[0],v=r[1],i=r[2],a=r[3],m=r[4],h=r[5],T=r[6],_=r[7],I=r[8],O=r[9],q=r[10],Z=r[11],$=r[12],ie=r[13],ae=r[14],le=r[15],ve=f[0],re=f[1],de=f[2],Oe=f[3],Ke=f[4],ke=f[5],Ve=f[6],Pe=f[7],De=f[8],Qe=f[9],Xe=f[10],ze=f[11],qe=f[12],Je=f[13],Le=f[14],Ue=f[15];return c[0]=E*ve+m*re+I*de+$*Oe,c[1]=v*ve+h*re+O*de+ie*Oe,c[2]=i*ve+T*re+q*de+ae*Oe,c[3]=a*ve+_*re+Z*de+le*Oe,c[4]=E*Ke+m*ke+I*Ve+$*Pe,c[5]=v*Ke+h*ke+O*Ve+ie*Pe,c[6]=i*Ke+T*ke+q*Ve+ae*Pe,c[7]=a*Ke+_*ke+Z*Ve+le*Pe,c[8]=E*De+m*Qe+I*Xe+$*ze,c[9]=v*De+h*Qe+O*Xe+ie*ze,c[10]=i*De+T*Qe+q*Xe+ae*ze,c[11]=a*De+_*Qe+Z*Xe+le*ze,c[12]=E*qe+m*Je+I*Le+$*Ue,c[13]=v*qe+h*Je+O*Le+ie*Ue,c[14]=i*qe+T*Je+q*Le+ae*Ue,c[15]=a*qe+_*Je+Z*Le+le*Ue,c}function oe(r,f,c){return c=c||H(),r!==c&&(c[0]=r[0],c[1]=r[1],c[2]=r[2],c[3]=r[3],c[4]=r[4],c[5]=r[5],c[6]=r[6],c[7]=r[7],c[8]=r[8],c[9]=r[9],c[10]=r[10],c[11]=r[11]),c[12]=f[0],c[13]=f[1],c[14]=f[2],c[15]=1,c}function he(r,f){return f=f||k.create(),f[0]=r[12],f[1]=r[13],f[2]=r[14],f}function Ne(r,f,c){c=c||k.create();var E=f*4;return c[0]=r[E+0],c[1]=r[E+1],c[2]=r[E+2],c}function _e(r,f,c,E){E!==r&&(E=C(r,E));var v=c*4;return E[v+0]=f[0],E[v+1]=f[1],E[v+2]=f[2],E}function or(r,f,c,E,v){v=v||new W(16);var i=Math.tan(Math.PI*.5-.5*r),a=1/(c-E);return v[0]=i/f,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=i,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=(c+E)*a,v[11]=-1,v[12]=0,v[13]=0,v[14]=c*E*a*2,v[15]=0,v}function ur(r,f,c,E,v,i,a){return a=a||new W(16),a[0]=2/(f-r),a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2/(E-c),a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2/(v-i),a[11]=0,a[12]=(f+r)/(r-f),a[13]=(E+c)/(c-E),a[14]=(i+v)/(v-i),a[15]=1,a}function rr(r,f,c,E,v,i,a){a=a||new W(16);var m=f-r,h=E-c,T=v-i;return a[0]=2*v/m,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*v/h,a[6]=0,a[7]=0,a[8]=(r+f)/m,a[9]=(E+c)/h,a[10]=i/T,a[11]=-1,a[12]=0,a[13]=0,a[14]=v*i/T,a[15]=0,a}var ye,x,B;function U(r,f,c,E){return E=E||new W(16),ye=ye||k.create(),x=x||k.create(),B=B||k.create(),k.normalize(k.subtract(r,f,B),B),k.normalize(k.cross(c,B,ye),ye),k.normalize(k.cross(B,ye,x),x),E[0]=ye[0],E[1]=ye[1],E[2]=ye[2],E[3]=0,E[4]=x[0],E[5]=x[1],E[6]=x[2],E[7]=0,E[8]=B[0],E[9]=B[1],E[10]=B[2],E[11]=0,E[12]=r[0],E[13]=r[1],E[14]=r[2],E[15]=1,E}function A(r,f){return f=f||new W(16),f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=r[0],f[13]=r[1],f[14]=r[2],f[15]=1,f}function be(r,f,c){c=c||new W(16);var E=f[0],v=f[1],i=f[2],a=r[0],m=r[1],h=r[2],T=r[3],_=r[1*4+0],I=r[1*4+1],O=r[1*4+2],q=r[1*4+3],Z=r[2*4+0],$=r[2*4+1],ie=r[2*4+2],ae=r[2*4+3],le=r[3*4+0],ve=r[3*4+1],re=r[3*4+2],de=r[3*4+3];return r!==c&&(c[0]=a,c[1]=m,c[2]=h,c[3]=T,c[4]=_,c[5]=I,c[6]=O,c[7]=q,c[8]=Z,c[9]=$,c[10]=ie,c[11]=ae),c[12]=a*E+_*v+Z*i+le,c[13]=m*E+I*v+$*i+ve,c[14]=h*E+O*v+ie*i+re,c[15]=T*E+q*v+ae*i+de,c}function we(r,f){f=f||new W(16);var c=Math.cos(r),E=Math.sin(r);return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=c,f[6]=E,f[7]=0,f[8]=0,f[9]=-E,f[10]=c,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function Ce(r,f,c){c=c||new W(16);var E=r[4],v=r[5],i=r[6],a=r[7],m=r[8],h=r[9],T=r[10],_=r[11],I=Math.cos(f),O=Math.sin(f);return c[4]=I*E+O*m,c[5]=I*v+O*h,c[6]=I*i+O*T,c[7]=I*a+O*_,c[8]=I*m-O*E,c[9]=I*h-O*v,c[10]=I*T-O*i,c[11]=I*_-O*a,r!==c&&(c[0]=r[0],c[1]=r[1],c[2]=r[2],c[3]=r[3],c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c}function We(r,f){f=f||new W(16);var c=Math.cos(r),E=Math.sin(r);return f[0]=c,f[1]=0,f[2]=-E,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=E,f[9]=0,f[10]=c,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function Ge(r,f,c){c=c||new W(16);var E=r[0*4+0],v=r[0*4+1],i=r[0*4+2],a=r[0*4+3],m=r[2*4+0],h=r[2*4+1],T=r[2*4+2],_=r[2*4+3],I=Math.cos(f),O=Math.sin(f);return c[0]=I*E-O*m,c[1]=I*v-O*h,c[2]=I*i-O*T,c[3]=I*a-O*_,c[8]=I*m+O*E,c[9]=I*h+O*v,c[10]=I*T+O*i,c[11]=I*_+O*a,r!==c&&(c[4]=r[4],c[5]=r[5],c[6]=r[6],c[7]=r[7],c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c}function Ze(r,f){f=f||new W(16);var c=Math.cos(r),E=Math.sin(r);return f[0]=c,f[1]=E,f[2]=0,f[3]=0,f[4]=-E,f[5]=c,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function He(r,f,c){c=c||new W(16);var E=r[0*4+0],v=r[0*4+1],i=r[0*4+2],a=r[0*4+3],m=r[1*4+0],h=r[1*4+1],T=r[1*4+2],_=r[1*4+3],I=Math.cos(f),O=Math.sin(f);return c[0]=I*E+O*m,c[1]=I*v+O*h,c[2]=I*i+O*T,c[3]=I*a+O*_,c[4]=I*m-O*E,c[5]=I*h-O*v,c[6]=I*T-O*i,c[7]=I*_-O*a,r!==c&&(c[8]=r[8],c[9]=r[9],c[10]=r[10],c[11]=r[11],c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c}function fr(r,f,c){c=c||new W(16);var E=r[0],v=r[1],i=r[2],a=Math.sqrt(E*E+v*v+i*i);E/=a,v/=a,i/=a;var m=E*E,h=v*v,T=i*i,_=Math.cos(f),I=Math.sin(f),O=1-_;return c[0]=m+(1-m)*_,c[1]=E*v*O+i*I,c[2]=E*i*O-v*I,c[3]=0,c[4]=E*v*O-i*I,c[5]=h+(1-h)*_,c[6]=v*i*O+E*I,c[7]=0,c[8]=E*i*O+v*I,c[9]=v*i*O-E*I,c[10]=T+(1-T)*_,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function Tr(r,f,c,E){E=E||new W(16);var v=f[0],i=f[1],a=f[2],m=Math.sqrt(v*v+i*i+a*a);v/=m,i/=m,a/=m;var h=v*v,T=i*i,_=a*a,I=Math.cos(c),O=Math.sin(c),q=1-I,Z=h+(1-h)*I,$=v*i*q+a*O,ie=v*a*q-i*O,ae=v*i*q-a*O,le=T+(1-T)*I,ve=i*a*q+v*O,re=v*a*q+i*O,de=i*a*q-v*O,Oe=_+(1-_)*I,Ke=r[0],ke=r[1],Ve=r[2],Pe=r[3],De=r[4],Qe=r[5],Xe=r[6],ze=r[7],qe=r[8],Je=r[9],Le=r[10],Ue=r[11];return E[0]=Z*Ke+$*De+ie*qe,E[1]=Z*ke+$*Qe+ie*Je,E[2]=Z*Ve+$*Xe+ie*Le,E[3]=Z*Pe+$*ze+ie*Ue,E[4]=ae*Ke+le*De+ve*qe,E[5]=ae*ke+le*Qe+ve*Je,E[6]=ae*Ve+le*Xe+ve*Le,E[7]=ae*Pe+le*ze+ve*Ue,E[8]=re*Ke+de*De+Oe*qe,E[9]=re*ke+de*Qe+Oe*Je,E[10]=re*Ve+de*Xe+Oe*Le,E[11]=re*Pe+de*ze+Oe*Ue,r!==E&&(E[12]=r[12],E[13]=r[13],E[14]=r[14],E[15]=r[15]),E}function cr(r,f){return f=f||new W(16),f[0]=r[0],f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=r[1],f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=r[2],f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function ar(r,f,c){c=c||new W(16);var E=f[0],v=f[1],i=f[2];return c[0]=E*r[0],c[1]=E*r[1],c[2]=E*r[2],c[3]=E*r[3],c[4]=v*r[4],c[5]=v*r[5],c[6]=v*r[6],c[7]=v*r[7],c[8]=i*r[8],c[9]=i*r[9],c[10]=i*r[10],c[11]=i*r[11],r!==c&&(c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c}function vr(r,f,c){c=c||k.create();var E=f[0],v=f[1],i=f[2],a=E*r[0*4+3]+v*r[1*4+3]+i*r[2*4+3]+r[3*4+3];return c[0]=(E*r[0]+v*r[4]+i*r[8]+r[12])/a,c[1]=(E*r[1]+v*r[5]+i*r[9]+r[13])/a,c[2]=(E*r[2]+v*r[6]+i*r[10]+r[14])/a,c}function Sr(r,f,c){c=c||k.create();var E=f[0],v=f[1],i=f[2];return c[0]=E*r[0]+v*r[4]+i*r[8],c[1]=E*r[1]+v*r[5]+i*r[9],c[2]=E*r[2]+v*r[6]+i*r[10],c}function fe(r,f,c){c=c||k.create();var E=P(r),v=f[0],i=f[1],a=f[2];return c[0]=v*E[0]+i*E[1]+a*E[2],c[1]=v*E[4]+i*E[5]+a*E[6],c[2]=v*E[8]+i*E[9]+a*E[10],c}},"./src/primitives.js":(X,u,Y)=>{function ee(i){"@babel/helpers - typeof";return ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},ee(i)}u.__esModule=!0,u.concatVertices=f,u.create3DFBuffers=u.create3DFBufferInfo=void 0,u.create3DFVertices=We,u.createAugmentedTypedArray=P,u.createCrescentBuffers=u.createCrescentBufferInfo=void 0,u.createCrescentVertices=Ge,u.createCubeBuffers=u.createCubeBufferInfo=u.createCresentVertices=u.createCresentBuffers=u.createCresentBufferInfo=void 0,u.createCubeVertices=be,u.createCylinderBuffers=u.createCylinderBufferInfo=void 0,u.createCylinderVertices=Ze,u.createDiscBuffers=u.createDiscBufferInfo=void 0,u.createDiscVertices=fr,u.createPlaneBuffers=u.createPlaneBufferInfo=void 0,u.createPlaneVertices=B,u.createSphereBuffers=u.createSphereBufferInfo=void 0,u.createSphereVertices=U,u.createTorusBuffers=u.createTorusBufferInfo=void 0,u.createTorusVertices=He,u.createTruncatedConeBuffers=u.createTruncatedConeBufferInfo=void 0,u.createTruncatedConeVertices=we,u.createXYQuadBuffers=u.createXYQuadBufferInfo=void 0,u.createXYQuadVertices=x,u.deindexVertices=oe,u.duplicateVertices=c,u.flattenNormals=he,u.makeRandomVertexColors=cr,u.reorientDirections=or,u.reorientNormals=ur,u.reorientPositions=rr,u.reorientVertices=ye;var k=ge(Y("./src/attributes.js")),se=ge(Y("./src/helper.js")),te=ge(Y("./src/typedarrays.js")),W=ge(Y("./src/m4.js")),me=ge(Y("./src/v3.js"));function ne(i){if(typeof WeakMap!="function")return null;var a=new WeakMap,m=new WeakMap;return(ne=function(T){return T?m:a})(i)}function ge(i,a){if(!a&&i&&i.__esModule)return i;if(i===null||ee(i)!="object"&&typeof i!="function")return{default:i};var m=ne(a);if(m&&m.has(i))return m.get(i);var h={__proto__:null},T=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var _ in i)if(_!=="default"&&Object.prototype.hasOwnProperty.call(i,_)){var I=T?Object.getOwnPropertyDescriptor(i,_):null;I&&(I.get||I.set)?Object.defineProperty(h,_,I):h[_]=i[_]}return h.default=i,m&&m.set(i,h),h}var C=k.getArray_,H=k.getNumComponents_;function z(i,a){var m=0;return i.push=function(){for(var h=0;h<arguments.length;++h){var T=arguments[h];if(T instanceof Array||te.isArrayBuffer(T))for(var _=0;_<T.length;++_)i[m++]=T[_];else i[m++]=T}},i.reset=function(h){m=h||0},i.numComponents=a,Object.defineProperty(i,"numElements",{get:function(){return this.length/this.numComponents|0}}),i}function P(i,a,m){var h=m||Float32Array;return z(new h(i*a),i)}function j(i){return i!=="indices"}function oe(i){var a=i.indices,m={},h=a.length;function T(_){for(var I=i[_],O=I.numComponents,q=P(O,h,I.constructor),Z=0;Z<h;++Z)for(var $=a[Z],ie=$*O,ae=0;ae<O;++ae)q.push(I[ie+ae]);m[_]=q}return Object.keys(i).filter(j).forEach(T),m}function he(i){if(i.indices)throw new Error("can not flatten normals of indexed vertices. deindex them first");for(var a=i.normal,m=a.length,h=0;h<m;h+=9){var T=a[h+0],_=a[h+1],I=a[h+2],O=a[h+3],q=a[h+4],Z=a[h+5],$=a[h+6],ie=a[h+7],ae=a[h+8],le=T+O+$,ve=_+q+ie,re=I+Z+ae,de=Math.sqrt(le*le+ve*ve+re*re);le/=de,ve/=de,re/=de,a[h+0]=le,a[h+1]=ve,a[h+2]=re,a[h+3]=le,a[h+4]=ve,a[h+5]=re,a[h+6]=le,a[h+7]=ve,a[h+8]=re}return i}function Ne(i,a,m){for(var h=i.length,T=new Float32Array(3),_=0;_<h;_+=3)m(a,[i[_],i[_+1],i[_+2]],T),i[_]=T[0],i[_+1]=T[1],i[_+2]=T[2]}function _e(i,a,m){m=m||me.create();var h=a[0],T=a[1],_=a[2];return m[0]=h*i[0]+T*i[1]+_*i[2],m[1]=h*i[4]+T*i[5]+_*i[6],m[2]=h*i[8]+T*i[9]+_*i[10],m}function or(i,a){return Ne(i,a,W.transformDirection),i}function ur(i,a){return Ne(i,W.inverse(a),_e),i}function rr(i,a){return Ne(i,a,W.transformPoint),i}function ye(i,a){return Object.keys(i).forEach(function(m){var h=i[m];m.indexOf("pos")>=0?rr(h,a):m.indexOf("tan")>=0||m.indexOf("binorm")>=0?or(h,a):m.indexOf("norm")>=0&&ur(h,a)}),i}function x(i,a,m){return i=i||2,a=a||0,m=m||0,i*=.5,{position:{numComponents:2,data:[a+-1*i,m+-1*i,a+1*i,m+-1*i,a+-1*i,m+1*i,a+1*i,m+1*i]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function B(i,a,m,h,T){i=i||1,a=a||1,m=m||1,h=h||1,T=T||W.identity();for(var _=(m+1)*(h+1),I=P(3,_),O=P(3,_),q=P(2,_),Z=0;Z<=h;Z++)for(var $=0;$<=m;$++){var ie=$/m,ae=Z/h;I.push(i*ie-i*.5,0,a*ae-a*.5),O.push(0,1,0),q.push(ie,ae)}for(var le=m+1,ve=P(3,m*h*2,Uint16Array),re=0;re<h;re++)for(var de=0;de<m;de++)ve.push((re+0)*le+de,(re+1)*le+de,(re+0)*le+de+1),ve.push((re+1)*le+de,(re+1)*le+de+1,(re+0)*le+de+1);var Oe=ye({position:I,normal:O,texcoord:q,indices:ve},T);return Oe}function U(i,a,m,h,T,_,I){if(a<=0||m<=0)throw new Error("subdivisionAxis and subdivisionHeight must be > 0");h=h||0,T=T||Math.PI,_=_||0,I=I||Math.PI*2;for(var O=T-h,q=I-_,Z=(a+1)*(m+1),$=P(3,Z),ie=P(3,Z),ae=P(2,Z),le=0;le<=m;le++)for(var ve=0;ve<=a;ve++){var re=ve/a,de=le/m,Oe=q*re+_,Ke=O*de+h,ke=Math.sin(Oe),Ve=Math.cos(Oe),Pe=Math.sin(Ke),De=Math.cos(Ke),Qe=Ve*Pe,Xe=De,ze=ke*Pe;$.push(i*Qe,i*Xe,i*ze),ie.push(Qe,Xe,ze),ae.push(1-re,de)}for(var qe=a+1,Je=P(3,a*m*2,Uint16Array),Le=0;Le<a;Le++)for(var Ue=0;Ue<m;Ue++)Je.push((Ue+0)*qe+Le,(Ue+0)*qe+Le+1,(Ue+1)*qe+Le),Je.push((Ue+1)*qe+Le,(Ue+0)*qe+Le+1,(Ue+1)*qe+Le+1);return{position:$,normal:ie,texcoord:ae,indices:Je}}var A=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function be(i){i=i||1;for(var a=i/2,m=[[-a,-a,-a],[+a,-a,-a],[-a,+a,-a],[+a,+a,-a],[-a,-a,+a],[+a,-a,+a],[-a,+a,+a],[+a,+a,+a]],h=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],T=[[1,0],[0,0],[0,1],[1,1]],_=6*4,I=P(3,_),O=P(3,_),q=P(2,_),Z=P(3,6*2,Uint16Array),$=0;$<6;++$){for(var ie=A[$],ae=0;ae<4;++ae){var le=m[ie[ae]],ve=h[$],re=T[ae];I.push(le),O.push(ve),q.push(re)}var de=4*$;Z.push(de+0,de+1,de+2),Z.push(de+0,de+2,de+3)}return{position:I,normal:O,texcoord:q,indices:Z}}function we(i,a,m,h,T,_,I){if(h<3)throw new Error("radialSubdivisions must be 3 or greater");if(T<1)throw new Error("verticalSubdivisions must be 1 or greater");for(var O=_===void 0?!0:_,q=I===void 0?!0:I,Z=(O?2:0)+(q?2:0),$=(h+1)*(T+1+Z),ie=P(3,$),ae=P(3,$),le=P(2,$),ve=P(3,h*(T+Z/2)*2,Uint16Array),re=h+1,de=Math.atan2(i-a,m),Oe=Math.cos(de),Ke=Math.sin(de),ke=O?-2:0,Ve=T+(q?2:0),Pe=ke;Pe<=Ve;++Pe){var De=Pe/T,Qe=m*De,Xe=void 0;Pe<0?(Qe=0,De=1,Xe=i):Pe>T?(Qe=m,De=1,Xe=a):Xe=i+(a-i)*(Pe/T),(Pe===-2||Pe===T+2)&&(Xe=0,De=0),Qe-=m/2;for(var ze=0;ze<re;++ze){var qe=Math.sin(ze*Math.PI*2/h),Je=Math.cos(ze*Math.PI*2/h);ie.push(qe*Xe,Qe,Je*Xe),Pe<0?ae.push(0,-1,0):Pe>T?ae.push(0,1,0):Xe===0?ae.push(0,0,0):ae.push(qe*Oe,Ke,Je*Oe),le.push(ze/h,1-De)}}for(var Le=0;Le<T+Z;++Le)if(!(Le===1&&O||Le===T+Z-2&&q))for(var Ue=0;Ue<h;++Ue)ve.push(re*(Le+0)+0+Ue,re*(Le+0)+1+Ue,re*(Le+1)+1+Ue),ve.push(re*(Le+0)+0+Ue,re*(Le+1)+1+Ue,re*(Le+1)+0+Ue);return{position:ie,normal:ae,texcoord:le,indices:ve}}function Ce(i,a){a=a||[];for(var m=[],h=0;h<i.length;h+=4){var T=i[h],_=i.slice(h+1,h+4);_.push.apply(_,a);for(var I=0;I<T;++I)m.push.apply(m,_)}return m}function We(){var i=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],a=[.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0],m=Ce([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),h=Ce([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),T=i.length/3,_={position:P(3,T),texcoord:P(2,T),normal:P(3,T),color:P(4,T,Uint8Array),indices:P(3,T/3,Uint16Array)};_.position.push(i),_.texcoord.push(a),_.normal.push(m),_.color.push(h);for(var I=0;I<T;++I)_.indices.push(I);return _}function Ge(i,a,m,h,T,_,I){if(T<=0)throw new Error("subdivisionDown must be > 0");_=_||0,I=I||1;var O=2,q=I-_,Z=(T+1)*2*(2+O),$=P(3,Z),ie=P(3,Z),ae=P(2,Z);function le(Ve,Pe,De){return Ve+(Pe-Ve)*De}function ve(Ve,Pe,De,Qe,Xe,ze){for(var qe=0;qe<=T;qe++){var Je=Pe/(O-1),Le=qe/T,Ue=(Je-.5)*2,yr=(_+Le*q)*Math.PI,lr=Math.sin(yr),gr=Math.cos(yr),_r=le(i,Ve,lr),Ir=Ue*h,Ur=gr*i,Gr=lr*_r;$.push(Ir,Ur,Gr);var $r=me.add(me.multiply([0,lr,gr],De),Qe);ie.push($r),ae.push(Je*Xe+ze,Le)}}for(var re=0;re<O;re++){var de=(re/(O-1)-.5)*2;ve(a,re,[1,1,1],[0,0,0],1,0),ve(a,re,[0,0,0],[de,0,0],0,0),ve(m,re,[1,1,1],[0,0,0],1,0),ve(m,re,[0,0,0],[de,0,0],0,1)}var Oe=P(3,T*2*(2+O),Uint16Array);function Ke(Ve,Pe){for(var De=0;De<T;++De)Oe.push(Ve+De+0,Ve+De+1,Pe+De+0),Oe.push(Ve+De+1,Pe+De+1,Pe+De+0)}var ke=T+1;return Ke(ke*0,ke*4),Ke(ke*5,ke*7),Ke(ke*6,ke*2),Ke(ke*3,ke*1),{position:$,normal:ie,texcoord:ae,indices:Oe}}function Ze(i,a,m,h,T,_){return we(i,i,a,m,h,T,_)}function He(i,a,m,h,T,_){if(m<3)throw new Error("radialSubdivisions must be 3 or greater");if(h<3)throw new Error("verticalSubdivisions must be 3 or greater");T=T||0,_=_||Math.PI*2;for(var I=_-T,O=m+1,q=h+1,Z=O*q,$=P(3,Z),ie=P(3,Z),ae=P(2,Z),le=P(3,m*h*2,Uint16Array),ve=0;ve<q;++ve)for(var re=ve/h,de=re*Math.PI*2,Oe=Math.sin(de),Ke=i+Oe*a,ke=Math.cos(de),Ve=ke*a,Pe=0;Pe<O;++Pe){var De=Pe/m,Qe=T+De*I,Xe=Math.sin(Qe),ze=Math.cos(Qe),qe=Xe*Ke,Je=ze*Ke,Le=Xe*Oe,Ue=ze*Oe;$.push(qe,Ve,Je),ie.push(Le,ke,Ue),ae.push(De,1-re)}for(var yr=0;yr<h;++yr)for(var lr=0;lr<m;++lr){var gr=1+lr,_r=1+yr;le.push(O*yr+lr,O*_r+lr,O*yr+gr),le.push(O*_r+lr,O*_r+gr,O*yr+gr)}return{position:$,normal:ie,texcoord:ae,indices:le}}function fr(i,a,m,h,T){if(a<3)throw new Error("divisions must be at least 3");m=m||1,T=T||1,h=h||0;for(var _=(a+1)*(m+1),I=P(3,_),O=P(3,_),q=P(2,_),Z=P(3,m*a*2,Uint16Array),$=0,ie=i-h,ae=a+1,le=0;le<=m;++le){for(var ve=h+ie*Math.pow(le/m,T),re=0;re<=a;++re){var de=2*Math.PI*re/a,Oe=ve*Math.cos(de),Ke=ve*Math.sin(de);if(I.push(Oe,0,Ke),O.push(0,1,0),q.push(1-re/a,le/m),le>0&&re!==a){var ke=$+(re+1),Ve=$+re,Pe=$+re-ae,De=$+(re+1)-ae;Z.push(ke,Ve,Pe),Z.push(ke,Pe,De)}}$+=a+1}return{position:I,normal:O,texcoord:q,indices:Z}}function Tr(i){return Math.random()*i|0}function cr(i,a){a=a||{};var m=i.position.numElements,h=P(4,m,Uint8Array),T=a.rand||function(ie,ae){return ae<3?Tr(256):255};if(i.color=h,i.indices)for(var _=0;_<m;++_)h.push(T(_,0),T(_,1),T(_,2),T(_,3));else for(var I=a.vertsPerColor||3,O=m/I,q=0;q<O;++q)for(var Z=[T(q,0),T(q,1),T(q,2),T(q,3)],$=0;$<I;++$)h.push(Z);return i}function ar(i){return function(a){var m=i.apply(this,Array.prototype.slice.call(arguments,1));return k.createBuffersFromArrays(a,m)}}function vr(i){return function(a){var m=i.apply(null,Array.prototype.slice.call(arguments,1));return k.createBufferInfoFromArrays(a,m)}}var Sr=["numComponents","size","type","normalize","stride","offset","attrib","name","attribName"];function fe(i,a,m,h){h=h||0;for(var T=i.length,_=0;_<T;++_)a[m+_]=i[_]+h}function r(i,a){var m=C(i),h=new m.constructor(a),T=h;return m.numComponents&&m.numElements&&z(h,m.numComponents),i.data&&(T={data:h},se.copyNamedProperties(Sr,i,T)),T}function f(i){for(var a={},m,h=function(){var $=i[T];Object.keys($).forEach(function(ie){a[ie]||(a[ie]=[]),!m&&ie!=="indices"&&(m=ie);var ae=$[ie],le=H(ae,ie),ve=C(ae),re=ve.length/le;a[ie].push(re)})},T=0;T<i.length;++T)h();function _(Z){for(var $=0,ie,ae=0;ae<i.length;++ae){var le=i[ae],ve=le[Z],re=C(ve);$+=re.length,(!ie||ve.data)&&(ie=ve)}return{length:$,spec:ie}}function I(Z,$,ie){for(var ae=0,le=0,ve=0;ve<i.length;++ve){var re=i[ve],de=re[Z],Oe=C(de);Z==="indices"?(fe(Oe,ie,le,ae),ae+=$[ve]):fe(Oe,ie,le),le+=Oe.length}}var O=a[m],q={};return Object.keys(a).forEach(function(Z){var $=_(Z),ie=r($.spec,$.length);I(Z,O,C(ie)),q[Z]=ie}),q}function c(i){var a={};return Object.keys(i).forEach(function(m){var h=i[m],T=C(h),_=r(h,T.length);fe(T,C(_),0),a[m]=_}),a}u.create3DFBufferInfo=vr(We),u.create3DFBuffers=ar(We),u.createCubeBufferInfo=vr(be),u.createCubeBuffers=ar(be),u.createPlaneBufferInfo=vr(B),u.createPlaneBuffers=ar(B),u.createSphereBufferInfo=vr(U),u.createSphereBuffers=ar(U),u.createTruncatedConeBufferInfo=vr(we),u.createTruncatedConeBuffers=ar(we),u.createXYQuadBufferInfo=vr(x),u.createXYQuadBuffers=ar(x);var E=u.createCrescentBufferInfo=vr(Ge),v=u.createCrescentBuffers=ar(Ge);u.createCylinderBufferInfo=vr(Ze),u.createCylinderBuffers=ar(Ze),u.createTorusBufferInfo=vr(He),u.createTorusBuffers=ar(He),u.createDiscBufferInfo=vr(fr),u.createDiscBuffers=ar(fr),u.createCresentBufferInfo=E,u.createCresentBuffers=v,u.createCresentVertices=Ge},"./src/programs.js":(X,u,Y)=>{function ee(e){"@babel/helpers - typeof";return ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ee(e)}u.__esModule=!0,u.bindTransformFeedbackInfo=Mt,u.bindUniformBlock=Nt,u.createAttributeSetters=ln,u.createProgram=mt,u.createProgramAsync=void 0,u.createProgramFromScripts=nn,u.createProgramFromSources=an,u.createProgramInfo=s,u.createProgramInfoAsync=void 0,u.createProgramInfoFromProgram=Gt,u.createProgramInfos=g,u.createProgramInfosAsync=void 0,u.createPrograms=p,u.createProgramsAsync=void 0,u.createTransformFeedback=un,u.createTransformFeedbackInfo=Ot,u.createUniformBlockInfo=cn,u.createUniformBlockInfoFromProgram=fn,u.createUniformBlockSpecFromProgram=zr,u.createUniformSetters=tt,u.setAttributes=sn,u.setBlockUniforms=ya,u.setBuffersAndAttributes=pa,u.setUniformBlock=jn,u.setUniforms=Ut,u.setUniformsAndBindTextures=void 0;var k=W(Y("./src/utils.js")),se=W(Y("./src/helper.js"));function te(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,n=new WeakMap;return(te=function(b){return b?n:t})(e)}function W(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||ee(e)!="object"&&typeof e!="function")return{default:e};var n=te(t);if(n&&n.has(e))return n.get(e);var d={__proto__:null},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var S in e)if(S!=="default"&&Object.prototype.hasOwnProperty.call(e,S)){var F=b?Object.getOwnPropertyDescriptor(e,S):null;F&&(F.get||F.set)?Object.defineProperty(d,S,F):d[S]=e[S]}return d.default=e,n&&n.set(e,d),d}function me(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */me=function(){return t};var e,t={},n=Object.prototype,d=n.hasOwnProperty,b=Object.defineProperty||function(ce,V,J){ce[V]=J.value},S=typeof Symbol=="function"?Symbol:{},F=S.iterator||"@@iterator",w=S.asyncIterator||"@@asyncIterator",M=S.toStringTag||"@@toStringTag";function D(ce,V,J){return Object.defineProperty(ce,V,{value:J,enumerable:!0,configurable:!0,writable:!0}),ce[V]}try{D({},"")}catch{D=function(J,Ae,Ie){return J[Ae]=Ie}}function G(ce,V,J,Ae){var Ie=V&&V.prototype instanceof je?V:je,Re=Object.create(Ie.prototype),sr=new Ea(Ae||[]);return b(Re,"_invoke",{value:Wa(ce,J,sr)}),Re}function ue(ce,V,J){try{return{type:"normal",arg:ce.call(V,J)}}catch(Ae){return{type:"throw",arg:Ae}}}t.wrap=G;var pe="suspendedStart",Ee="suspendedYield",Fe="executing",Me="completed",Be={};function je(){}function Ye(){}function ir(){}var mr={};D(mr,F,function(){return this});var wr=Object.getPrototypeOf,Or=wr&&wr(wr(Ta([])));Or&&Or!==n&&d.call(Or,F)&&(mr=Or);var Vr=ir.prototype=je.prototype=Object.create(mr);function Wn(ce){["next","throw","return"].forEach(function(V){D(ce,V,function(J){return this._invoke(V,J)})})}function Xn(ce,V){function J(Ie,Re,sr,Pr){var Rr=ue(ce[Ie],ce,Re);if(Rr.type!=="throw"){var pt=Rr.arg,nt=pt.value;return nt&&ee(nt)=="object"&&d.call(nt,"__await")?V.resolve(nt.__await).then(function(dt){J("next",dt,sr,Pr)},function(dt){J("throw",dt,sr,Pr)}):V.resolve(nt).then(function(dt){pt.value=dt,sr(pt)},function(dt){return J("throw",dt,sr,Pr)})}Pr(Rr.arg)}var Ae;b(this,"_invoke",{value:function(Re,sr){function Pr(){return new V(function(Rr,pt){J(Re,sr,Rr,pt)})}return Ae=Ae?Ae.then(Pr,Pr):Pr()}})}function Wa(ce,V,J){var Ae=pe;return function(Ie,Re){if(Ae===Fe)throw new Error("Generator is already running");if(Ae===Me){if(Ie==="throw")throw Re;return{value:e,done:!0}}for(J.method=Ie,J.arg=Re;;){var sr=J.delegate;if(sr){var Pr=Ca(sr,J);if(Pr){if(Pr===Be)continue;return Pr}}if(J.method==="next")J.sent=J._sent=J.arg;else if(J.method==="throw"){if(Ae===pe)throw Ae=Me,J.arg;J.dispatchException(J.arg)}else J.method==="return"&&J.abrupt("return",J.arg);Ae=Fe;var Rr=ue(ce,V,J);if(Rr.type==="normal"){if(Ae=J.done?Me:Ee,Rr.arg===Be)continue;return{value:Rr.arg,done:J.done}}Rr.type==="throw"&&(Ae=Me,J.method="throw",J.arg=Rr.arg)}}}function Ca(ce,V){var J=V.method,Ae=ce.iterator[J];if(Ae===e)return V.delegate=null,J==="throw"&&ce.iterator.return&&(V.method="return",V.arg=e,Ca(ce,V),V.method==="throw")||J!=="return"&&(V.method="throw",V.arg=new TypeError("The iterator does not provide a '"+J+"' method")),Be;var Ie=ue(Ae,ce.iterator,V.arg);if(Ie.type==="throw")return V.method="throw",V.arg=Ie.arg,V.delegate=null,Be;var Re=Ie.arg;return Re?Re.done?(V[ce.resultName]=Re.value,V.next=ce.nextLoc,V.method!=="return"&&(V.method="next",V.arg=e),V.delegate=null,Be):Re:(V.method="throw",V.arg=new TypeError("iterator result is not an object"),V.delegate=null,Be)}function Xa(ce){var V={tryLoc:ce[0]};1 in ce&&(V.catchLoc=ce[1]),2 in ce&&(V.finallyLoc=ce[2],V.afterLoc=ce[3]),this.tryEntries.push(V)}function ba(ce){var V=ce.completion||{};V.type="normal",delete V.arg,ce.completion=V}function Ea(ce){this.tryEntries=[{tryLoc:"root"}],ce.forEach(Xa,this),this.reset(!0)}function Ta(ce){if(ce||ce===""){var V=ce[F];if(V)return V.call(ce);if(typeof ce.next=="function")return ce;if(!isNaN(ce.length)){var J=-1,Ae=function Ie(){for(;++J<ce.length;)if(d.call(ce,J))return Ie.value=ce[J],Ie.done=!1,Ie;return Ie.value=e,Ie.done=!0,Ie};return Ae.next=Ae}}throw new TypeError(ee(ce)+" is not iterable")}return Ye.prototype=ir,b(Vr,"constructor",{value:ir,configurable:!0}),b(ir,"constructor",{value:Ye,configurable:!0}),Ye.displayName=D(ir,M,"GeneratorFunction"),t.isGeneratorFunction=function(ce){var V=typeof ce=="function"&&ce.constructor;return!!V&&(V===Ye||(V.displayName||V.name)==="GeneratorFunction")},t.mark=function(ce){return Object.setPrototypeOf?Object.setPrototypeOf(ce,ir):(ce.__proto__=ir,D(ce,M,"GeneratorFunction")),ce.prototype=Object.create(Vr),ce},t.awrap=function(ce){return{__await:ce}},Wn(Xn.prototype),D(Xn.prototype,w,function(){return this}),t.AsyncIterator=Xn,t.async=function(ce,V,J,Ae,Ie){Ie===void 0&&(Ie=Promise);var Re=new Xn(G(ce,V,J,Ae),Ie);return t.isGeneratorFunction(V)?Re:Re.next().then(function(sr){return sr.done?sr.value:Re.next()})},Wn(Vr),D(Vr,M,"Generator"),D(Vr,F,function(){return this}),D(Vr,"toString",function(){return"[object Generator]"}),t.keys=function(ce){var V=Object(ce),J=[];for(var Ae in V)J.push(Ae);return J.reverse(),function Ie(){for(;J.length;){var Re=J.pop();if(Re in V)return Ie.value=Re,Ie.done=!1,Ie}return Ie.done=!0,Ie}},t.values=Ta,Ea.prototype={constructor:Ea,reset:function(V){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(ba),!V)for(var J in this)J.charAt(0)==="t"&&d.call(this,J)&&!isNaN(+J.slice(1))&&(this[J]=e)},stop:function(){this.done=!0;var V=this.tryEntries[0].completion;if(V.type==="throw")throw V.arg;return this.rval},dispatchException:function(V){if(this.done)throw V;var J=this;function Ae(pt,nt){return sr.type="throw",sr.arg=V,J.next=pt,nt&&(J.method="next",J.arg=e),!!nt}for(var Ie=this.tryEntries.length-1;Ie>=0;--Ie){var Re=this.tryEntries[Ie],sr=Re.completion;if(Re.tryLoc==="root")return Ae("end");if(Re.tryLoc<=this.prev){var Pr=d.call(Re,"catchLoc"),Rr=d.call(Re,"finallyLoc");if(Pr&&Rr){if(this.prev<Re.catchLoc)return Ae(Re.catchLoc,!0);if(this.prev<Re.finallyLoc)return Ae(Re.finallyLoc)}else if(Pr){if(this.prev<Re.catchLoc)return Ae(Re.catchLoc,!0)}else{if(!Rr)throw new Error("try statement without catch or finally");if(this.prev<Re.finallyLoc)return Ae(Re.finallyLoc)}}}},abrupt:function(V,J){for(var Ae=this.tryEntries.length-1;Ae>=0;--Ae){var Ie=this.tryEntries[Ae];if(Ie.tryLoc<=this.prev&&d.call(Ie,"finallyLoc")&&this.prev<Ie.finallyLoc){var Re=Ie;break}}Re&&(V==="break"||V==="continue")&&Re.tryLoc<=J&&J<=Re.finallyLoc&&(Re=null);var sr=Re?Re.completion:{};return sr.type=V,sr.arg=J,Re?(this.method="next",this.next=Re.finallyLoc,Be):this.complete(sr)},complete:function(V,J){if(V.type==="throw")throw V.arg;return V.type==="break"||V.type==="continue"?this.next=V.arg:V.type==="return"?(this.rval=this.arg=V.arg,this.method="return",this.next="end"):V.type==="normal"&&J&&(this.next=J),Be},finish:function(V){for(var J=this.tryEntries.length-1;J>=0;--J){var Ae=this.tryEntries[J];if(Ae.finallyLoc===V)return this.complete(Ae.completion,Ae.afterLoc),ba(Ae),Be}},catch:function(V){for(var J=this.tryEntries.length-1;J>=0;--J){var Ae=this.tryEntries[J];if(Ae.tryLoc===V){var Ie=Ae.completion;if(Ie.type==="throw"){var Re=Ie.arg;ba(Ae)}return Re}}throw new Error("illegal catch attempt")},delegateYield:function(V,J,Ae){return this.delegate={iterator:Ta(V),resultName:J,nextLoc:Ae},this.method==="next"&&(this.arg=e),Be}},t}function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);t&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(e,b).enumerable})),n.push.apply(n,d)}return n}function ge(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ne(Object(n),!0).forEach(function(d){C(e,d,n[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach(function(d){Object.defineProperty(e,d,Object.getOwnPropertyDescriptor(n,d))})}return e}function C(e,t,n){return t=H(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function H(e){var t=z(e,"string");return ee(t)=="symbol"?t:String(t)}function z(e,t){if(ee(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var d=n.call(e,t||"default");if(ee(d)!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function P(e,t,n,d,b,S,F){try{var w=e[S](F),M=w.value}catch(D){n(D);return}w.done?t(M):Promise.resolve(M).then(d,b)}function j(e){return function(){var t=this,n=arguments;return new Promise(function(d,b){var S=e.apply(t,n);function F(M){P(S,d,b,F,w,"next",M)}function w(M){P(S,d,b,F,w,"throw",M)}F(void 0)})}}function oe(e,t){return _e(e)||Ne(e,t)||ye(e,t)||he()}function he(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ne(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var d,b,S,F,w=[],M=!0,D=!1;try{if(S=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;M=!1}else for(;!(M=(d=S.call(n)).done)&&(w.push(d.value),w.length!==t);M=!0);}catch(G){D=!0,b=G}finally{try{if(!M&&n.return!=null&&(F=n.return(),Object(F)!==F))return}finally{if(D)throw b}}return w}}function _e(e){if(Array.isArray(e))return e}function or(e,t){var n=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ye(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var d=0,b=function(){};return{s:b,n:function(){return d>=e.length?{done:!0}:{done:!1,value:e[d++]}},e:function(D){throw D},f:b}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var S=!0,F=!1,w;return{s:function(){n=n.call(e)},n:function(){var D=n.next();return S=D.done,D},e:function(D){F=!0,w=D},f:function(){try{!S&&n.return!=null&&n.return()}finally{if(F)throw w}}}}function ur(e){return B(e)||x(e)||ye(e)||rr()}function rr(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ye(e,t){if(e){if(typeof e=="string")return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,t)}}function x(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function B(e){if(Array.isArray(e))return U(e)}function U(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,d=new Array(t);n<t;n++)d[n]=e[n];return d}var A=se.error,be=se.warn;function we(e){return typeof document<"u"&&document.getElementById?document.getElementById(e):null}var Ce=33984,We=35048,Ge=34962,Ze=34963,He=35345,fr=35982,Tr=36386,cr=35713,ar=35714,vr=35632,Sr=35633,fe=35981,r=35718,f=35721,c=35971,E=35382,v=35396,i=35398,a=35392,m=35395,h=5126,T=35664,_=35665,I=35666,O=5124,q=35667,Z=35668,$=35669,ie=35670,ae=35671,le=35672,ve=35673,re=35674,de=35675,Oe=35676,Ke=35678,ke=35680,Ve=35679,Pe=35682,De=35685,Qe=35686,Xe=35687,ze=35688,qe=35689,Je=35690,Le=36289,Ue=36292,yr=36293,lr=5125,gr=36294,_r=36295,Ir=36296,Ur=36298,Gr=36299,$r=36300,At=36303,_t=36306,wt=36307,hr=36308,aa=36311,Pt=3553,xt=34067,Zt=32879,Rt=35866,xe={};function xn(e,t){return xe[t].bindPoint}function ia(e,t){return function(n){e.uniform1f(t,n)}}function oa(e,t){return function(n){e.uniform1fv(t,n)}}function ua(e,t){return function(n){e.uniform2fv(t,n)}}function fa(e,t){return function(n){e.uniform3fv(t,n)}}function ca(e,t){return function(n){e.uniform4fv(t,n)}}function Rn(e,t){return function(n){e.uniform1i(t,n)}}function Fn(e,t){return function(n){e.uniform1iv(t,n)}}function Cn(e,t){return function(n){e.uniform2iv(t,n)}}function Dn(e,t){return function(n){e.uniform3iv(t,n)}}function Ln(e,t){return function(n){e.uniform4iv(t,n)}}function kr(e,t){return function(n){e.uniform1ui(t,n)}}function nr(e,t){return function(n){e.uniform1uiv(t,n)}}function Ft(e,t){return function(n){e.uniform2uiv(t,n)}}function et(e,t){return function(n){e.uniform3uiv(t,n)}}function Ct(e,t){return function(n){e.uniform4uiv(t,n)}}function Wr(e,t){return function(n){e.uniformMatrix2fv(t,!1,n)}}function pr(e,t){return function(n){e.uniformMatrix3fv(t,!1,n)}}function Bn(e,t){return function(n){e.uniformMatrix4fv(t,!1,n)}}function In(e,t){return function(n){e.uniformMatrix2x3fv(t,!1,n)}}function On(e,t){return function(n){e.uniformMatrix3x2fv(t,!1,n)}}function Fr(e,t){return function(n){e.uniformMatrix2x4fv(t,!1,n)}}function ht(e,t){return function(n){e.uniformMatrix4x2fv(t,!1,n)}}function Jt(e,t){return function(n){e.uniformMatrix3x4fv(t,!1,n)}}function la(e,t){return function(n){e.uniformMatrix4x3fv(t,!1,n)}}function br(e,t,n,d){var b=xn(e,t);return k.isWebGL2(e)?function(S){var F,w;!S||se.isTexture(e,S)?(F=S,w=null):(F=S.texture,w=S.sampler),e.uniform1i(d,n),e.activeTexture(Ce+n),e.bindTexture(b,F),e.bindSampler(n,w)}:function(S){e.uniform1i(d,n),e.activeTexture(Ce+n),e.bindTexture(b,S)}}function Er(e,t,n,d,b){for(var S=xn(e,t),F=new Int32Array(b),w=0;w<b;++w)F[w]=n+w;return k.isWebGL2(e)?function(M){e.uniform1iv(d,F),M.forEach(function(D,G){e.activeTexture(Ce+F[G]);var ue,pe;!D||se.isTexture(e,D)?(ue=D,pe=null):(ue=D.texture,pe=D.sampler),e.bindSampler(n,pe),e.bindTexture(S,ue)})}:function(M){e.uniform1iv(d,F),M.forEach(function(D,G){e.activeTexture(Ce+F[G]),e.bindTexture(S,D)})}}xe[h]={Type:Float32Array,size:4,setter:ia,arraySetter:oa},xe[T]={Type:Float32Array,size:8,setter:ua,cols:2},xe[_]={Type:Float32Array,size:12,setter:fa,cols:3},xe[I]={Type:Float32Array,size:16,setter:ca,cols:4},xe[O]={Type:Int32Array,size:4,setter:Rn,arraySetter:Fn},xe[q]={Type:Int32Array,size:8,setter:Cn,cols:2},xe[Z]={Type:Int32Array,size:12,setter:Dn,cols:3},xe[$]={Type:Int32Array,size:16,setter:Ln,cols:4},xe[lr]={Type:Uint32Array,size:4,setter:kr,arraySetter:nr},xe[gr]={Type:Uint32Array,size:8,setter:Ft,cols:2},xe[_r]={Type:Uint32Array,size:12,setter:et,cols:3},xe[Ir]={Type:Uint32Array,size:16,setter:Ct,cols:4},xe[ie]={Type:Uint32Array,size:4,setter:Rn,arraySetter:Fn},xe[ae]={Type:Uint32Array,size:8,setter:Cn,cols:2},xe[le]={Type:Uint32Array,size:12,setter:Dn,cols:3},xe[ve]={Type:Uint32Array,size:16,setter:Ln,cols:4},xe[re]={Type:Float32Array,size:32,setter:Wr,rows:2,cols:2},xe[de]={Type:Float32Array,size:48,setter:pr,rows:3,cols:3},xe[Oe]={Type:Float32Array,size:64,setter:Bn,rows:4,cols:4},xe[De]={Type:Float32Array,size:32,setter:In,rows:2,cols:3},xe[Qe]={Type:Float32Array,size:32,setter:Fr,rows:2,cols:4},xe[Xe]={Type:Float32Array,size:48,setter:On,rows:3,cols:2},xe[ze]={Type:Float32Array,size:48,setter:Jt,rows:3,cols:4},xe[qe]={Type:Float32Array,size:64,setter:ht,rows:4,cols:2},xe[Je]={Type:Float32Array,size:64,setter:la,rows:4,cols:3},xe[Ke]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Pt},xe[ke]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:xt},xe[Ve]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Zt},xe[Pe]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Pt},xe[Le]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Rt},xe[Ue]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Rt},xe[yr]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:xt},xe[Ur]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Pt},xe[Gr]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Zt},xe[$r]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:xt},xe[At]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Rt},xe[_t]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Pt},xe[wt]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Zt},xe[hr]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:xt},xe[aa]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Rt};function Dt(e,t){return function(n){if(n.value)switch(e.disableVertexAttribArray(t),n.value.length){case 4:e.vertexAttrib4fv(t,n.value);break;case 3:e.vertexAttrib3fv(t,n.value);break;case 2:e.vertexAttrib2fv(t,n.value);break;case 1:e.vertexAttrib1fv(t,n.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else e.bindBuffer(Ge,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,n.numComponents||n.size,n.type||h,n.normalize||!1,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function xr(e,t){return function(n){if(n.value)if(e.disableVertexAttribArray(t),n.value.length===4)e.vertexAttrib4iv(t,n.value);else throw new Error("The length of an integer constant value must be 4!");else e.bindBuffer(Ge,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,n.numComponents||n.size,n.type||O,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function Dr(e,t){return function(n){if(n.value)if(e.disableVertexAttribArray(t),n.value.length===4)e.vertexAttrib4uiv(t,n.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else e.bindBuffer(Ge,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,n.numComponents||n.size,n.type||lr,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function Xr(e,t,n){var d=n.size,b=n.count;return function(S){e.bindBuffer(Ge,S.buffer);for(var F=S.size||S.numComponents||d,w=F/b,M=S.type||h,D=xe[M],G=D.size*F,ue=S.normalize||!1,pe=S.offset||0,Ee=G/b,Fe=0;Fe<b;++Fe)e.enableVertexAttribArray(t+Fe),e.vertexAttribPointer(t+Fe,w,M,ue,G,pe+Ee*Fe),e.vertexAttribDivisor&&e.vertexAttribDivisor(t+Fe,S.divisor||0)}}var tr={};tr[h]={size:4,setter:Dt},tr[T]={size:8,setter:Dt},tr[_]={size:12,setter:Dt},tr[I]={size:16,setter:Dt},tr[O]={size:4,setter:xr},tr[q]={size:8,setter:xr},tr[Z]={size:12,setter:xr},tr[$]={size:16,setter:xr},tr[lr]={size:4,setter:Dr},tr[gr]={size:8,setter:Dr},tr[_r]={size:12,setter:Dr},tr[Ir]={size:16,setter:Dr},tr[ie]={size:4,setter:xr},tr[ae]={size:8,setter:xr},tr[le]={size:12,setter:xr},tr[ve]={size:16,setter:xr},tr[re]={size:4,setter:Xr,count:2},tr[de]={size:9,setter:Xr,count:3},tr[Oe]={size:16,setter:Xr,count:4};var qr=/ERROR:\s*\d+:(\d+)/gi;function jr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,d=ur(t.matchAll(qr)),b=new Map(d.map(function(S,F){var w=parseInt(S[1]),M=d[F+1],D=M?M.index:t.length,G=t.substring(S.index,D);return[w-1,G]}));return e.split(`
`).map(function(S,F){var w=b.get(F);return"".concat(F+1+n,": ").concat(S).concat(w?`

^^^ `.concat(w):"")}).join(`
`)}var $t=/^[ \t]*\n/;function dr(e){var t=0;return $t.test(e)&&(t=1,e=e.replace($t,"")),{lineOffset:t,shaderSource:e}}function Lt(e,t){return e.errorCallback(t),e.callback&&setTimeout(function(){e.callback("".concat(t,`
`).concat(e.errors.join(`
`)))}),null}function Bt(e,t,n,d){d=d||A;var b=e.getShaderParameter(n,cr);if(!b){var S=e.getShaderInfoLog(n),F=dr(e.getShaderSource(n)),w=F.lineOffset,M=F.shaderSource,D="".concat(jr(M,S,w),`
Error compiling `).concat(k.glEnumToString(e,t),": ").concat(S);return d(D),D}return""}function Hr(e,t,n){var d,b,S;if(typeof t=="function"&&(n=t,t=void 0),typeof e=="function")n=e,e=void 0;else if(e&&!Array.isArray(e)){var F=e;n=F.errorCallback,e=F.attribLocations,d=F.transformFeedbackVaryings,b=F.transformFeedbackMode,S=F.callback}var w=n||A,M=[],D={errorCallback:function(pe){M.push(pe);for(var Ee=arguments.length,Fe=new Array(Ee>1?Ee-1:0),Me=1;Me<Ee;Me++)Fe[Me-1]=arguments[Me];w.apply(void 0,[pe].concat(Fe))},transformFeedbackVaryings:d,transformFeedbackMode:b,callback:S,errors:M};{var G={};Array.isArray(e)?e.forEach(function(ue,pe){G[ue]=t?t[pe]:pe}):G=e||{},D.attribLocations=G}return D}var Kr=["VERTEX_SHADER","FRAGMENT_SHADER"];function Mn(e,t){if(t.indexOf("frag")>=0)return vr;if(t.indexOf("vert")>=0)return Sr}function Nn(e,t,n){var d=e.getAttachedShaders(t),b=or(d),S;try{for(b.s();!(S=b.n()).done;){var F=S.value;n.has(F)&&e.deleteShader(F)}}catch(w){b.e(w)}finally{b.f()}e.deleteProgram(t)}var Un=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new Promise(function(n){return setTimeout(n,t)})};function Gn(e,t,n){for(var d=e.createProgram(),b=Hr(n),S=b.attribLocations,F=b.transformFeedbackVaryings,w=b.transformFeedbackMode,M=0;M<t.length;++M){var D=t[M];if(typeof D=="string"){var G=we(D),ue=G?G.text:D,pe=e[Kr[M]];G&&G.type&&(pe=Mn(e,G.type)||pe),D=e.createShader(pe),e.shaderSource(D,dr(ue).shaderSource),e.compileShader(D),e.attachShader(d,D)}}Object.entries(S).forEach(function(Fe){var Me=oe(Fe,2),Be=Me[0],je=Me[1];return e.bindAttribLocation(d,je,Be)});{var Ee=F;Ee&&(Ee.attribs&&(Ee=Ee.attribs),Array.isArray(Ee)||(Ee=Object.keys(Ee)),e.transformFeedbackVaryings(d,Ee,w||fe))}return e.linkProgram(d),d}function mt(e,t,n,d,b){var S=Hr(n,d,b),F=new Set(t),w=Gn(e,t,S);function M(D,G){var ue=tn(D,G,S.errorCallback);return ue&&Nn(D,G,F),ue}if(S.callback){en(e,w).then(function(){var D=M(e,w);S.callback(D,D?void 0:w)});return}return M(e,w)?void 0:w}function Yr(e){return function(t,n){for(var d=arguments.length,b=new Array(d>2?d-2:0),S=2;S<d;S++)b[S-2]=arguments[S];return new Promise(function(F,w){var M=Hr.apply(void 0,b);M.callback=function(D,G){D?w(D):F(G)},e(t,n,M)})}}u.createProgramAsync=Yr(mt),u.createProgramInfoAsync=Yr(s);function en(e,t){return rn.apply(this,arguments)}function rn(){return rn=j(me().mark(function e(t,n){var d,b,S;return me().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:d=t.getExtension("KHR_parallel_shader_compile"),b=d?function(M,D){return M.getProgramParameter(D,d.COMPLETION_STATUS_KHR)}:function(){return!0},S=0;case 3:return w.next=5,Un(S);case 5:S=16.666666666666668;case 6:if(!b(t,n)){w.next=3;break}case 7:case"end":return w.stop()}},e)})),rn.apply(this,arguments)}function rt(e,t){return It.apply(this,arguments)}function It(){return It=j(me().mark(function e(t,n){var d,b,S;return me().wrap(function(w){for(;;)switch(w.prev=w.next){case 0:d=0,b=Object.values(n);case 1:if(!(d<b.length)){w.next=8;break}return S=b[d],w.next=5,en(t,S);case 5:d++,w.next=1;break;case 8:case"end":return w.stop()}},e)})),It.apply(this,arguments)}function tn(e,t,n){n=n||A;var d=e.getProgramParameter(t,ar);if(!d){var b=e.getProgramInfoLog(t);n("Error in program linking: ".concat(b));var S=e.getAttachedShaders(t),F=S.map(function(w){return Bt(e,e.getShaderParameter(w,e.SHADER_TYPE),w,n)});return"".concat(b,`
`).concat(F.filter(function(w){return w}).join(`
`))}}function nn(e,t,n,d,b){var S=Hr(n,d,b),F=[],w=or(t),M;try{for(w.s();!(M=w.n()).done;){var D=M.value,G=we(D);if(!G)return Lt(S,"unknown script element: ".concat(D));F.push(G.text)}}catch(ue){w.e(ue)}finally{w.f()}return mt(e,F,S)}function an(e,t,n,d,b){return mt(e,t,n,d,b)}function on(e){var t=e.name;return t.startsWith("gl_")||t.startsWith("webgl_")}var sa=/(\.|\[|]|\w+)/g,va=function(t){return t>="0"&&t<="9"};function yt(e,t,n,d){for(var b=e.split(sa).filter(function(Fe){return Fe!==""}),S=0,F="";;){var w=b[S++];F+=w;var M=va(w[0]),D=M?parseInt(w):w;M&&(F+=b[S++]);var G=S===b.length;if(G){n[D]=t;break}else{var ue=b[S++],pe=ue==="[",Ee=n[D]||(pe?[]:{});n[D]=Ee,n=Ee,d[F]=d[F]||function(Fe){return function(Me){Vn(Fe,Me)}}(Ee),F+=ue}}}function tt(e,t){var n=0;function d(pe,Ee,Fe){var Me=Ee.name.endsWith("[0]"),Be=Ee.type,je=xe[Be];if(!je)throw new Error("unknown type: 0x".concat(Be.toString(16)));var Ye;if(je.bindPoint){var ir=n;n+=Ee.size,Me?Ye=je.arraySetter(e,Be,ir,Fe,Ee.size):Ye=je.setter(e,Be,ir,Fe,Ee.size)}else je.arraySetter&&Me?Ye=je.arraySetter(e,Fe):Ye=je.setter(e,Fe);return Ye.location=Fe,Ye}for(var b={},S={},F=e.getProgramParameter(t,r),w=0;w<F;++w){var M=e.getActiveUniform(t,w);if(!on(M)){var D=M.name;D.endsWith("[0]")&&(D=D.substr(0,D.length-3));var G=e.getUniformLocation(t,M.name);if(G){var ue=d(t,M,G);b[D]=ue,yt(D,ue,S,b)}}}return b}function Ot(e,t){for(var n={},d=e.getProgramParameter(t,c),b=0;b<d;++b){var S=e.getTransformFeedbackVarying(t,b);n[S.name]={index:b,type:S.type,size:S.size}}return n}function Mt(e,t,n){t.transformFeedbackInfo&&(t=t.transformFeedbackInfo),n.attribs&&(n=n.attribs);for(var d in n){var b=t[d];if(b){var S=n[d];S.offset?e.bindBufferRange(fr,b.index,S.buffer,S.offset,S.size):e.bindBufferBase(fr,b.index,S.buffer)}}}function un(e,t,n){var d=e.createTransformFeedback();return e.bindTransformFeedback(Tr,d),e.useProgram(t.program),Mt(e,t,n),e.bindTransformFeedback(Tr,null),d}function zr(e,t){for(var n=e.getProgramParameter(t,r),d=[],b=[],S=0;S<n;++S){b.push(S),d.push({});var F=e.getActiveUniform(t,S);d[S].name=F.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(pe){var Ee=pe[0],Fe=pe[1];e.getActiveUniforms(t,b,e[Ee]).forEach(function(Me,Be){d[Be][Fe]=Me})});for(var w={},M=e.getProgramParameter(t,E),D=0;D<M;++D){var G=e.getActiveUniformBlockName(t,D),ue={index:e.getUniformBlockIndex(t,G),usedByVertexShader:e.getActiveUniformBlockParameter(t,D,v),usedByFragmentShader:e.getActiveUniformBlockParameter(t,D,i),size:e.getActiveUniformBlockParameter(t,D,a),uniformIndices:e.getActiveUniformBlockParameter(t,D,m)};ue.used=ue.usedByVertexShader||ue.usedByFragmentShader,w[G]=ue}return{blockSpecs:w,uniformData:d}}var kn=/\[\d+\]\.$/,ha=function(t,n){return((t+(n-1))/n|0)*n};function ma(e,t,n,d){if(t||n){d=d||1;var b=e.length,S=b/4;return function(F){for(var w=0,M=0,D=0;D<S;++D){for(var G=0;G<d;++G)e[w++]=F[M++];w+=4-d}}}else return function(F){F.length?e.set(F):e[0]=F}}function fn(e,t,n,d){var b=n.blockSpecs,S=n.uniformData,F=b[d];if(!F)return be("no uniform block object named:",d),{name:d,uniforms:{}};var w=new ArrayBuffer(F.size),M=e.createBuffer(),D=F.index;e.bindBuffer(He,M),e.uniformBlockBinding(t,F.index,D);var G=d+".";kn.test(G)&&(G=G.replace(kn,"."));var ue={},pe={},Ee={};return F.uniformIndices.forEach(function(Fe){var Me=S[Fe],Be=Me.name;Be.startsWith(G)&&(Be=Be.substr(G.length));var je=Be.endsWith("[0]");je&&(Be=Be.substr(0,Be.length-3));var Ye=xe[Me.type],ir=Ye.Type,mr=je?ha(Ye.size,16)*Me.size:Ye.size*Me.size,wr=new ir(w,Me.offset,mr/ir.BYTES_PER_ELEMENT);ue[Be]=wr;var Or=ma(wr,je,Ye.rows,Ye.cols);pe[Be]=Or,yt(Be,Or,Ee,pe)}),{name:d,array:w,asFloat:new Float32Array(w),buffer:M,uniforms:ue,setters:pe}}function cn(e,t,n){return fn(e,t.program,t.uniformBlockSpec,n)}function Nt(e,t,n){var d=t.uniformBlockSpec||t,b=d.blockSpecs[n.name];if(b){var S=b.index;return e.bindBufferRange(He,S,n.buffer,n.offset||0,n.array.byteLength),!0}return!1}function jn(e,t,n){Nt(e,t,n)&&e.bufferData(He,n.array,We)}function ya(e,t){var n=e.setters;for(var d in t){var b=n[d];if(b){var S=t[d];b(S)}}}function Vn(e,t){for(var n in t){var d=e[n];typeof d=="function"?d(t[n]):Vn(e[n],t[n])}}function Ut(e){for(var t=e.uniformSetters||e,n=arguments.length<=1?0:arguments.length-1,d=0;d<n;++d){var b=d+1<1||arguments.length<=d+1?void 0:arguments[d+1];if(Array.isArray(b))for(var S=b.length,F=0;F<S;++F)Ut(t,b[F]);else for(var w in b){var M=t[w];M&&M(b[w])}}}u.setUniformsAndBindTextures=Ut;function ln(e,t){for(var n={},d=e.getProgramParameter(t,f),b=0;b<d;++b){var S=e.getActiveAttrib(t,b);if(!on(S)){var F=e.getAttribLocation(t,S.name),w=tr[S.type],M=w.setter(e,F,w);M.location=F,n[S.name]=M}}return n}function sn(e,t){for(var n in t){var d=e[n];d&&d(t[n])}}function pa(e,t,n){n.vertexArrayObject?e.bindVertexArray(n.vertexArrayObject):(sn(t.attribSetters||t,n.attribs),n.indices&&e.bindBuffer(Ze,n.indices))}function Gt(e,t){var n=tt(e,t),d=ln(e,t),b={program:t,uniformSetters:n,attribSetters:d};return k.isWebGL2(e)&&(b.uniformBlockSpec=zr(e,t),b.transformFeedbackInfo=Ot(e,t)),b}var da=/\s|{|}|;/;function s(e,t,n,d,b){var S=Hr(n,d,b),F=[];if(t=t.map(function(D){if(!da.test(D)){var G=we(D);if(G)D=G.text;else{var ue="no element with id: ".concat(D);S.errorCallback(ue),F.push(ue)}}return D}),F.length)return Lt(S,"");var w=S.callback;w&&(S.callback=function(D,G){w(D,D?void 0:Gt(e,G))});var M=an(e,t,S);return M?Gt(e,M):null}function y(e,t,n,d,b){for(var S=0,F=Object.entries(t);S<F.length;S++){var w=oe(F[S],2),M=w[0],D=w[1],G=ge({},b),ue=n[M];Array.isArray(ue)||Object.assign(G,ue);var pe=tn(e,D,G.errorCallback);if(pe){for(var Ee=0,Fe=Object.values(t);Ee<Fe.length;Ee++){var Me=Fe[Ee],Be=e.getAttachedShaders(Me);e.deleteProgram(Me);var je=or(Be),Ye;try{for(je.s();!(Ye=je.n()).done;){var ir=Ye.value;d.has(ir)||e.deleteShader(ir)}}catch(mr){je.e(mr)}finally{je.f()}}return pe}}}function p(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},d=new Set,b=Object.fromEntries(Object.entries(t).map(function(F){var w=oe(F,2),M=w[0],D=w[1],G=ge({},n),ue=Array.isArray(D)?D:D.shaders;return Array.isArray(D)||Object.assign(G,D),ue.forEach(d.add,d),[M,Gn(e,ue,G)]}));if(n.callback){rt(e,b).then(function(){var F=y(e,b,t,d,n);n.callback(F,F?void 0:b)});return}var S=y(e,b,t,d,n);return S?void 0:b}function g(e,t,n){n=Hr(n);function d(F,w){return Object.fromEntries(Object.entries(w).map(function(M){var D=oe(M,2),G=D[0],ue=D[1];return[G,Gt(F,ue)]}))}var b=n.callback;b&&(n.callback=function(F,w){b(F,F?void 0:d(e,w))});var S=p(e,t,n);if(!(b||!S))return d(e,S)}u.createProgramsAsync=Yr(p),u.createProgramInfosAsync=Yr(g)},"./src/textures.js":(X,u,Y)=>{function ee(s){"@babel/helpers - typeof";return ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},ee(s)}u.__esModule=!0,u.canFilter=Un,u.canGenerateMipmap=Nn,u.createSampler=on,u.createSamplers=sa,u.createTexture=sn,u.createTextures=da,u.getBytesPerElementForInternalFormat=Hr,u.getFormatAndTypeForInternalFormat=Kr,u.getNumComponentsForFormat=Gn,u.loadTextureFromUrl=jn,u.resizeTexture=pa,u.setDefaultTextureColor=en,u.setEmptyTexture=ln,u.setSamplerParameters=an,u.setTextureDefaults_=rn,u.setTextureFilteringForSize=yt,u.setTextureFromArray=Ut,u.setTextureFromElement=un,u.setTextureParameters=nn;var k=me(Y("./src/utils.js")),se=me(Y("./src/typedarrays.js")),te=me(Y("./src/helper.js"));function W(s){if(typeof WeakMap!="function")return null;var y=new WeakMap,p=new WeakMap;return(W=function(e){return e?p:y})(s)}function me(s,y){if(!y&&s&&s.__esModule)return s;if(s===null||ee(s)!="object"&&typeof s!="function")return{default:s};var p=W(y);if(p&&p.has(s))return p.get(s);var g={__proto__:null},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var t in s)if(t!=="default"&&Object.prototype.hasOwnProperty.call(s,t)){var n=e?Object.getOwnPropertyDescriptor(s,t):null;n&&(n.get||n.set)?Object.defineProperty(g,t,n):g[t]=s[t]}return g.default=s,p&&p.set(s,g),g}var ne={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},ge=se.isArrayBuffer,C=function(){var s;return function(){return s=s||(typeof document<"u"&&document.createElement?document.createElement("canvas").getContext("2d"):null),s}}(),H=6406,z=6407,P=6408,j=6409,oe=6410,he=6402,Ne=34041,_e=33071,or=9728,ur=9729,rr=3553,ye=34067,x=32879,B=35866,U=34069,A=34070,be=34071,we=34072,Ce=34073,We=34074,Ge=10241,Ze=10240,He=10242,fr=10243,Tr=32882,cr=33082,ar=33083,vr=33084,Sr=33085,fe=34892,r=34893,f=3317,c=3314,E=32878,v=3316,i=3315,a=32877,m=37443,h=37441,T=37440,_=33321,I=36756,O=33325,q=33326,Z=33330,$=33329,ie=33338,ae=33337,le=33340,ve=33339,re=33323,de=36757,Oe=33327,Ke=33328,ke=33336,Ve=33335,Pe=33332,De=33331,Qe=33334,Xe=33333,ze=32849,qe=35905,Je=36194,Le=36758,Ue=35898,yr=35901,lr=34843,gr=34837,_r=36221,Ir=36239,Ur=36215,Gr=36233,$r=36209,At=36227,_t=32856,wt=35907,hr=36759,aa=32855,Pt=32854,xt=32857,Zt=34842,Rt=34836,xe=36220,xn=36238,ia=36975,oa=36214,ua=36232,fa=36226,ca=36208,Rn=33189,Fn=33190,Cn=36012,Dn=36013,Ln=35056,kr=5120,nr=5121,Ft=5122,et=5123,Ct=5124,Wr=5125,pr=5126,Bn=32819,In=32820,On=33635,Fr=5131,ht=36193,Jt=33640,la=35899,br=35902,Er=36269,Dt=34042,xr=33319,Dr=33320,Xr=6403,tr=36244,qr=36248,jr=36249,$t={};{var dr=$t;dr[H]={numColorComponents:1},dr[j]={numColorComponents:1},dr[oe]={numColorComponents:2},dr[z]={numColorComponents:3},dr[P]={numColorComponents:4},dr[Xr]={numColorComponents:1},dr[tr]={numColorComponents:1},dr[xr]={numColorComponents:2},dr[Dr]={numColorComponents:2},dr[z]={numColorComponents:3},dr[qr]={numColorComponents:3},dr[P]={numColorComponents:4},dr[jr]={numColorComponents:4},dr[he]={numColorComponents:1},dr[Ne]={numColorComponents:2}}var Lt;function Bt(s){if(!Lt){var y={};y[H]={textureFormat:H,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[nr,Fr,ht,pr]},y[j]={textureFormat:j,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[nr,Fr,ht,pr]},y[oe]={textureFormat:oe,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[nr,Fr,ht,pr]},y[z]={textureFormat:z,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[nr,Fr,ht,pr,On]},y[P]={textureFormat:P,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[nr,Fr,ht,pr,Bn,In]},y[he]={textureFormat:he,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[Wr,et]},y[_]={textureFormat:Xr,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[nr]},y[I]={textureFormat:Xr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[kr]},y[O]={textureFormat:Xr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[pr,Fr]},y[q]={textureFormat:Xr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[pr]},y[Z]={textureFormat:tr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[nr]},y[$]={textureFormat:tr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[kr]},y[Pe]={textureFormat:tr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[et]},y[De]={textureFormat:tr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Ft]},y[Qe]={textureFormat:tr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Wr]},y[Xe]={textureFormat:tr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Ct]},y[re]={textureFormat:xr,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[nr]},y[de]={textureFormat:xr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[kr]},y[Oe]={textureFormat:xr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[pr,Fr]},y[Ke]={textureFormat:xr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[pr]},y[ke]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[nr]},y[Ve]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[kr]},y[ie]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[et]},y[ae]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Ft]},y[le]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Wr]},y[ve]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Ct]},y[ze]={textureFormat:z,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[nr]},y[qe]={textureFormat:z,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[nr]},y[Je]={textureFormat:z,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[nr,On]},y[Le]={textureFormat:z,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[kr]},y[Ue]={textureFormat:z,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[pr,Fr,la]},y[yr]={textureFormat:z,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[pr,Fr,br]},y[lr]={textureFormat:z,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[pr,Fr]},y[gr]={textureFormat:z,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[pr]},y[_r]={textureFormat:qr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[nr]},y[Ir]={textureFormat:qr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[kr]},y[Ur]={textureFormat:qr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[et]},y[Gr]={textureFormat:qr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[Ft]},y[$r]={textureFormat:qr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[Wr]},y[At]={textureFormat:qr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[Ct]},y[_t]={textureFormat:P,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[nr]},y[wt]={textureFormat:P,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[nr]},y[hr]={textureFormat:P,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[kr]},y[aa]={textureFormat:P,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[nr,In,Jt]},y[Pt]={textureFormat:P,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[nr,Bn]},y[xt]={textureFormat:P,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[Jt]},y[Zt]={textureFormat:P,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[pr,Fr]},y[Rt]={textureFormat:P,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[pr]},y[xe]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[nr]},y[xn]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[kr]},y[ia]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Jt]},y[oa]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[et]},y[ua]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Ft]},y[fa]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[Ct]},y[ca]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[Wr]},y[Rn]={textureFormat:he,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[et,Wr]},y[Fn]={textureFormat:he,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Wr]},y[Cn]={textureFormat:he,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[pr]},y[Ln]={textureFormat:Ne,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Dt]},y[Dn]={textureFormat:Ne,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Er]},Object.keys(y).forEach(function(p){var g=y[p];g.bytesPerElementMap={},g.bytesPerElement.forEach(function(e,t){var n=g.type[t];g.bytesPerElementMap[n]=e})}),Lt=y}return Lt[s]}function Hr(s,y){var p=Bt(s);if(!p)throw"unknown internal format";var g=p.bytesPerElementMap[y];if(g===void 0)throw"unknown internal format";return g}function Kr(s){var y=Bt(s);if(!y)throw"unknown internal format";return{format:y.textureFormat,type:y.type[0]}}function Mn(s){return(s&s-1)===0}function Nn(s,y,p,g){if(!k.isWebGL2(s))return Mn(y)&&Mn(p);var e=Bt(g);if(!e)throw"unknown internal format";return e.colorRenderable&&e.textureFilterable}function Un(s){var y=Bt(s);if(!y)throw"unknown internal format";return y.textureFilterable}function Gn(s){var y=$t[s];if(!y)throw"unknown format: "+s;return y.numColorComponents}function mt(s,y,p){return ge(y)?se.getGLTypeForTypedArray(y):p||nr}function Yr(s,y,p,g,e){if(e%1!==0)throw"can't guess dimensions";if(!p&&!g){var t=Math.sqrt(e/(y===ye?6:1));t%1===0?(p=t,g=t):(p=e,g=1)}else if(g){if(!p&&(p=e/g,p%1))throw"can't guess dimensions"}else if(g=e/p,g%1)throw"can't guess dimensions";return{width:p,height:g}}function en(s){ne.textureColor=new Uint8Array([s[0]*255,s[1]*255,s[2]*255,s[3]*255])}function rn(s){te.copyExistingProperties(s,ne),s.textureColor&&en(s.textureColor)}function rt(s,y){y.colorspaceConversion!==void 0&&s.pixelStorei(m,y.colorspaceConversion),y.premultiplyAlpha!==void 0&&s.pixelStorei(h,y.premultiplyAlpha),y.flipY!==void 0&&s.pixelStorei(T,y.flipY)}function It(s){s.pixelStorei(f,4),k.isWebGL2(s)&&(s.pixelStorei(c,0),s.pixelStorei(E,0),s.pixelStorei(v,0),s.pixelStorei(i,0),s.pixelStorei(a,0))}function tn(s,y,p,g){g.minMag&&(p.call(s,y,Ge,g.minMag),p.call(s,y,Ze,g.minMag)),g.min&&p.call(s,y,Ge,g.min),g.mag&&p.call(s,y,Ze,g.mag),g.wrap&&(p.call(s,y,He,g.wrap),p.call(s,y,fr,g.wrap),(y===x||te.isSampler(s,y))&&p.call(s,y,Tr,g.wrap)),g.wrapR&&p.call(s,y,Tr,g.wrapR),g.wrapS&&p.call(s,y,He,g.wrapS),g.wrapT&&p.call(s,y,fr,g.wrapT),g.minLod!==void 0&&p.call(s,y,cr,g.minLod),g.maxLod!==void 0&&p.call(s,y,ar,g.maxLod),g.baseLevel!==void 0&&p.call(s,y,vr,g.baseLevel),g.maxLevel!==void 0&&p.call(s,y,Sr,g.maxLevel),g.compareFunc!==void 0&&p.call(s,y,r,g.compareFunc),g.compareMode!==void 0&&p.call(s,y,fe,g.compareMode)}function nn(s,y,p){var g=p.target||rr;s.bindTexture(g,y),tn(s,g,s.texParameteri,p)}function an(s,y,p){tn(s,y,s.samplerParameteri,p)}function on(s,y){var p=s.createSampler();return an(s,p,y),p}function sa(s,y){var p={};return Object.keys(y).forEach(function(g){p[g]=on(s,y[g])}),p}function va(s){return s=s||ne.textureColor,ge(s)?s:new Uint8Array([s[0]*255,s[1]*255,s[2]*255,s[3]*255])}function yt(s,y,p,g,e,t){p=p||ne.textureOptions,t=t||P;var n=p.target||rr;if(g=g||p.width,e=e||p.height,s.bindTexture(n,y),Nn(s,g,e,t))s.generateMipmap(n);else{var d=Un(t)?ur:or;s.texParameteri(n,Ge,d),s.texParameteri(n,Ze,d),s.texParameteri(n,He,_e),s.texParameteri(n,fr,_e)}}function tt(s){return s.auto===!0||s.auto===void 0&&s.level===void 0}function Ot(s,y){return y=y||{},y.cubeFaceOrder||[U,A,be,we,Ce,We]}function Mt(s,y){var p=Ot(s,y),g=p.map(function(e,t){return{face:e,ndx:t}});return g.sort(function(e,t){return e.face-t.face}),g}function un(s,y,p,g){g=g||ne.textureOptions;var e=g.target||rr,t=g.level||0,n=p.width,d=p.height,b=g.internalFormat||g.format||P,S=Kr(b),F=g.format||S.format,w=g.type||S.type;if(rt(s,g),s.bindTexture(e,y),e===ye){var M=p.width,D=p.height,G,ue;if(M/6===D)G=D,ue=[0,0,1,0,2,0,3,0,4,0,5,0];else if(D/6===M)G=M,ue=[0,0,0,1,0,2,0,3,0,4,0,5];else if(M/3===D/2)G=M/3,ue=[0,0,1,0,2,0,0,1,1,1,2,1];else if(M/2===D/3)G=M/2,ue=[0,0,1,0,0,1,1,1,0,2,1,2];else throw"can't figure out cube map from element: "+(p.src?p.src:p.nodeName);var pe=C();pe?(pe.canvas.width=G,pe.canvas.height=G,n=G,d=G,Mt(s,g).forEach(function(wr){var Or=ue[wr.ndx*2+0]*G,Vr=ue[wr.ndx*2+1]*G;pe.drawImage(p,Or,Vr,G,G,0,0,G,G),s.texImage2D(wr.face,t,b,F,w,pe.canvas)}),pe.canvas.width=1,pe.canvas.height=1):typeof createImageBitmap<"u"&&(n=G,d=G,Mt(s,g).forEach(function(wr){var Or=ue[wr.ndx*2+0]*G,Vr=ue[wr.ndx*2+1]*G;s.texImage2D(wr.face,t,b,G,G,0,F,w,null),createImageBitmap(p,Or,Vr,G,G,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(function(Wn){rt(s,g),s.bindTexture(e,y),s.texImage2D(wr.face,t,b,F,w,Wn),tt(g)&&yt(s,y,g,n,d,b)})}))}else if(e===x||e===B){var Ee=Math.min(p.width,p.height),Fe=Math.max(p.width,p.height),Me=Fe/Ee;if(Me%1!==0)throw"can not compute 3D dimensions of element";var Be=p.width===Fe?1:0,je=p.height===Fe?1:0;s.pixelStorei(f,1),s.pixelStorei(c,p.width),s.pixelStorei(E,0),s.pixelStorei(a,0),s.texImage3D(e,t,b,Ee,Ee,Ee,0,F,w,null);for(var Ye=0;Ye<Me;++Ye){var ir=Ye*Ee*Be,mr=Ye*Ee*je;s.pixelStorei(v,ir),s.pixelStorei(i,mr),s.texSubImage3D(e,t,0,0,Ye,Ee,Ee,1,F,w,p)}It(s)}else s.texImage2D(e,t,b,F,w,p);tt(g)&&yt(s,y,g,n,d,b),nn(s,y,g)}function zr(){}function kn(s){if(typeof document<"u"){var y=document.createElement("a");return y.href=s,y.hostname===location.hostname&&y.port===location.port&&y.protocol===location.protocol}else{var p=new URL(location.href).origin,g=new URL(s,location.href).origin;return g===p}}function ha(s,y){return y===void 0&&!kn(s)?"anonymous":y}function ma(s,y,p){p=p||zr;var g;if(y=y!==void 0?y:ne.crossOrigin,y=ha(s,y),typeof Image<"u"){g=new Image,y!==void 0&&(g.crossOrigin=y);var e=function(){g.removeEventListener("error",t),g.removeEventListener("load",n),g=null},t=function(){var M="couldn't load image: "+s;te.error(M),p(M,g),e()},n=function(){p(null,g),e()};return g.addEventListener("error",t),g.addEventListener("load",n),g.src=s,g}else if(typeof ImageBitmap<"u"){var d,b,S=function(){p(d,b)},F={};y&&(F.mode="cors"),fetch(s,F).then(function(w){if(!w.ok)throw w;return w.blob()}).then(function(w){return createImageBitmap(w,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}).then(function(w){b=w,setTimeout(S)}).catch(function(w){d=w,setTimeout(S)}),g=null}return g}function fn(s){return typeof ImageBitmap<"u"&&s instanceof ImageBitmap||typeof ImageData<"u"&&s instanceof ImageData||typeof HTMLElement<"u"&&s instanceof HTMLElement}function cn(s,y,p){return fn(s)?(setTimeout(function(){p(null,s)}),s):ma(s,y,p)}function Nt(s,y,p){p=p||ne.textureOptions;var g=p.target||rr;if(s.bindTexture(g,y),p.color!==!1){var e=va(p.color);if(g===ye)for(var t=0;t<6;++t)s.texImage2D(U+t,0,P,1,1,0,P,nr,e);else g===x||g===B?s.texImage3D(g,0,P,1,1,1,0,P,nr,e):s.texImage2D(g,0,P,1,1,0,P,nr,e)}}function jn(s,y,p,g){g=g||zr,p=p||ne.textureOptions,Nt(s,y,p),p=Object.assign({},p);var e=cn(p.src,p.crossOrigin,function(t,n){t?g(t,y,n):(un(s,y,n,p),g(null,y,n))});return e}function ya(s,y,p,g){g=g||zr;var e=p.src;if(e.length!==6)throw"there must be 6 urls for a cubemap";var t=p.level||0,n=p.internalFormat||p.format||P,d=Kr(n),b=p.format||d.format,S=p.type||nr,F=p.target||rr;if(F!==ye)throw"target must be TEXTURE_CUBE_MAP";Nt(s,y,p),p=Object.assign({},p);var w=6,M=[],D=Ot(s,p),G;function ue(pe){return function(Ee,Fe){--w,Ee?M.push(Ee):Fe.width!==Fe.height?M.push("cubemap face img is not a square: "+Fe.src):(rt(s,p),s.bindTexture(F,y),w===5?Ot().forEach(function(Me){s.texImage2D(Me,t,n,b,S,Fe)}):s.texImage2D(pe,t,n,b,S,Fe),tt(p)&&s.generateMipmap(F)),w===0&&g(M.length?M:void 0,y,G)}}G=e.map(function(pe,Ee){return cn(pe,p.crossOrigin,ue(D[Ee]))})}function Vn(s,y,p,g){g=g||zr;var e=p.src,t=p.internalFormat||p.format||P,n=Kr(t),d=p.format||n.format,b=p.type||nr,S=p.target||B;if(S!==x&&S!==B)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";Nt(s,y,p),p=Object.assign({},p);var F=e.length,w=[],M,D=p.level||0,G=p.width,ue=p.height,pe=e.length,Ee=!0;function Fe(Me){return function(Be,je){if(--F,Be)w.push(Be);else{if(rt(s,p),s.bindTexture(S,y),Ee){Ee=!1,G=p.width||je.width,ue=p.height||je.height,s.texImage3D(S,D,t,G,ue,pe,0,d,b,null);for(var Ye=0;Ye<pe;++Ye)s.texSubImage3D(S,D,0,0,Ye,G,ue,1,d,b,je)}else{var ir=je,mr;(je.width!==G||je.height!==ue)&&(mr=C(),ir=mr.canvas,mr.canvas.width=G,mr.canvas.height=ue,mr.drawImage(je,0,0,G,ue)),s.texSubImage3D(S,D,0,0,Me,G,ue,1,d,b,ir),mr&&ir===mr.canvas&&(mr.canvas.width=0,mr.canvas.height=0)}tt(p)&&s.generateMipmap(S)}F===0&&g(w.length?w:void 0,y,M)}}M=e.map(function(Me,Be){return cn(Me,p.crossOrigin,Fe(Be))})}function Ut(s,y,p,g){g=g||ne.textureOptions;var e=g.target||rr;s.bindTexture(e,y);var t=g.width,n=g.height,d=g.depth,b=g.level||0,S=g.internalFormat||g.format||P,F=Kr(S),w=g.format||F.format,M=g.type||mt(s,p,F.type);if(ge(p))p instanceof Uint8ClampedArray&&(p=new Uint8Array(p.buffer));else{var D=se.getTypedArrayTypeForGLType(M);p=new D(p)}var G=Hr(S,M),ue=p.byteLength/G;if(ue%1)throw"length wrong size for format: "+k.glEnumToString(s,w);var pe;if(e===x||e===B)if(!t&&!n&&!d){var Ee=Math.cbrt(ue);if(Ee%1!==0)throw"can't guess cube size of array of numElements: "+ue;t=Ee,n=Ee,d=Ee}else t&&(!n||!d)?(pe=Yr(s,e,n,d,ue/t),n=pe.width,d=pe.height):n&&(!t||!d)?(pe=Yr(s,e,t,d,ue/n),t=pe.width,d=pe.height):(pe=Yr(s,e,t,n,ue/d),t=pe.width,n=pe.height);else pe=Yr(s,e,t,n,ue),t=pe.width,n=pe.height;if(It(s),s.pixelStorei(f,g.unpackAlignment||1),rt(s,g),e===ye){var Fe=G/p.BYTES_PER_ELEMENT,Me=ue/6*Fe;Mt(s,g).forEach(function(Be){var je=Me*Be.ndx,Ye=p.subarray(je,je+Me);s.texImage2D(Be.face,b,S,t,n,0,w,M,Ye)})}else e===x||e===B?s.texImage3D(e,b,S,t,n,d,0,w,M,p):s.texImage2D(e,b,S,t,n,0,w,M,p);return{width:t,height:n,depth:d,type:M}}function ln(s,y,p){var g=p.target||rr;s.bindTexture(g,y);var e=p.level||0,t=p.internalFormat||p.format||P,n=Kr(t),d=p.format||n.format,b=p.type||n.type;if(rt(s,p),g===ye)for(var S=0;S<6;++S)s.texImage2D(U+S,e,t,p.width,p.height,0,d,b,null);else g===x||g===B?s.texImage3D(g,e,t,p.width,p.height,p.depth,0,d,b,null):s.texImage2D(g,e,t,p.width,p.height,0,d,b,null)}function sn(s,y,p){p=p||zr,y=y||ne.textureOptions;var g=s.createTexture(),e=y.target||rr,t=y.width||1,n=y.height||1,d=y.internalFormat||P;s.bindTexture(e,g),e===ye&&(s.texParameteri(e,He,_e),s.texParameteri(e,fr,_e));var b=y.src;if(b)if(typeof b=="function"&&(b=b(s,y)),typeof b=="string")jn(s,g,y,p);else if(ge(b)||Array.isArray(b)&&(typeof b[0]=="number"||Array.isArray(b[0])||ge(b[0]))){var S=Ut(s,g,b,y);t=S.width,n=S.height}else Array.isArray(b)&&(typeof b[0]=="string"||fn(b[0]))?e===ye?ya(s,g,y,p):Vn(s,g,y,p):(un(s,g,b,y),t=b.width,n=b.height);else ln(s,g,y);return tt(y)&&yt(s,g,y,t,n,d),nn(s,g,y),g}function pa(s,y,p,g,e,t){g=g||p.width,e=e||p.height,t=t||p.depth;var n=p.target||rr;s.bindTexture(n,y);var d=p.level||0,b=p.internalFormat||p.format||P,S=Kr(b),F=p.format||S.format,w,M=p.src;if(M&&(ge(M)||Array.isArray(M)&&typeof M[0]=="number")?w=p.type||mt(s,M,S.type):w=p.type||S.type,n===ye)for(var D=0;D<6;++D)s.texImage2D(U+D,d,b,g,e,0,F,w,null);else n===x||n===B?s.texImage3D(n,d,b,g,e,t,0,F,w,null):s.texImage2D(n,d,b,g,e,0,F,w,null)}function Gt(s){return typeof s=="string"||Array.isArray(s)&&typeof s[0]=="string"}function da(s,y,p){p=p||zr;var g=0,e=[],t={},n={};function d(){g===0&&setTimeout(function(){p(e.length?e:void 0,t,n)},0)}return Object.keys(y).forEach(function(b){var S=y[b],F;Gt(S.src)&&(F=function(M,D,G){n[b]=G,--g,M&&e.push(M),d()},++g),t[b]=sn(s,S,F)}),d(),t}},"./src/twgl-full.js":(X,u,Y)=>{function ee(C){"@babel/helpers - typeof";return ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(H){return typeof H}:function(H){return H&&typeof Symbol=="function"&&H.constructor===Symbol&&H!==Symbol.prototype?"symbol":typeof H},ee(C)}u.__esModule=!0;var k={m4:!0,v3:!0,primitives:!0};u.v3=u.primitives=u.m4=void 0;var se=ge(Y("./src/m4.js"));u.m4=se;var te=ge(Y("./src/v3.js"));u.v3=te;var W=ge(Y("./src/primitives.js"));u.primitives=W;var me=Y("./src/twgl.js");Object.keys(me).forEach(function(C){C==="default"||C==="__esModule"||Object.prototype.hasOwnProperty.call(k,C)||C in u&&u[C]===me[C]||(u[C]=me[C])});function ne(C){if(typeof WeakMap!="function")return null;var H=new WeakMap,z=new WeakMap;return(ne=function(j){return j?z:H})(C)}function ge(C,H){if(!H&&C&&C.__esModule)return C;if(C===null||ee(C)!="object"&&typeof C!="function")return{default:C};var z=ne(H);if(z&&z.has(C))return z.get(C);var P={__proto__:null},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var oe in C)if(oe!=="default"&&Object.prototype.hasOwnProperty.call(C,oe)){var he=j?Object.getOwnPropertyDescriptor(C,oe):null;he&&(he.get||he.set)?Object.defineProperty(P,oe,he):P[oe]=C[oe]}return P.default=C,z&&z.set(C,P),P}},"./src/twgl.js":(X,u,Y)=>{function ee(A){"@babel/helpers - typeof";return ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(be){return typeof be}:function(be){return be&&typeof Symbol=="function"&&be.constructor===Symbol&&be!==Symbol.prototype?"symbol":typeof be},ee(A)}u.__esModule=!0;var k={addExtensionsToContext:!0,getContext:!0,getWebGLContext:!0,resizeCanvasToDisplaySize:!0,setDefaults:!0,attributes:!0,textures:!0,utils:!0,draw:!0,framebuffers:!0,programs:!0,typedarrays:!0,vertexArrays:!0};u.addExtensionsToContext=ur,u.framebuffers=u.draw=u.attributes=void 0,u.getContext=B,u.getWebGLContext=ye,u.programs=void 0,u.resizeCanvasToDisplaySize=U,u.setDefaults=he,u.vertexArrays=u.utils=u.typedarrays=u.textures=void 0;var se=j(Y("./src/attributes.js"));u.attributes=se,Object.keys(se).forEach(function(A){A==="default"||A==="__esModule"||Object.prototype.hasOwnProperty.call(k,A)||A in u&&u[A]===se[A]||(u[A]=se[A])});var te=j(Y("./src/textures.js"));u.textures=te,Object.keys(te).forEach(function(A){A==="default"||A==="__esModule"||Object.prototype.hasOwnProperty.call(k,A)||A in u&&u[A]===te[A]||(u[A]=te[A])});var W=j(Y("./src/helper.js")),me=j(Y("./src/utils.js"));u.utils=me,Object.keys(me).forEach(function(A){A==="default"||A==="__esModule"||Object.prototype.hasOwnProperty.call(k,A)||A in u&&u[A]===me[A]||(u[A]=me[A])});var ne=j(Y("./src/draw.js"));u.draw=ne,Object.keys(ne).forEach(function(A){A==="default"||A==="__esModule"||Object.prototype.hasOwnProperty.call(k,A)||A in u&&u[A]===ne[A]||(u[A]=ne[A])});var ge=j(Y("./src/framebuffers.js"));u.framebuffers=ge,Object.keys(ge).forEach(function(A){A==="default"||A==="__esModule"||Object.prototype.hasOwnProperty.call(k,A)||A in u&&u[A]===ge[A]||(u[A]=ge[A])});var C=j(Y("./src/programs.js"));u.programs=C,Object.keys(C).forEach(function(A){A==="default"||A==="__esModule"||Object.prototype.hasOwnProperty.call(k,A)||A in u&&u[A]===C[A]||(u[A]=C[A])});var H=j(Y("./src/typedarrays.js"));u.typedarrays=H,Object.keys(H).forEach(function(A){A==="default"||A==="__esModule"||Object.prototype.hasOwnProperty.call(k,A)||A in u&&u[A]===H[A]||(u[A]=H[A])});var z=j(Y("./src/vertex-arrays.js"));u.vertexArrays=z,Object.keys(z).forEach(function(A){A==="default"||A==="__esModule"||Object.prototype.hasOwnProperty.call(k,A)||A in u&&u[A]===z[A]||(u[A]=z[A])});function P(A){if(typeof WeakMap!="function")return null;var be=new WeakMap,we=new WeakMap;return(P=function(We){return We?we:be})(A)}function j(A,be){if(!be&&A&&A.__esModule)return A;if(A===null||ee(A)!="object"&&typeof A!="function")return{default:A};var we=P(be);if(we&&we.has(A))return we.get(A);var Ce={__proto__:null},We=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Ge in A)if(Ge!=="default"&&Object.prototype.hasOwnProperty.call(A,Ge)){var Ze=We?Object.getOwnPropertyDescriptor(A,Ge):null;Ze&&(Ze.get||Ze.set)?Object.defineProperty(Ce,Ge,Ze):Ce[Ge]=A[Ge]}return Ce.default=A,we&&we.set(A,Ce),Ce}var oe={addExtensionsToContext:!0};function he(A){W.copyExistingProperties(A,oe),se.setAttributeDefaults_(A),te.setTextureDefaults_(A)}var Ne=/^(.*?)_/;function _e(A,be){me.glEnumToString(A,0);var we=A.getExtension(be);if(we){var Ce={},We=Ne.exec(be)[1],Ge="_"+We;for(var Ze in we){var He=we[Ze],fr=typeof He=="function",Tr=fr?We:Ge,cr=Ze;Ze.endsWith(Tr)&&(cr=Ze.substring(0,Ze.length-Tr.length)),A[cr]!==void 0?!fr&&A[cr]!==He&&W.warn(cr,A[cr],He,Ze):fr?A[cr]=function(ar){return function(){return ar.apply(we,arguments)}}(He):(A[cr]=He,Ce[cr]=He)}Ce.constructor={name:we.constructor.name},me.glEnumToString(Ce,0)}return we}var or=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_depth_texture","WEBGL_draw_buffers"];function ur(A){for(var be=0;be<or.length;++be)_e(A,or[be])}function rr(A,be){for(var we=["webgl","experimental-webgl"],Ce=null,We=0;We<we.length;++We)if(Ce=A.getContext(we[We],be),Ce){oe.addExtensionsToContext&&ur(Ce);break}return Ce}function ye(A,be){var we=rr(A,be);return we}function x(A,be){for(var we=["webgl2","webgl","experimental-webgl"],Ce=null,We=0;We<we.length;++We)if(Ce=A.getContext(we[We],be),Ce){oe.addExtensionsToContext&&ur(Ce);break}return Ce}function B(A,be){var we=x(A,be);return we}function U(A,be){be=be||1,be=Math.max(0,be);var we=A.clientWidth*be|0,Ce=A.clientHeight*be|0;return A.width!==we||A.height!==Ce?(A.width=we,A.height=Ce,!0):!1}},"./src/typedarrays.js":(X,u)=>{u.__esModule=!0,u.getGLTypeForTypedArray=or,u.getGLTypeForTypedArrayType=ur,u.getTypedArrayTypeForGLType=rr,u.isArrayBuffer=void 0;var Y=5120,ee=5121,k=5122,se=5123,te=5124,W=5125,me=5126,ne=32819,ge=32820,C=33635,H=5131,z=33640,P=35899,j=35902,oe=36269,he=34042,Ne={};{var _e=Ne;_e[Y]=Int8Array,_e[ee]=Uint8Array,_e[k]=Int16Array,_e[se]=Uint16Array,_e[te]=Int32Array,_e[W]=Uint32Array,_e[me]=Float32Array,_e[ne]=Uint16Array,_e[ge]=Uint16Array,_e[C]=Uint16Array,_e[H]=Uint16Array,_e[z]=Uint32Array,_e[P]=Uint32Array,_e[j]=Uint32Array,_e[oe]=Uint32Array,_e[he]=Uint32Array}function or(ye){if(ye instanceof Int8Array)return Y;if(ye instanceof Uint8Array||ye instanceof Uint8ClampedArray)return ee;if(ye instanceof Int16Array)return k;if(ye instanceof Uint16Array)return se;if(ye instanceof Int32Array)return te;if(ye instanceof Uint32Array)return W;if(ye instanceof Float32Array)return me;throw new Error("unsupported typed array type")}function ur(ye){if(ye===Int8Array)return Y;if(ye===Uint8Array||ye===Uint8ClampedArray)return ee;if(ye===Int16Array)return k;if(ye===Uint16Array)return se;if(ye===Int32Array)return te;if(ye===Uint32Array)return W;if(ye===Float32Array)return me;throw new Error("unsupported typed array type")}function rr(ye){var x=Ne[ye];if(!x)throw new Error("unknown gl type");return x}u.isArrayBuffer=typeof SharedArrayBuffer<"u"?function(x){return x&&x.buffer&&(x.buffer instanceof ArrayBuffer||x.buffer instanceof SharedArrayBuffer)}:function(x){return x&&x.buffer&&x.buffer instanceof ArrayBuffer}},"./src/utils.js":(X,u)=>{u.__esModule=!0,u.glEnumToString=void 0,u.isWebGL1=ee,u.isWebGL2=Y;function Y(k){return!!k.texStorage2D}function ee(k){return!k.texStorage2D}u.glEnumToString=function(){var k={},se={};function te(W){var me=W.constructor.name;if(!k[me]){for(var ne in W)if(typeof W[ne]=="number"){var ge=se[W[ne]];se[W[ne]]=ge?"".concat(ge," | ").concat(ne):ne}k[me]=!0}}return function(me,ne){return te(me),se[ne]||(typeof ne=="number"?"0x".concat(ne.toString(16)):ne)}}()},"./src/v3.js":(X,u)=>{u.__esModule=!0,u.add=se,u.copy=ur,u.create=k,u.cross=z,u.distance=he,u.distanceSq=Ne,u.divScalar=H,u.divide=ye,u.dot=P,u.length=j,u.lengthSq=oe,u.lerp=W,u.lerpV=me,u.max=ne,u.min=ge,u.mulScalar=C,u.multiply=rr,u.negate=or,u.normalize=_e,u.setDefaultType=ee,u.subtract=te;var Y=Float32Array;function ee(x){var B=Y;return Y=x,B}function k(x,B,U){var A=new Y(3);return x&&(A[0]=x),B&&(A[1]=B),U&&(A[2]=U),A}function se(x,B,U){return U=U||new Y(3),U[0]=x[0]+B[0],U[1]=x[1]+B[1],U[2]=x[2]+B[2],U}function te(x,B,U){return U=U||new Y(3),U[0]=x[0]-B[0],U[1]=x[1]-B[1],U[2]=x[2]-B[2],U}function W(x,B,U,A){return A=A||new Y(3),A[0]=x[0]+U*(B[0]-x[0]),A[1]=x[1]+U*(B[1]-x[1]),A[2]=x[2]+U*(B[2]-x[2]),A}function me(x,B,U,A){return A=A||new Y(3),A[0]=x[0]+U[0]*(B[0]-x[0]),A[1]=x[1]+U[1]*(B[1]-x[1]),A[2]=x[2]+U[2]*(B[2]-x[2]),A}function ne(x,B,U){return U=U||new Y(3),U[0]=Math.max(x[0],B[0]),U[1]=Math.max(x[1],B[1]),U[2]=Math.max(x[2],B[2]),U}function ge(x,B,U){return U=U||new Y(3),U[0]=Math.min(x[0],B[0]),U[1]=Math.min(x[1],B[1]),U[2]=Math.min(x[2],B[2]),U}function C(x,B,U){return U=U||new Y(3),U[0]=x[0]*B,U[1]=x[1]*B,U[2]=x[2]*B,U}function H(x,B,U){return U=U||new Y(3),U[0]=x[0]/B,U[1]=x[1]/B,U[2]=x[2]/B,U}function z(x,B,U){U=U||new Y(3);var A=x[2]*B[0]-x[0]*B[2],be=x[0]*B[1]-x[1]*B[0];return U[0]=x[1]*B[2]-x[2]*B[1],U[1]=A,U[2]=be,U}function P(x,B){return x[0]*B[0]+x[1]*B[1]+x[2]*B[2]}function j(x){return Math.sqrt(x[0]*x[0]+x[1]*x[1]+x[2]*x[2])}function oe(x){return x[0]*x[0]+x[1]*x[1]+x[2]*x[2]}function he(x,B){var U=x[0]-B[0],A=x[1]-B[1],be=x[2]-B[2];return Math.sqrt(U*U+A*A+be*be)}function Ne(x,B){var U=x[0]-B[0],A=x[1]-B[1],be=x[2]-B[2];return U*U+A*A+be*be}function _e(x,B){B=B||new Y(3);var U=x[0]*x[0]+x[1]*x[1]+x[2]*x[2],A=Math.sqrt(U);return A>1e-5?(B[0]=x[0]/A,B[1]=x[1]/A,B[2]=x[2]/A):(B[0]=0,B[1]=0,B[2]=0),B}function or(x,B){return B=B||new Y(3),B[0]=-x[0],B[1]=-x[1],B[2]=-x[2],B}function ur(x,B){return B=B||new Y(3),B[0]=x[0],B[1]=x[1],B[2]=x[2],B}function rr(x,B,U){return U=U||new Y(3),U[0]=x[0]*B[0],U[1]=x[1]*B[1],U[2]=x[2]*B[2],U}function ye(x,B,U){return U=U||new Y(3),U[0]=x[0]/B[0],U[1]=x[1]/B[1],U[2]=x[2]/B[2],U}},"./src/vertex-arrays.js":(X,u,Y)=>{function ee(C){"@babel/helpers - typeof";return ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(H){return typeof H}:function(H){return H&&typeof Symbol=="function"&&H.constructor===Symbol&&H!==Symbol.prototype?"symbol":typeof H},ee(C)}u.__esModule=!0,u.createVAOAndSetAttributes=ne,u.createVAOFromBufferInfo=ge,u.createVertexArrayInfo=me;var k=te(Y("./src/programs.js"));function se(C){if(typeof WeakMap!="function")return null;var H=new WeakMap,z=new WeakMap;return(se=function(j){return j?z:H})(C)}function te(C,H){if(!H&&C&&C.__esModule)return C;if(C===null||ee(C)!="object"&&typeof C!="function")return{default:C};var z=se(H);if(z&&z.has(C))return z.get(C);var P={__proto__:null},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var oe in C)if(oe!=="default"&&Object.prototype.hasOwnProperty.call(C,oe)){var he=j?Object.getOwnPropertyDescriptor(C,oe):null;he&&(he.get||he.set)?Object.defineProperty(P,oe,he):P[oe]=C[oe]}return P.default=C,z&&z.set(C,P),P}var W=34963;function me(C,H,z){var P=C.createVertexArray();return C.bindVertexArray(P),H.length||(H=[H]),H.forEach(function(j){k.setBuffersAndAttributes(C,j,z)}),C.bindVertexArray(null),{numElements:z.numElements,elementType:z.elementType,vertexArrayObject:P}}function ne(C,H,z,P){var j=C.createVertexArray();return C.bindVertexArray(j),k.setAttributes(H,z),P&&C.bindBuffer(W,P),C.bindVertexArray(null),j}function ge(C,H,z){return ne(C,H.attribSetters||H,z.attribs,z.indices)}}},R={};function L(X){var u=R[X];if(u!==void 0)return u.exports;var Y=R[X]={exports:{}};return l[X](Y,Y.exports,L),Y.exports}var Q=L("./src/twgl-full.js");return Q})())})(Na);var at=Na.exports,Cr,Br,ot,Xt,ut,Ar,ft,Nr,qt,bn,En,Tn,ea,Ua,ra,Ga,ta,ka,Sn,Ra,na,ja;class za{constructor(){Te(this,ea);Te(this,ra);Te(this,ta);Te(this,Sn);Te(this,na);$e(this,"canvas",document.querySelector("#canvas"));$e(this,"gl");Te(this,Cr,new Map);Te(this,Br,new Map);Te(this,ot,void 0);Te(this,Xt,void 0);Te(this,ut,void 0);Te(this,Ar,new Uint8Array(600));Te(this,ft,void 0);Te(this,Nr,new Uint8Array(3*40));Te(this,qt,void 0);Te(this,bn,document.createTextNode("0"));Te(this,En,document.createTextNode("1"));Te(this,Tn,document.createTextNode("0"));document.querySelector("#linesCleared").appendChild(N(this,bn)),document.querySelector("#speedLevel").appendChild(N(this,En)),document.querySelector("#score").appendChild(N(this,Tn)),N(this,Cr).set(1,[255,0,0]),N(this,Cr).set(2,[0,255,0]),N(this,Cr).set(3,[255,255,0]),N(this,Cr).set(4,[0,0,255]),N(this,Cr).set(5,[180,90,246]),N(this,Cr).set(6,[0,255,255]),N(this,Cr).set(7,[255,140,40]),N(this,Br).set("Z",1),N(this,Br).set("S",2),N(this,Br).set("O",3),N(this,Br).set("J",4),N(this,Br).set("T",5),N(this,Br).set("I",6),N(this,Br).set("L",7);let o=this.canvas.getContext("webgl");this.gl=o,o||document.body.appendChild(document.createTextNode("WebGL is not supported."));function l(ee,k,se,te){return[ee,k+te,ee+se,k+te,ee+se,k,ee,k]}function R(ee,k,se,te){let W=[ee/2,ee],me=[],ne=(500-W[1])/2,ge=(400-W[0])/2;me.push(...l(ge,ne,W[0],W[1])),me.push(...l(ge-k-te,ne,te,te));for(let C=0;C<3;C++)me.push(...l(ge+k+W[0],ne+C*(te+se),te,te));return me}const L={a_Position:{numComponents:2,data:R(500,5,0,70)},a_GridPos:{numComponents:2,data:[0,0,10,0,10,20,0,20,0,0,4,0,4,4,0,4,0,0,4,0,4,4,0,4,0,0,4,0,4,4,0,4,0,0,4,0,4,4,0,4]},a_QueueID:{numComponents:1,data:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3]},a_ShaderID:{numComponents:1,data:[0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},indices:{numComponents:3,data:[0,1,2,2,3,0,4,5,6,6,7,4,8,9,10,10,11,8,12,13,14,14,15,12,16,17,18,18,19,16]}};Se(this,Xt,at.createBufferInfoFromArrays(o,L));let Q=document.querySelector("#vertex-shader-2d").text,X=document.querySelector("#fragment-shader-2d").text;Se(this,ot,at.createProgramInfo(o,[Q,X]));let u={src:"textures/block.png",mag:o.LINEAR};Se(this,qt,at.createTexture(this.gl,u)),Se(this,ut,o.createTexture()),o.bindTexture(o.TEXTURE_2D,N(this,ut)),o.pixelStorei(o.UNPACK_ALIGNMENT,1),o.texImage2D(o.TEXTURE_2D,0,o.RGB,10,20,0,o.RGB,o.UNSIGNED_BYTE,null),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),Se(this,ft,o.createTexture()),o.bindTexture(o.TEXTURE_2D,N(this,ft)),o.pixelStorei(o.UNPACK_ALIGNMENT,1),o.texImage2D(o.TEXTURE_2D,0,o.RGB,4,2*5,0,o.RGB,o.UNSIGNED_BYTE,null),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.useProgram(N(this,ot).program),at.setBuffersAndAttributes(o,N(this,ot),N(this,Xt));let Y={u_Resolution:[this.gl.canvas.width,this.gl.canvas.height],u_GridData:N(this,ut),u_QueueData:N(this,ft),u_BlockTexture:N(this,qt)};at.setUniforms(N(this,ot),Y)}updateData(o){er(this,ea,Ua).call(this,o),er(this,ta,ka).call(this,o),er(this,na,ja).call(this,o)}renderGame(){at.resizeCanvasToDisplaySize(this.gl.canvas),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height);let o={u_Resolution:[this.gl.canvas.width,this.gl.canvas.height],u_GridData:N(this,ut),u_QueueData:N(this,ft),u_BlockTexture:N(this,qt)};at.setUniforms(N(this,ot),o),at.drawBufferInfo(this.gl,N(this,Xt))}}Cr=new WeakMap,Br=new WeakMap,ot=new WeakMap,Xt=new WeakMap,ut=new WeakMap,Ar=new WeakMap,ft=new WeakMap,Nr=new WeakMap,qt=new WeakMap,bn=new WeakMap,En=new WeakMap,Tn=new WeakMap,ea=new WeakSet,Ua=function(o){for(let l=0;l<20;l++){let R=o.gridData[l];for(let L=0;L<10;L++){let Q=er(this,ra,Ga).call(this,R,L),X=3*(10*l+L);if(Q!=0){let u=N(this,Cr).get(Q);N(this,Ar)[X]=u[0],N(this,Ar)[X+1]=u[1],N(this,Ar)[X+2]=u[2]}else N(this,Ar)[X]=0,N(this,Ar)[X+1]=0,N(this,Ar)[X+2]=0}}if(o.playerPiece.active){let l=170;for(let L=0;L<4;L++){let Q=3*(10*o.ghostBlocks[L][1]+o.ghostBlocks[L][0]);N(this,Ar)[Q]=l,N(this,Ar)[Q+1]=l,N(this,Ar)[Q+2]=l}let R=o.playerPiece.shape;for(let L=0;L<4;L++){let Q=N(this,Cr).get(N(this,Br).get(R)),X=3*(10*o.playerPiece.blocks[L][1]+o.playerPiece.blocks[L][0]);N(this,Ar)[X]=Q[0],N(this,Ar)[X+1]=Q[1],N(this,Ar)[X+2]=Q[2]}}this.gl.bindTexture(this.gl.TEXTURE_2D,N(this,ut)),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,10,20,this.gl.RGB,this.gl.UNSIGNED_BYTE,N(this,Ar))},ra=new WeakSet,Ga=function(o,l){const R=32-(3+3*l),L=7<<R;return(o&L)>>>R},ta=new WeakSet,ka=function(o){for(let l=0;l<N(this,Nr).length;l++)N(this,Nr)[l]=0;o.heldPiece!=null&&er(this,Sn,Ra).call(this,o.heldPiece,0);for(let l=0;l<4;l++)er(this,Sn,Ra).call(this,o.pieceQueue[l],24*(1+l));this.gl.bindTexture(this.gl.TEXTURE_2D,N(this,ft)),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,4,10,this.gl.RGB,this.gl.UNSIGNED_BYTE,N(this,Nr))},Sn=new WeakSet,Ra=function(o,l){let R=it.getBaseShape(o),L=N(this,Cr).get(N(this,Br).get(o));for(let Q=0;Q<4;Q++){let X=R[Q],u=l+3*(X[1]*4+X[0]);N(this,Nr)[u]=L[0],N(this,Nr)[u+1]=L[1],N(this,Nr)[u+2]=L[2]}if(o!="I"&&o!="O"){let Q=l+21;N(this,Nr)[Q]=255}else o=="I"&&(N(this,Nr)[l+21+1]=255)},na=new WeakSet,ja=function(o){N(this,bn).nodeValue=o.linesCleared,N(this,En).nodeValue=o.speedLevel==11?"MAX":o.speedLevel,N(this,Tn).nodeValue=o.score};var Ht,Kt,St,ct,lt,st,Jr,Yt,gn;class Qa{constructor(o,l){$e(this,"leftQueue",0);$e(this,"rightQueue",0);$e(this,"moveDown",!1);$e(this,"rotate",{left:!1,right:!1});$e(this,"hardDrop",!1);$e(this,"hold",!1);$e(this,"dragSensitivity",40);$e(this,"slamThreshold",150);$e(this,"slamTimeLimit",400);$e(this,"turnaroundFactor",.5);Te(this,Ht,void 0);Te(this,Kt,void 0);Te(this,St,void 0);Te(this,ct,void 0);Te(this,lt,!1);Te(this,st,null);Te(this,Jr,{startTime:0,startY:0,endY:0});Te(this,Yt,void 0);Te(this,gn,!1);o.addEventListener("touchmove",R=>{this.dragEvent(R)}),o.addEventListener("touchstart",R=>{this.touchStart(R)}),o.addEventListener("touchend",R=>{this.touchEnd(R)}),o.addEventListener("touchcancel",R=>{this.touchEnd(R)}),Se(this,Ht,o),l.addEventListener("click",R=>{this.hold=!0})}touchStart(o){if(N(this,st)===null&&o.target.closest(".blockGestures")===null){let l=o.touches.item(0);Se(this,st,l.identifier),Se(this,St,l.pageX),Se(this,ct,l.pageY),Se(this,Kt,l.pageX),Se(this,Yt,Date.now()),Se(this,gn,l.clientX<N(this,Ht).getBoundingClientRect().x+N(this,Ht).getBoundingClientRect().width*.5),Se(this,Jr,{startTime:Date.now(),startY:l.pageY,endY:l.pageY})}}touchEnd(o){let l=!0;for(let R=0;R<o.touches.length&&l;R++)o.touches.item(R).identifier===N(this,st)&&(l=!1);l&&(Date.now()-N(this,Yt)<300&&this.leftQueue==0&&this.rightQueue==0&&(N(this,gn)?this.rotate.left=!0:this.rotate.right=!0),Date.now()-N(this,Jr).startTime<=this.slamTimeLimit&&N(this,Jr).endY-N(this,Jr).startY>this.slamThreshold&&(this.hardDrop=!0),Se(this,st,null),this.leftQueue=0,this.rightQueue=0,this.moveDown=!1)}dragEvent(o){let l=!1,R=null;for(let L=0;L<o.changedTouches.length;L++)if(o.changedTouches.item(L).identifier===N(this,st)){R=o.changedTouches.item(L);break}R!==null&&((R.pageX-N(this,Kt))*(N(this,lt)?1:-1)>0&&(Se(this,lt,!N(this,lt)),Se(this,St,R.pageX+this.dragSensitivity*this.turnaroundFactor*(N(this,lt)?1:-1)),Se(this,ct,R.pageY)),Math.abs(R.pageX-N(this,St))>this.dragSensitivity&&(N(this,lt)?(this.leftQueue++,this.rightQueue=0):(this.rightQueue++,this.leftQueue=0),l=!0,N(this,Jr).startTime=0,this.moveDown=!1),R.pageY-N(this,ct)>this.dragSensitivity?(this.moveDown=!0,this.leftQueue=0,this.rightQueue=0,l=!0):N(this,ct)-R.pageY>this.dragSensitivity&&(this.moveDown=!1,l=!0),l&&(Se(this,St,R.pageX),Se(this,ct,R.pageY),Se(this,Yt,0)),Se(this,Kt,R.pageX),N(this,Jr).endY=R.pageY)}}Ht=new WeakMap,Kt=new WeakMap,St=new WeakMap,ct=new WeakMap,lt=new WeakMap,st=new WeakMap,Jr=new WeakMap,Yt=new WeakMap,gn=new WeakMap;class Za{constructor(o,l,R,L,Q,X,u){$e(this,"inputStates",new Map);$e(this,"frameCounter",{moveLeft:0,moveRight:0,softDrop:0});this.inputStates.set("moveLeft",!1),this.inputStates.set("moveRight",!1),this.inputStates.set("softDrop",!1),this.inputStates.set("hold",!1),this.inputStates.set("hardDrop",!1),this.inputStates.set("rotateClockwise",!1),this.inputStates.set("rotateAnticlockwise",!1),console.log("adding listeners"),this.addStateListeners(l,"moveLeft"),this.addStateListeners(R,"moveRight"),this.addStateListeners(L,"softDrop"),this.addFlagListners(Q,"hardDrop"),this.addFlagListners(X,"rotateClockwise"),this.addFlagListners(u,"rotateAnticlockwise"),this.addFlagListners(o,"hold"),console.log("listeners added")}addCommonListeners(o,l){o.addEventListener("pointerdown",R=>{this.inputStates.set(l,!0),o.classList.add("pressed")}),o.addEventListener("pointerleave",R=>{o.classList.remove("pressed")}),o.addEventListener("touchstart",R=>{R.preventDefault()})}addFlagListners(o,l){o.addEventListener("click",R=>{R.pointerType===""&&this.inputStates.set(l,!0)}),this.addCommonListeners(o,l)}addStateListeners(o,l){o.addEventListener("pointerleave",R=>{switch(this.inputStates.set(l,!1),o.classList.remove("pressed"),l){case"moveLeft":this.frameCounter.moveLeft=0;break;case"moveRight":this.frameCounter.moveRight=0;break;case"softDrop":this.frameCounter.softDrop=0;break}}),o.addEventListener("click",R=>{R.pointerType===""&&(l==="moveLeft"?this.frameCounter.moveLeft++:l==="moveRight"?this.frameCounter.moveRight++:l==="softDrop"&&this.frameCounter.softDrop++)}),this.addCommonListeners(o,l)}countFrame(){this.inputStates.get("moveLeft")&&this.frameCounter.moveLeft++,this.inputStates.get("moveRight")&&this.frameCounter.moveRight++,this.inputStates.get("softDrop")&&this.frameCounter.softDrop++}resetFlags(){this.inputStates.set("hold",!1),this.inputStates.set("hardDrop",!1),this.inputStates.set("rotateClockwise",!1),this.inputStates.set("rotateAnticlockwise",!1)}getInput(o){return this.inputStates.get(o)}}let hn=null,Fa=new Map,Va;function Ja(K){K.inputKeys.forEach(function(l,R,L){localStorage.setItem(l,R)})}function $a(K){let o=[];K.inputKeys.forEach(function(l,R,L){const Q=localStorage.getItem(l);Q!=null&&o.push({action:l,oldKey:R,newKey:Q})});for(let l=0;l<o.length;l++)K.inputKeys.delete(o[l].oldKey);for(let l=0;l<o.length;l++)K.inputKeys.set(o[l].newKey,o[l].action)}function ei(K,o){const l=document.querySelectorAll(K);for(let Q=0;Q<l.length;Q++){let X=l[Q];X.classList.add("ready"),X.addEventListener("click",function(){o.selectedSpan!=null&&(o.selectedKey="Escape",L()),o.originalKeybind=X.innerText,o.selectedSpan=X,o.selectedAction=X.id.substring(2),hn.textContent="Rebinding "+o.selectedAction+" action (press key to rebind)...",document.addEventListener("keydown",R),X.classList.remove("ready"),X.classList.add("waiting"),X.innerText="..."}),X.innerText=o.actionToKey(X.id.substring(2)),X.innerText==" "&&(X.innerText="Space")}function R(Q){o.selectedKey=Q.key.length>1?Q.key:Q.key.toUpperCase(),L()}function L(){o.selectedKey=="Escape"||Va.classList.contains("hide")?(o.selectedKey=o.originalKeybind,Q(),hn.textContent="Rebind canceled.",o.updateCounters()):o.rebindControl(o.selectedAction,o.selectedKey)?(hn.textContent="Rebind successful!",Q(),Ja(o)):hn.textContent="'"+o.selectedKey+"' is already in use (press another key)...";function Q(){document.removeEventListener("keydown",R);const X=o.selectedKey==" "?"Space":o.selectedKey;o.selectedSpan.innerText=X,Fa.get(o.selectedAction).forEach(function(u,Y,ee){u.innerText=X}),o.selectedAction="",o.selectedKey="",o.selectedSpan.classList.remove("waiting"),o.selectedSpan.classList.add("ready"),o.selectedSpan=null}}}function ri(K,o,l,R){Va=R,hn=l,ei(K,o),o.actionStates.forEach(function(L,Q,X){Fa.set(Q,document.querySelectorAll("span.cd_"+Q)),Fa.get(Q).forEach(function(u,Y,ee){const k=o.actionToKey(Q);u.innerText=k==" "?"Space":k})})}var An,_n,wn,Pn,vt,zt,gt,Qt;class ti{constructor(o,l,R,L){Te(this,An,void 0);Te(this,_n,void 0);Te(this,wn,void 0);Te(this,Pn,{gestureEnable:!1,buttonEnable:!0,keyboardRepeatDelay:5,gestureGridIncrement:40,gestureDirectionSwapAssist:0,gestureHardDropDistance:150,gestureHardDropTimer:200,buttonRepeatDelay:5});$e(this,"settingsValues");Te(this,vt,void 0);Te(this,zt,void 0);Te(this,gt,void 0);Te(this,Qt,void 0);Se(this,An,document.querySelector("div."+o)),Se(this,_n,document.querySelector("div."+l)),Se(this,wn,document.querySelector("div."+R)),document.querySelector("button."+o).addEventListener("click",Q=>{Aa(N(this,An))}),document.querySelector("button."+l).addEventListener("click",Q=>{Aa(N(this,_n))}),document.querySelector("button."+R).addEventListener("click",Q=>{Aa(N(this,wn))}),this.settingsValues={...N(this,Pn)},Object.keys(N(this,Pn)).forEach((Q,X,u)=>{this.linkInput(Q)}),Se(this,vt,L),Se(this,zt,document.querySelector(".canvasSpace")),Se(this,gt,document.querySelector(".controller")),Se(this,Qt,!N(this,gt).classList.contains("hide")),this.updateValues()}linkInput(o){let l=document.querySelector("input."+o);if(l===null){console.log("Could not find input element for the '"+o+"' setting.");return}if(l.getAttribute("type")==="checkbox"){let L=l.closest(".menu");l.addEventListener("input",Q=>{this.settingsValues[o]=l.checked,l.checked?L.classList.remove("disabled"):L.classList.add("disabled"),this.updateValues()}),l.checked=this.settingsValues[o],l.checked||L.classList.add("disabled");return}l.value=this.settingsValues[o];let R=document.querySelector("span."+o);R.innerHTML=l.value,l.addEventListener("input",L=>{R.innerHTML=l.value,this.settingsValues[o]=l.value,this.updateValues()})}updateValues(){N(this,vt).dragSensitivity=this.settingsValues.gestureGridIncrement,N(this,vt).slamThreshold=this.settingsValues.gestureHardDropDistance,N(this,vt).slamTimeLimit=this.settingsValues.gestureHardDropTimer,N(this,vt).turnaroundFactor=this.settingsValues.gestureDirectionSwapAssist/100,N(this,Qt)!==this.settingsValues.buttonEnable&&(Se(this,Qt,this.settingsValues.buttonEnable),this.settingsValues.buttonEnable?(N(this,gt).classList.remove("hide"),N(this,zt).classList.add("giveControllerSpace")):(N(this,gt).classList.add("hide"),N(this,zt).classList.remove("giveControllerSpace")))}}An=new WeakMap,_n=new WeakMap,wn=new WeakMap,Pn=new WeakMap,vt=new WeakMap,zt=new WeakMap,gt=new WeakMap,Qt=new WeakMap;function Aa(K){K.classList.contains("hide")?K.classList.remove("hide"):K.classList.add("hide")}function ni(){let K=document.createTextNode("");document.querySelector("#debug").appendChild(K),K.textContent="Starting Program";const o=document.querySelector("#startButton");K.textContent="Creating keyboard input module";let l=new Ka;$a(l),document.addEventListener("keydown",function(he){l.setInputState(he.key,!0)}),document.addEventListener("keyup",function(he){l.setInputState(he.key,!1)}),K.textContent="Creating touch input module";let R=new Qa(document.querySelector(".container"),document.querySelector("#heldPiece"));K.textContent="Creating GUI input module";let L=new Za(document.querySelector("#tib_hold"),document.querySelector("#tib_moveLeft"),document.querySelector("#tib_moveRight"),document.querySelector("#tib_softDrop"),document.querySelector("#tib_hardDrop"),document.querySelector("#tib_rotateClockwise"),document.querySelector("#tib_rotateAnticlockwise")),Q=new ti("keyboardSettings","gestureSettings","buttonSettings",R);K.textContent="Creating game module";let X=new _a;K.textContent="Creating rendering module";let u=new za;K.textContent="Selecting screens";const Y=document.querySelector("#titleScreen"),ee=document.querySelector("#pauseScreen"),k=document.querySelector("#gameOverScreen"),se=document.querySelector("#settingsScreen");let te=!0;K.textContent="Adding final score nodes";const W=document.createTextNode("0"),me=document.createTextNode("0");document.querySelector("#finalScore").appendChild(W),document.querySelector("#finalLines").append(me);let ne=0,ge=document.querySelector(".canvasSpace"),C=document.querySelector("#gameDebug");K.textContent="Creating game loop";let H=0,z=0;function P(he){let Ne=(he-z)*.001;z=he,H+=Ne,se.classList.contains("hide")?X.gameState.gameOver?te||k.classList.contains("hide")&&(k.classList.remove("hide"),W.textContent=X.gameState.score,me.textContent=X.gameState.linesCleared):(H>=X.gameTickTime&&(H=Math.min(H-X.gameTickTime,X.gameTickTime),l.updateCounters(),ai(X,l,R,L,Q.settingsValues),X.runTick(),l.getCounter("pause")==1&&(X.gameState.isPaused?(X.pauseGame(!1),ee.classList.add("hide")):(X.pauseGame(!0),ee.classList.remove("hide")))),X.isStateChanged&&u.updateData(X.gameState)):(l.updateCounters(),l.getCounter("pause")==1&&se.classList.add("hide")),window.visualViewport.scale!==ne&&(console.log(window.visualViewport.scale),C.innerHTML=window.visualViewport.scale,window.visualViewport.scale!=1?ge.classList.add("allowTouchAction"):ge.classList.remove("allowTouchAction"),ne=window.visualViewport.scale),u.renderGame(),requestAnimationFrame(P)}function j(){X.startNewGame(),u.updateData(X.gameState),u.renderGame(),document.querySelector("#titleScreen").classList.add("hide"),requestAnimationFrame(P),te=!1}K.textContent="Connecting buttons",o.addEventListener("click",j),document.querySelector("#unpauseButton").addEventListener("click",function(){X.gameState.isPaused=!1,ee.classList.add("hide")}),document.querySelector("#replayButton").addEventListener("click",function(){X.startNewGame(),u.updateData(X.gameState),u.renderGame(),k.classList.add("hide")}),document.querySelector("#returnToTitleButton").addEventListener("click",function(){Y.classList.remove("hide"),k.classList.add("hide"),te=!0}),K.textContent="Starting game",requestAnimationFrame(P),document.querySelector("#pauseButton").addEventListener("click",he=>{X.pauseGame(!0),ee.classList.remove("hide")}),K.textContent="Setting up settings";let oe=document.createTextNode("");document.querySelector("#settingsConsoleText").appendChild(oe),ri(".controlRebind",l,oe,se),document.querySelector("#exitSettingsButton").addEventListener("click",function(){se.classList.add("hide")}),document.querySelectorAll(".settingsButton").forEach(function(he,Ne,_e){he.addEventListener("click",function(){se.classList.remove("hide")})}),K.textContent="Initialization complete"}function ai(K,o,l,R,L){let Q=L.keyboardRepeatDelay,X=L.buttonRepeatDelay;o.getCounter("hardDrop")==1&&(K.input.hardDrop=!0),o.getCounter("hold")==1&&(K.input.hold=!0),o.getCounter("rotateClockwise")==1&&(K.input.rotateClockwise=!0),o.getCounter("rotateAnticlockwise")==1&&(K.input.rotateAnticlockwise=!0),o.getInputState("softDrop")&&(K.input.softDrop=!0),(o.getCounter("moveLeft")==1||o.getCounter("moveLeft")>Q)&&(K.input.moveLeft=!0),(o.getCounter("moveRight")==1||o.getCounter("moveRight")>Q)&&(K.input.moveRight=!0),L.gestureEnable&&(l.leftQueue>0&&(K.input.moveLeft=!0,l.leftQueue--),l.rightQueue>0&&(K.input.moveRight=!0,l.rightQueue--),l.moveDown&&(K.input.softDrop=!0),l.rotate.left?K.input.rotateAnticlockwise=!0:l.rotate.right&&(K.input.rotateClockwise=!0),l.rotate={left:!1,right:!1},l.hardDrop&&(K.input.hardDrop=!0,l.hardDrop=!1)),l.hold&&(K.input.hold=!0,l.hold=!1),L.buttonEnable&&(R.countFrame(),(R.frameCounter.moveLeft==1||R.frameCounter.moveLeft>X)&&(K.input.moveLeft=!0),(R.frameCounter.moveRight==1||R.frameCounter.moveRight>X)&&(K.input.moveRight=!0),R.frameCounter.softDrop>=1&&(K.input.softDrop=!0),R.getInput("hold")&&(K.input.hold=!0),R.getInput("rotateClockwise")&&(K.input.rotateClockwise=!0),R.getInput("rotateAnticlockwise")&&(K.input.rotateAnticlockwise=!0),R.getInput("hardDrop")&&(K.input.hardDrop=!0),R.resetFlags())}ni();
