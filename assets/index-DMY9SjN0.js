var Va=Object.defineProperty;var Wa=(J,f,v)=>f in J?Va(J,f,{enumerable:!0,configurable:!0,writable:!0,value:v}):J[f]=v;var nr=(J,f,v)=>(Wa(J,typeof f!="symbol"?f+"":f,v),v),ha=(J,f,v)=>{if(!f.has(J))throw TypeError("Cannot "+v)};var k=(J,f,v)=>(ha(J,f,"read from private field"),v?v.call(J):f.get(J)),Te=(J,f,v)=>{if(f.has(J))throw TypeError("Cannot add the same private member more than once");f instanceof WeakSet?f.add(J):f.set(J,v)},Ce=(J,f,v,D)=>(ha(J,f,"write to private field"),D?D.call(J,v):f.set(J,v),v);var ma=(J,f,v,D)=>({set _(M){Ce(J,f,M,v)},get _(){return k(J,f,D)}}),$e=(J,f,v)=>(ha(J,f,"access private method"),v);(function(){const f=document.createElement("link").relList;if(f&&f.supports&&f.supports("modulepreload"))return;for(const M of document.querySelectorAll('link[rel="modulepreload"]'))D(M);new MutationObserver(M=>{for(const H of M)if(H.type==="childList")for(const ie of H.addedNodes)ie.tagName==="LINK"&&ie.rel==="modulepreload"&&D(ie)}).observe(document,{childList:!0,subtree:!0});function v(M){const H={};return M.integrity&&(H.integrity=M.integrity),M.referrerPolicy&&(H.referrerPolicy=M.referrerPolicy),M.crossOrigin==="use-credentials"?H.credentials="include":M.crossOrigin==="anonymous"?H.credentials="omit":H.credentials="same-origin",H}function D(M){if(M.ep)return;M.ep=!0;const H=v(M);fetch(M.href,H)}})();var Ut,Qr,Zr,Gn,dt,Gt,Mr,bt,kn,Ra,jn,Ca,Vn,Fa,Wn,Da,kt,Nn,Et,fn,sn,pa,Xn,Ba,vn,da,Hn,Ia,jt,Un,hn,ba;const ln=class ln{constructor(){Te(this,kn);Te(this,jn);Te(this,Vn);Te(this,Wn);Te(this,kt);Te(this,Et);Te(this,sn);Te(this,Xn);Te(this,vn);Te(this,Hn);Te(this,jt);Te(this,hn);nr(this,"input",{moveLeft:!1,moveRight:!1,hardDrop:!1,softDrop:!1,hold:!1,rotClockwise:!1,rotAntiClockwise:!1});nr(this,"numRows",21);nr(this,"graceTimerDuration",.5);nr(this,"gameTickTime",1/30);nr(this,"pieceMap",new Map);nr(this,"gameState",{isPaused:!1,gameOver:!0,gridData:new Uint32Array(this.numRows),playerPiece:null,pieceQueue:[],heldPiece:null,ghostBlocks:[[0,0],[0,0],[0,0],[0,0]],linesCleared:0,speedLevel:1,score:0});Te(this,Ut,15);Te(this,Qr,!0);Te(this,Zr,0);Te(this,Gn,!1);Te(this,dt,-1);Te(this,Gt,0);Te(this,Mr,!1);Te(this,bt,!1);$e(this,kt,Nn).call(this),$e(this,Et,fn).call(this),$e(this,jt,Un).call(this),Ce(this,Ut,15),this.pieceMap.set("Z",1),this.pieceMap.set("S",2),this.pieceMap.set("O",3),this.pieceMap.set("J",4),this.pieceMap.set("T",5),this.pieceMap.set("I",6),this.pieceMap.set("L",7),this.gameState.isPaused=!0}get isStateChanged(){const f=k(this,Qr);return Ce(this,Qr,!1),f}runTick(){if(this.gameState.isPaused)return;let f=!1;if(k(this,bt)){this.animationCount==null||this.rowCount==null?(this.animationCount=0,this.rowCount=0):(this.animationCount++,this.rowCount<this.numRows&&this.animationCount%4==0?(this.clearRow(0),this.rowCount++,Ce(this,Qr,!0)):this.rowCount==this.numRows&&(this.rowCount++,this.gameState.gameOver=!0));return}if(this.input.hardDrop)this.hardDropPlayerPiece(),this.finishWithPiece(),f=!0;else if(this.input.hold)this.holdPiece(),f=!0;else{k(this,Mr)&&$e(this,Xn,Ba).call(this,this.gameTickTime),this.input.softDrop&&(f=this.tryMovePiece(0,-1)||f);let v=0;this.input.rotClockwise&&(v+=1),this.input.rotAntiClockwise&&(v-=1),v!=0&&(f=this.tryRotatePiece(v==1)||f);let D=0;if(this.input.moveLeft&&(D-=1),this.input.moveRight&&(D+=1),D!=0&&(f=this.tryMovePiece(D,0)||f),ma(this,Zr)._++,k(this,Zr)>=k(this,Ut)){let M=!this.tryMovePiece(0,-1);f||(f=!M),Ce(this,Zr,0),M&&!k(this,Mr)&&$e(this,sn,pa).call(this)}if(k(this,Mr)&&k(this,dt)<=0){let M=!this.tryMovePiece(0,-1);f=!0,M&&this.finishWithPiece()}else if(!k(this,Mr)){let M=!1;for(const H of this.gameState.playerPiece.blocks)M=M||this.isBlockHere(H[0],H[1]-1);M&&$e(this,sn,pa).call(this)}}f&&($e(this,jt,Un).call(this),Ce(this,Qr,!0)),this.input={moveLeft:!1,moveRight:!1,hardDrop:!1,softDrop:!1,hold:!1,rotClockwise:!1,rotAntiClockwise:!1}}pauseGame(f){this.gameState.isPaused=f}startNewGame(){this.gameState.gameOver=!1,this.gameState.isPaused=!1,Ce(this,bt,!1),this.animationCount=null,this.rowCount=null;for(let f=0;f<this.gameState.gridData.length;f++)this.gameState.gridData[f]=0;this.gameState.linesCleared=0,this.gameState.speedLevel=0,this.gameState.score=0,this.gameState.pieceQueue=[],this.gameState.heldPiece=null,$e(this,kt,Nn).call(this),$e(this,Et,fn).call(this),$e(this,jt,Un).call(this),$e(this,hn,ba).call(this)}tryMovePiece(f,v){let D=!0;for(let M=0;M<4&&D;M++){let H=this.gameState.playerPiece.blocks[M][0]+f,ie=this.gameState.playerPiece.blocks[M][1]+v;this.isBlockHere(H,ie)&&(D=!1)}return D&&($e(this,jn,Ca).call(this,f,v),f!=0&&$e(this,vn,da).call(this),v!=0&&Ce(this,Mr,!1)),D}hardDropPlayerPiece(){for(;this.tryMovePiece(0,-1););}tryRotatePiece(f){let v=$e(this,Vn,Fa).call(this,f);return v&&$e(this,vn,da).call(this),v}holdPiece(){if(this.gameState.heldPiece==null)this.gameState.heldPiece=this.gameState.playerPiece.shape,$e(this,Et,fn).call(this),Ce(this,Qr,!0),Ce(this,Zr,0);else if(!this.gameState.playerPiece.wasHeld){let f=this.gameState.heldPiece;this.gameState.heldPiece=this.gameState.playerPiece.shape,this.gameState.playerPiece=new it(f),this.gameState.playerPiece.wasHeld=!0,Ce(this,Qr,!0),Ce(this,Zr,0),this.isPlayerPieceValid()||(this.gameState.playerPiece.active=!1,Ce(this,bt,!0))}}finishWithPiece(){const f=this.gameState.linesCleared;this.gameState.playerPiece.shape=="T"&&Ce(this,Gn,!0),$e(this,Wn,Da).call(this),$e(this,Et,fn).call(this),Ce(this,Mr,!1),$e(this,Hn,Ia).call(this),this.gameState.linesCleared!=f&&($e(this,hn,ba).call(this),this.gameState.score+=Math.pow(this.gameState.linesCleared-f,2)*100)}clearRow(f){for(let v=f;v<this.numRows-1;v++)this.gameState.gridData[v]=this.gameState.gridData[v+1];this.gameState.gridData[this.numRows-1]=0}isBlockHere(f,v){if(f<0||v<0||f>=10||v>=this.numRows)return!0;const D=this.gameState.gridData[v],M=7<<32-(3+3*f);return(D&M)!=0}getBlockData(f,v){const D=this.gameState.gridData[v],M=32-(3+3*f),H=7<<M;return(D&H)>>>M}isPlayerPieceValid(){let f=!0;for(let v=0;v<4&&f;v++)this.isBlockHere(this.gameState.playerPiece.blocks[v][0],this.gameState.playerPiece.blocks[v][1])&&(f=!1);return f}};Ut=new WeakMap,Qr=new WeakMap,Zr=new WeakMap,Gn=new WeakMap,dt=new WeakMap,Gt=new WeakMap,Mr=new WeakMap,bt=new WeakMap,kn=new WeakSet,Ra=function(f,v,D){const H=~(7<<32-(3+3*f));this.gameState.gridData[v]&=H;const ie=D<<32-(3+3*f);this.gameState.gridData[v]|=ie},jn=new WeakSet,Ca=function(f,v){for(let D=0;D<4;D++)this.gameState.playerPiece.blocks[D][0]+=f,this.gameState.playerPiece.blocks[D][1]+=v},Vn=new WeakSet,Fa=function(f){let v=(this.gameState.playerPiece.rotationIndex+4+(f?1:-1))%4,D=[...this.gameState.playerPiece.blocks[0]],M=[];for(let te=0;te<4;te++)M.push([...this.gameState.playerPiece.blocks[te]]);let H=1,ie=1;f?ie=-1:H=-1;let o;for(let te=0;te<4;te++)M[te][0]-=D[0],M[te][1]-=D[1],o=M[te][0],M[te][0]=H*M[te][1],M[te][1]=ie*o,M[te][0]+=D[0],M[te][1]+=D[1];let Y;switch(this.gameState.playerPiece.shape){case"O":Y=it.offsets.O;break;case"I":Y=it.offsets.I;break;default:Y=it.offsets.OTHER;break}let $,G,he=!1;for(let te=0;te<5&&!he;te++){$=Y[te],G=[$[this.gameState.playerPiece.rotationIndex][0]-$[v][0],$[this.gameState.playerPiece.rotationIndex][1]-$[v][1]],he=!0;for(let W=0;W<4;W++)M[W][0]+=G[0],M[W][1]+=G[1],this.isBlockHere(M[W][0],M[W][1])&&(he=!1);if(!he)for(let W=0;W<4;W++)M[W][0]-=G[0],M[W][1]-=G[1]}if(he){for(let te=0;te<4;te++)this.gameState.playerPiece.blocks[te]=[...M[te]];this.gameState.playerPiece.rotationIndex=v}return he},Wn=new WeakSet,Da=function(){let f,v,D=this.pieceMap.get(this.gameState.playerPiece.shape);for(let M=0;M<4;M++)f=this.gameState.playerPiece.blocks[M][0],v=this.gameState.playerPiece.blocks[M][1],$e(this,kn,Ra).call(this,f,v,D)},kt=new WeakSet,Nn=function(){let f=["O","I","T","J","L","S","Z"],v;for(let D=0;D<7;D++)v=Math.floor(Math.random()*f.length),this.gameState.pieceQueue.push(f[v]),f.splice(v,1)},Et=new WeakSet,fn=function(){let f=this.gameState.pieceQueue[0];this.gameState.pieceQueue.splice(0,1),this.gameState.pieceQueue.length<7&&$e(this,kt,Nn).call(this),delete this.gameState.playerPiece,this.gameState.playerPiece=new it(f),this.isPlayerPieceValid()||(this.gameState.playerPiece.active=!1,Ce(this,bt,!0)),Ce(this,Zr,0)},sn=new WeakSet,pa=function(){Ce(this,dt,this.graceTimerDuration),Ce(this,Mr,!0),Ce(this,Gt,0)},Xn=new WeakSet,Ba=function(f){Ce(this,dt,k(this,dt)-f)},vn=new WeakSet,da=function(){k(this,Mr)&&k(this,Gt)<30&&(Ce(this,dt,this.graceTimerDuration),ma(this,Gt)._++)},Hn=new WeakSet,Ia=function(){for(let f=0;f<this.numRows;f++){let v=!0;for(let D=0;D<10&&v;D++)this.isBlockHere(D,f)||(v=!1);v&&(this.clearRow(f),this.gameState.linesCleared++,f--)}},jt=new WeakSet,Un=function(){for(let v=0;v<4;v++)this.gameState.ghostBlocks[v]=[...this.gameState.playerPiece.blocks[v]];let f=!1;for(;!f;){for(let v=0;v<4;v++)this.isBlockHere(this.gameState.ghostBlocks[v][0],this.gameState.ghostBlocks[v][1]-1)&&(f=!0);if(!f)for(let v=0;v<4;v++)this.gameState.ghostBlocks[v][1]-=1}},hn=new WeakSet,ba=function(){this.gameState.speedLevel=Math.min(Math.floor(this.gameState.linesCleared/10)+1,ln.levels.max),Ce(this,Ut,ln.levels[this.gameState.speedLevel])},nr(ln,"levels",{1:25,2:20,3:16,4:12,5:10,6:8,7:6,8:5,9:4,10:2,11:1,max:11});let ya=ln;const Br=class Br{constructor(f){this.blocks=[],this.shape=f,this.rotationIndex=0,this.active=!0,this.wasHeld=!1;let v=Br.getBaseShape(f);for(let D=0;D<4;D++)this.blocks.push([...v[D]]),this.blocks[D][0]+=3,this.blocks[D][1]+=19}static getBaseShape(f){let v;switch(f){case"O":v=Br.pieces.O;break;case"I":v=Br.pieces.I;break;case"L":v=Br.pieces.L;break;case"J":v=Br.pieces.J;break;case"T":v=Br.pieces.T;break;case"S":v=Br.pieces.S;break;case"Z":v=Br.pieces.Z;break;default:v=[[0,0],[0,0],[0,0],[0,0]]}return v}};nr(Br,"offsets",{O:[[[0,0],[0,-1],[-1,-1],[-1,0]]],I:[[[0,0],[-1,0],[-1,1],[0,1]],[[-1,0],[0,0],[1,1],[0,1]],[[2,0],[0,0],[-2,1],[0,1]],[[-1,0],[0,1],[1,0],[0,-1]],[[2,0],[0,-2],[-2,0],[0,2]]],OTHER:[[[0,0],[0,0],[0,0],[0,0]],[[0,0],[1,0],[0,0],[-1,0]],[[0,0],[1,-1],[0,0],[-1,-1]],[[0,0],[0,2],[0,0],[0,2]],[[0,0],[1,2],[0,0],[-1,2]]]}),nr(Br,"pieces",{O:[[1,0],[1,1],[2,1],[2,0]],I:[[1,0],[0,0],[2,0],[3,0]],L:[[1,0],[0,0],[2,0],[2,1]],J:[[1,0],[0,0],[0,1],[2,0]],T:[[1,0],[0,0],[2,0],[1,1]],S:[[1,0],[0,0],[1,1],[2,1]],Z:[[1,0],[2,0],[1,1],[0,1]]});let it=Br;class Xa{constructor(){nr(this,"selectedKey","");nr(this,"originalKeybind","");nr(this,"selectedAction","");nr(this,"selectedSpan",null);this.actionStates=new Map,this.actionStates.set("HardDrop",!1),this.actionStates.set("SoftDrop",!1),this.actionStates.set("MoveLeft",!1),this.actionStates.set("MoveRight",!1),this.actionStates.set("Hold",!1),this.actionStates.set("RotateClockwise",!1),this.actionStates.set("RotateAntiClockwise",!1),this.actionStates.set("Pause",!1),this.inputKeys=new Map,this.inputKeys.set("A","MoveLeft"),this.inputKeys.set("D","MoveRight"),this.inputKeys.set("W","HardDrop"),this.inputKeys.set("S","SoftDrop"),this.inputKeys.set("E","Hold"),this.inputKeys.set("ArrowLeft","RotateAntiClockwise"),this.inputKeys.set("ArrowRight","RotateClockwise"),this.inputKeys.set("Escape","Pause"),this.counters=new Map,this.counters.set("MoveLeft",0),this.counters.set("MoveRight",0),this.counters.set("RotateClockwise",0),this.counters.set("RotateAntiClockwise",0),this.counters.set("HardDrop",0),this.counters.set("Hold",0),this.counters.set("Pause",0)}keyToState(f){return f.length==1&&(f=f.toUpperCase()),this.inputKeys.get(f)}actionToKey(f){let v="";return this.inputKeys.forEach(function(D,M,H){D==f&&(v=M)}),v}rebindControl(f,v){let D=!1,M="";return this.inputKeys.forEach(function(H,ie,o){H==f&&(M=ie)}),M!=""&&(this.inputKeys.has(v)&&v!=M||(this.inputKeys.delete(M),this.inputKeys.set(v,f),D=!0)),D}setInputState(f,v){let D=this.keyToState(f);D!=null&&this.actionStates.set(D,v)}getInputState(f){return this.actionStates.has(f)?this.actionStates.get(f):(console.log("ERROR: trying to access an input action that doesn't exist ("+f+"). The allowed options are:"),this.actionStates.forEach(function(v,D,M){console.log("    - "+D)}),null)}updateCounters(){for(const[f,v]of this.counters)this.getInputState(f)?this.counters.set(f,v+1):this.counters.set(f,0)}getCounter(f){return this.counters.has(f)?this.counters.get(f):(console.log("ERROR: trying to access input action that doesn't have a counter ("+f+"). The counters are:"),this.counters.forEach(function(v,D,M){console.log("    - "+D+": "+v)}),null)}}var Ha=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},La={exports:{}};/*!
 * @license twgl.js 5.5.4 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
 * Available via the MIT license.
 * see: http://github.com/greggman/twgl.js for details
 */(function(J,f){(function(D,M){J.exports=M()})(typeof self<"u"?self:Ha,()=>(()=>{var v={"./src/attributes.js":(ie,o,Y)=>{function $(s){"@babel/helpers - typeof";return $=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},$(s)}o.__esModule=!0,o.createAttribsFromArrays=cr,o.createBufferFromArray=c,o.createBufferFromTypedArray=me,o.createBufferInfoFromArrays=u,o.createBuffersFromArrays=E,o.getArray_=N,o.getNumComponents_=Fe,o.setAttribInfoBufferFromArray=ar,o.setAttributeDefaults_=ur,o.setAttributePrefix=or;var G=W(Y("./src/typedarrays.js")),he=W(Y("./src/helper.js"));function te(s){if(typeof WeakMap!="function")return null;var i=new WeakMap,a=new WeakMap;return(te=function(h){return h?a:i})(s)}function W(s,i){if(!i&&s&&s.__esModule)return s;if(s===null||$(s)!="object"&&typeof s!="function")return{default:s};var a=te(i);if(a&&a.has(s))return a.get(s);var m={__proto__:null},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var T in s)if(T!=="default"&&Object.prototype.hasOwnProperty.call(s,T)){var _=h?Object.getOwnPropertyDescriptor(s,T):null;_&&(_.get||_.set)?Object.defineProperty(m,T,_):m[T]=s[T]}return m.default=s,a&&a.set(s,m),m}var ve=35044,re=34962,Se=34963,C=34660,q=5120,K=5121,x=5122,j=5123,ce=5124,Ee=5125,Ge=5126,xe={attribPrefix:""};function or(s){xe.attribPrefix=s}function ur(s){he.copyExistingProperties(s,xe)}function er(s,i,a,m,h){s.bindBuffer(i,a),s.bufferData(i,m,h||ve)}function me(s,i,a,m){if(he.isBuffer(s,i))return i;a=a||re;var h=s.createBuffer();return er(s,a,h,i,m),h}function w(s){return s==="indices"}function B(s){return s===Int8Array||s===Uint8Array}function N(s){return s.length?s:s.data}var g=/coord|texture/i,de=/color|colour/i;function ge(s,i){var a;if(g.test(s)?a=2:de.test(s)?a=4:a=3,i%a>0)throw new Error("Can not guess numComponents for attribute '".concat(s,"'. Tried ").concat(a," but ").concat(i," values is not evenly divisible by ").concat(a,". You should specify it."));return a}function Fe(s,i,a){return s.numComponents||s.size||ge(i,a||N(s).length)}function We(s,i){if(G.isArrayBuffer(s))return s;if(G.isArrayBuffer(s.data))return s.data;Array.isArray(s)&&(s={data:s});var a=s.type?Ze(s.type):void 0;return a||(w(i)?a=Uint16Array:a=Float32Array),new a(s.data)}function Ue(s){return typeof s=="number"?s:s?G.getGLTypeForTypedArrayType(s):Ge}function Ze(s){return typeof s=="number"?G.getTypedArrayTypeForGLType(s):s||Float32Array}function Ke(s,i){return{buffer:i.buffer,numValues:24,type:Ue(i.type),arrayType:Ze(i.type)}}function fr(s,i){var a=i.data||i,m=Ze(i.type),h=a*m.BYTES_PER_ELEMENT,T=s.createBuffer();return s.bindBuffer(re,T),s.bufferData(re,h,i.drawType||ve),{buffer:T,numValues:a,type:G.getGLTypeForTypedArrayType(m),arrayType:m}}function Tr(s,i,a){var m=We(i,a);return{arrayType:m.constructor,buffer:me(s,m,void 0,i.drawType),type:G.getGLTypeForTypedArray(m),numValues:0}}function cr(s,i){var a={};return Object.keys(i).forEach(function(m){if(!w(m)){var h=i[m],T=h.attrib||h.name||h.attribName||xe.attribPrefix+m;if(h.value){if(!Array.isArray(h.value)&&!G.isArrayBuffer(h.value))throw new Error("array.value is not array or typedarray");a[T]={value:h.value}}else{var _;h.buffer&&h.buffer instanceof WebGLBuffer?_=Ke:typeof h=="number"||typeof h.data=="number"?_=fr:_=Tr;var I=_(s,h,m),L=I.buffer,X=I.type,z=I.numValues,Z=I.arrayType,ae=h.normalize!==void 0?h.normalize:B(Z),ne=Fe(h,m,z);a[T]={buffer:L,numComponents:ne,type:X,normalize:ae,stride:h.stride||0,offset:h.offset||0,divisor:h.divisor===void 0?void 0:h.divisor,drawType:h.drawType}}}}),s.bindBuffer(re,null),a}function ar(s,i,a,m){a=We(a),m!==void 0?(s.bindBuffer(re,i.buffer),s.bufferSubData(re,m,a)):er(s,re,i.buffer,a,i.drawType)}function vr(s,i){return i===q||i===K?1:i===x||i===j?2:i===ce||i===Ee||i===Ge?4:0}var Sr=["position","positions","a_position"];function ue(s){var i,a;for(a=0;a<Sr.length&&(i=Sr[a],!(i in s));++a);a===Sr.length&&(i=Object.keys(s)[0]);var m=s[i],h=N(m).length;if(h===void 0)return 1;var T=Fe(m,i),_=h/T;if(h%T>0)throw new Error("numComponents ".concat(T," not correct for length ").concat(h));return _}function r(s,i){var a,m;for(m=0;m<Sr.length&&(a=Sr[m],!(a in i||(a=xe.attribPrefix+a,a in i)));++m);m===Sr.length&&(a=Object.keys(i)[0]);var h=i[a];if(!h.buffer)return 1;s.bindBuffer(re,h.buffer);var T=s.getBufferParameter(re,C);s.bindBuffer(re,null);var _=vr(s,h.type),I=T/_,L=h.numComponents||h.size,X=I/L;if(X%1!==0)throw new Error("numComponents ".concat(L," not correct for length ").concat(length));return X}function u(s,i,a){var m=cr(s,i),h=Object.assign({},a||{});h.attribs=Object.assign({},a?a.attribs:{},m);var T=i.indices;if(T){var _=We(T,"indices");h.indices=me(s,_,Se),h.numElements=_.length,h.elementType=G.getGLTypeForTypedArray(_)}else h.numElements||(h.numElements=r(s,h.attribs));return h}function c(s,i,a){var m=a==="indices"?Se:re,h=We(i,a);return me(s,h,m)}function E(s,i){var a={};return Object.keys(i).forEach(function(m){a[m]=c(s,i[m],m)}),i.indices?(a.numElements=i.indices.length,a.elementType=G.getGLTypeForTypedArray(We(i.indices),"indices")):a.numElements=ue(i),a}},"./src/draw.js":(ie,o,Y)=>{function $(C){"@babel/helpers - typeof";return $=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(q){return typeof q}:function(q){return q&&typeof Symbol=="function"&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q},$(C)}o.__esModule=!0,o.drawBufferInfo=re,o.drawObjectList=Se;var G=te(Y("./src/programs.js"));function he(C){if(typeof WeakMap!="function")return null;var q=new WeakMap,K=new WeakMap;return(he=function(j){return j?K:q})(C)}function te(C,q){if(!q&&C&&C.__esModule)return C;if(C===null||$(C)!="object"&&typeof C!="function")return{default:C};var K=he(q);if(K&&K.has(C))return K.get(C);var x={__proto__:null},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ce in C)if(ce!=="default"&&Object.prototype.hasOwnProperty.call(C,ce)){var Ee=j?Object.getOwnPropertyDescriptor(C,ce):null;Ee&&(Ee.get||Ee.set)?Object.defineProperty(x,ce,Ee):x[ce]=C[ce]}return x.default=C,K&&K.set(C,x),x}var W=4,ve=5123;function re(C,q,K,x,j,ce){K=K===void 0?W:K;var Ee=q.indices,Ge=q.elementType,xe=x===void 0?q.numElements:x;j=j===void 0?0:j,Ge||Ee?ce!==void 0?C.drawElementsInstanced(K,xe,Ge===void 0?ve:q.elementType,j,ce):C.drawElements(K,xe,Ge===void 0?ve:q.elementType,j):ce!==void 0?C.drawArraysInstanced(K,j,xe,ce):C.drawArrays(K,j,xe)}function Se(C,q){var K=null,x=null;q.forEach(function(j){if(j.active!==!1){var ce=j.programInfo,Ee=j.vertexArrayInfo||j.bufferInfo,Ge=!1,xe=j.type===void 0?W:j.type;ce!==K&&(K=ce,C.useProgram(ce.program),Ge=!0),(Ge||Ee!==x)&&(x&&x.vertexArrayObject&&!Ee.vertexArrayObject&&C.bindVertexArray(null),x=Ee,G.setBuffersAndAttributes(C,ce,Ee)),G.setUniforms(ce,j.uniforms),re(C,Ee,xe,j.count,j.offset,j.instanceCount)}}),x&&x.vertexArrayObject&&C.bindVertexArray(null)}},"./src/framebuffers.js":(ie,o,Y)=>{function $(ue){"@babel/helpers - typeof";return $=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},$(ue)}o.__esModule=!0,o.bindFramebufferInfo=Sr,o.createFramebufferInfo=ar,o.resizeFramebufferInfo=vr;var G=W(Y("./src/textures.js")),he=W(Y("./src/helper.js"));function te(ue){if(typeof WeakMap!="function")return null;var r=new WeakMap,u=new WeakMap;return(te=function(E){return E?u:r})(ue)}function W(ue,r){if(!r&&ue&&ue.__esModule)return ue;if(ue===null||$(ue)!="object"&&typeof ue!="function")return{default:ue};var u=te(r);if(u&&u.has(ue))return u.get(ue);var c={__proto__:null},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in ue)if(s!=="default"&&Object.prototype.hasOwnProperty.call(ue,s)){var i=E?Object.getOwnPropertyDescriptor(ue,s):null;i&&(i.get||i.set)?Object.defineProperty(c,s,i):c[s]=ue[s]}return c.default=ue,u&&u.set(ue,c),c}var ve=36160,re=36161,Se=3553,C=5121,q=6402,K=6408,x=33190,j=36012,ce=35056,Ee=36013,Ge=32854,xe=32855,or=36194,ur=33189,er=6401,me=36168,w=34041,B=36064,N=36096,g=36128,de=33306,ge=33071,Fe=9729,We=[{format:K,type:C,min:Fe,wrap:ge},{format:w}],Ue={};Ue[w]=de,Ue[er]=g,Ue[me]=g,Ue[q]=N,Ue[ur]=N,Ue[x]=N,Ue[j]=N,Ue[ce]=de,Ue[Ee]=de;function Ze(ue,r){return Ue[ue]||Ue[r]}var Ke={};Ke[Ge]=!0,Ke[xe]=!0,Ke[or]=!0,Ke[w]=!0,Ke[ur]=!0,Ke[er]=!0,Ke[me]=!0;function fr(ue){return Ke[ue]}var Tr=32;function cr(ue){return ue>=B&&ue<B+Tr}function ar(ue,r,u,c){var E=ve,s=ue.createFramebuffer();ue.bindFramebuffer(E,s),u=u||ue.drawingBufferWidth,c=c||ue.drawingBufferHeight,r=r||We;var i=[],a={framebuffer:s,attachments:[],width:u,height:c};return r.forEach(function(m,h){var T=m.attachment,_=m.samples,I=m.format,L=m.attachmentPoint||Ze(I,m.internalFormat);if(L||(L=B+h),cr(L)&&i.push(L),!T)if(_!==void 0||fr(I))T=ue.createRenderbuffer(),ue.bindRenderbuffer(re,T),_>1?ue.renderbufferStorageMultisample(re,_,I,u,c):ue.renderbufferStorage(re,I,u,c);else{var X=Object.assign({},m);X.width=u,X.height=c,X.auto===void 0&&(X.auto=!1,X.min=X.min||X.minMag||Fe,X.mag=X.mag||X.minMag||Fe,X.wrapS=X.wrapS||X.wrap||ge,X.wrapT=X.wrapT||X.wrap||ge),T=G.createTexture(ue,X)}if(he.isRenderbuffer(ue,T))ue.framebufferRenderbuffer(E,L,re,T);else if(he.isTexture(ue,T))m.layer!==void 0?ue.framebufferTextureLayer(E,L,T,m.level||0,m.layer):ue.framebufferTexture2D(E,L,m.target||Se,T,m.level||0);else throw new Error("unknown attachment type");a.attachments.push(T)}),ue.drawBuffers&&ue.drawBuffers(i),a}function vr(ue,r,u,c,E){c=c||ue.drawingBufferWidth,E=E||ue.drawingBufferHeight,r.width=c,r.height=E,u=u||We,u.forEach(function(s,i){var a=r.attachments[i],m=s.format,h=s.samples;if(h!==void 0||he.isRenderbuffer(ue,a))ue.bindRenderbuffer(re,a),h>1?ue.renderbufferStorageMultisample(re,h,m,c,E):ue.renderbufferStorage(re,m,c,E);else if(he.isTexture(ue,a))G.resizeTexture(ue,a,s,c,E);else throw new Error("unknown attachment type")})}function Sr(ue,r,u){u=u||ve,r?(ue.bindFramebuffer(u,r.framebuffer),ue.viewport(0,0,r.width,r.height)):(ue.bindFramebuffer(u,null),ue.viewport(0,0,ue.drawingBufferWidth,ue.drawingBufferHeight))}},"./src/helper.js":(ie,o)=>{o.__esModule=!0,o.copyExistingProperties=G,o.copyNamedProperties=$,o.error=he,o.isBuffer=re,o.isRenderbuffer=Se,o.isSampler=K,o.isShader=C,o.isTexture=q,o.warn=te;function Y(x){"@babel/helpers - typeof";return Y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(j){return typeof j}:function(j){return j&&typeof Symbol=="function"&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j},Y(x)}function $(x,j,ce){x.forEach(function(Ee){var Ge=j[Ee];Ge!==void 0&&(ce[Ee]=Ge)})}function G(x,j){Object.keys(j).forEach(function(ce){j.hasOwnProperty(ce)&&x.hasOwnProperty(ce)&&(j[ce]=x[ce])})}function he(){var x;(x=console).error.apply(x,arguments)}function te(){var x;(x=console).warn.apply(x,arguments)}var W=new Map;function ve(x,j){if(!x||Y(x)!=="object")return!1;var ce=W.get(j);ce||(ce=new WeakMap,W.set(j,ce));var Ee=ce.get(x);if(Ee===void 0){var Ge=Object.prototype.toString.call(x);Ee=Ge.substring(8,Ge.length-1)===j,ce.set(x,Ee)}return Ee}function re(x,j){return typeof WebGLBuffer<"u"&&ve(j,"WebGLBuffer")}function Se(x,j){return typeof WebGLRenderbuffer<"u"&&ve(j,"WebGLRenderbuffer")}function C(x,j){return typeof WebGLShader<"u"&&ve(j,"WebGLShader")}function q(x,j){return typeof WebGLTexture<"u"&&ve(j,"WebGLTexture")}function K(x,j){return typeof WebGLSampler<"u"&&ve(j,"WebGLSampler")}},"./src/m4.js":(ie,o,Y)=>{function $(r){"@babel/helpers - typeof";return $=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},$(r)}o.__esModule=!0,o.axisRotate=Tr,o.axisRotation=fr,o.copy=C,o.create=Se,o.frustum=er,o.getAxis=Ge,o.getTranslation=Ee,o.identity=q,o.inverse=x,o.lookAt=N,o.multiply=j,o.negate=re,o.ortho=ur,o.perspective=or,o.rotateX=Fe,o.rotateY=Ue,o.rotateZ=Ke,o.rotationX=ge,o.rotationY=We,o.rotationZ=Ze,o.scale=ar,o.scaling=cr,o.setAxis=xe,o.setDefaultType=ve,o.setTranslation=ce,o.transformDirection=Sr,o.transformNormal=ue,o.transformPoint=vr,o.translate=de,o.translation=g,o.transpose=K;var G=te(Y("./src/v3.js"));function he(r){if(typeof WeakMap!="function")return null;var u=new WeakMap,c=new WeakMap;return(he=function(s){return s?c:u})(r)}function te(r,u){if(!u&&r&&r.__esModule)return r;if(r===null||$(r)!="object"&&typeof r!="function")return{default:r};var c=he(u);if(c&&c.has(r))return c.get(r);var E={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in r)if(i!=="default"&&Object.prototype.hasOwnProperty.call(r,i)){var a=s?Object.getOwnPropertyDescriptor(r,i):null;a&&(a.get||a.set)?Object.defineProperty(E,i,a):E[i]=r[i]}return E.default=r,c&&c.set(r,E),E}var W=Float32Array;function ve(r){var u=W;return W=r,u}function re(r,u){return u=u||new W(16),u[0]=-r[0],u[1]=-r[1],u[2]=-r[2],u[3]=-r[3],u[4]=-r[4],u[5]=-r[5],u[6]=-r[6],u[7]=-r[7],u[8]=-r[8],u[9]=-r[9],u[10]=-r[10],u[11]=-r[11],u[12]=-r[12],u[13]=-r[13],u[14]=-r[14],u[15]=-r[15],u}function Se(){return new W(16).fill(0)}function C(r,u){return u=u||new W(16),u[0]=r[0],u[1]=r[1],u[2]=r[2],u[3]=r[3],u[4]=r[4],u[5]=r[5],u[6]=r[6],u[7]=r[7],u[8]=r[8],u[9]=r[9],u[10]=r[10],u[11]=r[11],u[12]=r[12],u[13]=r[13],u[14]=r[14],u[15]=r[15],u}function q(r){return r=r||new W(16),r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function K(r,u){if(u=u||new W(16),u===r){var c;return c=r[1],r[1]=r[4],r[4]=c,c=r[2],r[2]=r[8],r[8]=c,c=r[3],r[3]=r[12],r[12]=c,c=r[6],r[6]=r[9],r[9]=c,c=r[7],r[7]=r[13],r[13]=c,c=r[11],r[11]=r[14],r[14]=c,u}var E=r[0*4+0],s=r[0*4+1],i=r[0*4+2],a=r[0*4+3],m=r[1*4+0],h=r[1*4+1],T=r[1*4+2],_=r[1*4+3],I=r[2*4+0],L=r[2*4+1],X=r[2*4+2],z=r[2*4+3],Z=r[3*4+0],ae=r[3*4+1],ne=r[3*4+2],le=r[3*4+3];return u[0]=E,u[1]=m,u[2]=I,u[3]=Z,u[4]=s,u[5]=h,u[6]=L,u[7]=ae,u[8]=i,u[9]=T,u[10]=X,u[11]=ne,u[12]=a,u[13]=_,u[14]=z,u[15]=le,u}function x(r,u){u=u||new W(16);var c=r[0*4+0],E=r[0*4+1],s=r[0*4+2],i=r[0*4+3],a=r[1*4+0],m=r[1*4+1],h=r[1*4+2],T=r[1*4+3],_=r[2*4+0],I=r[2*4+1],L=r[2*4+2],X=r[2*4+3],z=r[3*4+0],Z=r[3*4+1],ae=r[3*4+2],ne=r[3*4+3],le=L*ne,se=ae*X,ee=h*ne,pe=ae*T,Oe=h*X,Ye=L*T,ke=s*ne,Ve=ae*i,_e=s*X,De=L*i,Qe=s*T,Xe=h*i,ze=_*Z,He=z*I,Je=a*Z,Be=z*m,Ne=a*I,yr=_*m,lr=c*Z,Ar=z*E,_r=c*I,Lr=_*E,Ur=c*m,Gr=a*E,$r=le*m+pe*I+Oe*Z-(se*m+ee*I+Ye*Z),St=se*E+ke*I+De*Z-(le*E+Ve*I+_e*Z),At=ee*E+Ve*m+Qe*Z-(pe*E+ke*m+Xe*Z),gt=Ye*E+_e*m+Xe*I-(Oe*E+De*m+Qe*I),hr=1/(c*$r+a*St+_*At+z*gt);return u[0]=hr*$r,u[1]=hr*St,u[2]=hr*At,u[3]=hr*gt,u[4]=hr*(se*a+ee*_+Ye*z-(le*a+pe*_+Oe*z)),u[5]=hr*(le*c+Ve*_+_e*z-(se*c+ke*_+De*z)),u[6]=hr*(pe*c+ke*a+Xe*z-(ee*c+Ve*a+Qe*z)),u[7]=hr*(Oe*c+De*a+Qe*_-(Ye*c+_e*a+Xe*_)),u[8]=hr*(ze*T+Be*X+Ne*ne-(He*T+Je*X+yr*ne)),u[9]=hr*(He*i+lr*X+Lr*ne-(ze*i+Ar*X+_r*ne)),u[10]=hr*(Je*i+Ar*T+Ur*ne-(Be*i+lr*T+Gr*ne)),u[11]=hr*(yr*i+_r*T+Gr*X-(Ne*i+Lr*T+Ur*X)),u[12]=hr*(Je*L+yr*ae+He*h-(Ne*ae+ze*h+Be*L)),u[13]=hr*(_r*ae+ze*s+Ar*L-(lr*L+Lr*ae+He*s)),u[14]=hr*(lr*h+Gr*ae+Be*s-(Ur*ae+Je*s+Ar*h)),u[15]=hr*(Ur*L+Ne*s+Lr*h-(_r*h+Gr*L+yr*s)),u}function j(r,u,c){c=c||new W(16);var E=r[0],s=r[1],i=r[2],a=r[3],m=r[4],h=r[5],T=r[6],_=r[7],I=r[8],L=r[9],X=r[10],z=r[11],Z=r[12],ae=r[13],ne=r[14],le=r[15],se=u[0],ee=u[1],pe=u[2],Oe=u[3],Ye=u[4],ke=u[5],Ve=u[6],_e=u[7],De=u[8],Qe=u[9],Xe=u[10],ze=u[11],He=u[12],Je=u[13],Be=u[14],Ne=u[15];return c[0]=E*se+m*ee+I*pe+Z*Oe,c[1]=s*se+h*ee+L*pe+ae*Oe,c[2]=i*se+T*ee+X*pe+ne*Oe,c[3]=a*se+_*ee+z*pe+le*Oe,c[4]=E*Ye+m*ke+I*Ve+Z*_e,c[5]=s*Ye+h*ke+L*Ve+ae*_e,c[6]=i*Ye+T*ke+X*Ve+ne*_e,c[7]=a*Ye+_*ke+z*Ve+le*_e,c[8]=E*De+m*Qe+I*Xe+Z*ze,c[9]=s*De+h*Qe+L*Xe+ae*ze,c[10]=i*De+T*Qe+X*Xe+ne*ze,c[11]=a*De+_*Qe+z*Xe+le*ze,c[12]=E*He+m*Je+I*Be+Z*Ne,c[13]=s*He+h*Je+L*Be+ae*Ne,c[14]=i*He+T*Je+X*Be+ne*Ne,c[15]=a*He+_*Je+z*Be+le*Ne,c}function ce(r,u,c){return c=c||q(),r!==c&&(c[0]=r[0],c[1]=r[1],c[2]=r[2],c[3]=r[3],c[4]=r[4],c[5]=r[5],c[6]=r[6],c[7]=r[7],c[8]=r[8],c[9]=r[9],c[10]=r[10],c[11]=r[11]),c[12]=u[0],c[13]=u[1],c[14]=u[2],c[15]=1,c}function Ee(r,u){return u=u||G.create(),u[0]=r[12],u[1]=r[13],u[2]=r[14],u}function Ge(r,u,c){c=c||G.create();var E=u*4;return c[0]=r[E+0],c[1]=r[E+1],c[2]=r[E+2],c}function xe(r,u,c,E){E!==r&&(E=C(r,E));var s=c*4;return E[s+0]=u[0],E[s+1]=u[1],E[s+2]=u[2],E}function or(r,u,c,E,s){s=s||new W(16);var i=Math.tan(Math.PI*.5-.5*r),a=1/(c-E);return s[0]=i/u,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=i,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=(c+E)*a,s[11]=-1,s[12]=0,s[13]=0,s[14]=c*E*a*2,s[15]=0,s}function ur(r,u,c,E,s,i,a){return a=a||new W(16),a[0]=2/(u-r),a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2/(E-c),a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2/(s-i),a[11]=0,a[12]=(u+r)/(r-u),a[13]=(E+c)/(c-E),a[14]=(i+s)/(s-i),a[15]=1,a}function er(r,u,c,E,s,i,a){a=a||new W(16);var m=u-r,h=E-c,T=s-i;return a[0]=2*s/m,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*s/h,a[6]=0,a[7]=0,a[8]=(r+u)/m,a[9]=(E+c)/h,a[10]=i/T,a[11]=-1,a[12]=0,a[13]=0,a[14]=s*i/T,a[15]=0,a}var me,w,B;function N(r,u,c,E){return E=E||new W(16),me=me||G.create(),w=w||G.create(),B=B||G.create(),G.normalize(G.subtract(r,u,B),B),G.normalize(G.cross(c,B,me),me),G.normalize(G.cross(B,me,w),w),E[0]=me[0],E[1]=me[1],E[2]=me[2],E[3]=0,E[4]=w[0],E[5]=w[1],E[6]=w[2],E[7]=0,E[8]=B[0],E[9]=B[1],E[10]=B[2],E[11]=0,E[12]=r[0],E[13]=r[1],E[14]=r[2],E[15]=1,E}function g(r,u){return u=u||new W(16),u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=r[0],u[13]=r[1],u[14]=r[2],u[15]=1,u}function de(r,u,c){c=c||new W(16);var E=u[0],s=u[1],i=u[2],a=r[0],m=r[1],h=r[2],T=r[3],_=r[1*4+0],I=r[1*4+1],L=r[1*4+2],X=r[1*4+3],z=r[2*4+0],Z=r[2*4+1],ae=r[2*4+2],ne=r[2*4+3],le=r[3*4+0],se=r[3*4+1],ee=r[3*4+2],pe=r[3*4+3];return r!==c&&(c[0]=a,c[1]=m,c[2]=h,c[3]=T,c[4]=_,c[5]=I,c[6]=L,c[7]=X,c[8]=z,c[9]=Z,c[10]=ae,c[11]=ne),c[12]=a*E+_*s+z*i+le,c[13]=m*E+I*s+Z*i+se,c[14]=h*E+L*s+ae*i+ee,c[15]=T*E+X*s+ne*i+pe,c}function ge(r,u){u=u||new W(16);var c=Math.cos(r),E=Math.sin(r);return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=c,u[6]=E,u[7]=0,u[8]=0,u[9]=-E,u[10]=c,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function Fe(r,u,c){c=c||new W(16);var E=r[4],s=r[5],i=r[6],a=r[7],m=r[8],h=r[9],T=r[10],_=r[11],I=Math.cos(u),L=Math.sin(u);return c[4]=I*E+L*m,c[5]=I*s+L*h,c[6]=I*i+L*T,c[7]=I*a+L*_,c[8]=I*m-L*E,c[9]=I*h-L*s,c[10]=I*T-L*i,c[11]=I*_-L*a,r!==c&&(c[0]=r[0],c[1]=r[1],c[2]=r[2],c[3]=r[3],c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c}function We(r,u){u=u||new W(16);var c=Math.cos(r),E=Math.sin(r);return u[0]=c,u[1]=0,u[2]=-E,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=E,u[9]=0,u[10]=c,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function Ue(r,u,c){c=c||new W(16);var E=r[0*4+0],s=r[0*4+1],i=r[0*4+2],a=r[0*4+3],m=r[2*4+0],h=r[2*4+1],T=r[2*4+2],_=r[2*4+3],I=Math.cos(u),L=Math.sin(u);return c[0]=I*E-L*m,c[1]=I*s-L*h,c[2]=I*i-L*T,c[3]=I*a-L*_,c[8]=I*m+L*E,c[9]=I*h+L*s,c[10]=I*T+L*i,c[11]=I*_+L*a,r!==c&&(c[4]=r[4],c[5]=r[5],c[6]=r[6],c[7]=r[7],c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c}function Ze(r,u){u=u||new W(16);var c=Math.cos(r),E=Math.sin(r);return u[0]=c,u[1]=E,u[2]=0,u[3]=0,u[4]=-E,u[5]=c,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function Ke(r,u,c){c=c||new W(16);var E=r[0*4+0],s=r[0*4+1],i=r[0*4+2],a=r[0*4+3],m=r[1*4+0],h=r[1*4+1],T=r[1*4+2],_=r[1*4+3],I=Math.cos(u),L=Math.sin(u);return c[0]=I*E+L*m,c[1]=I*s+L*h,c[2]=I*i+L*T,c[3]=I*a+L*_,c[4]=I*m-L*E,c[5]=I*h-L*s,c[6]=I*T-L*i,c[7]=I*_-L*a,r!==c&&(c[8]=r[8],c[9]=r[9],c[10]=r[10],c[11]=r[11],c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c}function fr(r,u,c){c=c||new W(16);var E=r[0],s=r[1],i=r[2],a=Math.sqrt(E*E+s*s+i*i);E/=a,s/=a,i/=a;var m=E*E,h=s*s,T=i*i,_=Math.cos(u),I=Math.sin(u),L=1-_;return c[0]=m+(1-m)*_,c[1]=E*s*L+i*I,c[2]=E*i*L-s*I,c[3]=0,c[4]=E*s*L-i*I,c[5]=h+(1-h)*_,c[6]=s*i*L+E*I,c[7]=0,c[8]=E*i*L+s*I,c[9]=s*i*L-E*I,c[10]=T+(1-T)*_,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function Tr(r,u,c,E){E=E||new W(16);var s=u[0],i=u[1],a=u[2],m=Math.sqrt(s*s+i*i+a*a);s/=m,i/=m,a/=m;var h=s*s,T=i*i,_=a*a,I=Math.cos(c),L=Math.sin(c),X=1-I,z=h+(1-h)*I,Z=s*i*X+a*L,ae=s*a*X-i*L,ne=s*i*X-a*L,le=T+(1-T)*I,se=i*a*X+s*L,ee=s*a*X+i*L,pe=i*a*X-s*L,Oe=_+(1-_)*I,Ye=r[0],ke=r[1],Ve=r[2],_e=r[3],De=r[4],Qe=r[5],Xe=r[6],ze=r[7],He=r[8],Je=r[9],Be=r[10],Ne=r[11];return E[0]=z*Ye+Z*De+ae*He,E[1]=z*ke+Z*Qe+ae*Je,E[2]=z*Ve+Z*Xe+ae*Be,E[3]=z*_e+Z*ze+ae*Ne,E[4]=ne*Ye+le*De+se*He,E[5]=ne*ke+le*Qe+se*Je,E[6]=ne*Ve+le*Xe+se*Be,E[7]=ne*_e+le*ze+se*Ne,E[8]=ee*Ye+pe*De+Oe*He,E[9]=ee*ke+pe*Qe+Oe*Je,E[10]=ee*Ve+pe*Xe+Oe*Be,E[11]=ee*_e+pe*ze+Oe*Ne,r!==E&&(E[12]=r[12],E[13]=r[13],E[14]=r[14],E[15]=r[15]),E}function cr(r,u){return u=u||new W(16),u[0]=r[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=r[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=r[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function ar(r,u,c){c=c||new W(16);var E=u[0],s=u[1],i=u[2];return c[0]=E*r[0],c[1]=E*r[1],c[2]=E*r[2],c[3]=E*r[3],c[4]=s*r[4],c[5]=s*r[5],c[6]=s*r[6],c[7]=s*r[7],c[8]=i*r[8],c[9]=i*r[9],c[10]=i*r[10],c[11]=i*r[11],r!==c&&(c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c}function vr(r,u,c){c=c||G.create();var E=u[0],s=u[1],i=u[2],a=E*r[0*4+3]+s*r[1*4+3]+i*r[2*4+3]+r[3*4+3];return c[0]=(E*r[0]+s*r[4]+i*r[8]+r[12])/a,c[1]=(E*r[1]+s*r[5]+i*r[9]+r[13])/a,c[2]=(E*r[2]+s*r[6]+i*r[10]+r[14])/a,c}function Sr(r,u,c){c=c||G.create();var E=u[0],s=u[1],i=u[2];return c[0]=E*r[0]+s*r[4]+i*r[8],c[1]=E*r[1]+s*r[5]+i*r[9],c[2]=E*r[2]+s*r[6]+i*r[10],c}function ue(r,u,c){c=c||G.create();var E=x(r),s=u[0],i=u[1],a=u[2];return c[0]=s*E[0]+i*E[1]+a*E[2],c[1]=s*E[4]+i*E[5]+a*E[6],c[2]=s*E[8]+i*E[9]+a*E[10],c}},"./src/primitives.js":(ie,o,Y)=>{function $(i){"@babel/helpers - typeof";return $=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},$(i)}o.__esModule=!0,o.concatVertices=u,o.create3DFBuffers=o.create3DFBufferInfo=void 0,o.create3DFVertices=We,o.createAugmentedTypedArray=x,o.createCrescentBuffers=o.createCrescentBufferInfo=void 0,o.createCrescentVertices=Ue,o.createCubeBuffers=o.createCubeBufferInfo=o.createCresentVertices=o.createCresentBuffers=o.createCresentBufferInfo=void 0,o.createCubeVertices=de,o.createCylinderBuffers=o.createCylinderBufferInfo=void 0,o.createCylinderVertices=Ze,o.createDiscBuffers=o.createDiscBufferInfo=void 0,o.createDiscVertices=fr,o.createPlaneBuffers=o.createPlaneBufferInfo=void 0,o.createPlaneVertices=B,o.createSphereBuffers=o.createSphereBufferInfo=void 0,o.createSphereVertices=N,o.createTorusBuffers=o.createTorusBufferInfo=void 0,o.createTorusVertices=Ke,o.createTruncatedConeBuffers=o.createTruncatedConeBufferInfo=void 0,o.createTruncatedConeVertices=ge,o.createXYQuadBuffers=o.createXYQuadBufferInfo=void 0,o.createXYQuadVertices=w,o.deindexVertices=ce,o.duplicateVertices=c,o.flattenNormals=Ee,o.makeRandomVertexColors=cr,o.reorientDirections=or,o.reorientNormals=ur,o.reorientPositions=er,o.reorientVertices=me;var G=Se(Y("./src/attributes.js")),he=Se(Y("./src/helper.js")),te=Se(Y("./src/typedarrays.js")),W=Se(Y("./src/m4.js")),ve=Se(Y("./src/v3.js"));function re(i){if(typeof WeakMap!="function")return null;var a=new WeakMap,m=new WeakMap;return(re=function(T){return T?m:a})(i)}function Se(i,a){if(!a&&i&&i.__esModule)return i;if(i===null||$(i)!="object"&&typeof i!="function")return{default:i};var m=re(a);if(m&&m.has(i))return m.get(i);var h={__proto__:null},T=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var _ in i)if(_!=="default"&&Object.prototype.hasOwnProperty.call(i,_)){var I=T?Object.getOwnPropertyDescriptor(i,_):null;I&&(I.get||I.set)?Object.defineProperty(h,_,I):h[_]=i[_]}return h.default=i,m&&m.set(i,h),h}var C=G.getArray_,q=G.getNumComponents_;function K(i,a){var m=0;return i.push=function(){for(var h=0;h<arguments.length;++h){var T=arguments[h];if(T instanceof Array||te.isArrayBuffer(T))for(var _=0;_<T.length;++_)i[m++]=T[_];else i[m++]=T}},i.reset=function(h){m=h||0},i.numComponents=a,Object.defineProperty(i,"numElements",{get:function(){return this.length/this.numComponents|0}}),i}function x(i,a,m){var h=m||Float32Array;return K(new h(i*a),i)}function j(i){return i!=="indices"}function ce(i){var a=i.indices,m={},h=a.length;function T(_){for(var I=i[_],L=I.numComponents,X=x(L,h,I.constructor),z=0;z<h;++z)for(var Z=a[z],ae=Z*L,ne=0;ne<L;++ne)X.push(I[ae+ne]);m[_]=X}return Object.keys(i).filter(j).forEach(T),m}function Ee(i){if(i.indices)throw new Error("can not flatten normals of indexed vertices. deindex them first");for(var a=i.normal,m=a.length,h=0;h<m;h+=9){var T=a[h+0],_=a[h+1],I=a[h+2],L=a[h+3],X=a[h+4],z=a[h+5],Z=a[h+6],ae=a[h+7],ne=a[h+8],le=T+L+Z,se=_+X+ae,ee=I+z+ne,pe=Math.sqrt(le*le+se*se+ee*ee);le/=pe,se/=pe,ee/=pe,a[h+0]=le,a[h+1]=se,a[h+2]=ee,a[h+3]=le,a[h+4]=se,a[h+5]=ee,a[h+6]=le,a[h+7]=se,a[h+8]=ee}return i}function Ge(i,a,m){for(var h=i.length,T=new Float32Array(3),_=0;_<h;_+=3)m(a,[i[_],i[_+1],i[_+2]],T),i[_]=T[0],i[_+1]=T[1],i[_+2]=T[2]}function xe(i,a,m){m=m||ve.create();var h=a[0],T=a[1],_=a[2];return m[0]=h*i[0]+T*i[1]+_*i[2],m[1]=h*i[4]+T*i[5]+_*i[6],m[2]=h*i[8]+T*i[9]+_*i[10],m}function or(i,a){return Ge(i,a,W.transformDirection),i}function ur(i,a){return Ge(i,W.inverse(a),xe),i}function er(i,a){return Ge(i,a,W.transformPoint),i}function me(i,a){return Object.keys(i).forEach(function(m){var h=i[m];m.indexOf("pos")>=0?er(h,a):m.indexOf("tan")>=0||m.indexOf("binorm")>=0?or(h,a):m.indexOf("norm")>=0&&ur(h,a)}),i}function w(i,a,m){return i=i||2,a=a||0,m=m||0,i*=.5,{position:{numComponents:2,data:[a+-1*i,m+-1*i,a+1*i,m+-1*i,a+-1*i,m+1*i,a+1*i,m+1*i]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function B(i,a,m,h,T){i=i||1,a=a||1,m=m||1,h=h||1,T=T||W.identity();for(var _=(m+1)*(h+1),I=x(3,_),L=x(3,_),X=x(2,_),z=0;z<=h;z++)for(var Z=0;Z<=m;Z++){var ae=Z/m,ne=z/h;I.push(i*ae-i*.5,0,a*ne-a*.5),L.push(0,1,0),X.push(ae,ne)}for(var le=m+1,se=x(3,m*h*2,Uint16Array),ee=0;ee<h;ee++)for(var pe=0;pe<m;pe++)se.push((ee+0)*le+pe,(ee+1)*le+pe,(ee+0)*le+pe+1),se.push((ee+1)*le+pe,(ee+1)*le+pe+1,(ee+0)*le+pe+1);var Oe=me({position:I,normal:L,texcoord:X,indices:se},T);return Oe}function N(i,a,m,h,T,_,I){if(a<=0||m<=0)throw new Error("subdivisionAxis and subdivisionHeight must be > 0");h=h||0,T=T||Math.PI,_=_||0,I=I||Math.PI*2;for(var L=T-h,X=I-_,z=(a+1)*(m+1),Z=x(3,z),ae=x(3,z),ne=x(2,z),le=0;le<=m;le++)for(var se=0;se<=a;se++){var ee=se/a,pe=le/m,Oe=X*ee+_,Ye=L*pe+h,ke=Math.sin(Oe),Ve=Math.cos(Oe),_e=Math.sin(Ye),De=Math.cos(Ye),Qe=Ve*_e,Xe=De,ze=ke*_e;Z.push(i*Qe,i*Xe,i*ze),ae.push(Qe,Xe,ze),ne.push(1-ee,pe)}for(var He=a+1,Je=x(3,a*m*2,Uint16Array),Be=0;Be<a;Be++)for(var Ne=0;Ne<m;Ne++)Je.push((Ne+0)*He+Be,(Ne+0)*He+Be+1,(Ne+1)*He+Be),Je.push((Ne+1)*He+Be,(Ne+0)*He+Be+1,(Ne+1)*He+Be+1);return{position:Z,normal:ae,texcoord:ne,indices:Je}}var g=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function de(i){i=i||1;for(var a=i/2,m=[[-a,-a,-a],[+a,-a,-a],[-a,+a,-a],[+a,+a,-a],[-a,-a,+a],[+a,-a,+a],[-a,+a,+a],[+a,+a,+a]],h=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],T=[[1,0],[0,0],[0,1],[1,1]],_=6*4,I=x(3,_),L=x(3,_),X=x(2,_),z=x(3,6*2,Uint16Array),Z=0;Z<6;++Z){for(var ae=g[Z],ne=0;ne<4;++ne){var le=m[ae[ne]],se=h[Z],ee=T[ne];I.push(le),L.push(se),X.push(ee)}var pe=4*Z;z.push(pe+0,pe+1,pe+2),z.push(pe+0,pe+2,pe+3)}return{position:I,normal:L,texcoord:X,indices:z}}function ge(i,a,m,h,T,_,I){if(h<3)throw new Error("radialSubdivisions must be 3 or greater");if(T<1)throw new Error("verticalSubdivisions must be 1 or greater");for(var L=_===void 0?!0:_,X=I===void 0?!0:I,z=(L?2:0)+(X?2:0),Z=(h+1)*(T+1+z),ae=x(3,Z),ne=x(3,Z),le=x(2,Z),se=x(3,h*(T+z/2)*2,Uint16Array),ee=h+1,pe=Math.atan2(i-a,m),Oe=Math.cos(pe),Ye=Math.sin(pe),ke=L?-2:0,Ve=T+(X?2:0),_e=ke;_e<=Ve;++_e){var De=_e/T,Qe=m*De,Xe=void 0;_e<0?(Qe=0,De=1,Xe=i):_e>T?(Qe=m,De=1,Xe=a):Xe=i+(a-i)*(_e/T),(_e===-2||_e===T+2)&&(Xe=0,De=0),Qe-=m/2;for(var ze=0;ze<ee;++ze){var He=Math.sin(ze*Math.PI*2/h),Je=Math.cos(ze*Math.PI*2/h);ae.push(He*Xe,Qe,Je*Xe),_e<0?ne.push(0,-1,0):_e>T?ne.push(0,1,0):Xe===0?ne.push(0,0,0):ne.push(He*Oe,Ye,Je*Oe),le.push(ze/h,1-De)}}for(var Be=0;Be<T+z;++Be)if(!(Be===1&&L||Be===T+z-2&&X))for(var Ne=0;Ne<h;++Ne)se.push(ee*(Be+0)+0+Ne,ee*(Be+0)+1+Ne,ee*(Be+1)+1+Ne),se.push(ee*(Be+0)+0+Ne,ee*(Be+1)+1+Ne,ee*(Be+1)+0+Ne);return{position:ae,normal:ne,texcoord:le,indices:se}}function Fe(i,a){a=a||[];for(var m=[],h=0;h<i.length;h+=4){var T=i[h],_=i.slice(h+1,h+4);_.push.apply(_,a);for(var I=0;I<T;++I)m.push.apply(m,_)}return m}function We(){var i=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],a=[.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0],m=Fe([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),h=Fe([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),T=i.length/3,_={position:x(3,T),texcoord:x(2,T),normal:x(3,T),color:x(4,T,Uint8Array),indices:x(3,T/3,Uint16Array)};_.position.push(i),_.texcoord.push(a),_.normal.push(m),_.color.push(h);for(var I=0;I<T;++I)_.indices.push(I);return _}function Ue(i,a,m,h,T,_,I){if(T<=0)throw new Error("subdivisionDown must be > 0");_=_||0,I=I||1;var L=2,X=I-_,z=(T+1)*2*(2+L),Z=x(3,z),ae=x(3,z),ne=x(2,z);function le(Ve,_e,De){return Ve+(_e-Ve)*De}function se(Ve,_e,De,Qe,Xe,ze){for(var He=0;He<=T;He++){var Je=_e/(L-1),Be=He/T,Ne=(Je-.5)*2,yr=(_+Be*X)*Math.PI,lr=Math.sin(yr),Ar=Math.cos(yr),_r=le(i,Ve,lr),Lr=Ne*h,Ur=Ar*i,Gr=lr*_r;Z.push(Lr,Ur,Gr);var $r=ve.add(ve.multiply([0,lr,Ar],De),Qe);ae.push($r),ne.push(Je*Xe+ze,Be)}}for(var ee=0;ee<L;ee++){var pe=(ee/(L-1)-.5)*2;se(a,ee,[1,1,1],[0,0,0],1,0),se(a,ee,[0,0,0],[pe,0,0],0,0),se(m,ee,[1,1,1],[0,0,0],1,0),se(m,ee,[0,0,0],[pe,0,0],0,1)}var Oe=x(3,T*2*(2+L),Uint16Array);function Ye(Ve,_e){for(var De=0;De<T;++De)Oe.push(Ve+De+0,Ve+De+1,_e+De+0),Oe.push(Ve+De+1,_e+De+1,_e+De+0)}var ke=T+1;return Ye(ke*0,ke*4),Ye(ke*5,ke*7),Ye(ke*6,ke*2),Ye(ke*3,ke*1),{position:Z,normal:ae,texcoord:ne,indices:Oe}}function Ze(i,a,m,h,T,_){return ge(i,i,a,m,h,T,_)}function Ke(i,a,m,h,T,_){if(m<3)throw new Error("radialSubdivisions must be 3 or greater");if(h<3)throw new Error("verticalSubdivisions must be 3 or greater");T=T||0,_=_||Math.PI*2;for(var I=_-T,L=m+1,X=h+1,z=L*X,Z=x(3,z),ae=x(3,z),ne=x(2,z),le=x(3,m*h*2,Uint16Array),se=0;se<X;++se)for(var ee=se/h,pe=ee*Math.PI*2,Oe=Math.sin(pe),Ye=i+Oe*a,ke=Math.cos(pe),Ve=ke*a,_e=0;_e<L;++_e){var De=_e/m,Qe=T+De*I,Xe=Math.sin(Qe),ze=Math.cos(Qe),He=Xe*Ye,Je=ze*Ye,Be=Xe*Oe,Ne=ze*Oe;Z.push(He,Ve,Je),ae.push(Be,ke,Ne),ne.push(De,1-ee)}for(var yr=0;yr<h;++yr)for(var lr=0;lr<m;++lr){var Ar=1+lr,_r=1+yr;le.push(L*yr+lr,L*_r+lr,L*yr+Ar),le.push(L*_r+lr,L*_r+Ar,L*yr+Ar)}return{position:Z,normal:ae,texcoord:ne,indices:le}}function fr(i,a,m,h,T){if(a<3)throw new Error("divisions must be at least 3");m=m||1,T=T||1,h=h||0;for(var _=(a+1)*(m+1),I=x(3,_),L=x(3,_),X=x(2,_),z=x(3,m*a*2,Uint16Array),Z=0,ae=i-h,ne=a+1,le=0;le<=m;++le){for(var se=h+ae*Math.pow(le/m,T),ee=0;ee<=a;++ee){var pe=2*Math.PI*ee/a,Oe=se*Math.cos(pe),Ye=se*Math.sin(pe);if(I.push(Oe,0,Ye),L.push(0,1,0),X.push(1-ee/a,le/m),le>0&&ee!==a){var ke=Z+(ee+1),Ve=Z+ee,_e=Z+ee-ne,De=Z+(ee+1)-ne;z.push(ke,Ve,_e),z.push(ke,_e,De)}}Z+=a+1}return{position:I,normal:L,texcoord:X,indices:z}}function Tr(i){return Math.random()*i|0}function cr(i,a){a=a||{};var m=i.position.numElements,h=x(4,m,Uint8Array),T=a.rand||function(ae,ne){return ne<3?Tr(256):255};if(i.color=h,i.indices)for(var _=0;_<m;++_)h.push(T(_,0),T(_,1),T(_,2),T(_,3));else for(var I=a.vertsPerColor||3,L=m/I,X=0;X<L;++X)for(var z=[T(X,0),T(X,1),T(X,2),T(X,3)],Z=0;Z<I;++Z)h.push(z);return i}function ar(i){return function(a){var m=i.apply(this,Array.prototype.slice.call(arguments,1));return G.createBuffersFromArrays(a,m)}}function vr(i){return function(a){var m=i.apply(null,Array.prototype.slice.call(arguments,1));return G.createBufferInfoFromArrays(a,m)}}var Sr=["numComponents","size","type","normalize","stride","offset","attrib","name","attribName"];function ue(i,a,m,h){h=h||0;for(var T=i.length,_=0;_<T;++_)a[m+_]=i[_]+h}function r(i,a){var m=C(i),h=new m.constructor(a),T=h;return m.numComponents&&m.numElements&&K(h,m.numComponents),i.data&&(T={data:h},he.copyNamedProperties(Sr,i,T)),T}function u(i){for(var a={},m,h=function(){var Z=i[T];Object.keys(Z).forEach(function(ae){a[ae]||(a[ae]=[]),!m&&ae!=="indices"&&(m=ae);var ne=Z[ae],le=q(ne,ae),se=C(ne),ee=se.length/le;a[ae].push(ee)})},T=0;T<i.length;++T)h();function _(z){for(var Z=0,ae,ne=0;ne<i.length;++ne){var le=i[ne],se=le[z],ee=C(se);Z+=ee.length,(!ae||se.data)&&(ae=se)}return{length:Z,spec:ae}}function I(z,Z,ae){for(var ne=0,le=0,se=0;se<i.length;++se){var ee=i[se],pe=ee[z],Oe=C(pe);z==="indices"?(ue(Oe,ae,le,ne),ne+=Z[se]):ue(Oe,ae,le),le+=Oe.length}}var L=a[m],X={};return Object.keys(a).forEach(function(z){var Z=_(z),ae=r(Z.spec,Z.length);I(z,L,C(ae)),X[z]=ae}),X}function c(i){var a={};return Object.keys(i).forEach(function(m){var h=i[m],T=C(h),_=r(h,T.length);ue(T,C(_),0),a[m]=_}),a}o.create3DFBufferInfo=vr(We),o.create3DFBuffers=ar(We),o.createCubeBufferInfo=vr(de),o.createCubeBuffers=ar(de),o.createPlaneBufferInfo=vr(B),o.createPlaneBuffers=ar(B),o.createSphereBufferInfo=vr(N),o.createSphereBuffers=ar(N),o.createTruncatedConeBufferInfo=vr(ge),o.createTruncatedConeBuffers=ar(ge),o.createXYQuadBufferInfo=vr(w),o.createXYQuadBuffers=ar(w);var E=o.createCrescentBufferInfo=vr(Ue),s=o.createCrescentBuffers=ar(Ue);o.createCylinderBufferInfo=vr(Ze),o.createCylinderBuffers=ar(Ze),o.createTorusBufferInfo=vr(Ke),o.createTorusBuffers=ar(Ke),o.createDiscBufferInfo=vr(fr),o.createDiscBuffers=ar(fr),o.createCresentBufferInfo=E,o.createCresentBuffers=s,o.createCresentVertices=Ue},"./src/programs.js":(ie,o,Y)=>{function $(e){"@babel/helpers - typeof";return $=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(e)}o.__esModule=!0,o.bindTransformFeedbackInfo=Lt,o.bindUniformBlock=Ot,o.createAttributeSetters=on,o.createProgram=ht,o.createProgramAsync=void 0,o.createProgramFromScripts=$t,o.createProgramFromSources=en,o.createProgramInfo=l,o.createProgramInfoAsync=void 0,o.createProgramInfoFromProgram=Nt,o.createProgramInfos=A,o.createProgramInfosAsync=void 0,o.createPrograms=p,o.createProgramsAsync=void 0,o.createTransformFeedback=tn,o.createTransformFeedbackInfo=It,o.createUniformBlockInfo=an,o.createUniformBlockInfoFromProgram=nn,o.createUniformBlockSpecFromProgram=zr,o.createUniformSetters=tt,o.setAttributes=un,o.setBlockUniforms=ua,o.setBuffersAndAttributes=fa,o.setUniformBlock=In,o.setUniforms=Mt,o.setUniformsAndBindTextures=void 0;var G=W(Y("./src/utils.js")),he=W(Y("./src/helper.js"));function te(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,n=new WeakMap;return(te=function(b){return b?n:t})(e)}function W(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||$(e)!="object"&&typeof e!="function")return{default:e};var n=te(t);if(n&&n.has(e))return n.get(e);var d={__proto__:null},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var S in e)if(S!=="default"&&Object.prototype.hasOwnProperty.call(e,S)){var R=b?Object.getOwnPropertyDescriptor(e,S):null;R&&(R.get||R.set)?Object.defineProperty(d,S,R):d[S]=e[S]}return d.default=e,n&&n.set(e,d),d}function ve(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ve=function(){return t};var e,t={},n=Object.prototype,d=n.hasOwnProperty,b=Object.defineProperty||function(fe,V,Q){fe[V]=Q.value},S=typeof Symbol=="function"?Symbol:{},R=S.iterator||"@@iterator",P=S.asyncIterator||"@@asyncIterator",O=S.toStringTag||"@@toStringTag";function F(fe,V,Q){return Object.defineProperty(fe,V,{value:Q,enumerable:!0,configurable:!0,writable:!0}),fe[V]}try{F({},"")}catch{F=function(Q,Ae,Le){return Q[Ae]=Le}}function U(fe,V,Q,Ae){var Le=V&&V.prototype instanceof je?V:je,we=Object.create(Le.prototype),sr=new sa(Ae||[]);return b(we,"_invoke",{value:ka(fe,Q,sr)}),we}function oe(fe,V,Q){try{return{type:"normal",arg:fe.call(V,Q)}}catch(Ae){return{type:"throw",arg:Ae}}}t.wrap=U;var ye="suspendedStart",be="suspendedYield",Re="executing",Me="completed",Ie={};function je(){}function qe(){}function ir(){}var mr={};F(mr,R,function(){return this});var Pr=Object.getPrototypeOf,Or=Pr&&Pr(Pr(va([])));Or&&Or!==n&&d.call(Or,R)&&(mr=Or);var Vr=ir.prototype=je.prototype=Object.create(mr);function On(fe){["next","throw","return"].forEach(function(V){F(fe,V,function(Q){return this._invoke(V,Q)})})}function Mn(fe,V){function Q(Le,we,sr,wr){var Rr=oe(fe[Le],fe,we);if(Rr.type!=="throw"){var yt=Rr.arg,nt=yt.value;return nt&&$(nt)=="object"&&d.call(nt,"__await")?V.resolve(nt.__await).then(function(pt){Q("next",pt,sr,wr)},function(pt){Q("throw",pt,sr,wr)}):V.resolve(nt).then(function(pt){yt.value=pt,sr(yt)},function(pt){return Q("throw",pt,sr,wr)})}wr(Rr.arg)}var Ae;b(this,"_invoke",{value:function(we,sr){function wr(){return new V(function(Rr,yt){Q(we,sr,Rr,yt)})}return Ae=Ae?Ae.then(wr,wr):wr()}})}function ka(fe,V,Q){var Ae=ye;return function(Le,we){if(Ae===Re)throw new Error("Generator is already running");if(Ae===Me){if(Le==="throw")throw we;return{value:e,done:!0}}for(Q.method=Le,Q.arg=we;;){var sr=Q.delegate;if(sr){var wr=xa(sr,Q);if(wr){if(wr===Ie)continue;return wr}}if(Q.method==="next")Q.sent=Q._sent=Q.arg;else if(Q.method==="throw"){if(Ae===ye)throw Ae=Me,Q.arg;Q.dispatchException(Q.arg)}else Q.method==="return"&&Q.abrupt("return",Q.arg);Ae=Re;var Rr=oe(fe,V,Q);if(Rr.type==="normal"){if(Ae=Q.done?Me:be,Rr.arg===Ie)continue;return{value:Rr.arg,done:Q.done}}Rr.type==="throw"&&(Ae=Me,Q.method="throw",Q.arg=Rr.arg)}}}function xa(fe,V){var Q=V.method,Ae=fe.iterator[Q];if(Ae===e)return V.delegate=null,Q==="throw"&&fe.iterator.return&&(V.method="return",V.arg=e,xa(fe,V),V.method==="throw")||Q!=="return"&&(V.method="throw",V.arg=new TypeError("The iterator does not provide a '"+Q+"' method")),Ie;var Le=oe(Ae,fe.iterator,V.arg);if(Le.type==="throw")return V.method="throw",V.arg=Le.arg,V.delegate=null,Ie;var we=Le.arg;return we?we.done?(V[fe.resultName]=we.value,V.next=fe.nextLoc,V.method!=="return"&&(V.method="next",V.arg=e),V.delegate=null,Ie):we:(V.method="throw",V.arg=new TypeError("iterator result is not an object"),V.delegate=null,Ie)}function ja(fe){var V={tryLoc:fe[0]};1 in fe&&(V.catchLoc=fe[1]),2 in fe&&(V.finallyLoc=fe[2],V.afterLoc=fe[3]),this.tryEntries.push(V)}function la(fe){var V=fe.completion||{};V.type="normal",delete V.arg,fe.completion=V}function sa(fe){this.tryEntries=[{tryLoc:"root"}],fe.forEach(ja,this),this.reset(!0)}function va(fe){if(fe||fe===""){var V=fe[R];if(V)return V.call(fe);if(typeof fe.next=="function")return fe;if(!isNaN(fe.length)){var Q=-1,Ae=function Le(){for(;++Q<fe.length;)if(d.call(fe,Q))return Le.value=fe[Q],Le.done=!1,Le;return Le.value=e,Le.done=!0,Le};return Ae.next=Ae}}throw new TypeError($(fe)+" is not iterable")}return qe.prototype=ir,b(Vr,"constructor",{value:ir,configurable:!0}),b(ir,"constructor",{value:qe,configurable:!0}),qe.displayName=F(ir,O,"GeneratorFunction"),t.isGeneratorFunction=function(fe){var V=typeof fe=="function"&&fe.constructor;return!!V&&(V===qe||(V.displayName||V.name)==="GeneratorFunction")},t.mark=function(fe){return Object.setPrototypeOf?Object.setPrototypeOf(fe,ir):(fe.__proto__=ir,F(fe,O,"GeneratorFunction")),fe.prototype=Object.create(Vr),fe},t.awrap=function(fe){return{__await:fe}},On(Mn.prototype),F(Mn.prototype,P,function(){return this}),t.AsyncIterator=Mn,t.async=function(fe,V,Q,Ae,Le){Le===void 0&&(Le=Promise);var we=new Mn(U(fe,V,Q,Ae),Le);return t.isGeneratorFunction(V)?we:we.next().then(function(sr){return sr.done?sr.value:we.next()})},On(Vr),F(Vr,O,"Generator"),F(Vr,R,function(){return this}),F(Vr,"toString",function(){return"[object Generator]"}),t.keys=function(fe){var V=Object(fe),Q=[];for(var Ae in V)Q.push(Ae);return Q.reverse(),function Le(){for(;Q.length;){var we=Q.pop();if(we in V)return Le.value=we,Le.done=!1,Le}return Le.done=!0,Le}},t.values=va,sa.prototype={constructor:sa,reset:function(V){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(la),!V)for(var Q in this)Q.charAt(0)==="t"&&d.call(this,Q)&&!isNaN(+Q.slice(1))&&(this[Q]=e)},stop:function(){this.done=!0;var V=this.tryEntries[0].completion;if(V.type==="throw")throw V.arg;return this.rval},dispatchException:function(V){if(this.done)throw V;var Q=this;function Ae(yt,nt){return sr.type="throw",sr.arg=V,Q.next=yt,nt&&(Q.method="next",Q.arg=e),!!nt}for(var Le=this.tryEntries.length-1;Le>=0;--Le){var we=this.tryEntries[Le],sr=we.completion;if(we.tryLoc==="root")return Ae("end");if(we.tryLoc<=this.prev){var wr=d.call(we,"catchLoc"),Rr=d.call(we,"finallyLoc");if(wr&&Rr){if(this.prev<we.catchLoc)return Ae(we.catchLoc,!0);if(this.prev<we.finallyLoc)return Ae(we.finallyLoc)}else if(wr){if(this.prev<we.catchLoc)return Ae(we.catchLoc,!0)}else{if(!Rr)throw new Error("try statement without catch or finally");if(this.prev<we.finallyLoc)return Ae(we.finallyLoc)}}}},abrupt:function(V,Q){for(var Ae=this.tryEntries.length-1;Ae>=0;--Ae){var Le=this.tryEntries[Ae];if(Le.tryLoc<=this.prev&&d.call(Le,"finallyLoc")&&this.prev<Le.finallyLoc){var we=Le;break}}we&&(V==="break"||V==="continue")&&we.tryLoc<=Q&&Q<=we.finallyLoc&&(we=null);var sr=we?we.completion:{};return sr.type=V,sr.arg=Q,we?(this.method="next",this.next=we.finallyLoc,Ie):this.complete(sr)},complete:function(V,Q){if(V.type==="throw")throw V.arg;return V.type==="break"||V.type==="continue"?this.next=V.arg:V.type==="return"?(this.rval=this.arg=V.arg,this.method="return",this.next="end"):V.type==="normal"&&Q&&(this.next=Q),Ie},finish:function(V){for(var Q=this.tryEntries.length-1;Q>=0;--Q){var Ae=this.tryEntries[Q];if(Ae.finallyLoc===V)return this.complete(Ae.completion,Ae.afterLoc),la(Ae),Ie}},catch:function(V){for(var Q=this.tryEntries.length-1;Q>=0;--Q){var Ae=this.tryEntries[Q];if(Ae.tryLoc===V){var Le=Ae.completion;if(Le.type==="throw"){var we=Le.arg;la(Ae)}return we}}throw new Error("illegal catch attempt")},delegateYield:function(V,Q,Ae){return this.delegate={iterator:va(V),resultName:Q,nextLoc:Ae},this.method==="next"&&(this.arg=e),Ie}},t}function re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);t&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(e,b).enumerable})),n.push.apply(n,d)}return n}function Se(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?re(Object(n),!0).forEach(function(d){C(e,d,n[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach(function(d){Object.defineProperty(e,d,Object.getOwnPropertyDescriptor(n,d))})}return e}function C(e,t,n){return t=q(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function q(e){var t=K(e,"string");return $(t)=="symbol"?t:String(t)}function K(e,t){if($(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var d=n.call(e,t||"default");if($(d)!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function x(e,t,n,d,b,S,R){try{var P=e[S](R),O=P.value}catch(F){n(F);return}P.done?t(O):Promise.resolve(O).then(d,b)}function j(e){return function(){var t=this,n=arguments;return new Promise(function(d,b){var S=e.apply(t,n);function R(O){x(S,d,b,R,P,"next",O)}function P(O){x(S,d,b,R,P,"throw",O)}R(void 0)})}}function ce(e,t){return xe(e)||Ge(e,t)||me(e,t)||Ee()}function Ee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ge(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var d,b,S,R,P=[],O=!0,F=!1;try{if(S=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;O=!1}else for(;!(O=(d=S.call(n)).done)&&(P.push(d.value),P.length!==t);O=!0);}catch(U){F=!0,b=U}finally{try{if(!O&&n.return!=null&&(R=n.return(),Object(R)!==R))return}finally{if(F)throw b}}return P}}function xe(e){if(Array.isArray(e))return e}function or(e,t){var n=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=me(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var d=0,b=function(){};return{s:b,n:function(){return d>=e.length?{done:!0}:{done:!1,value:e[d++]}},e:function(F){throw F},f:b}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var S=!0,R=!1,P;return{s:function(){n=n.call(e)},n:function(){var F=n.next();return S=F.done,F},e:function(F){R=!0,P=F},f:function(){try{!S&&n.return!=null&&n.return()}finally{if(R)throw P}}}}function ur(e){return B(e)||w(e)||me(e)||er()}function er(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function me(e,t){if(e){if(typeof e=="string")return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}}function w(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function B(e){if(Array.isArray(e))return N(e)}function N(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,d=new Array(t);n<t;n++)d[n]=e[n];return d}var g=he.error,de=he.warn;function ge(e){return typeof document<"u"&&document.getElementById?document.getElementById(e):null}var Fe=33984,We=35048,Ue=34962,Ze=34963,Ke=35345,fr=35982,Tr=36386,cr=35713,ar=35714,vr=35632,Sr=35633,ue=35981,r=35718,u=35721,c=35971,E=35382,s=35396,i=35398,a=35392,m=35395,h=5126,T=35664,_=35665,I=35666,L=5124,X=35667,z=35668,Z=35669,ae=35670,ne=35671,le=35672,se=35673,ee=35674,pe=35675,Oe=35676,Ye=35678,ke=35680,Ve=35679,_e=35682,De=35685,Qe=35686,Xe=35687,ze=35688,He=35689,Je=35690,Be=36289,Ne=36292,yr=36293,lr=5125,Ar=36294,_r=36295,Lr=36296,Ur=36298,Gr=36299,$r=36300,St=36303,At=36306,gt=36307,hr=36308,Qn=36311,_t=3553,Pt=34067,Yt=32879,wt=35866,Pe={};function En(e,t){return Pe[t].bindPoint}function Zn(e,t){return function(n){e.uniform1f(t,n)}}function Jn(e,t){return function(n){e.uniform1fv(t,n)}}function $n(e,t){return function(n){e.uniform2fv(t,n)}}function ea(e,t){return function(n){e.uniform3fv(t,n)}}function ra(e,t){return function(n){e.uniform4fv(t,n)}}function Tn(e,t){return function(n){e.uniform1i(t,n)}}function Sn(e,t){return function(n){e.uniform1iv(t,n)}}function An(e,t){return function(n){e.uniform2iv(t,n)}}function gn(e,t){return function(n){e.uniform3iv(t,n)}}function _n(e,t){return function(n){e.uniform4iv(t,n)}}function kr(e,t){return function(n){e.uniform1ui(t,n)}}function tr(e,t){return function(n){e.uniform1uiv(t,n)}}function xt(e,t){return function(n){e.uniform2uiv(t,n)}}function et(e,t){return function(n){e.uniform3uiv(t,n)}}function Rt(e,t){return function(n){e.uniform4uiv(t,n)}}function Wr(e,t){return function(n){e.uniformMatrix2fv(t,!1,n)}}function pr(e,t){return function(n){e.uniformMatrix3fv(t,!1,n)}}function Pn(e,t){return function(n){e.uniformMatrix4fv(t,!1,n)}}function wn(e,t){return function(n){e.uniformMatrix2x3fv(t,!1,n)}}function xn(e,t){return function(n){e.uniformMatrix3x2fv(t,!1,n)}}function Cr(e,t){return function(n){e.uniformMatrix2x4fv(t,!1,n)}}function vt(e,t){return function(n){e.uniformMatrix4x2fv(t,!1,n)}}function qt(e,t){return function(n){e.uniformMatrix3x4fv(t,!1,n)}}function ta(e,t){return function(n){e.uniformMatrix4x3fv(t,!1,n)}}function br(e,t,n,d){var b=En(e,t);return G.isWebGL2(e)?function(S){var R,P;!S||he.isTexture(e,S)?(R=S,P=null):(R=S.texture,P=S.sampler),e.uniform1i(d,n),e.activeTexture(Fe+n),e.bindTexture(b,R),e.bindSampler(n,P)}:function(S){e.uniform1i(d,n),e.activeTexture(Fe+n),e.bindTexture(b,S)}}function Er(e,t,n,d,b){for(var S=En(e,t),R=new Int32Array(b),P=0;P<b;++P)R[P]=n+P;return G.isWebGL2(e)?function(O){e.uniform1iv(d,R),O.forEach(function(F,U){e.activeTexture(Fe+R[U]);var oe,ye;!F||he.isTexture(e,F)?(oe=F,ye=null):(oe=F.texture,ye=F.sampler),e.bindSampler(n,ye),e.bindTexture(S,oe)})}:function(O){e.uniform1iv(d,R),O.forEach(function(F,U){e.activeTexture(Fe+R[U]),e.bindTexture(S,F)})}}Pe[h]={Type:Float32Array,size:4,setter:Zn,arraySetter:Jn},Pe[T]={Type:Float32Array,size:8,setter:$n,cols:2},Pe[_]={Type:Float32Array,size:12,setter:ea,cols:3},Pe[I]={Type:Float32Array,size:16,setter:ra,cols:4},Pe[L]={Type:Int32Array,size:4,setter:Tn,arraySetter:Sn},Pe[X]={Type:Int32Array,size:8,setter:An,cols:2},Pe[z]={Type:Int32Array,size:12,setter:gn,cols:3},Pe[Z]={Type:Int32Array,size:16,setter:_n,cols:4},Pe[lr]={Type:Uint32Array,size:4,setter:kr,arraySetter:tr},Pe[Ar]={Type:Uint32Array,size:8,setter:xt,cols:2},Pe[_r]={Type:Uint32Array,size:12,setter:et,cols:3},Pe[Lr]={Type:Uint32Array,size:16,setter:Rt,cols:4},Pe[ae]={Type:Uint32Array,size:4,setter:Tn,arraySetter:Sn},Pe[ne]={Type:Uint32Array,size:8,setter:An,cols:2},Pe[le]={Type:Uint32Array,size:12,setter:gn,cols:3},Pe[se]={Type:Uint32Array,size:16,setter:_n,cols:4},Pe[ee]={Type:Float32Array,size:32,setter:Wr,rows:2,cols:2},Pe[pe]={Type:Float32Array,size:48,setter:pr,rows:3,cols:3},Pe[Oe]={Type:Float32Array,size:64,setter:Pn,rows:4,cols:4},Pe[De]={Type:Float32Array,size:32,setter:wn,rows:2,cols:3},Pe[Qe]={Type:Float32Array,size:32,setter:Cr,rows:2,cols:4},Pe[Xe]={Type:Float32Array,size:48,setter:xn,rows:3,cols:2},Pe[ze]={Type:Float32Array,size:48,setter:qt,rows:3,cols:4},Pe[He]={Type:Float32Array,size:64,setter:vt,rows:4,cols:2},Pe[Je]={Type:Float32Array,size:64,setter:ta,rows:4,cols:3},Pe[Ye]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:_t},Pe[ke]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Pt},Pe[Ve]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Yt},Pe[_e]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:_t},Pe[Be]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:wt},Pe[Ne]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:wt},Pe[yr]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Pt},Pe[Ur]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:_t},Pe[Gr]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Yt},Pe[$r]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Pt},Pe[St]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:wt},Pe[At]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:_t},Pe[gt]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Yt},Pe[hr]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Pt},Pe[Qn]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:wt};function Ct(e,t){return function(n){if(n.value)switch(e.disableVertexAttribArray(t),n.value.length){case 4:e.vertexAttrib4fv(t,n.value);break;case 3:e.vertexAttrib3fv(t,n.value);break;case 2:e.vertexAttrib2fv(t,n.value);break;case 1:e.vertexAttrib1fv(t,n.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else e.bindBuffer(Ue,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,n.numComponents||n.size,n.type||h,n.normalize||!1,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function xr(e,t){return function(n){if(n.value)if(e.disableVertexAttribArray(t),n.value.length===4)e.vertexAttrib4iv(t,n.value);else throw new Error("The length of an integer constant value must be 4!");else e.bindBuffer(Ue,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,n.numComponents||n.size,n.type||L,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function Dr(e,t){return function(n){if(n.value)if(e.disableVertexAttribArray(t),n.value.length===4)e.vertexAttrib4uiv(t,n.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else e.bindBuffer(Ue,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,n.numComponents||n.size,n.type||lr,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function Xr(e,t,n){var d=n.size,b=n.count;return function(S){e.bindBuffer(Ue,S.buffer);for(var R=S.size||S.numComponents||d,P=R/b,O=S.type||h,F=Pe[O],U=F.size*R,oe=S.normalize||!1,ye=S.offset||0,be=U/b,Re=0;Re<b;++Re)e.enableVertexAttribArray(t+Re),e.vertexAttribPointer(t+Re,P,O,oe,U,ye+be*Re),e.vertexAttribDivisor&&e.vertexAttribDivisor(t+Re,S.divisor||0)}}var rr={};rr[h]={size:4,setter:Ct},rr[T]={size:8,setter:Ct},rr[_]={size:12,setter:Ct},rr[I]={size:16,setter:Ct},rr[L]={size:4,setter:xr},rr[X]={size:8,setter:xr},rr[z]={size:12,setter:xr},rr[Z]={size:16,setter:xr},rr[lr]={size:4,setter:Dr},rr[Ar]={size:8,setter:Dr},rr[_r]={size:12,setter:Dr},rr[Lr]={size:16,setter:Dr},rr[ae]={size:4,setter:xr},rr[ne]={size:8,setter:xr},rr[le]={size:12,setter:xr},rr[se]={size:16,setter:xr},rr[ee]={size:4,setter:Xr,count:2},rr[pe]={size:9,setter:Xr,count:3},rr[Oe]={size:16,setter:Xr,count:4};var Hr=/ERROR:\s*\d+:(\d+)/gi;function jr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,d=ur(t.matchAll(Hr)),b=new Map(d.map(function(S,R){var P=parseInt(S[1]),O=d[R+1],F=O?O.index:t.length,U=t.substring(S.index,F);return[P-1,U]}));return e.split(`
`).map(function(S,R){var P=b.get(R);return"".concat(R+1+n,": ").concat(S).concat(P?`

^^^ `.concat(P):"")}).join(`
`)}var zt=/^[ \t]*\n/;function dr(e){var t=0;return zt.test(e)&&(t=1,e=e.replace(zt,"")),{lineOffset:t,shaderSource:e}}function Ft(e,t){return e.errorCallback(t),e.callback&&setTimeout(function(){e.callback("".concat(t,`
`).concat(e.errors.join(`
`)))}),null}function Dt(e,t,n,d){d=d||g;var b=e.getShaderParameter(n,cr);if(!b){var S=e.getShaderInfoLog(n),R=dr(e.getShaderSource(n)),P=R.lineOffset,O=R.shaderSource,F="".concat(jr(O,S,P),`
Error compiling `).concat(G.glEnumToString(e,t),": ").concat(S);return d(F),F}return""}function Kr(e,t,n){var d,b,S;if(typeof t=="function"&&(n=t,t=void 0),typeof e=="function")n=e,e=void 0;else if(e&&!Array.isArray(e)){var R=e;n=R.errorCallback,e=R.attribLocations,d=R.transformFeedbackVaryings,b=R.transformFeedbackMode,S=R.callback}var P=n||g,O=[],F={errorCallback:function(ye){O.push(ye);for(var be=arguments.length,Re=new Array(be>1?be-1:0),Me=1;Me<be;Me++)Re[Me-1]=arguments[Me];P.apply(void 0,[ye].concat(Re))},transformFeedbackVaryings:d,transformFeedbackMode:b,callback:S,errors:O};{var U={};Array.isArray(e)?e.forEach(function(oe,ye){U[oe]=t?t[ye]:ye}):U=e||{},F.attribLocations=U}return F}var Yr=["VERTEX_SHADER","FRAGMENT_SHADER"];function Rn(e,t){if(t.indexOf("frag")>=0)return vr;if(t.indexOf("vert")>=0)return Sr}function Cn(e,t,n){var d=e.getAttachedShaders(t),b=or(d),S;try{for(b.s();!(S=b.n()).done;){var R=S.value;n.has(R)&&e.deleteShader(R)}}catch(P){b.e(P)}finally{b.f()}e.deleteProgram(t)}var Fn=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new Promise(function(n){return setTimeout(n,t)})};function Dn(e,t,n){for(var d=e.createProgram(),b=Kr(n),S=b.attribLocations,R=b.transformFeedbackVaryings,P=b.transformFeedbackMode,O=0;O<t.length;++O){var F=t[O];if(typeof F=="string"){var U=ge(F),oe=U?U.text:F,ye=e[Yr[O]];U&&U.type&&(ye=Rn(e,U.type)||ye),F=e.createShader(ye),e.shaderSource(F,dr(oe).shaderSource),e.compileShader(F),e.attachShader(d,F)}}Object.entries(S).forEach(function(Re){var Me=ce(Re,2),Ie=Me[0],je=Me[1];return e.bindAttribLocation(d,je,Ie)});{var be=R;be&&(be.attribs&&(be=be.attribs),Array.isArray(be)||(be=Object.keys(be)),e.transformFeedbackVaryings(d,be,P||ue))}return e.linkProgram(d),d}function ht(e,t,n,d,b){var S=Kr(n,d,b),R=new Set(t),P=Dn(e,t,S);function O(F,U){var oe=Jt(F,U,S.errorCallback);return oe&&Cn(F,U,R),oe}if(S.callback){Qt(e,P).then(function(){var F=O(e,P);S.callback(F,F?void 0:P)});return}return O(e,P)?void 0:P}function qr(e){return function(t,n){for(var d=arguments.length,b=new Array(d>2?d-2:0),S=2;S<d;S++)b[S-2]=arguments[S];return new Promise(function(R,P){var O=Kr.apply(void 0,b);O.callback=function(F,U){F?P(F):R(U)},e(t,n,O)})}}o.createProgramAsync=qr(ht),o.createProgramInfoAsync=qr(l);function Qt(e,t){return Zt.apply(this,arguments)}function Zt(){return Zt=j(ve().mark(function e(t,n){var d,b,S;return ve().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:d=t.getExtension("KHR_parallel_shader_compile"),b=d?function(O,F){return O.getProgramParameter(F,d.COMPLETION_STATUS_KHR)}:function(){return!0},S=0;case 3:return P.next=5,Fn(S);case 5:S=16.666666666666668;case 6:if(!b(t,n)){P.next=3;break}case 7:case"end":return P.stop()}},e)})),Zt.apply(this,arguments)}function rt(e,t){return Bt.apply(this,arguments)}function Bt(){return Bt=j(ve().mark(function e(t,n){var d,b,S;return ve().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:d=0,b=Object.values(n);case 1:if(!(d<b.length)){P.next=8;break}return S=b[d],P.next=5,Qt(t,S);case 5:d++,P.next=1;break;case 8:case"end":return P.stop()}},e)})),Bt.apply(this,arguments)}function Jt(e,t,n){n=n||g;var d=e.getProgramParameter(t,ar);if(!d){var b=e.getProgramInfoLog(t);n("Error in program linking: ".concat(b));var S=e.getAttachedShaders(t),R=S.map(function(P){return Dt(e,e.getShaderParameter(P,e.SHADER_TYPE),P,n)});return"".concat(b,`
`).concat(R.filter(function(P){return P}).join(`
`))}}function $t(e,t,n,d,b){var S=Kr(n,d,b),R=[],P=or(t),O;try{for(P.s();!(O=P.n()).done;){var F=O.value,U=ge(F);if(!U)return Ft(S,"unknown script element: ".concat(F));R.push(U.text)}}catch(oe){P.e(oe)}finally{P.f()}return ht(e,R,S)}function en(e,t,n,d,b){return ht(e,t,n,d,b)}function rn(e){var t=e.name;return t.startsWith("gl_")||t.startsWith("webgl_")}var na=/(\.|\[|]|\w+)/g,aa=function(t){return t>="0"&&t<="9"};function mt(e,t,n,d){for(var b=e.split(na).filter(function(Re){return Re!==""}),S=0,R="";;){var P=b[S++];R+=P;var O=aa(P[0]),F=O?parseInt(P):P;O&&(R+=b[S++]);var U=S===b.length;if(U){n[F]=t;break}else{var oe=b[S++],ye=oe==="[",be=n[F]||(ye?[]:{});n[F]=be,n=be,d[R]=d[R]||function(Re){return function(Me){Ln(Re,Me)}}(be),R+=oe}}}function tt(e,t){var n=0;function d(ye,be,Re){var Me=be.name.endsWith("[0]"),Ie=be.type,je=Pe[Ie];if(!je)throw new Error("unknown type: 0x".concat(Ie.toString(16)));var qe;if(je.bindPoint){var ir=n;n+=be.size,Me?qe=je.arraySetter(e,Ie,ir,Re,be.size):qe=je.setter(e,Ie,ir,Re,be.size)}else je.arraySetter&&Me?qe=je.arraySetter(e,Re):qe=je.setter(e,Re);return qe.location=Re,qe}for(var b={},S={},R=e.getProgramParameter(t,r),P=0;P<R;++P){var O=e.getActiveUniform(t,P);if(!rn(O)){var F=O.name;F.endsWith("[0]")&&(F=F.substr(0,F.length-3));var U=e.getUniformLocation(t,O.name);if(U){var oe=d(t,O,U);b[F]=oe,mt(F,oe,S,b)}}}return b}function It(e,t){for(var n={},d=e.getProgramParameter(t,c),b=0;b<d;++b){var S=e.getTransformFeedbackVarying(t,b);n[S.name]={index:b,type:S.type,size:S.size}}return n}function Lt(e,t,n){t.transformFeedbackInfo&&(t=t.transformFeedbackInfo),n.attribs&&(n=n.attribs);for(var d in n){var b=t[d];if(b){var S=n[d];S.offset?e.bindBufferRange(fr,b.index,S.buffer,S.offset,S.size):e.bindBufferBase(fr,b.index,S.buffer)}}}function tn(e,t,n){var d=e.createTransformFeedback();return e.bindTransformFeedback(Tr,d),e.useProgram(t.program),Lt(e,t,n),e.bindTransformFeedback(Tr,null),d}function zr(e,t){for(var n=e.getProgramParameter(t,r),d=[],b=[],S=0;S<n;++S){b.push(S),d.push({});var R=e.getActiveUniform(t,S);d[S].name=R.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(ye){var be=ye[0],Re=ye[1];e.getActiveUniforms(t,b,e[be]).forEach(function(Me,Ie){d[Ie][Re]=Me})});for(var P={},O=e.getProgramParameter(t,E),F=0;F<O;++F){var U=e.getActiveUniformBlockName(t,F),oe={index:e.getUniformBlockIndex(t,U),usedByVertexShader:e.getActiveUniformBlockParameter(t,F,s),usedByFragmentShader:e.getActiveUniformBlockParameter(t,F,i),size:e.getActiveUniformBlockParameter(t,F,a),uniformIndices:e.getActiveUniformBlockParameter(t,F,m)};oe.used=oe.usedByVertexShader||oe.usedByFragmentShader,P[U]=oe}return{blockSpecs:P,uniformData:d}}var Bn=/\[\d+\]\.$/,ia=function(t,n){return((t+(n-1))/n|0)*n};function oa(e,t,n,d){if(t||n){d=d||1;var b=e.length,S=b/4;return function(R){for(var P=0,O=0,F=0;F<S;++F){for(var U=0;U<d;++U)e[P++]=R[O++];P+=4-d}}}else return function(R){R.length?e.set(R):e[0]=R}}function nn(e,t,n,d){var b=n.blockSpecs,S=n.uniformData,R=b[d];if(!R)return de("no uniform block object named:",d),{name:d,uniforms:{}};var P=new ArrayBuffer(R.size),O=e.createBuffer(),F=R.index;e.bindBuffer(Ke,O),e.uniformBlockBinding(t,R.index,F);var U=d+".";Bn.test(U)&&(U=U.replace(Bn,"."));var oe={},ye={},be={};return R.uniformIndices.forEach(function(Re){var Me=S[Re],Ie=Me.name;Ie.startsWith(U)&&(Ie=Ie.substr(U.length));var je=Ie.endsWith("[0]");je&&(Ie=Ie.substr(0,Ie.length-3));var qe=Pe[Me.type],ir=qe.Type,mr=je?ia(qe.size,16)*Me.size:qe.size*Me.size,Pr=new ir(P,Me.offset,mr/ir.BYTES_PER_ELEMENT);oe[Ie]=Pr;var Or=oa(Pr,je,qe.rows,qe.cols);ye[Ie]=Or,mt(Ie,Or,be,ye)}),{name:d,array:P,asFloat:new Float32Array(P),buffer:O,uniforms:oe,setters:ye}}function an(e,t,n){return nn(e,t.program,t.uniformBlockSpec,n)}function Ot(e,t,n){var d=t.uniformBlockSpec||t,b=d.blockSpecs[n.name];if(b){var S=b.index;return e.bindBufferRange(Ke,S,n.buffer,n.offset||0,n.array.byteLength),!0}return!1}function In(e,t,n){Ot(e,t,n)&&e.bufferData(Ke,n.array,We)}function ua(e,t){var n=e.setters;for(var d in t){var b=n[d];if(b){var S=t[d];b(S)}}}function Ln(e,t){for(var n in t){var d=e[n];typeof d=="function"?d(t[n]):Ln(e[n],t[n])}}function Mt(e){for(var t=e.uniformSetters||e,n=arguments.length<=1?0:arguments.length-1,d=0;d<n;++d){var b=d+1<1||arguments.length<=d+1?void 0:arguments[d+1];if(Array.isArray(b))for(var S=b.length,R=0;R<S;++R)Mt(t,b[R]);else for(var P in b){var O=t[P];O&&O(b[P])}}}o.setUniformsAndBindTextures=Mt;function on(e,t){for(var n={},d=e.getProgramParameter(t,u),b=0;b<d;++b){var S=e.getActiveAttrib(t,b);if(!rn(S)){var R=e.getAttribLocation(t,S.name),P=rr[S.type],O=P.setter(e,R,P);O.location=R,n[S.name]=O}}return n}function un(e,t){for(var n in t){var d=e[n];d&&d(t[n])}}function fa(e,t,n){n.vertexArrayObject?e.bindVertexArray(n.vertexArrayObject):(un(t.attribSetters||t,n.attribs),n.indices&&e.bindBuffer(Ze,n.indices))}function Nt(e,t){var n=tt(e,t),d=on(e,t),b={program:t,uniformSetters:n,attribSetters:d};return G.isWebGL2(e)&&(b.uniformBlockSpec=zr(e,t),b.transformFeedbackInfo=It(e,t)),b}var ca=/\s|{|}|;/;function l(e,t,n,d,b){var S=Kr(n,d,b),R=[];if(t=t.map(function(F){if(!ca.test(F)){var U=ge(F);if(U)F=U.text;else{var oe="no element with id: ".concat(F);S.errorCallback(oe),R.push(oe)}}return F}),R.length)return Ft(S,"");var P=S.callback;P&&(S.callback=function(F,U){P(F,F?void 0:Nt(e,U))});var O=en(e,t,S);return O?Nt(e,O):null}function y(e,t,n,d,b){for(var S=0,R=Object.entries(t);S<R.length;S++){var P=ce(R[S],2),O=P[0],F=P[1],U=Se({},b),oe=n[O];Array.isArray(oe)||Object.assign(U,oe);var ye=Jt(e,F,U.errorCallback);if(ye){for(var be=0,Re=Object.values(t);be<Re.length;be++){var Me=Re[be],Ie=e.getAttachedShaders(Me);e.deleteProgram(Me);var je=or(Ie),qe;try{for(je.s();!(qe=je.n()).done;){var ir=qe.value;d.has(ir)||e.deleteShader(ir)}}catch(mr){je.e(mr)}finally{je.f()}}return ye}}}function p(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},d=new Set,b=Object.fromEntries(Object.entries(t).map(function(R){var P=ce(R,2),O=P[0],F=P[1],U=Se({},n),oe=Array.isArray(F)?F:F.shaders;return Array.isArray(F)||Object.assign(U,F),oe.forEach(d.add,d),[O,Dn(e,oe,U)]}));if(n.callback){rt(e,b).then(function(){var R=y(e,b,t,d,n);n.callback(R,R?void 0:b)});return}var S=y(e,b,t,d,n);return S?void 0:b}function A(e,t,n){n=Kr(n);function d(R,P){return Object.fromEntries(Object.entries(P).map(function(O){var F=ce(O,2),U=F[0],oe=F[1];return[U,Nt(R,oe)]}))}var b=n.callback;b&&(n.callback=function(R,P){b(R,R?void 0:d(e,P))});var S=p(e,t,n);if(!(b||!S))return d(e,S)}o.createProgramsAsync=qr(p),o.createProgramInfosAsync=qr(A)},"./src/textures.js":(ie,o,Y)=>{function $(l){"@babel/helpers - typeof";return $=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},$(l)}o.__esModule=!0,o.canFilter=Fn,o.canGenerateMipmap=Cn,o.createSampler=rn,o.createSamplers=na,o.createTexture=un,o.createTextures=ca,o.getBytesPerElementForInternalFormat=Kr,o.getFormatAndTypeForInternalFormat=Yr,o.getNumComponentsForFormat=Dn,o.loadTextureFromUrl=In,o.resizeTexture=fa,o.setDefaultTextureColor=Qt,o.setEmptyTexture=on,o.setSamplerParameters=en,o.setTextureDefaults_=Zt,o.setTextureFilteringForSize=mt,o.setTextureFromArray=Mt,o.setTextureFromElement=tn,o.setTextureParameters=$t;var G=ve(Y("./src/utils.js")),he=ve(Y("./src/typedarrays.js")),te=ve(Y("./src/helper.js"));function W(l){if(typeof WeakMap!="function")return null;var y=new WeakMap,p=new WeakMap;return(W=function(e){return e?p:y})(l)}function ve(l,y){if(!y&&l&&l.__esModule)return l;if(l===null||$(l)!="object"&&typeof l!="function")return{default:l};var p=W(y);if(p&&p.has(l))return p.get(l);var A={__proto__:null},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var t in l)if(t!=="default"&&Object.prototype.hasOwnProperty.call(l,t)){var n=e?Object.getOwnPropertyDescriptor(l,t):null;n&&(n.get||n.set)?Object.defineProperty(A,t,n):A[t]=l[t]}return A.default=l,p&&p.set(l,A),A}var re={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},Se=he.isArrayBuffer,C=function(){var l;return function(){return l=l||(typeof document<"u"&&document.createElement?document.createElement("canvas").getContext("2d"):null),l}}(),q=6406,K=6407,x=6408,j=6409,ce=6410,Ee=6402,Ge=34041,xe=33071,or=9728,ur=9729,er=3553,me=34067,w=32879,B=35866,N=34069,g=34070,de=34071,ge=34072,Fe=34073,We=34074,Ue=10241,Ze=10240,Ke=10242,fr=10243,Tr=32882,cr=33082,ar=33083,vr=33084,Sr=33085,ue=34892,r=34893,u=3317,c=3314,E=32878,s=3316,i=3315,a=32877,m=37443,h=37441,T=37440,_=33321,I=36756,L=33325,X=33326,z=33330,Z=33329,ae=33338,ne=33337,le=33340,se=33339,ee=33323,pe=36757,Oe=33327,Ye=33328,ke=33336,Ve=33335,_e=33332,De=33331,Qe=33334,Xe=33333,ze=32849,He=35905,Je=36194,Be=36758,Ne=35898,yr=35901,lr=34843,Ar=34837,_r=36221,Lr=36239,Ur=36215,Gr=36233,$r=36209,St=36227,At=32856,gt=35907,hr=36759,Qn=32855,_t=32854,Pt=32857,Yt=34842,wt=34836,Pe=36220,En=36238,Zn=36975,Jn=36214,$n=36232,ea=36226,ra=36208,Tn=33189,Sn=33190,An=36012,gn=36013,_n=35056,kr=5120,tr=5121,xt=5122,et=5123,Rt=5124,Wr=5125,pr=5126,Pn=32819,wn=32820,xn=33635,Cr=5131,vt=36193,qt=33640,ta=35899,br=35902,Er=36269,Ct=34042,xr=33319,Dr=33320,Xr=6403,rr=36244,Hr=36248,jr=36249,zt={};{var dr=zt;dr[q]={numColorComponents:1},dr[j]={numColorComponents:1},dr[ce]={numColorComponents:2},dr[K]={numColorComponents:3},dr[x]={numColorComponents:4},dr[Xr]={numColorComponents:1},dr[rr]={numColorComponents:1},dr[xr]={numColorComponents:2},dr[Dr]={numColorComponents:2},dr[K]={numColorComponents:3},dr[Hr]={numColorComponents:3},dr[x]={numColorComponents:4},dr[jr]={numColorComponents:4},dr[Ee]={numColorComponents:1},dr[Ge]={numColorComponents:2}}var Ft;function Dt(l){if(!Ft){var y={};y[q]={textureFormat:q,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[tr,Cr,vt,pr]},y[j]={textureFormat:j,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[tr,Cr,vt,pr]},y[ce]={textureFormat:ce,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[tr,Cr,vt,pr]},y[K]={textureFormat:K,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[tr,Cr,vt,pr,xn]},y[x]={textureFormat:x,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[tr,Cr,vt,pr,Pn,wn]},y[Ee]={textureFormat:Ee,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[Wr,et]},y[_]={textureFormat:Xr,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[tr]},y[I]={textureFormat:Xr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[kr]},y[L]={textureFormat:Xr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[pr,Cr]},y[X]={textureFormat:Xr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[pr]},y[z]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[tr]},y[Z]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[kr]},y[_e]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[et]},y[De]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[xt]},y[Qe]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Wr]},y[Xe]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Rt]},y[ee]={textureFormat:xr,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[tr]},y[pe]={textureFormat:xr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[kr]},y[Oe]={textureFormat:xr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[pr,Cr]},y[Ye]={textureFormat:xr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[pr]},y[ke]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[tr]},y[Ve]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[kr]},y[ae]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[et]},y[ne]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[xt]},y[le]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Wr]},y[se]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Rt]},y[ze]={textureFormat:K,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[tr]},y[He]={textureFormat:K,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[tr]},y[Je]={textureFormat:K,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[tr,xn]},y[Be]={textureFormat:K,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[kr]},y[Ne]={textureFormat:K,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[pr,Cr,ta]},y[yr]={textureFormat:K,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[pr,Cr,br]},y[lr]={textureFormat:K,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[pr,Cr]},y[Ar]={textureFormat:K,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[pr]},y[_r]={textureFormat:Hr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[tr]},y[Lr]={textureFormat:Hr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[kr]},y[Ur]={textureFormat:Hr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[et]},y[Gr]={textureFormat:Hr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[xt]},y[$r]={textureFormat:Hr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[Wr]},y[St]={textureFormat:Hr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[Rt]},y[At]={textureFormat:x,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[tr]},y[gt]={textureFormat:x,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[tr]},y[hr]={textureFormat:x,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[kr]},y[Qn]={textureFormat:x,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[tr,wn,qt]},y[_t]={textureFormat:x,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[tr,Pn]},y[Pt]={textureFormat:x,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[qt]},y[Yt]={textureFormat:x,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[pr,Cr]},y[wt]={textureFormat:x,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[pr]},y[Pe]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[tr]},y[En]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[kr]},y[Zn]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[qt]},y[Jn]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[et]},y[$n]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[xt]},y[ea]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[Rt]},y[ra]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[Wr]},y[Tn]={textureFormat:Ee,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[et,Wr]},y[Sn]={textureFormat:Ee,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Wr]},y[An]={textureFormat:Ee,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[pr]},y[_n]={textureFormat:Ge,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Ct]},y[gn]={textureFormat:Ge,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Er]},Object.keys(y).forEach(function(p){var A=y[p];A.bytesPerElementMap={},A.bytesPerElement.forEach(function(e,t){var n=A.type[t];A.bytesPerElementMap[n]=e})}),Ft=y}return Ft[l]}function Kr(l,y){var p=Dt(l);if(!p)throw"unknown internal format";var A=p.bytesPerElementMap[y];if(A===void 0)throw"unknown internal format";return A}function Yr(l){var y=Dt(l);if(!y)throw"unknown internal format";return{format:y.textureFormat,type:y.type[0]}}function Rn(l){return(l&l-1)===0}function Cn(l,y,p,A){if(!G.isWebGL2(l))return Rn(y)&&Rn(p);var e=Dt(A);if(!e)throw"unknown internal format";return e.colorRenderable&&e.textureFilterable}function Fn(l){var y=Dt(l);if(!y)throw"unknown internal format";return y.textureFilterable}function Dn(l){var y=zt[l];if(!y)throw"unknown format: "+l;return y.numColorComponents}function ht(l,y,p){return Se(y)?he.getGLTypeForTypedArray(y):p||tr}function qr(l,y,p,A,e){if(e%1!==0)throw"can't guess dimensions";if(!p&&!A){var t=Math.sqrt(e/(y===me?6:1));t%1===0?(p=t,A=t):(p=e,A=1)}else if(A){if(!p&&(p=e/A,p%1))throw"can't guess dimensions"}else if(A=e/p,A%1)throw"can't guess dimensions";return{width:p,height:A}}function Qt(l){re.textureColor=new Uint8Array([l[0]*255,l[1]*255,l[2]*255,l[3]*255])}function Zt(l){te.copyExistingProperties(l,re),l.textureColor&&Qt(l.textureColor)}function rt(l,y){y.colorspaceConversion!==void 0&&l.pixelStorei(m,y.colorspaceConversion),y.premultiplyAlpha!==void 0&&l.pixelStorei(h,y.premultiplyAlpha),y.flipY!==void 0&&l.pixelStorei(T,y.flipY)}function Bt(l){l.pixelStorei(u,4),G.isWebGL2(l)&&(l.pixelStorei(c,0),l.pixelStorei(E,0),l.pixelStorei(s,0),l.pixelStorei(i,0),l.pixelStorei(a,0))}function Jt(l,y,p,A){A.minMag&&(p.call(l,y,Ue,A.minMag),p.call(l,y,Ze,A.minMag)),A.min&&p.call(l,y,Ue,A.min),A.mag&&p.call(l,y,Ze,A.mag),A.wrap&&(p.call(l,y,Ke,A.wrap),p.call(l,y,fr,A.wrap),(y===w||te.isSampler(l,y))&&p.call(l,y,Tr,A.wrap)),A.wrapR&&p.call(l,y,Tr,A.wrapR),A.wrapS&&p.call(l,y,Ke,A.wrapS),A.wrapT&&p.call(l,y,fr,A.wrapT),A.minLod!==void 0&&p.call(l,y,cr,A.minLod),A.maxLod!==void 0&&p.call(l,y,ar,A.maxLod),A.baseLevel!==void 0&&p.call(l,y,vr,A.baseLevel),A.maxLevel!==void 0&&p.call(l,y,Sr,A.maxLevel),A.compareFunc!==void 0&&p.call(l,y,r,A.compareFunc),A.compareMode!==void 0&&p.call(l,y,ue,A.compareMode)}function $t(l,y,p){var A=p.target||er;l.bindTexture(A,y),Jt(l,A,l.texParameteri,p)}function en(l,y,p){Jt(l,y,l.samplerParameteri,p)}function rn(l,y){var p=l.createSampler();return en(l,p,y),p}function na(l,y){var p={};return Object.keys(y).forEach(function(A){p[A]=rn(l,y[A])}),p}function aa(l){return l=l||re.textureColor,Se(l)?l:new Uint8Array([l[0]*255,l[1]*255,l[2]*255,l[3]*255])}function mt(l,y,p,A,e,t){p=p||re.textureOptions,t=t||x;var n=p.target||er;if(A=A||p.width,e=e||p.height,l.bindTexture(n,y),Cn(l,A,e,t))l.generateMipmap(n);else{var d=Fn(t)?ur:or;l.texParameteri(n,Ue,d),l.texParameteri(n,Ze,d),l.texParameteri(n,Ke,xe),l.texParameteri(n,fr,xe)}}function tt(l){return l.auto===!0||l.auto===void 0&&l.level===void 0}function It(l,y){return y=y||{},y.cubeFaceOrder||[N,g,de,ge,Fe,We]}function Lt(l,y){var p=It(l,y),A=p.map(function(e,t){return{face:e,ndx:t}});return A.sort(function(e,t){return e.face-t.face}),A}function tn(l,y,p,A){A=A||re.textureOptions;var e=A.target||er,t=A.level||0,n=p.width,d=p.height,b=A.internalFormat||A.format||x,S=Yr(b),R=A.format||S.format,P=A.type||S.type;if(rt(l,A),l.bindTexture(e,y),e===me){var O=p.width,F=p.height,U,oe;if(O/6===F)U=F,oe=[0,0,1,0,2,0,3,0,4,0,5,0];else if(F/6===O)U=O,oe=[0,0,0,1,0,2,0,3,0,4,0,5];else if(O/3===F/2)U=O/3,oe=[0,0,1,0,2,0,0,1,1,1,2,1];else if(O/2===F/3)U=O/2,oe=[0,0,1,0,0,1,1,1,0,2,1,2];else throw"can't figure out cube map from element: "+(p.src?p.src:p.nodeName);var ye=C();ye?(ye.canvas.width=U,ye.canvas.height=U,n=U,d=U,Lt(l,A).forEach(function(Pr){var Or=oe[Pr.ndx*2+0]*U,Vr=oe[Pr.ndx*2+1]*U;ye.drawImage(p,Or,Vr,U,U,0,0,U,U),l.texImage2D(Pr.face,t,b,R,P,ye.canvas)}),ye.canvas.width=1,ye.canvas.height=1):typeof createImageBitmap<"u"&&(n=U,d=U,Lt(l,A).forEach(function(Pr){var Or=oe[Pr.ndx*2+0]*U,Vr=oe[Pr.ndx*2+1]*U;l.texImage2D(Pr.face,t,b,U,U,0,R,P,null),createImageBitmap(p,Or,Vr,U,U,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(function(On){rt(l,A),l.bindTexture(e,y),l.texImage2D(Pr.face,t,b,R,P,On),tt(A)&&mt(l,y,A,n,d,b)})}))}else if(e===w||e===B){var be=Math.min(p.width,p.height),Re=Math.max(p.width,p.height),Me=Re/be;if(Me%1!==0)throw"can not compute 3D dimensions of element";var Ie=p.width===Re?1:0,je=p.height===Re?1:0;l.pixelStorei(u,1),l.pixelStorei(c,p.width),l.pixelStorei(E,0),l.pixelStorei(a,0),l.texImage3D(e,t,b,be,be,be,0,R,P,null);for(var qe=0;qe<Me;++qe){var ir=qe*be*Ie,mr=qe*be*je;l.pixelStorei(s,ir),l.pixelStorei(i,mr),l.texSubImage3D(e,t,0,0,qe,be,be,1,R,P,p)}Bt(l)}else l.texImage2D(e,t,b,R,P,p);tt(A)&&mt(l,y,A,n,d,b),$t(l,y,A)}function zr(){}function Bn(l){if(typeof document<"u"){var y=document.createElement("a");return y.href=l,y.hostname===location.hostname&&y.port===location.port&&y.protocol===location.protocol}else{var p=new URL(location.href).origin,A=new URL(l,location.href).origin;return A===p}}function ia(l,y){return y===void 0&&!Bn(l)?"anonymous":y}function oa(l,y,p){p=p||zr;var A;if(y=y!==void 0?y:re.crossOrigin,y=ia(l,y),typeof Image<"u"){A=new Image,y!==void 0&&(A.crossOrigin=y);var e=function(){A.removeEventListener("error",t),A.removeEventListener("load",n),A=null},t=function(){var O="couldn't load image: "+l;te.error(O),p(O,A),e()},n=function(){p(null,A),e()};return A.addEventListener("error",t),A.addEventListener("load",n),A.src=l,A}else if(typeof ImageBitmap<"u"){var d,b,S=function(){p(d,b)},R={};y&&(R.mode="cors"),fetch(l,R).then(function(P){if(!P.ok)throw P;return P.blob()}).then(function(P){return createImageBitmap(P,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}).then(function(P){b=P,setTimeout(S)}).catch(function(P){d=P,setTimeout(S)}),A=null}return A}function nn(l){return typeof ImageBitmap<"u"&&l instanceof ImageBitmap||typeof ImageData<"u"&&l instanceof ImageData||typeof HTMLElement<"u"&&l instanceof HTMLElement}function an(l,y,p){return nn(l)?(setTimeout(function(){p(null,l)}),l):oa(l,y,p)}function Ot(l,y,p){p=p||re.textureOptions;var A=p.target||er;if(l.bindTexture(A,y),p.color!==!1){var e=aa(p.color);if(A===me)for(var t=0;t<6;++t)l.texImage2D(N+t,0,x,1,1,0,x,tr,e);else A===w||A===B?l.texImage3D(A,0,x,1,1,1,0,x,tr,e):l.texImage2D(A,0,x,1,1,0,x,tr,e)}}function In(l,y,p,A){A=A||zr,p=p||re.textureOptions,Ot(l,y,p),p=Object.assign({},p);var e=an(p.src,p.crossOrigin,function(t,n){t?A(t,y,n):(tn(l,y,n,p),A(null,y,n))});return e}function ua(l,y,p,A){A=A||zr;var e=p.src;if(e.length!==6)throw"there must be 6 urls for a cubemap";var t=p.level||0,n=p.internalFormat||p.format||x,d=Yr(n),b=p.format||d.format,S=p.type||tr,R=p.target||er;if(R!==me)throw"target must be TEXTURE_CUBE_MAP";Ot(l,y,p),p=Object.assign({},p);var P=6,O=[],F=It(l,p),U;function oe(ye){return function(be,Re){--P,be?O.push(be):Re.width!==Re.height?O.push("cubemap face img is not a square: "+Re.src):(rt(l,p),l.bindTexture(R,y),P===5?It().forEach(function(Me){l.texImage2D(Me,t,n,b,S,Re)}):l.texImage2D(ye,t,n,b,S,Re),tt(p)&&l.generateMipmap(R)),P===0&&A(O.length?O:void 0,y,U)}}U=e.map(function(ye,be){return an(ye,p.crossOrigin,oe(F[be]))})}function Ln(l,y,p,A){A=A||zr;var e=p.src,t=p.internalFormat||p.format||x,n=Yr(t),d=p.format||n.format,b=p.type||tr,S=p.target||B;if(S!==w&&S!==B)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";Ot(l,y,p),p=Object.assign({},p);var R=e.length,P=[],O,F=p.level||0,U=p.width,oe=p.height,ye=e.length,be=!0;function Re(Me){return function(Ie,je){if(--R,Ie)P.push(Ie);else{if(rt(l,p),l.bindTexture(S,y),be){be=!1,U=p.width||je.width,oe=p.height||je.height,l.texImage3D(S,F,t,U,oe,ye,0,d,b,null);for(var qe=0;qe<ye;++qe)l.texSubImage3D(S,F,0,0,qe,U,oe,1,d,b,je)}else{var ir=je,mr;(je.width!==U||je.height!==oe)&&(mr=C(),ir=mr.canvas,mr.canvas.width=U,mr.canvas.height=oe,mr.drawImage(je,0,0,U,oe)),l.texSubImage3D(S,F,0,0,Me,U,oe,1,d,b,ir),mr&&ir===mr.canvas&&(mr.canvas.width=0,mr.canvas.height=0)}tt(p)&&l.generateMipmap(S)}R===0&&A(P.length?P:void 0,y,O)}}O=e.map(function(Me,Ie){return an(Me,p.crossOrigin,Re(Ie))})}function Mt(l,y,p,A){A=A||re.textureOptions;var e=A.target||er;l.bindTexture(e,y);var t=A.width,n=A.height,d=A.depth,b=A.level||0,S=A.internalFormat||A.format||x,R=Yr(S),P=A.format||R.format,O=A.type||ht(l,p,R.type);if(Se(p))p instanceof Uint8ClampedArray&&(p=new Uint8Array(p.buffer));else{var F=he.getTypedArrayTypeForGLType(O);p=new F(p)}var U=Kr(S,O),oe=p.byteLength/U;if(oe%1)throw"length wrong size for format: "+G.glEnumToString(l,P);var ye;if(e===w||e===B)if(!t&&!n&&!d){var be=Math.cbrt(oe);if(be%1!==0)throw"can't guess cube size of array of numElements: "+oe;t=be,n=be,d=be}else t&&(!n||!d)?(ye=qr(l,e,n,d,oe/t),n=ye.width,d=ye.height):n&&(!t||!d)?(ye=qr(l,e,t,d,oe/n),t=ye.width,d=ye.height):(ye=qr(l,e,t,n,oe/d),t=ye.width,n=ye.height);else ye=qr(l,e,t,n,oe),t=ye.width,n=ye.height;if(Bt(l),l.pixelStorei(u,A.unpackAlignment||1),rt(l,A),e===me){var Re=U/p.BYTES_PER_ELEMENT,Me=oe/6*Re;Lt(l,A).forEach(function(Ie){var je=Me*Ie.ndx,qe=p.subarray(je,je+Me);l.texImage2D(Ie.face,b,S,t,n,0,P,O,qe)})}else e===w||e===B?l.texImage3D(e,b,S,t,n,d,0,P,O,p):l.texImage2D(e,b,S,t,n,0,P,O,p);return{width:t,height:n,depth:d,type:O}}function on(l,y,p){var A=p.target||er;l.bindTexture(A,y);var e=p.level||0,t=p.internalFormat||p.format||x,n=Yr(t),d=p.format||n.format,b=p.type||n.type;if(rt(l,p),A===me)for(var S=0;S<6;++S)l.texImage2D(N+S,e,t,p.width,p.height,0,d,b,null);else A===w||A===B?l.texImage3D(A,e,t,p.width,p.height,p.depth,0,d,b,null):l.texImage2D(A,e,t,p.width,p.height,0,d,b,null)}function un(l,y,p){p=p||zr,y=y||re.textureOptions;var A=l.createTexture(),e=y.target||er,t=y.width||1,n=y.height||1,d=y.internalFormat||x;l.bindTexture(e,A),e===me&&(l.texParameteri(e,Ke,xe),l.texParameteri(e,fr,xe));var b=y.src;if(b)if(typeof b=="function"&&(b=b(l,y)),typeof b=="string")In(l,A,y,p);else if(Se(b)||Array.isArray(b)&&(typeof b[0]=="number"||Array.isArray(b[0])||Se(b[0]))){var S=Mt(l,A,b,y);t=S.width,n=S.height}else Array.isArray(b)&&(typeof b[0]=="string"||nn(b[0]))?e===me?ua(l,A,y,p):Ln(l,A,y,p):(tn(l,A,b,y),t=b.width,n=b.height);else on(l,A,y);return tt(y)&&mt(l,A,y,t,n,d),$t(l,A,y),A}function fa(l,y,p,A,e,t){A=A||p.width,e=e||p.height,t=t||p.depth;var n=p.target||er;l.bindTexture(n,y);var d=p.level||0,b=p.internalFormat||p.format||x,S=Yr(b),R=p.format||S.format,P,O=p.src;if(O&&(Se(O)||Array.isArray(O)&&typeof O[0]=="number")?P=p.type||ht(l,O,S.type):P=p.type||S.type,n===me)for(var F=0;F<6;++F)l.texImage2D(N+F,d,b,A,e,0,R,P,null);else n===w||n===B?l.texImage3D(n,d,b,A,e,t,0,R,P,null):l.texImage2D(n,d,b,A,e,0,R,P,null)}function Nt(l){return typeof l=="string"||Array.isArray(l)&&typeof l[0]=="string"}function ca(l,y,p){p=p||zr;var A=0,e=[],t={},n={};function d(){A===0&&setTimeout(function(){p(e.length?e:void 0,t,n)},0)}return Object.keys(y).forEach(function(b){var S=y[b],R;Nt(S.src)&&(R=function(O,F,U){n[b]=U,--A,O&&e.push(O),d()},++A),t[b]=un(l,S,R)}),d(),t}},"./src/twgl-full.js":(ie,o,Y)=>{function $(C){"@babel/helpers - typeof";return $=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(q){return typeof q}:function(q){return q&&typeof Symbol=="function"&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q},$(C)}o.__esModule=!0;var G={m4:!0,v3:!0,primitives:!0};o.v3=o.primitives=o.m4=void 0;var he=Se(Y("./src/m4.js"));o.m4=he;var te=Se(Y("./src/v3.js"));o.v3=te;var W=Se(Y("./src/primitives.js"));o.primitives=W;var ve=Y("./src/twgl.js");Object.keys(ve).forEach(function(C){C==="default"||C==="__esModule"||Object.prototype.hasOwnProperty.call(G,C)||C in o&&o[C]===ve[C]||(o[C]=ve[C])});function re(C){if(typeof WeakMap!="function")return null;var q=new WeakMap,K=new WeakMap;return(re=function(j){return j?K:q})(C)}function Se(C,q){if(!q&&C&&C.__esModule)return C;if(C===null||$(C)!="object"&&typeof C!="function")return{default:C};var K=re(q);if(K&&K.has(C))return K.get(C);var x={__proto__:null},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ce in C)if(ce!=="default"&&Object.prototype.hasOwnProperty.call(C,ce)){var Ee=j?Object.getOwnPropertyDescriptor(C,ce):null;Ee&&(Ee.get||Ee.set)?Object.defineProperty(x,ce,Ee):x[ce]=C[ce]}return x.default=C,K&&K.set(C,x),x}},"./src/twgl.js":(ie,o,Y)=>{function $(g){"@babel/helpers - typeof";return $=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(de){return typeof de}:function(de){return de&&typeof Symbol=="function"&&de.constructor===Symbol&&de!==Symbol.prototype?"symbol":typeof de},$(g)}o.__esModule=!0;var G={addExtensionsToContext:!0,getContext:!0,getWebGLContext:!0,resizeCanvasToDisplaySize:!0,setDefaults:!0,attributes:!0,textures:!0,utils:!0,draw:!0,framebuffers:!0,programs:!0,typedarrays:!0,vertexArrays:!0};o.addExtensionsToContext=ur,o.framebuffers=o.draw=o.attributes=void 0,o.getContext=B,o.getWebGLContext=me,o.programs=void 0,o.resizeCanvasToDisplaySize=N,o.setDefaults=Ee,o.vertexArrays=o.utils=o.typedarrays=o.textures=void 0;var he=j(Y("./src/attributes.js"));o.attributes=he,Object.keys(he).forEach(function(g){g==="default"||g==="__esModule"||Object.prototype.hasOwnProperty.call(G,g)||g in o&&o[g]===he[g]||(o[g]=he[g])});var te=j(Y("./src/textures.js"));o.textures=te,Object.keys(te).forEach(function(g){g==="default"||g==="__esModule"||Object.prototype.hasOwnProperty.call(G,g)||g in o&&o[g]===te[g]||(o[g]=te[g])});var W=j(Y("./src/helper.js")),ve=j(Y("./src/utils.js"));o.utils=ve,Object.keys(ve).forEach(function(g){g==="default"||g==="__esModule"||Object.prototype.hasOwnProperty.call(G,g)||g in o&&o[g]===ve[g]||(o[g]=ve[g])});var re=j(Y("./src/draw.js"));o.draw=re,Object.keys(re).forEach(function(g){g==="default"||g==="__esModule"||Object.prototype.hasOwnProperty.call(G,g)||g in o&&o[g]===re[g]||(o[g]=re[g])});var Se=j(Y("./src/framebuffers.js"));o.framebuffers=Se,Object.keys(Se).forEach(function(g){g==="default"||g==="__esModule"||Object.prototype.hasOwnProperty.call(G,g)||g in o&&o[g]===Se[g]||(o[g]=Se[g])});var C=j(Y("./src/programs.js"));o.programs=C,Object.keys(C).forEach(function(g){g==="default"||g==="__esModule"||Object.prototype.hasOwnProperty.call(G,g)||g in o&&o[g]===C[g]||(o[g]=C[g])});var q=j(Y("./src/typedarrays.js"));o.typedarrays=q,Object.keys(q).forEach(function(g){g==="default"||g==="__esModule"||Object.prototype.hasOwnProperty.call(G,g)||g in o&&o[g]===q[g]||(o[g]=q[g])});var K=j(Y("./src/vertex-arrays.js"));o.vertexArrays=K,Object.keys(K).forEach(function(g){g==="default"||g==="__esModule"||Object.prototype.hasOwnProperty.call(G,g)||g in o&&o[g]===K[g]||(o[g]=K[g])});function x(g){if(typeof WeakMap!="function")return null;var de=new WeakMap,ge=new WeakMap;return(x=function(We){return We?ge:de})(g)}function j(g,de){if(!de&&g&&g.__esModule)return g;if(g===null||$(g)!="object"&&typeof g!="function")return{default:g};var ge=x(de);if(ge&&ge.has(g))return ge.get(g);var Fe={__proto__:null},We=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Ue in g)if(Ue!=="default"&&Object.prototype.hasOwnProperty.call(g,Ue)){var Ze=We?Object.getOwnPropertyDescriptor(g,Ue):null;Ze&&(Ze.get||Ze.set)?Object.defineProperty(Fe,Ue,Ze):Fe[Ue]=g[Ue]}return Fe.default=g,ge&&ge.set(g,Fe),Fe}var ce={addExtensionsToContext:!0};function Ee(g){W.copyExistingProperties(g,ce),he.setAttributeDefaults_(g),te.setTextureDefaults_(g)}var Ge=/^(.*?)_/;function xe(g,de){ve.glEnumToString(g,0);var ge=g.getExtension(de);if(ge){var Fe={},We=Ge.exec(de)[1],Ue="_"+We;for(var Ze in ge){var Ke=ge[Ze],fr=typeof Ke=="function",Tr=fr?We:Ue,cr=Ze;Ze.endsWith(Tr)&&(cr=Ze.substring(0,Ze.length-Tr.length)),g[cr]!==void 0?!fr&&g[cr]!==Ke&&W.warn(cr,g[cr],Ke,Ze):fr?g[cr]=function(ar){return function(){return ar.apply(ge,arguments)}}(Ke):(g[cr]=Ke,Fe[cr]=Ke)}Fe.constructor={name:ge.constructor.name},ve.glEnumToString(Fe,0)}return ge}var or=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_depth_texture","WEBGL_draw_buffers"];function ur(g){for(var de=0;de<or.length;++de)xe(g,or[de])}function er(g,de){for(var ge=["webgl","experimental-webgl"],Fe=null,We=0;We<ge.length;++We)if(Fe=g.getContext(ge[We],de),Fe){ce.addExtensionsToContext&&ur(Fe);break}return Fe}function me(g,de){var ge=er(g,de);return ge}function w(g,de){for(var ge=["webgl2","webgl","experimental-webgl"],Fe=null,We=0;We<ge.length;++We)if(Fe=g.getContext(ge[We],de),Fe){ce.addExtensionsToContext&&ur(Fe);break}return Fe}function B(g,de){var ge=w(g,de);return ge}function N(g,de){de=de||1,de=Math.max(0,de);var ge=g.clientWidth*de|0,Fe=g.clientHeight*de|0;return g.width!==ge||g.height!==Fe?(g.width=ge,g.height=Fe,!0):!1}},"./src/typedarrays.js":(ie,o)=>{o.__esModule=!0,o.getGLTypeForTypedArray=or,o.getGLTypeForTypedArrayType=ur,o.getTypedArrayTypeForGLType=er,o.isArrayBuffer=void 0;var Y=5120,$=5121,G=5122,he=5123,te=5124,W=5125,ve=5126,re=32819,Se=32820,C=33635,q=5131,K=33640,x=35899,j=35902,ce=36269,Ee=34042,Ge={};{var xe=Ge;xe[Y]=Int8Array,xe[$]=Uint8Array,xe[G]=Int16Array,xe[he]=Uint16Array,xe[te]=Int32Array,xe[W]=Uint32Array,xe[ve]=Float32Array,xe[re]=Uint16Array,xe[Se]=Uint16Array,xe[C]=Uint16Array,xe[q]=Uint16Array,xe[K]=Uint32Array,xe[x]=Uint32Array,xe[j]=Uint32Array,xe[ce]=Uint32Array,xe[Ee]=Uint32Array}function or(me){if(me instanceof Int8Array)return Y;if(me instanceof Uint8Array||me instanceof Uint8ClampedArray)return $;if(me instanceof Int16Array)return G;if(me instanceof Uint16Array)return he;if(me instanceof Int32Array)return te;if(me instanceof Uint32Array)return W;if(me instanceof Float32Array)return ve;throw new Error("unsupported typed array type")}function ur(me){if(me===Int8Array)return Y;if(me===Uint8Array||me===Uint8ClampedArray)return $;if(me===Int16Array)return G;if(me===Uint16Array)return he;if(me===Int32Array)return te;if(me===Uint32Array)return W;if(me===Float32Array)return ve;throw new Error("unsupported typed array type")}function er(me){var w=Ge[me];if(!w)throw new Error("unknown gl type");return w}o.isArrayBuffer=typeof SharedArrayBuffer<"u"?function(w){return w&&w.buffer&&(w.buffer instanceof ArrayBuffer||w.buffer instanceof SharedArrayBuffer)}:function(w){return w&&w.buffer&&w.buffer instanceof ArrayBuffer}},"./src/utils.js":(ie,o)=>{o.__esModule=!0,o.glEnumToString=void 0,o.isWebGL1=$,o.isWebGL2=Y;function Y(G){return!!G.texStorage2D}function $(G){return!G.texStorage2D}o.glEnumToString=function(){var G={},he={};function te(W){var ve=W.constructor.name;if(!G[ve]){for(var re in W)if(typeof W[re]=="number"){var Se=he[W[re]];he[W[re]]=Se?"".concat(Se," | ").concat(re):re}G[ve]=!0}}return function(ve,re){return te(ve),he[re]||(typeof re=="number"?"0x".concat(re.toString(16)):re)}}()},"./src/v3.js":(ie,o)=>{o.__esModule=!0,o.add=he,o.copy=ur,o.create=G,o.cross=K,o.distance=Ee,o.distanceSq=Ge,o.divScalar=q,o.divide=me,o.dot=x,o.length=j,o.lengthSq=ce,o.lerp=W,o.lerpV=ve,o.max=re,o.min=Se,o.mulScalar=C,o.multiply=er,o.negate=or,o.normalize=xe,o.setDefaultType=$,o.subtract=te;var Y=Float32Array;function $(w){var B=Y;return Y=w,B}function G(w,B,N){var g=new Y(3);return w&&(g[0]=w),B&&(g[1]=B),N&&(g[2]=N),g}function he(w,B,N){return N=N||new Y(3),N[0]=w[0]+B[0],N[1]=w[1]+B[1],N[2]=w[2]+B[2],N}function te(w,B,N){return N=N||new Y(3),N[0]=w[0]-B[0],N[1]=w[1]-B[1],N[2]=w[2]-B[2],N}function W(w,B,N,g){return g=g||new Y(3),g[0]=w[0]+N*(B[0]-w[0]),g[1]=w[1]+N*(B[1]-w[1]),g[2]=w[2]+N*(B[2]-w[2]),g}function ve(w,B,N,g){return g=g||new Y(3),g[0]=w[0]+N[0]*(B[0]-w[0]),g[1]=w[1]+N[1]*(B[1]-w[1]),g[2]=w[2]+N[2]*(B[2]-w[2]),g}function re(w,B,N){return N=N||new Y(3),N[0]=Math.max(w[0],B[0]),N[1]=Math.max(w[1],B[1]),N[2]=Math.max(w[2],B[2]),N}function Se(w,B,N){return N=N||new Y(3),N[0]=Math.min(w[0],B[0]),N[1]=Math.min(w[1],B[1]),N[2]=Math.min(w[2],B[2]),N}function C(w,B,N){return N=N||new Y(3),N[0]=w[0]*B,N[1]=w[1]*B,N[2]=w[2]*B,N}function q(w,B,N){return N=N||new Y(3),N[0]=w[0]/B,N[1]=w[1]/B,N[2]=w[2]/B,N}function K(w,B,N){N=N||new Y(3);var g=w[2]*B[0]-w[0]*B[2],de=w[0]*B[1]-w[1]*B[0];return N[0]=w[1]*B[2]-w[2]*B[1],N[1]=g,N[2]=de,N}function x(w,B){return w[0]*B[0]+w[1]*B[1]+w[2]*B[2]}function j(w){return Math.sqrt(w[0]*w[0]+w[1]*w[1]+w[2]*w[2])}function ce(w){return w[0]*w[0]+w[1]*w[1]+w[2]*w[2]}function Ee(w,B){var N=w[0]-B[0],g=w[1]-B[1],de=w[2]-B[2];return Math.sqrt(N*N+g*g+de*de)}function Ge(w,B){var N=w[0]-B[0],g=w[1]-B[1],de=w[2]-B[2];return N*N+g*g+de*de}function xe(w,B){B=B||new Y(3);var N=w[0]*w[0]+w[1]*w[1]+w[2]*w[2],g=Math.sqrt(N);return g>1e-5?(B[0]=w[0]/g,B[1]=w[1]/g,B[2]=w[2]/g):(B[0]=0,B[1]=0,B[2]=0),B}function or(w,B){return B=B||new Y(3),B[0]=-w[0],B[1]=-w[1],B[2]=-w[2],B}function ur(w,B){return B=B||new Y(3),B[0]=w[0],B[1]=w[1],B[2]=w[2],B}function er(w,B,N){return N=N||new Y(3),N[0]=w[0]*B[0],N[1]=w[1]*B[1],N[2]=w[2]*B[2],N}function me(w,B,N){return N=N||new Y(3),N[0]=w[0]/B[0],N[1]=w[1]/B[1],N[2]=w[2]/B[2],N}},"./src/vertex-arrays.js":(ie,o,Y)=>{function $(C){"@babel/helpers - typeof";return $=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(q){return typeof q}:function(q){return q&&typeof Symbol=="function"&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q},$(C)}o.__esModule=!0,o.createVAOAndSetAttributes=re,o.createVAOFromBufferInfo=Se,o.createVertexArrayInfo=ve;var G=te(Y("./src/programs.js"));function he(C){if(typeof WeakMap!="function")return null;var q=new WeakMap,K=new WeakMap;return(he=function(j){return j?K:q})(C)}function te(C,q){if(!q&&C&&C.__esModule)return C;if(C===null||$(C)!="object"&&typeof C!="function")return{default:C};var K=he(q);if(K&&K.has(C))return K.get(C);var x={__proto__:null},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ce in C)if(ce!=="default"&&Object.prototype.hasOwnProperty.call(C,ce)){var Ee=j?Object.getOwnPropertyDescriptor(C,ce):null;Ee&&(Ee.get||Ee.set)?Object.defineProperty(x,ce,Ee):x[ce]=C[ce]}return x.default=C,K&&K.set(C,x),x}var W=34963;function ve(C,q,K){var x=C.createVertexArray();return C.bindVertexArray(x),q.length||(q=[q]),q.forEach(function(j){G.setBuffersAndAttributes(C,j,K)}),C.bindVertexArray(null),{numElements:K.numElements,elementType:K.elementType,vertexArrayObject:x}}function re(C,q,K,x){var j=C.createVertexArray();return C.bindVertexArray(j),G.setAttributes(q,K),x&&C.bindBuffer(W,x),C.bindVertexArray(null),j}function Se(C,q,K){return re(C,q.attribSetters||q,K.attribs,K.indices)}}},D={};function M(ie){var o=D[ie];if(o!==void 0)return o.exports;var Y=D[ie]={exports:{}};return v[ie](Y,Y.exports,M),Y.exports}var H=M("./src/twgl-full.js");return H})())})(La);var at=La.exports,Fr,Ir,ot,Vt,ut,gr,ft,Nr,Wt,mn,yn,pn,Sa,Aa,ga,_a,Pa,wa,Kn,Oa,Yn,Ma,qn,Na,dn,Ea,zn,Ua;class Ka{constructor(){Te(this,Kn);Te(this,Yn);Te(this,qn);Te(this,dn);Te(this,zn);nr(this,"canvas",document.querySelector("#canvas"));nr(this,"gl");Te(this,Fr,new Map);Te(this,Ir,new Map);Te(this,ot,void 0);Te(this,Vt,void 0);Te(this,ut,void 0);Te(this,gr,new Uint8Array(600));Te(this,ft,void 0);Te(this,Nr,new Uint8Array(3*40));Te(this,Wt,void 0);Te(this,mn,document.createTextNode("0"));Te(this,yn,document.createTextNode("1"));Te(this,pn,document.createTextNode("0"));Te(this,Sa,0);Te(this,Aa,0);Te(this,ga,new Map);Te(this,_a,void 0);Te(this,Pa,void 0);Te(this,wa,document.querySelectorAll("button"));document.querySelector("#linesCleared").appendChild(k(this,mn)),document.querySelector("#speedLevel").appendChild(k(this,yn)),document.querySelector("#score").appendChild(k(this,pn)),k(this,Fr).set(1,[255,0,0]),k(this,Fr).set(2,[0,255,0]),k(this,Fr).set(3,[255,255,0]),k(this,Fr).set(4,[0,0,255]),k(this,Fr).set(5,[180,90,246]),k(this,Fr).set(6,[0,255,255]),k(this,Fr).set(7,[255,140,40]),k(this,Ir).set("Z",1),k(this,Ir).set("S",2),k(this,Ir).set("O",3),k(this,Ir).set("J",4),k(this,Ir).set("T",5),k(this,Ir).set("I",6),k(this,Ir).set("L",7);let f=this.canvas.getContext("webgl");this.gl=f,f||document.body.appendChild(document.createTextNode("WebGL is not supported."));function v($,G,he,te){return[$,G+te,$+he,G+te,$+he,G,$,G]}function D($,G,he,te){let W=[$/2,$],ve=[],re=(500-W[1])/2,Se=(400-W[0])/2;ve.push(...v(Se,re,W[0],W[1])),ve.push(...v(Se-G-te,re,te,te));for(let C=0;C<3;C++)ve.push(...v(Se+G+W[0],re+C*(te+he),te,te));return ve}const M={a_Position:{numComponents:2,data:D(500,5,0,70)},a_GridPos:{numComponents:2,data:[0,0,10,0,10,20,0,20,0,0,4,0,4,4,0,4,0,0,4,0,4,4,0,4,0,0,4,0,4,4,0,4,0,0,4,0,4,4,0,4]},a_QueueID:{numComponents:1,data:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3]},a_ShaderID:{numComponents:1,data:[0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},indices:{numComponents:3,data:[0,1,2,2,3,0,4,5,6,6,7,4,8,9,10,10,11,8,12,13,14,14,15,12,16,17,18,18,19,16]}};Ce(this,Vt,at.createBufferInfoFromArrays(f,M));let H=document.querySelector("#vertex-shader-2d").text,ie=document.querySelector("#fragment-shader-2d").text;Ce(this,ot,at.createProgramInfo(f,[H,ie]));let o={src:"textures/block.png",mag:f.LINEAR};Ce(this,Wt,at.createTexture(this.gl,o)),Ce(this,ut,f.createTexture()),f.bindTexture(f.TEXTURE_2D,k(this,ut)),f.pixelStorei(f.UNPACK_ALIGNMENT,1),f.texImage2D(f.TEXTURE_2D,0,f.RGB,10,20,0,f.RGB,f.UNSIGNED_BYTE,null),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),Ce(this,ft,f.createTexture()),f.bindTexture(f.TEXTURE_2D,k(this,ft)),f.pixelStorei(f.UNPACK_ALIGNMENT,1),f.texImage2D(f.TEXTURE_2D,0,f.RGB,4,2*5,0,f.RGB,f.UNSIGNED_BYTE,null),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.useProgram(k(this,ot).program),at.setBuffersAndAttributes(f,k(this,ot),k(this,Vt));let Y={u_Resolution:[this.gl.canvas.width,this.gl.canvas.height],u_GridData:k(this,ut),u_QueueData:k(this,ft),u_BlockTexture:k(this,Wt)};at.setUniforms(k(this,ot),Y)}updateData(f){$e(this,Kn,Oa).call(this,f),$e(this,qn,Na).call(this,f),$e(this,zn,Ua).call(this,f)}renderGame(){at.resizeCanvasToDisplaySize(this.gl.canvas),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height);let f={u_Resolution:[this.gl.canvas.width,this.gl.canvas.height],u_GridData:k(this,ut),u_QueueData:k(this,ft),u_BlockTexture:k(this,Wt)};at.setUniforms(k(this,ot),f),at.drawBufferInfo(this.gl,k(this,Vt))}}Fr=new WeakMap,Ir=new WeakMap,ot=new WeakMap,Vt=new WeakMap,ut=new WeakMap,gr=new WeakMap,ft=new WeakMap,Nr=new WeakMap,Wt=new WeakMap,mn=new WeakMap,yn=new WeakMap,pn=new WeakMap,Sa=new WeakMap,Aa=new WeakMap,ga=new WeakMap,_a=new WeakMap,Pa=new WeakMap,wa=new WeakMap,Kn=new WeakSet,Oa=function(f){for(let v=0;v<20;v++){let D=f.gridData[v];for(let M=0;M<10;M++){let H=$e(this,Yn,Ma).call(this,D,M),ie=3*(10*v+M);if(H!=0){let o=k(this,Fr).get(H);k(this,gr)[ie]=o[0],k(this,gr)[ie+1]=o[1],k(this,gr)[ie+2]=o[2]}else k(this,gr)[ie]=0,k(this,gr)[ie+1]=0,k(this,gr)[ie+2]=0}}if(f.playerPiece.active){let v=170;for(let M=0;M<4;M++){let H=3*(10*f.ghostBlocks[M][1]+f.ghostBlocks[M][0]);k(this,gr)[H]=v,k(this,gr)[H+1]=v,k(this,gr)[H+2]=v}let D=f.playerPiece.shape;for(let M=0;M<4;M++){let H=k(this,Fr).get(k(this,Ir).get(D)),ie=3*(10*f.playerPiece.blocks[M][1]+f.playerPiece.blocks[M][0]);k(this,gr)[ie]=H[0],k(this,gr)[ie+1]=H[1],k(this,gr)[ie+2]=H[2]}}this.gl.bindTexture(this.gl.TEXTURE_2D,k(this,ut)),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,10,20,this.gl.RGB,this.gl.UNSIGNED_BYTE,k(this,gr))},Yn=new WeakSet,Ma=function(f,v){const D=32-(3+3*v),M=7<<D;return(f&M)>>>D},qn=new WeakSet,Na=function(f){for(let v=0;v<k(this,Nr).length;v++)k(this,Nr)[v]=0;f.heldPiece!=null&&$e(this,dn,Ea).call(this,f.heldPiece,0);for(let v=0;v<4;v++)$e(this,dn,Ea).call(this,f.pieceQueue[v],24*(1+v));this.gl.bindTexture(this.gl.TEXTURE_2D,k(this,ft)),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,4,10,this.gl.RGB,this.gl.UNSIGNED_BYTE,k(this,Nr))},dn=new WeakSet,Ea=function(f,v){let D=it.getBaseShape(f),M=k(this,Fr).get(k(this,Ir).get(f));for(let H=0;H<4;H++){let ie=D[H],o=v+3*(ie[1]*4+ie[0]);k(this,Nr)[o]=M[0],k(this,Nr)[o+1]=M[1],k(this,Nr)[o+2]=M[2]}if(f!="I"&&f!="O"){let H=v+21;k(this,Nr)[H]=255}else f=="I"&&(k(this,Nr)[v+21+1]=255)},zn=new WeakSet,Ua=function(f){k(this,mn).nodeValue=f.linesCleared,k(this,yn).nodeValue=f.speedLevel==11?"MAX":f.speedLevel,k(this,pn).nodeValue=f.score};var Xt,Ht,Tt,ct,lt,st,Jr,Kt,bn;class Ya{constructor(f){nr(this,"leftQueue",0);nr(this,"rightQueue",0);nr(this,"moveDown",!1);nr(this,"rotate",{left:!1,right:!1});nr(this,"hardDrop",!1);nr(this,"dragSensitivity",40);nr(this,"slamThreshold",150);nr(this,"slamTimeLimit",400);Te(this,Xt,void 0);Te(this,Ht,void 0);Te(this,Tt,void 0);Te(this,ct,void 0);Te(this,lt,!1);Te(this,st,null);Te(this,Jr,{startTime:0,startY:0,endY:0});Te(this,Kt,void 0);Te(this,bn,!1);f.addEventListener("touchmove",v=>{this.dragEvent(v)}),f.addEventListener("touchstart",v=>{this.touchStart(v)}),f.addEventListener("touchend",v=>{this.touchEnd(v)}),f.addEventListener("touchcancel",v=>{this.touchEnd(v)}),Ce(this,Xt,f),document.addEventListener("dblclick",function(v){v.preventDefault()},{passive:!1})}touchStart(f){if(k(this,st)===null&&!f.target.classList.contains("blockGestures")){let v=f.touches.item(0);Ce(this,st,v.identifier),Ce(this,Tt,v.pageX),Ce(this,ct,v.pageY),Ce(this,Ht,v.pageX),Ce(this,Kt,Date.now()),Ce(this,bn,v.clientX<k(this,Xt).getBoundingClientRect().x+k(this,Xt).getBoundingClientRect().width*.5),Ce(this,Jr,{startTime:Date.now(),startY:v.pageY,endY:v.pageY})}}touchEnd(f){let v=!0;for(let D=0;D<f.touches.length&&v;D++)f.touches.item(D).identifier===k(this,st)&&(v=!1);v&&(Date.now()-k(this,Kt)<300&&this.leftQueue==0&&this.rightQueue==0&&(k(this,bn)?this.rotate.left=!0:this.rotate.right=!0),Date.now()-k(this,Jr).startTime<=this.slamTimeLimit&&k(this,Jr).endY-k(this,Jr).startY>this.slamThreshold&&(this.hardDrop=!0),Ce(this,st,null),this.leftQueue=0,this.rightQueue=0,this.moveDown=!1)}dragEvent(f){let v=!1,D=null;for(let M=0;M<f.changedTouches.length;M++)if(f.changedTouches.item(M).identifier===k(this,st)){D=f.changedTouches.item(M);break}D!==null&&((D.pageX-k(this,Ht))*(k(this,lt)?1:-1)>0&&(Ce(this,lt,!k(this,lt)),Ce(this,Tt,D.pageX+this.dragSensitivity*.5*(k(this,lt)?1:-1)),Ce(this,ct,D.pageY)),Math.abs(D.pageX-k(this,Tt))>this.dragSensitivity&&(k(this,lt)?(this.leftQueue++,this.rightQueue=0):(this.rightQueue++,this.leftQueue=0),v=!0,k(this,Jr).startTime=0,this.moveDown=!1),D.pageY-k(this,ct)>this.dragSensitivity?(this.moveDown=!0,this.leftQueue=0,this.rightQueue=0,v=!0):k(this,ct)-D.pageY>this.dragSensitivity&&(this.moveDown=!1,v=!0),v&&(Ce(this,Tt,D.pageX),Ce(this,ct,D.pageY),Ce(this,Kt,0)),Ce(this,Ht,D.pageX),k(this,Jr).endY=D.pageY)}}Xt=new WeakMap,Ht=new WeakMap,Tt=new WeakMap,ct=new WeakMap,lt=new WeakMap,st=new WeakMap,Jr=new WeakMap,Kt=new WeakMap,bn=new WeakMap;class qa{constructor(f,v,D,M,H,ie,o){nr(this,"inputStates",new Map);nr(this,"frameCounter",{moveLeft:0,moveRight:0,softDrop:0});this.inputStates.set("moveLeft",!1),this.inputStates.set("moveRight",!1),this.inputStates.set("softDrop",!1),this.inputStates.set("hold",!1),this.inputStates.set("hardDrop",!1),this.inputStates.set("rotateClockwise",!1),this.inputStates.set("rotateAnticlockwise",!1),this.addReleasableListeners(v,"moveLeft"),this.addReleasableListeners(D,"moveRight"),this.addReleasableListeners(M,"softDrop"),this.addListeners(H,"hardDrop"),this.addListeners(ie,"rotateClockwise"),this.addListeners(o,"rotateAnticlockwise"),this.addListeners(f,"hold")}addListeners(f,v){f.addEventListener("pointerdown",D=>{this.inputStates.set(v,!0)}),f.addEventListener("click",D=>{D.pointerType===""&&this.inputStates.set(v,!0)})}addReleasableListeners(f,v){f.addEventListener("pointerdown",D=>{this.inputStates.set(v,!0)}),f.addEventListener("pointerup",D=>{this.inputStates.set(v,!1)}),f.addEventListener("click",D=>{D.pointerType===""&&(v==="moveLeft"?this.frameCounter.moveLeft++:v==="moveRight"?this.frameCounter.moveRight++:v==="softDrop"&&this.frameCounter.softDrop++)})}countFrame(){this.inputStates.get("moveLeft")&&this.frameCounter.moveLeft++,this.inputStates.get("moveRight")&&this.frameCounter.moveRight++,this.inputStates.get("softDrop")&&this.frameCounter.softDrop++}resetFlags(){this.inputStates.set("hold",!1),this.inputStates.set("hardDrop",!1),this.inputStates.set("rotateClockwise",!1),this.inputStates.set("rotateAnticlockwise",!1),this.inputStates.get("moveLeft")||(this.frameCounter.moveLeft=0),this.inputStates.get("moveRight")||(this.frameCounter.moveRight=0),this.inputStates.get("softDrop")||(this.frameCounter.softDrop=0)}getInput(f){return this.inputStates.get(f)}}let cn=null,Ta=new Map,Ga;function za(J){J.inputKeys.forEach(function(v,D,M){localStorage.setItem(v,D)})}function Qa(J){let f=[];J.inputKeys.forEach(function(v,D,M){const H=localStorage.getItem(v);H!=null&&f.push({action:v,oldKey:D,newKey:H})});for(let v=0;v<f.length;v++)J.inputKeys.delete(f[v].oldKey);for(let v=0;v<f.length;v++)J.inputKeys.set(f[v].newKey,f[v].action)}function Za(J,f){const v=document.querySelectorAll(J);for(let H=0;H<v.length;H++){let ie=v[H];ie.classList.add("ready"),ie.addEventListener("click",function(){f.selectedSpan!=null&&(f.selectedKey="Escape",M()),f.originalKeybind=ie.innerText,f.selectedSpan=ie,f.selectedAction=ie.id.substring(2),cn.textContent="Rebinding "+f.selectedAction+" action (press key to rebind)...",document.addEventListener("keydown",D),ie.classList.remove("ready"),ie.classList.add("waiting"),ie.innerText="..."}),ie.innerText=f.actionToKey(ie.id.substring(2)),ie.innerText==" "&&(ie.innerText="Space")}function D(H){f.selectedKey=H.key.length>1?H.key:H.key.toUpperCase(),M()}function M(){f.selectedKey=="Escape"||Ga.classList.contains("hide")?(f.selectedKey=f.originalKeybind,H(),cn.textContent="Rebind canceled.",f.updateCounters()):f.rebindControl(f.selectedAction,f.selectedKey)?(cn.textContent="Rebind successful!",H(),za(f)):cn.textContent="'"+f.selectedKey+"' is already in use (press another key)...";function H(){document.removeEventListener("keydown",D);const ie=f.selectedKey==" "?"Space":f.selectedKey;f.selectedSpan.innerText=ie,Ta.get(f.selectedAction).forEach(function(o,Y,$){o.innerText=ie}),f.selectedAction="",f.selectedKey="",f.selectedSpan.classList.remove("waiting"),f.selectedSpan.classList.add("ready"),f.selectedSpan=null}}}function Ja(J,f,v,D){Ga=D,cn=v,Za(J,f),f.actionStates.forEach(function(M,H,ie){Ta.set(H,document.querySelectorAll("span.cd_"+H)),Ta.get(H).forEach(function(o,Y,$){const G=f.actionToKey(H);o.innerText=G==" "?"Space":G})})}function $a(){let J=document.createTextNode("");document.querySelector("#debug").appendChild(J),J.textContent="Starting Program";const f=document.querySelector("#startButton");J.textContent="Creating keyboard input module";let v=new Xa;Qa(v),document.addEventListener("keydown",function(K){v.setInputState(K.key,!0)}),document.addEventListener("keyup",function(K){v.setInputState(K.key,!1)}),J.textContent="Creating touch input module";let D=new Ya(document.querySelector("#gameGUI"));J.textContent="Creating GUI input module";let M=new qa(document.querySelector("#tib_Hold"),document.querySelector("#tib_MoveLeft"),document.querySelector("#tib_MoveRight"),document.querySelector("#tib_SoftDrop"),document.querySelector("#tib_HardDrop"),document.querySelector("#tib_RotateClockwise"),document.querySelector("#tib_RotateAnticlockwise"));J.textContent="Creating game module";let H=new ya;J.textContent="Creating rendering module";let ie=new Ka;J.textContent="Selecting screens";const o=document.querySelector("#titleScreen"),Y=document.querySelector("#pauseScreen"),$=document.querySelector("#gameOverScreen"),G=document.querySelector("#settingsScreen");let he=!0;J.textContent="Adding final score nodes";const te=document.createTextNode("0"),W=document.createTextNode("0");document.querySelector("#finalScore").appendChild(te),document.querySelector("#finalLines").append(W),J.textContent="Creating game loop";let ve=0,re=0;function Se(K){let x=(K-re)*.001;re=K,ve+=x,G.classList.contains("hide")?H.gameState.gameOver?he||$.classList.contains("hide")&&($.classList.remove("hide"),te.textContent=H.gameState.score,W.textContent=H.gameState.linesCleared):(ve>=H.gameTickTime&&(ve=Math.min(ve-H.gameTickTime,H.gameTickTime),v.updateCounters(),ei(H,v,D,M),H.runTick(),v.getCounter("Pause")==1&&(H.gameState.isPaused?(H.pauseGame(!1),Y.classList.add("hide")):(H.pauseGame(!0),Y.classList.remove("hide")))),H.isStateChanged&&ie.updateData(H.gameState)):(v.updateCounters(),v.getCounter("Pause")==1&&G.classList.add("hide")),ie.renderGame(),requestAnimationFrame(Se)}function C(){H.startNewGame(),ie.updateData(H.gameState),ie.renderGame(),document.querySelector("#titleScreen").classList.add("hide"),document.querySelector("#gameGUI").classList.remove("hide"),requestAnimationFrame(Se),he=!1}J.textContent="Connecting buttons",f.addEventListener("click",C),document.querySelector("#unpauseButton").addEventListener("click",function(){H.gameState.isPaused=!1,Y.classList.add("hide")}),document.querySelector("#replayButton").addEventListener("click",function(){H.startNewGame(),ie.updateData(H.gameState),ie.renderGame(),$.classList.add("hide")}),document.querySelector("#returnToTitleButton").addEventListener("click",function(){o.classList.remove("hide"),$.classList.add("hide"),he=!0}),J.textContent="Starting game",requestAnimationFrame(Se),J.textContent="Setting up settings";let q=document.createTextNode("");document.querySelector("#settingsConsoleText").appendChild(q),Ja(".controlRebind",v,q,G),document.querySelector("#exitSettingsButton").addEventListener("click",function(){G.classList.add("hide")}),document.querySelectorAll(".settingsButton").forEach(function(K,x,j){K.addEventListener("click",function(){G.classList.remove("hide")})}),J.textContent="Initialization complete"}function ei(J,f,v,D){let M=5;f.getCounter("HardDrop")==1&&(J.input.hardDrop=!0),f.getCounter("Hold")==1&&(J.input.hold=!0),f.getCounter("RotateClockwise")==1&&(J.input.rotClockwise=!0),f.getCounter("RotateAntiClockwise")==1&&(J.input.rotAntiClockwise=!0),f.getInputState("SoftDrop")&&(J.input.softDrop=!0),(f.getCounter("MoveLeft")==1||f.getCounter("MoveLeft")>M)&&(J.input.moveLeft=!0),(f.getCounter("MoveRight")==1||f.getCounter("MoveRight")>M)&&(J.input.moveRight=!0),v.leftQueue>0&&(J.input.moveLeft=!0,v.leftQueue--),v.rightQueue>0&&(J.input.moveRight=!0,v.rightQueue--),v.moveDown&&(J.input.softDrop=!0),v.rotate.left?J.input.rotAntiClockwise=!0:v.rotate.right&&(J.input.rotClockwise=!0),v.rotate={left:!1,right:!1},v.hardDrop&&(J.input.hardDrop=!0,v.hardDrop=!1),D.countFrame(),(D.frameCounter.moveLeft==1||D.frameCounter.moveLeft>M)&&(J.input.moveLeft=!0),(D.frameCounter.moveRight==1||D.frameCounter.moveRight>M)&&(J.input.moveRight=!0),D.frameCounter.softDrop>=1&&(J.input.softDrop=!0),D.getInput("hold")&&(J.input.hold=!0),D.getInput("rotateClockwise")&&(J.input.rotClockwise=!0),D.getInput("rotateAnticlockwise")&&(J.input.rotAntiClockwise=!0),D.getInput("hardDrop")&&(J.input.hardDrop=!0),D.resetFlags()}$a();
