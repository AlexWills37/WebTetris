var Hn=Object.defineProperty;var Kn=(ce,a,s)=>a in ce?Hn(ce,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):ce[a]=s;var $e=(ce,a,s)=>(Kn(ce,typeof a!="symbol"?a+"":a,s),s),An=(ce,a,s)=>{if(!a.has(ce))throw TypeError("Cannot "+s)};var N=(ce,a,s)=>(An(ce,a,"read from private field"),s?s.call(ce):a.get(ce)),Ee=(ce,a,s)=>{if(a.has(ce))throw TypeError("Cannot add the same private member more than once");a instanceof WeakSet?a.add(ce):a.set(ce,s)},Se=(ce,a,s,R)=>(An(ce,a,"write to private field"),R?R.call(ce,s):a.set(ce,s),s);var gn=(ce,a,s,R)=>({set _(C){Se(ce,a,C,s)},get _(){return N(ce,a,R)}}),er=(ce,a,s)=>(An(ce,a,"access private method"),s);(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const C of document.querySelectorAll('link[rel="modulepreload"]'))R(C);new MutationObserver(C=>{for(const G of C)if(G.type==="childList")for(const z of G.addedNodes)z.tagName==="LINK"&&z.rel==="modulepreload"&&R(z)}).observe(document,{childList:!0,subtree:!0});function s(C){const G={};return C.integrity&&(G.integrity=C.integrity),C.referrerPolicy&&(G.referrerPolicy=C.referrerPolicy),C.crossOrigin==="use-credentials"?G.credentials="include":C.crossOrigin==="anonymous"?G.credentials="omit":G.credentials="same-origin",G}function R(C){if(C.ep)return;C.ep=!0;const G=s(C);fetch(C.href,G)}})();var jt,Jr,$r,Ka,Et,Vt,Mr,Tt,Ya,Ln,za,Bn,Qa,In,Za,On,Wt,qa,St,ha,pa,Pn,Ja,Mn,da,xn,$a,Nn,Xt,Ha,ba,Rn;const ya=class ya{constructor(){Ee(this,Ya);Ee(this,za);Ee(this,Qa);Ee(this,Za);Ee(this,Wt);Ee(this,St);Ee(this,pa);Ee(this,Ja);Ee(this,da);Ee(this,$a);Ee(this,Xt);Ee(this,ba);$e(this,"input",{moveLeft:!1,moveRight:!1,hardDrop:!1,softDrop:!1,hold:!1,rotateClockwise:!1,rotateAnticlockwise:!1});$e(this,"numRows",21);$e(this,"graceTimerDuration",.5);$e(this,"gameTickTime",1/30);$e(this,"pieceMap",new Map);$e(this,"gameState",{isPaused:!1,gameOver:!0,gridData:new Uint32Array(this.numRows),playerPiece:null,pieceQueue:[],heldPiece:null,ghostBlocks:[[0,0],[0,0],[0,0],[0,0]],linesCleared:0,speedLevel:1,score:0});Ee(this,jt,15);Ee(this,Jr,!0);Ee(this,$r,0);Ee(this,Ka,!1);Ee(this,Et,-1);Ee(this,Vt,0);Ee(this,Mr,!1);Ee(this,Tt,!1);er(this,Wt,qa).call(this),er(this,St,ha).call(this),er(this,Xt,Ha).call(this),Se(this,jt,15),this.pieceMap.set("Z",1),this.pieceMap.set("S",2),this.pieceMap.set("O",3),this.pieceMap.set("J",4),this.pieceMap.set("T",5),this.pieceMap.set("I",6),this.pieceMap.set("L",7),this.gameState.isPaused=!0}get isStateChanged(){const a=N(this,Jr);return Se(this,Jr,!1),a}runTick(){if(this.gameState.isPaused)return;let a=!1;if(N(this,Tt)){this.animationCount==null||this.rowCount==null?(this.animationCount=0,this.rowCount=0):(this.animationCount++,this.rowCount<this.numRows&&this.animationCount%4==0?(this.clearRow(0),this.rowCount++,Se(this,Jr,!0)):this.rowCount==this.numRows&&(this.rowCount++,this.gameState.gameOver=!0));return}if(this.input.hardDrop)this.hardDropPlayerPiece(),this.finishWithPiece(),a=!0;else if(this.input.hold)this.holdPiece(),a=!0;else{N(this,Mr)&&er(this,Ja,Mn).call(this,this.gameTickTime),this.input.softDrop&&(a=this.tryMovePiece(0,-1)||a);let s=0;this.input.rotateClockwise&&(s+=1),this.input.rotateAnticlockwise&&(s-=1),s!=0&&(a=this.tryRotatePiece(s==1)||a);let R=0;if(this.input.moveLeft&&(R-=1),this.input.moveRight&&(R+=1),R!=0&&(a=this.tryMovePiece(R,0)||a),gn(this,$r)._++,N(this,$r)>=N(this,jt)){let C=!this.tryMovePiece(0,-1);a||(a=!C),Se(this,$r,0),C&&!N(this,Mr)&&er(this,pa,Pn).call(this)}if(N(this,Mr)&&N(this,Et)<=0){let C=!this.tryMovePiece(0,-1);a=!0,C&&this.finishWithPiece()}else if(!N(this,Mr)){let C=!1;for(const G of this.gameState.playerPiece.blocks)C=C||this.isBlockHere(G[0],G[1]-1);C&&er(this,pa,Pn).call(this)}}a&&(er(this,Xt,Ha).call(this),Se(this,Jr,!0)),this.input={moveLeft:!1,moveRight:!1,hardDrop:!1,softDrop:!1,hold:!1,rotateClockwise:!1,rotateAnticlockwise:!1}}pauseGame(a){this.gameState.isPaused=a}startNewGame(){this.gameState.gameOver=!1,this.gameState.isPaused=!1,Se(this,Tt,!1),this.animationCount=null,this.rowCount=null;for(let a=0;a<this.gameState.gridData.length;a++)this.gameState.gridData[a]=0;this.gameState.linesCleared=0,this.gameState.speedLevel=0,this.gameState.score=0,this.gameState.pieceQueue=[],this.gameState.heldPiece=null,er(this,Wt,qa).call(this),er(this,St,ha).call(this),er(this,Xt,Ha).call(this),er(this,ba,Rn).call(this),Object.keys(this.input).forEach((a,s,R)=>{this.input[a]=!1})}tryMovePiece(a,s){let R=!0;for(let C=0;C<4&&R;C++){let G=this.gameState.playerPiece.blocks[C][0]+a,z=this.gameState.playerPiece.blocks[C][1]+s;this.isBlockHere(G,z)&&(R=!1)}return R&&(er(this,za,Bn).call(this,a,s),a!=0&&er(this,da,xn).call(this),s!=0&&Se(this,Mr,!1)),R}hardDropPlayerPiece(){for(;this.tryMovePiece(0,-1););}tryRotatePiece(a){let s=er(this,Qa,In).call(this,a);return s&&er(this,da,xn).call(this),s}holdPiece(){if(this.gameState.heldPiece==null)this.gameState.heldPiece=this.gameState.playerPiece.shape,er(this,St,ha).call(this),Se(this,Jr,!0),Se(this,$r,0);else if(!this.gameState.playerPiece.wasHeld){let a=this.gameState.heldPiece;this.gameState.heldPiece=this.gameState.playerPiece.shape,this.gameState.playerPiece=new ot(a),this.gameState.playerPiece.wasHeld=!0,Se(this,Jr,!0),Se(this,$r,0),this.isPlayerPieceValid()||(this.gameState.playerPiece.active=!1,Se(this,Tt,!0))}}finishWithPiece(){const a=this.gameState.linesCleared;this.gameState.playerPiece.shape=="T"&&Se(this,Ka,!0),er(this,Za,On).call(this),er(this,St,ha).call(this),Se(this,Mr,!1),er(this,$a,Nn).call(this),this.gameState.linesCleared!=a&&(er(this,ba,Rn).call(this),this.gameState.score+=Math.pow(this.gameState.linesCleared-a,2)*100)}clearRow(a){for(let s=a;s<this.numRows-1;s++)this.gameState.gridData[s]=this.gameState.gridData[s+1];this.gameState.gridData[this.numRows-1]=0}isBlockHere(a,s){if(a<0||s<0||a>=10||s>=this.numRows)return!0;const R=this.gameState.gridData[s],C=7<<32-(3+3*a);return(R&C)!=0}getBlockData(a,s){const R=this.gameState.gridData[s],C=32-(3+3*a),G=7<<C;return(R&G)>>>C}isPlayerPieceValid(){let a=!0;for(let s=0;s<4&&a;s++)this.isBlockHere(this.gameState.playerPiece.blocks[s][0],this.gameState.playerPiece.blocks[s][1])&&(a=!1);return a}};jt=new WeakMap,Jr=new WeakMap,$r=new WeakMap,Ka=new WeakMap,Et=new WeakMap,Vt=new WeakMap,Mr=new WeakMap,Tt=new WeakMap,Ya=new WeakSet,Ln=function(a,s,R){const G=~(7<<32-(3+3*a));this.gameState.gridData[s]&=G;const z=R<<32-(3+3*a);this.gameState.gridData[s]|=z},za=new WeakSet,Bn=function(a,s){for(let R=0;R<4;R++)this.gameState.playerPiece.blocks[R][0]+=a,this.gameState.playerPiece.blocks[R][1]+=s},Qa=new WeakSet,In=function(a){let s=(this.gameState.playerPiece.rotationIndex+4+(a?1:-1))%4,R=[...this.gameState.playerPiece.blocks[0]],C=[];for(let oe=0;oe<4;oe++)C.push([...this.gameState.playerPiece.blocks[oe]]);let G=1,z=1;a?z=-1:G=-1;let u;for(let oe=0;oe<4;oe++)C[oe][0]-=R[0],C[oe][1]-=R[1],u=C[oe][0],C[oe][0]=G*C[oe][1],C[oe][1]=z*u,C[oe][0]+=R[0],C[oe][1]+=R[1];let H;switch(this.gameState.playerPiece.shape){case"O":H=ot.offsets.O;break;case"I":H=ot.offsets.I;break;default:H=ot.offsets.OTHER;break}let ie,j,le=!1;for(let oe=0;oe<5&&!le;oe++){ie=H[oe],j=[ie[this.gameState.playerPiece.rotationIndex][0]-ie[s][0],ie[this.gameState.playerPiece.rotationIndex][1]-ie[s][1]],le=!0;for(let W=0;W<4;W++)C[W][0]+=j[0],C[W][1]+=j[1],this.isBlockHere(C[W][0],C[W][1])&&(le=!1);if(!le)for(let W=0;W<4;W++)C[W][0]-=j[0],C[W][1]-=j[1]}if(le){for(let oe=0;oe<4;oe++)this.gameState.playerPiece.blocks[oe]=[...C[oe]];this.gameState.playerPiece.rotationIndex=s}return le},Za=new WeakSet,On=function(){let a,s,R=this.pieceMap.get(this.gameState.playerPiece.shape);for(let C=0;C<4;C++)a=this.gameState.playerPiece.blocks[C][0],s=this.gameState.playerPiece.blocks[C][1],er(this,Ya,Ln).call(this,a,s,R)},Wt=new WeakSet,qa=function(){let a=["O","I","T","J","L","S","Z"],s;for(let R=0;R<7;R++)s=Math.floor(Math.random()*a.length),this.gameState.pieceQueue.push(a[s]),a.splice(s,1)},St=new WeakSet,ha=function(){let a=this.gameState.pieceQueue[0];this.gameState.pieceQueue.splice(0,1),this.gameState.pieceQueue.length<7&&er(this,Wt,qa).call(this),delete this.gameState.playerPiece,this.gameState.playerPiece=new ot(a),this.isPlayerPieceValid()||(this.gameState.playerPiece.active=!1,Se(this,Tt,!0)),Se(this,$r,0)},pa=new WeakSet,Pn=function(){Se(this,Et,this.graceTimerDuration),Se(this,Mr,!0),Se(this,Vt,0)},Ja=new WeakSet,Mn=function(a){Se(this,Et,N(this,Et)-a)},da=new WeakSet,xn=function(){N(this,Mr)&&N(this,Vt)<30&&(Se(this,Et,this.graceTimerDuration),gn(this,Vt)._++)},$a=new WeakSet,Nn=function(){for(let a=0;a<this.numRows;a++){let s=!0;for(let R=0;R<10&&s;R++)this.isBlockHere(R,a)||(s=!1);s&&(this.clearRow(a),this.gameState.linesCleared++,a--)}},Xt=new WeakSet,Ha=function(){for(let s=0;s<4;s++)this.gameState.ghostBlocks[s]=[...this.gameState.playerPiece.blocks[s]];let a=!1;for(;!a;){for(let s=0;s<4;s++)this.isBlockHere(this.gameState.ghostBlocks[s][0],this.gameState.ghostBlocks[s][1]-1)&&(a=!0);if(!a)for(let s=0;s<4;s++)this.gameState.ghostBlocks[s][1]-=1}},ba=new WeakSet,Rn=function(){this.gameState.speedLevel=Math.min(Math.floor(this.gameState.linesCleared/10)+1,ya.levels.max),Se(this,jt,ya.levels[this.gameState.speedLevel])},$e(ya,"levels",{1:25,2:20,3:16,4:12,5:10,6:8,7:6,8:5,9:4,10:2,11:1,max:11});let wn=ya;const Lr=class Lr{constructor(a){this.blocks=[],this.shape=a,this.rotationIndex=0,this.active=!0,this.wasHeld=!1;let s=Lr.getBaseShape(a);for(let R=0;R<4;R++)this.blocks.push([...s[R]]),this.blocks[R][0]+=3,this.blocks[R][1]+=19}static getBaseShape(a){let s;switch(a){case"O":s=Lr.pieces.O;break;case"I":s=Lr.pieces.I;break;case"L":s=Lr.pieces.L;break;case"J":s=Lr.pieces.J;break;case"T":s=Lr.pieces.T;break;case"S":s=Lr.pieces.S;break;case"Z":s=Lr.pieces.Z;break;default:s=[[0,0],[0,0],[0,0],[0,0]]}return s}};$e(Lr,"offsets",{O:[[[0,0],[0,-1],[-1,-1],[-1,0]]],I:[[[0,0],[-1,0],[-1,1],[0,1]],[[-1,0],[0,0],[1,1],[0,1]],[[2,0],[0,0],[-2,1],[0,1]],[[-1,0],[0,1],[1,0],[0,-1]],[[2,0],[0,-2],[-2,0],[0,2]]],OTHER:[[[0,0],[0,0],[0,0],[0,0]],[[0,0],[1,0],[0,0],[-1,0]],[[0,0],[1,-1],[0,0],[-1,-1]],[[0,0],[0,2],[0,0],[0,2]],[[0,0],[1,2],[0,0],[-1,2]]]}),$e(Lr,"pieces",{O:[[1,0],[1,1],[2,1],[2,0]],I:[[1,0],[0,0],[2,0],[3,0]],L:[[1,0],[0,0],[2,0],[2,1]],J:[[1,0],[0,0],[0,1],[2,0]],T:[[1,0],[0,0],[2,0],[1,1]],S:[[1,0],[0,0],[1,1],[2,1]],Z:[[1,0],[2,0],[1,1],[0,1]]});let ot=Lr;class Yn{constructor(){$e(this,"selectedKey","");$e(this,"originalKeybind","");$e(this,"selectedAction","");$e(this,"selectedSpan",null);this.actionStates=new Map,this.actionStates.set("hardDrop",!1),this.actionStates.set("softDrop",!1),this.actionStates.set("moveLeft",!1),this.actionStates.set("moveRight",!1),this.actionStates.set("hold",!1),this.actionStates.set("rotateClockwise",!1),this.actionStates.set("rotateAnticlockwise",!1),this.actionStates.set("pause",!1),this.inputKeys=new Map,this.inputKeys.set("A","moveLeft"),this.inputKeys.set("D","moveRight"),this.inputKeys.set("W","hardDrop"),this.inputKeys.set("S","softDrop"),this.inputKeys.set("E","hold"),this.inputKeys.set("ArrowLeft","rotateAnticlockwise"),this.inputKeys.set("ArrowRight","rotateClockwise"),this.inputKeys.set("Escape","pause"),this.counters=new Map,this.counters.set("moveLeft",0),this.counters.set("moveRight",0),this.counters.set("rotateClockwise",0),this.counters.set("rotateAnticlockwise",0),this.counters.set("hardDrop",0),this.counters.set("hold",0),this.counters.set("pause",0)}keyToState(a){return a.length==1&&(a=a.toUpperCase()),this.inputKeys.get(a)}actionToKey(a){let s="";return this.inputKeys.forEach(function(R,C,G){R==a&&(s=C)}),s}rebindControl(a,s){let R=!1,C="";return this.inputKeys.forEach(function(G,z,u){G==a&&(C=z)}),C!=""&&(this.inputKeys.has(s)&&s!=C||(this.inputKeys.delete(C),this.inputKeys.set(s,a),R=!0)),R}setInputState(a,s){let R=this.keyToState(a);R!=null&&this.actionStates.set(R,s)}getInputState(a){return this.actionStates.has(a)?this.actionStates.get(a):(console.log("ERROR: trying to access an input action that doesn't exist ("+a+"). The allowed options are:"),this.actionStates.forEach(function(s,R,C){console.log("    - "+R)}),null)}updateCounters(){for(const[a,s]of this.counters)this.getInputState(a)?this.counters.set(a,s+1):this.counters.set(a,0)}getCounter(a){return this.counters.has(a)?this.counters.get(a):(console.log("ERROR: trying to access input action that doesn't have a counter ("+a+"). The counters are:"),this.counters.forEach(function(s,R,C){console.log("    - "+R+": "+s)}),null)}}var zn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Un={exports:{}};/*!
 * @license twgl.js 5.5.4 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
 * Available via the MIT license.
 * see: http://github.com/greggman/twgl.js for details
 */(function(ce,a){(function(R,C){ce.exports=C()})(typeof self<"u"?self:zn,()=>(()=>{var s={"./src/attributes.js":(z,u,H)=>{function ie(v){"@babel/helpers - typeof";return ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},ie(v)}u.__esModule=!0,u.createAttribsFromArrays=cr,u.createBufferFromArray=c,u.createBufferFromTypedArray=me,u.createBufferInfoFromArrays=f,u.createBuffersFromArrays=E,u.getArray_=U,u.getNumComponents_=Ce,u.setAttribInfoBufferFromArray=nr,u.setAttributeDefaults_=ur,u.setAttributePrefix=or;var j=W(H("./src/typedarrays.js")),le=W(H("./src/helper.js"));function oe(v){if(typeof WeakMap!="function")return null;var o=new WeakMap,i=new WeakMap;return(oe=function(h){return h?i:o})(v)}function W(v,o){if(!o&&v&&v.__esModule)return v;if(v===null||ie(v)!="object"&&typeof v!="function")return{default:v};var i=oe(o);if(i&&i.has(v))return i.get(v);var m={__proto__:null},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var T in v)if(T!=="default"&&Object.prototype.hasOwnProperty.call(v,T)){var w=h?Object.getOwnPropertyDescriptor(v,T):null;w&&(w.get||w.set)?Object.defineProperty(m,T,w):m[T]=v[T]}return m.default=v,i&&i.set(v,m),m}var he=35044,Q=34962,Ae=34963,D=34660,K=5120,Y=5121,_=5122,V=5123,ae=5124,Te=5125,Ge=5126,Re={attribPrefix:""};function or(v){Re.attribPrefix=v}function ur(v){le.copyExistingProperties(v,Re)}function rr(v,o,i,m,h){v.bindBuffer(o,i),v.bufferData(o,m,h||he)}function me(v,o,i,m){if(le.isBuffer(v,o))return o;i=i||Q;var h=v.createBuffer();return rr(v,i,h,o,m),h}function x(v){return v==="indices"}function B(v){return v===Int8Array||v===Uint8Array}function U(v){return v.length?v:v.data}var g=/coord|texture/i,de=/color|colour/i;function _e(v,o){var i;if(g.test(v)?i=2:de.test(v)?i=4:i=3,o%i>0)throw new Error("Can not guess numComponents for attribute '".concat(v,"'. Tried ").concat(i," but ").concat(o," values is not evenly divisible by ").concat(i,". You should specify it."));return i}function Ce(v,o,i){return v.numComponents||v.size||_e(o,i||U(v).length)}function We(v,o){if(j.isArrayBuffer(v))return v;if(j.isArrayBuffer(v.data))return v.data;Array.isArray(v)&&(v={data:v});var i=v.type?Ze(v.type):void 0;return i||(x(o)?i=Uint16Array:i=Float32Array),new i(v.data)}function Ue(v){return typeof v=="number"?v:v?j.getGLTypeForTypedArrayType(v):Ge}function Ze(v){return typeof v=="number"?j.getTypedArrayTypeForGLType(v):v||Float32Array}function He(v,o){return{buffer:o.buffer,numValues:24,type:Ue(o.type),arrayType:Ze(o.type)}}function fr(v,o){var i=o.data||o,m=Ze(o.type),h=i*m.BYTES_PER_ELEMENT,T=v.createBuffer();return v.bindBuffer(Q,T),v.bufferData(Q,h,o.drawType||he),{buffer:T,numValues:i,type:j.getGLTypeForTypedArrayType(m),arrayType:m}}function Tr(v,o,i){var m=We(o,i);return{arrayType:m.constructor,buffer:me(v,m,void 0,o.drawType),type:j.getGLTypeForTypedArray(m),numValues:0}}function cr(v,o){var i={};return Object.keys(o).forEach(function(m){if(!x(m)){var h=o[m],T=h.attrib||h.name||h.attribName||Re.attribPrefix+m;if(h.value){if(!Array.isArray(h.value)&&!j.isArrayBuffer(h.value))throw new Error("array.value is not array or typedarray");i[T]={value:h.value}}else{var w;h.buffer&&h.buffer instanceof WebGLBuffer?w=He:typeof h=="number"||typeof h.data=="number"?w=fr:w=Tr;var I=w(v,h,m),O=I.buffer,q=I.type,Z=I.numValues,$=I.arrayType,te=h.normalize!==void 0?h.normalize:B($),re=Ce(h,m,Z);i[T]={buffer:O,numComponents:re,type:q,normalize:te,stride:h.stride||0,offset:h.offset||0,divisor:h.divisor===void 0?void 0:h.divisor,drawType:h.drawType}}}}),v.bindBuffer(Q,null),i}function nr(v,o,i,m){i=We(i),m!==void 0?(v.bindBuffer(Q,o.buffer),v.bufferSubData(Q,m,i)):rr(v,Q,o.buffer,i,o.drawType)}function vr(v,o){return o===K||o===Y?1:o===_||o===V?2:o===ae||o===Te||o===Ge?4:0}var Sr=["position","positions","a_position"];function ue(v){var o,i;for(i=0;i<Sr.length&&(o=Sr[i],!(o in v));++i);i===Sr.length&&(o=Object.keys(v)[0]);var m=v[o],h=U(m).length;if(h===void 0)return 1;var T=Ce(m,o),w=h/T;if(h%T>0)throw new Error("numComponents ".concat(T," not correct for length ").concat(h));return w}function r(v,o){var i,m;for(m=0;m<Sr.length&&(i=Sr[m],!(i in o||(i=Re.attribPrefix+i,i in o)));++m);m===Sr.length&&(i=Object.keys(o)[0]);var h=o[i];if(!h.buffer)return 1;v.bindBuffer(Q,h.buffer);var T=v.getBufferParameter(Q,D);v.bindBuffer(Q,null);var w=vr(v,h.type),I=T/w,O=h.numComponents||h.size,q=I/O;if(q%1!==0)throw new Error("numComponents ".concat(O," not correct for length ").concat(length));return q}function f(v,o,i){var m=cr(v,o),h=Object.assign({},i||{});h.attribs=Object.assign({},i?i.attribs:{},m);var T=o.indices;if(T){var w=We(T,"indices");h.indices=me(v,w,Ae),h.numElements=w.length,h.elementType=j.getGLTypeForTypedArray(w)}else h.numElements||(h.numElements=r(v,h.attribs));return h}function c(v,o,i){var m=i==="indices"?Ae:Q,h=We(o,i);return me(v,h,m)}function E(v,o){var i={};return Object.keys(o).forEach(function(m){i[m]=c(v,o[m],m)}),o.indices?(i.numElements=o.indices.length,i.elementType=j.getGLTypeForTypedArray(We(o.indices),"indices")):i.numElements=ue(o),i}},"./src/draw.js":(z,u,H)=>{function ie(D){"@babel/helpers - typeof";return ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(K){return typeof K}:function(K){return K&&typeof Symbol=="function"&&K.constructor===Symbol&&K!==Symbol.prototype?"symbol":typeof K},ie(D)}u.__esModule=!0,u.drawBufferInfo=Q,u.drawObjectList=Ae;var j=oe(H("./src/programs.js"));function le(D){if(typeof WeakMap!="function")return null;var K=new WeakMap,Y=new WeakMap;return(le=function(V){return V?Y:K})(D)}function oe(D,K){if(!K&&D&&D.__esModule)return D;if(D===null||ie(D)!="object"&&typeof D!="function")return{default:D};var Y=le(K);if(Y&&Y.has(D))return Y.get(D);var _={__proto__:null},V=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ae in D)if(ae!=="default"&&Object.prototype.hasOwnProperty.call(D,ae)){var Te=V?Object.getOwnPropertyDescriptor(D,ae):null;Te&&(Te.get||Te.set)?Object.defineProperty(_,ae,Te):_[ae]=D[ae]}return _.default=D,Y&&Y.set(D,_),_}var W=4,he=5123;function Q(D,K,Y,_,V,ae){Y=Y===void 0?W:Y;var Te=K.indices,Ge=K.elementType,Re=_===void 0?K.numElements:_;V=V===void 0?0:V,Ge||Te?ae!==void 0?D.drawElementsInstanced(Y,Re,Ge===void 0?he:K.elementType,V,ae):D.drawElements(Y,Re,Ge===void 0?he:K.elementType,V):ae!==void 0?D.drawArraysInstanced(Y,V,Re,ae):D.drawArrays(Y,V,Re)}function Ae(D,K){var Y=null,_=null;K.forEach(function(V){if(V.active!==!1){var ae=V.programInfo,Te=V.vertexArrayInfo||V.bufferInfo,Ge=!1,Re=V.type===void 0?W:V.type;ae!==Y&&(Y=ae,D.useProgram(ae.program),Ge=!0),(Ge||Te!==_)&&(_&&_.vertexArrayObject&&!Te.vertexArrayObject&&D.bindVertexArray(null),_=Te,j.setBuffersAndAttributes(D,ae,Te)),j.setUniforms(ae,V.uniforms),Q(D,Te,Re,V.count,V.offset,V.instanceCount)}}),_&&_.vertexArrayObject&&D.bindVertexArray(null)}},"./src/framebuffers.js":(z,u,H)=>{function ie(ue){"@babel/helpers - typeof";return ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ie(ue)}u.__esModule=!0,u.bindFramebufferInfo=Sr,u.createFramebufferInfo=nr,u.resizeFramebufferInfo=vr;var j=W(H("./src/textures.js")),le=W(H("./src/helper.js"));function oe(ue){if(typeof WeakMap!="function")return null;var r=new WeakMap,f=new WeakMap;return(oe=function(E){return E?f:r})(ue)}function W(ue,r){if(!r&&ue&&ue.__esModule)return ue;if(ue===null||ie(ue)!="object"&&typeof ue!="function")return{default:ue};var f=oe(r);if(f&&f.has(ue))return f.get(ue);var c={__proto__:null},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in ue)if(v!=="default"&&Object.prototype.hasOwnProperty.call(ue,v)){var o=E?Object.getOwnPropertyDescriptor(ue,v):null;o&&(o.get||o.set)?Object.defineProperty(c,v,o):c[v]=ue[v]}return c.default=ue,f&&f.set(ue,c),c}var he=36160,Q=36161,Ae=3553,D=5121,K=6402,Y=6408,_=33190,V=36012,ae=35056,Te=36013,Ge=32854,Re=32855,or=36194,ur=33189,rr=6401,me=36168,x=34041,B=36064,U=36096,g=36128,de=33306,_e=33071,Ce=9729,We=[{format:Y,type:D,min:Ce,wrap:_e},{format:x}],Ue={};Ue[x]=de,Ue[rr]=g,Ue[me]=g,Ue[K]=U,Ue[ur]=U,Ue[_]=U,Ue[V]=U,Ue[ae]=de,Ue[Te]=de;function Ze(ue,r){return Ue[ue]||Ue[r]}var He={};He[Ge]=!0,He[Re]=!0,He[or]=!0,He[x]=!0,He[ur]=!0,He[rr]=!0,He[me]=!0;function fr(ue){return He[ue]}var Tr=32;function cr(ue){return ue>=B&&ue<B+Tr}function nr(ue,r,f,c){var E=he,v=ue.createFramebuffer();ue.bindFramebuffer(E,v),f=f||ue.drawingBufferWidth,c=c||ue.drawingBufferHeight,r=r||We;var o=[],i={framebuffer:v,attachments:[],width:f,height:c};return r.forEach(function(m,h){var T=m.attachment,w=m.samples,I=m.format,O=m.attachmentPoint||Ze(I,m.internalFormat);if(O||(O=B+h),cr(O)&&o.push(O),!T)if(w!==void 0||fr(I))T=ue.createRenderbuffer(),ue.bindRenderbuffer(Q,T),w>1?ue.renderbufferStorageMultisample(Q,w,I,f,c):ue.renderbufferStorage(Q,I,f,c);else{var q=Object.assign({},m);q.width=f,q.height=c,q.auto===void 0&&(q.auto=!1,q.min=q.min||q.minMag||Ce,q.mag=q.mag||q.minMag||Ce,q.wrapS=q.wrapS||q.wrap||_e,q.wrapT=q.wrapT||q.wrap||_e),T=j.createTexture(ue,q)}if(le.isRenderbuffer(ue,T))ue.framebufferRenderbuffer(E,O,Q,T);else if(le.isTexture(ue,T))m.layer!==void 0?ue.framebufferTextureLayer(E,O,T,m.level||0,m.layer):ue.framebufferTexture2D(E,O,m.target||Ae,T,m.level||0);else throw new Error("unknown attachment type");i.attachments.push(T)}),ue.drawBuffers&&ue.drawBuffers(o),i}function vr(ue,r,f,c,E){c=c||ue.drawingBufferWidth,E=E||ue.drawingBufferHeight,r.width=c,r.height=E,f=f||We,f.forEach(function(v,o){var i=r.attachments[o],m=v.format,h=v.samples;if(h!==void 0||le.isRenderbuffer(ue,i))ue.bindRenderbuffer(Q,i),h>1?ue.renderbufferStorageMultisample(Q,h,m,c,E):ue.renderbufferStorage(Q,m,c,E);else if(le.isTexture(ue,i))j.resizeTexture(ue,i,v,c,E);else throw new Error("unknown attachment type")})}function Sr(ue,r,f){f=f||he,r?(ue.bindFramebuffer(f,r.framebuffer),ue.viewport(0,0,r.width,r.height)):(ue.bindFramebuffer(f,null),ue.viewport(0,0,ue.drawingBufferWidth,ue.drawingBufferHeight))}},"./src/helper.js":(z,u)=>{u.__esModule=!0,u.copyExistingProperties=j,u.copyNamedProperties=ie,u.error=le,u.isBuffer=Q,u.isRenderbuffer=Ae,u.isSampler=Y,u.isShader=D,u.isTexture=K,u.warn=oe;function H(_){"@babel/helpers - typeof";return H=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(V){return typeof V}:function(V){return V&&typeof Symbol=="function"&&V.constructor===Symbol&&V!==Symbol.prototype?"symbol":typeof V},H(_)}function ie(_,V,ae){_.forEach(function(Te){var Ge=V[Te];Ge!==void 0&&(ae[Te]=Ge)})}function j(_,V){Object.keys(V).forEach(function(ae){V.hasOwnProperty(ae)&&_.hasOwnProperty(ae)&&(V[ae]=_[ae])})}function le(){var _;(_=console).error.apply(_,arguments)}function oe(){var _;(_=console).warn.apply(_,arguments)}var W=new Map;function he(_,V){if(!_||H(_)!=="object")return!1;var ae=W.get(V);ae||(ae=new WeakMap,W.set(V,ae));var Te=ae.get(_);if(Te===void 0){var Ge=Object.prototype.toString.call(_);Te=Ge.substring(8,Ge.length-1)===V,ae.set(_,Te)}return Te}function Q(_,V){return typeof WebGLBuffer<"u"&&he(V,"WebGLBuffer")}function Ae(_,V){return typeof WebGLRenderbuffer<"u"&&he(V,"WebGLRenderbuffer")}function D(_,V){return typeof WebGLShader<"u"&&he(V,"WebGLShader")}function K(_,V){return typeof WebGLTexture<"u"&&he(V,"WebGLTexture")}function Y(_,V){return typeof WebGLSampler<"u"&&he(V,"WebGLSampler")}},"./src/m4.js":(z,u,H)=>{function ie(r){"@babel/helpers - typeof";return ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},ie(r)}u.__esModule=!0,u.axisRotate=Tr,u.axisRotation=fr,u.copy=D,u.create=Ae,u.frustum=rr,u.getAxis=Ge,u.getTranslation=Te,u.identity=K,u.inverse=_,u.lookAt=U,u.multiply=V,u.negate=Q,u.ortho=ur,u.perspective=or,u.rotateX=Ce,u.rotateY=Ue,u.rotateZ=He,u.rotationX=_e,u.rotationY=We,u.rotationZ=Ze,u.scale=nr,u.scaling=cr,u.setAxis=Re,u.setDefaultType=he,u.setTranslation=ae,u.transformDirection=Sr,u.transformNormal=ue,u.transformPoint=vr,u.translate=de,u.translation=g,u.transpose=Y;var j=oe(H("./src/v3.js"));function le(r){if(typeof WeakMap!="function")return null;var f=new WeakMap,c=new WeakMap;return(le=function(v){return v?c:f})(r)}function oe(r,f){if(!f&&r&&r.__esModule)return r;if(r===null||ie(r)!="object"&&typeof r!="function")return{default:r};var c=le(f);if(c&&c.has(r))return c.get(r);var E={__proto__:null},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in r)if(o!=="default"&&Object.prototype.hasOwnProperty.call(r,o)){var i=v?Object.getOwnPropertyDescriptor(r,o):null;i&&(i.get||i.set)?Object.defineProperty(E,o,i):E[o]=r[o]}return E.default=r,c&&c.set(r,E),E}var W=Float32Array;function he(r){var f=W;return W=r,f}function Q(r,f){return f=f||new W(16),f[0]=-r[0],f[1]=-r[1],f[2]=-r[2],f[3]=-r[3],f[4]=-r[4],f[5]=-r[5],f[6]=-r[6],f[7]=-r[7],f[8]=-r[8],f[9]=-r[9],f[10]=-r[10],f[11]=-r[11],f[12]=-r[12],f[13]=-r[13],f[14]=-r[14],f[15]=-r[15],f}function Ae(){return new W(16).fill(0)}function D(r,f){return f=f||new W(16),f[0]=r[0],f[1]=r[1],f[2]=r[2],f[3]=r[3],f[4]=r[4],f[5]=r[5],f[6]=r[6],f[7]=r[7],f[8]=r[8],f[9]=r[9],f[10]=r[10],f[11]=r[11],f[12]=r[12],f[13]=r[13],f[14]=r[14],f[15]=r[15],f}function K(r){return r=r||new W(16),r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Y(r,f){if(f=f||new W(16),f===r){var c;return c=r[1],r[1]=r[4],r[4]=c,c=r[2],r[2]=r[8],r[8]=c,c=r[3],r[3]=r[12],r[12]=c,c=r[6],r[6]=r[9],r[9]=c,c=r[7],r[7]=r[13],r[13]=c,c=r[11],r[11]=r[14],r[14]=c,f}var E=r[0*4+0],v=r[0*4+1],o=r[0*4+2],i=r[0*4+3],m=r[1*4+0],h=r[1*4+1],T=r[1*4+2],w=r[1*4+3],I=r[2*4+0],O=r[2*4+1],q=r[2*4+2],Z=r[2*4+3],$=r[3*4+0],te=r[3*4+1],re=r[3*4+2],se=r[3*4+3];return f[0]=E,f[1]=m,f[2]=I,f[3]=$,f[4]=v,f[5]=h,f[6]=O,f[7]=te,f[8]=o,f[9]=T,f[10]=q,f[11]=re,f[12]=i,f[13]=w,f[14]=Z,f[15]=se,f}function _(r,f){f=f||new W(16);var c=r[0*4+0],E=r[0*4+1],v=r[0*4+2],o=r[0*4+3],i=r[1*4+0],m=r[1*4+1],h=r[1*4+2],T=r[1*4+3],w=r[2*4+0],I=r[2*4+1],O=r[2*4+2],q=r[2*4+3],Z=r[3*4+0],$=r[3*4+1],te=r[3*4+2],re=r[3*4+3],se=O*re,ve=te*q,ee=h*re,pe=te*T,Oe=h*q,Ke=O*T,ke=v*re,Ve=te*o,we=v*q,De=O*o,Qe=v*T,Xe=h*o,ze=w*$,qe=Z*I,Je=i*$,Le=Z*m,Ne=i*I,yr=w*m,lr=c*$,Ar=Z*E,_r=c*I,Ir=w*E,Ur=c*m,Gr=i*E,rt=se*m+pe*I+Oe*$-(ve*m+ee*I+Ke*$),_t=ve*E+ke*I+De*$-(se*E+Ve*I+we*$),wt=ee*E+Ve*m+Qe*$-(pe*E+ke*m+Xe*$),Pt=Ke*E+we*m+Xe*I-(Oe*E+De*m+Qe*I),hr=1/(c*rt+i*_t+w*wt+Z*Pt);return f[0]=hr*rt,f[1]=hr*_t,f[2]=hr*wt,f[3]=hr*Pt,f[4]=hr*(ve*i+ee*w+Ke*Z-(se*i+pe*w+Oe*Z)),f[5]=hr*(se*c+Ve*w+we*Z-(ve*c+ke*w+De*Z)),f[6]=hr*(pe*c+ke*i+Xe*Z-(ee*c+Ve*i+Qe*Z)),f[7]=hr*(Oe*c+De*i+Qe*w-(Ke*c+we*i+Xe*w)),f[8]=hr*(ze*T+Le*q+Ne*re-(qe*T+Je*q+yr*re)),f[9]=hr*(qe*o+lr*q+Ir*re-(ze*o+Ar*q+_r*re)),f[10]=hr*(Je*o+Ar*T+Ur*re-(Le*o+lr*T+Gr*re)),f[11]=hr*(yr*o+_r*T+Gr*q-(Ne*o+Ir*T+Ur*q)),f[12]=hr*(Je*O+yr*te+qe*h-(Ne*te+ze*h+Le*O)),f[13]=hr*(_r*te+ze*v+Ar*O-(lr*O+Ir*te+qe*v)),f[14]=hr*(lr*h+Gr*te+Le*v-(Ur*te+Je*v+Ar*h)),f[15]=hr*(Ur*O+Ne*v+Ir*h-(_r*h+Gr*O+yr*v)),f}function V(r,f,c){c=c||new W(16);var E=r[0],v=r[1],o=r[2],i=r[3],m=r[4],h=r[5],T=r[6],w=r[7],I=r[8],O=r[9],q=r[10],Z=r[11],$=r[12],te=r[13],re=r[14],se=r[15],ve=f[0],ee=f[1],pe=f[2],Oe=f[3],Ke=f[4],ke=f[5],Ve=f[6],we=f[7],De=f[8],Qe=f[9],Xe=f[10],ze=f[11],qe=f[12],Je=f[13],Le=f[14],Ne=f[15];return c[0]=E*ve+m*ee+I*pe+$*Oe,c[1]=v*ve+h*ee+O*pe+te*Oe,c[2]=o*ve+T*ee+q*pe+re*Oe,c[3]=i*ve+w*ee+Z*pe+se*Oe,c[4]=E*Ke+m*ke+I*Ve+$*we,c[5]=v*Ke+h*ke+O*Ve+te*we,c[6]=o*Ke+T*ke+q*Ve+re*we,c[7]=i*Ke+w*ke+Z*Ve+se*we,c[8]=E*De+m*Qe+I*Xe+$*ze,c[9]=v*De+h*Qe+O*Xe+te*ze,c[10]=o*De+T*Qe+q*Xe+re*ze,c[11]=i*De+w*Qe+Z*Xe+se*ze,c[12]=E*qe+m*Je+I*Le+$*Ne,c[13]=v*qe+h*Je+O*Le+te*Ne,c[14]=o*qe+T*Je+q*Le+re*Ne,c[15]=i*qe+w*Je+Z*Le+se*Ne,c}function ae(r,f,c){return c=c||K(),r!==c&&(c[0]=r[0],c[1]=r[1],c[2]=r[2],c[3]=r[3],c[4]=r[4],c[5]=r[5],c[6]=r[6],c[7]=r[7],c[8]=r[8],c[9]=r[9],c[10]=r[10],c[11]=r[11]),c[12]=f[0],c[13]=f[1],c[14]=f[2],c[15]=1,c}function Te(r,f){return f=f||j.create(),f[0]=r[12],f[1]=r[13],f[2]=r[14],f}function Ge(r,f,c){c=c||j.create();var E=f*4;return c[0]=r[E+0],c[1]=r[E+1],c[2]=r[E+2],c}function Re(r,f,c,E){E!==r&&(E=D(r,E));var v=c*4;return E[v+0]=f[0],E[v+1]=f[1],E[v+2]=f[2],E}function or(r,f,c,E,v){v=v||new W(16);var o=Math.tan(Math.PI*.5-.5*r),i=1/(c-E);return v[0]=o/f,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=o,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=(c+E)*i,v[11]=-1,v[12]=0,v[13]=0,v[14]=c*E*i*2,v[15]=0,v}function ur(r,f,c,E,v,o,i){return i=i||new W(16),i[0]=2/(f-r),i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2/(E-c),i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2/(v-o),i[11]=0,i[12]=(f+r)/(r-f),i[13]=(E+c)/(c-E),i[14]=(o+v)/(v-o),i[15]=1,i}function rr(r,f,c,E,v,o,i){i=i||new W(16);var m=f-r,h=E-c,T=v-o;return i[0]=2*v/m,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=2*v/h,i[6]=0,i[7]=0,i[8]=(r+f)/m,i[9]=(E+c)/h,i[10]=o/T,i[11]=-1,i[12]=0,i[13]=0,i[14]=v*o/T,i[15]=0,i}var me,x,B;function U(r,f,c,E){return E=E||new W(16),me=me||j.create(),x=x||j.create(),B=B||j.create(),j.normalize(j.subtract(r,f,B),B),j.normalize(j.cross(c,B,me),me),j.normalize(j.cross(B,me,x),x),E[0]=me[0],E[1]=me[1],E[2]=me[2],E[3]=0,E[4]=x[0],E[5]=x[1],E[6]=x[2],E[7]=0,E[8]=B[0],E[9]=B[1],E[10]=B[2],E[11]=0,E[12]=r[0],E[13]=r[1],E[14]=r[2],E[15]=1,E}function g(r,f){return f=f||new W(16),f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=r[0],f[13]=r[1],f[14]=r[2],f[15]=1,f}function de(r,f,c){c=c||new W(16);var E=f[0],v=f[1],o=f[2],i=r[0],m=r[1],h=r[2],T=r[3],w=r[1*4+0],I=r[1*4+1],O=r[1*4+2],q=r[1*4+3],Z=r[2*4+0],$=r[2*4+1],te=r[2*4+2],re=r[2*4+3],se=r[3*4+0],ve=r[3*4+1],ee=r[3*4+2],pe=r[3*4+3];return r!==c&&(c[0]=i,c[1]=m,c[2]=h,c[3]=T,c[4]=w,c[5]=I,c[6]=O,c[7]=q,c[8]=Z,c[9]=$,c[10]=te,c[11]=re),c[12]=i*E+w*v+Z*o+se,c[13]=m*E+I*v+$*o+ve,c[14]=h*E+O*v+te*o+ee,c[15]=T*E+q*v+re*o+pe,c}function _e(r,f){f=f||new W(16);var c=Math.cos(r),E=Math.sin(r);return f[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=c,f[6]=E,f[7]=0,f[8]=0,f[9]=-E,f[10]=c,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function Ce(r,f,c){c=c||new W(16);var E=r[4],v=r[5],o=r[6],i=r[7],m=r[8],h=r[9],T=r[10],w=r[11],I=Math.cos(f),O=Math.sin(f);return c[4]=I*E+O*m,c[5]=I*v+O*h,c[6]=I*o+O*T,c[7]=I*i+O*w,c[8]=I*m-O*E,c[9]=I*h-O*v,c[10]=I*T-O*o,c[11]=I*w-O*i,r!==c&&(c[0]=r[0],c[1]=r[1],c[2]=r[2],c[3]=r[3],c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c}function We(r,f){f=f||new W(16);var c=Math.cos(r),E=Math.sin(r);return f[0]=c,f[1]=0,f[2]=-E,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=E,f[9]=0,f[10]=c,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function Ue(r,f,c){c=c||new W(16);var E=r[0*4+0],v=r[0*4+1],o=r[0*4+2],i=r[0*4+3],m=r[2*4+0],h=r[2*4+1],T=r[2*4+2],w=r[2*4+3],I=Math.cos(f),O=Math.sin(f);return c[0]=I*E-O*m,c[1]=I*v-O*h,c[2]=I*o-O*T,c[3]=I*i-O*w,c[8]=I*m+O*E,c[9]=I*h+O*v,c[10]=I*T+O*o,c[11]=I*w+O*i,r!==c&&(c[4]=r[4],c[5]=r[5],c[6]=r[6],c[7]=r[7],c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c}function Ze(r,f){f=f||new W(16);var c=Math.cos(r),E=Math.sin(r);return f[0]=c,f[1]=E,f[2]=0,f[3]=0,f[4]=-E,f[5]=c,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function He(r,f,c){c=c||new W(16);var E=r[0*4+0],v=r[0*4+1],o=r[0*4+2],i=r[0*4+3],m=r[1*4+0],h=r[1*4+1],T=r[1*4+2],w=r[1*4+3],I=Math.cos(f),O=Math.sin(f);return c[0]=I*E+O*m,c[1]=I*v+O*h,c[2]=I*o+O*T,c[3]=I*i+O*w,c[4]=I*m-O*E,c[5]=I*h-O*v,c[6]=I*T-O*o,c[7]=I*w-O*i,r!==c&&(c[8]=r[8],c[9]=r[9],c[10]=r[10],c[11]=r[11],c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c}function fr(r,f,c){c=c||new W(16);var E=r[0],v=r[1],o=r[2],i=Math.sqrt(E*E+v*v+o*o);E/=i,v/=i,o/=i;var m=E*E,h=v*v,T=o*o,w=Math.cos(f),I=Math.sin(f),O=1-w;return c[0]=m+(1-m)*w,c[1]=E*v*O+o*I,c[2]=E*o*O-v*I,c[3]=0,c[4]=E*v*O-o*I,c[5]=h+(1-h)*w,c[6]=v*o*O+E*I,c[7]=0,c[8]=E*o*O+v*I,c[9]=v*o*O-E*I,c[10]=T+(1-T)*w,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function Tr(r,f,c,E){E=E||new W(16);var v=f[0],o=f[1],i=f[2],m=Math.sqrt(v*v+o*o+i*i);v/=m,o/=m,i/=m;var h=v*v,T=o*o,w=i*i,I=Math.cos(c),O=Math.sin(c),q=1-I,Z=h+(1-h)*I,$=v*o*q+i*O,te=v*i*q-o*O,re=v*o*q-i*O,se=T+(1-T)*I,ve=o*i*q+v*O,ee=v*i*q+o*O,pe=o*i*q-v*O,Oe=w+(1-w)*I,Ke=r[0],ke=r[1],Ve=r[2],we=r[3],De=r[4],Qe=r[5],Xe=r[6],ze=r[7],qe=r[8],Je=r[9],Le=r[10],Ne=r[11];return E[0]=Z*Ke+$*De+te*qe,E[1]=Z*ke+$*Qe+te*Je,E[2]=Z*Ve+$*Xe+te*Le,E[3]=Z*we+$*ze+te*Ne,E[4]=re*Ke+se*De+ve*qe,E[5]=re*ke+se*Qe+ve*Je,E[6]=re*Ve+se*Xe+ve*Le,E[7]=re*we+se*ze+ve*Ne,E[8]=ee*Ke+pe*De+Oe*qe,E[9]=ee*ke+pe*Qe+Oe*Je,E[10]=ee*Ve+pe*Xe+Oe*Le,E[11]=ee*we+pe*ze+Oe*Ne,r!==E&&(E[12]=r[12],E[13]=r[13],E[14]=r[14],E[15]=r[15]),E}function cr(r,f){return f=f||new W(16),f[0]=r[0],f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=r[1],f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=r[2],f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,f}function nr(r,f,c){c=c||new W(16);var E=f[0],v=f[1],o=f[2];return c[0]=E*r[0],c[1]=E*r[1],c[2]=E*r[2],c[3]=E*r[3],c[4]=v*r[4],c[5]=v*r[5],c[6]=v*r[6],c[7]=v*r[7],c[8]=o*r[8],c[9]=o*r[9],c[10]=o*r[10],c[11]=o*r[11],r!==c&&(c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c}function vr(r,f,c){c=c||j.create();var E=f[0],v=f[1],o=f[2],i=E*r[0*4+3]+v*r[1*4+3]+o*r[2*4+3]+r[3*4+3];return c[0]=(E*r[0]+v*r[4]+o*r[8]+r[12])/i,c[1]=(E*r[1]+v*r[5]+o*r[9]+r[13])/i,c[2]=(E*r[2]+v*r[6]+o*r[10]+r[14])/i,c}function Sr(r,f,c){c=c||j.create();var E=f[0],v=f[1],o=f[2];return c[0]=E*r[0]+v*r[4]+o*r[8],c[1]=E*r[1]+v*r[5]+o*r[9],c[2]=E*r[2]+v*r[6]+o*r[10],c}function ue(r,f,c){c=c||j.create();var E=_(r),v=f[0],o=f[1],i=f[2];return c[0]=v*E[0]+o*E[1]+i*E[2],c[1]=v*E[4]+o*E[5]+i*E[6],c[2]=v*E[8]+o*E[9]+i*E[10],c}},"./src/primitives.js":(z,u,H)=>{function ie(o){"@babel/helpers - typeof";return ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},ie(o)}u.__esModule=!0,u.concatVertices=f,u.create3DFBuffers=u.create3DFBufferInfo=void 0,u.create3DFVertices=We,u.createAugmentedTypedArray=_,u.createCrescentBuffers=u.createCrescentBufferInfo=void 0,u.createCrescentVertices=Ue,u.createCubeBuffers=u.createCubeBufferInfo=u.createCresentVertices=u.createCresentBuffers=u.createCresentBufferInfo=void 0,u.createCubeVertices=de,u.createCylinderBuffers=u.createCylinderBufferInfo=void 0,u.createCylinderVertices=Ze,u.createDiscBuffers=u.createDiscBufferInfo=void 0,u.createDiscVertices=fr,u.createPlaneBuffers=u.createPlaneBufferInfo=void 0,u.createPlaneVertices=B,u.createSphereBuffers=u.createSphereBufferInfo=void 0,u.createSphereVertices=U,u.createTorusBuffers=u.createTorusBufferInfo=void 0,u.createTorusVertices=He,u.createTruncatedConeBuffers=u.createTruncatedConeBufferInfo=void 0,u.createTruncatedConeVertices=_e,u.createXYQuadBuffers=u.createXYQuadBufferInfo=void 0,u.createXYQuadVertices=x,u.deindexVertices=ae,u.duplicateVertices=c,u.flattenNormals=Te,u.makeRandomVertexColors=cr,u.reorientDirections=or,u.reorientNormals=ur,u.reorientPositions=rr,u.reorientVertices=me;var j=Ae(H("./src/attributes.js")),le=Ae(H("./src/helper.js")),oe=Ae(H("./src/typedarrays.js")),W=Ae(H("./src/m4.js")),he=Ae(H("./src/v3.js"));function Q(o){if(typeof WeakMap!="function")return null;var i=new WeakMap,m=new WeakMap;return(Q=function(T){return T?m:i})(o)}function Ae(o,i){if(!i&&o&&o.__esModule)return o;if(o===null||ie(o)!="object"&&typeof o!="function")return{default:o};var m=Q(i);if(m&&m.has(o))return m.get(o);var h={__proto__:null},T=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in o)if(w!=="default"&&Object.prototype.hasOwnProperty.call(o,w)){var I=T?Object.getOwnPropertyDescriptor(o,w):null;I&&(I.get||I.set)?Object.defineProperty(h,w,I):h[w]=o[w]}return h.default=o,m&&m.set(o,h),h}var D=j.getArray_,K=j.getNumComponents_;function Y(o,i){var m=0;return o.push=function(){for(var h=0;h<arguments.length;++h){var T=arguments[h];if(T instanceof Array||oe.isArrayBuffer(T))for(var w=0;w<T.length;++w)o[m++]=T[w];else o[m++]=T}},o.reset=function(h){m=h||0},o.numComponents=i,Object.defineProperty(o,"numElements",{get:function(){return this.length/this.numComponents|0}}),o}function _(o,i,m){var h=m||Float32Array;return Y(new h(o*i),o)}function V(o){return o!=="indices"}function ae(o){var i=o.indices,m={},h=i.length;function T(w){for(var I=o[w],O=I.numComponents,q=_(O,h,I.constructor),Z=0;Z<h;++Z)for(var $=i[Z],te=$*O,re=0;re<O;++re)q.push(I[te+re]);m[w]=q}return Object.keys(o).filter(V).forEach(T),m}function Te(o){if(o.indices)throw new Error("can not flatten normals of indexed vertices. deindex them first");for(var i=o.normal,m=i.length,h=0;h<m;h+=9){var T=i[h+0],w=i[h+1],I=i[h+2],O=i[h+3],q=i[h+4],Z=i[h+5],$=i[h+6],te=i[h+7],re=i[h+8],se=T+O+$,ve=w+q+te,ee=I+Z+re,pe=Math.sqrt(se*se+ve*ve+ee*ee);se/=pe,ve/=pe,ee/=pe,i[h+0]=se,i[h+1]=ve,i[h+2]=ee,i[h+3]=se,i[h+4]=ve,i[h+5]=ee,i[h+6]=se,i[h+7]=ve,i[h+8]=ee}return o}function Ge(o,i,m){for(var h=o.length,T=new Float32Array(3),w=0;w<h;w+=3)m(i,[o[w],o[w+1],o[w+2]],T),o[w]=T[0],o[w+1]=T[1],o[w+2]=T[2]}function Re(o,i,m){m=m||he.create();var h=i[0],T=i[1],w=i[2];return m[0]=h*o[0]+T*o[1]+w*o[2],m[1]=h*o[4]+T*o[5]+w*o[6],m[2]=h*o[8]+T*o[9]+w*o[10],m}function or(o,i){return Ge(o,i,W.transformDirection),o}function ur(o,i){return Ge(o,W.inverse(i),Re),o}function rr(o,i){return Ge(o,i,W.transformPoint),o}function me(o,i){return Object.keys(o).forEach(function(m){var h=o[m];m.indexOf("pos")>=0?rr(h,i):m.indexOf("tan")>=0||m.indexOf("binorm")>=0?or(h,i):m.indexOf("norm")>=0&&ur(h,i)}),o}function x(o,i,m){return o=o||2,i=i||0,m=m||0,o*=.5,{position:{numComponents:2,data:[i+-1*o,m+-1*o,i+1*o,m+-1*o,i+-1*o,m+1*o,i+1*o,m+1*o]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function B(o,i,m,h,T){o=o||1,i=i||1,m=m||1,h=h||1,T=T||W.identity();for(var w=(m+1)*(h+1),I=_(3,w),O=_(3,w),q=_(2,w),Z=0;Z<=h;Z++)for(var $=0;$<=m;$++){var te=$/m,re=Z/h;I.push(o*te-o*.5,0,i*re-i*.5),O.push(0,1,0),q.push(te,re)}for(var se=m+1,ve=_(3,m*h*2,Uint16Array),ee=0;ee<h;ee++)for(var pe=0;pe<m;pe++)ve.push((ee+0)*se+pe,(ee+1)*se+pe,(ee+0)*se+pe+1),ve.push((ee+1)*se+pe,(ee+1)*se+pe+1,(ee+0)*se+pe+1);var Oe=me({position:I,normal:O,texcoord:q,indices:ve},T);return Oe}function U(o,i,m,h,T,w,I){if(i<=0||m<=0)throw new Error("subdivisionAxis and subdivisionHeight must be > 0");h=h||0,T=T||Math.PI,w=w||0,I=I||Math.PI*2;for(var O=T-h,q=I-w,Z=(i+1)*(m+1),$=_(3,Z),te=_(3,Z),re=_(2,Z),se=0;se<=m;se++)for(var ve=0;ve<=i;ve++){var ee=ve/i,pe=se/m,Oe=q*ee+w,Ke=O*pe+h,ke=Math.sin(Oe),Ve=Math.cos(Oe),we=Math.sin(Ke),De=Math.cos(Ke),Qe=Ve*we,Xe=De,ze=ke*we;$.push(o*Qe,o*Xe,o*ze),te.push(Qe,Xe,ze),re.push(1-ee,pe)}for(var qe=i+1,Je=_(3,i*m*2,Uint16Array),Le=0;Le<i;Le++)for(var Ne=0;Ne<m;Ne++)Je.push((Ne+0)*qe+Le,(Ne+0)*qe+Le+1,(Ne+1)*qe+Le),Je.push((Ne+1)*qe+Le,(Ne+0)*qe+Le+1,(Ne+1)*qe+Le+1);return{position:$,normal:te,texcoord:re,indices:Je}}var g=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function de(o){o=o||1;for(var i=o/2,m=[[-i,-i,-i],[+i,-i,-i],[-i,+i,-i],[+i,+i,-i],[-i,-i,+i],[+i,-i,+i],[-i,+i,+i],[+i,+i,+i]],h=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],T=[[1,0],[0,0],[0,1],[1,1]],w=6*4,I=_(3,w),O=_(3,w),q=_(2,w),Z=_(3,6*2,Uint16Array),$=0;$<6;++$){for(var te=g[$],re=0;re<4;++re){var se=m[te[re]],ve=h[$],ee=T[re];I.push(se),O.push(ve),q.push(ee)}var pe=4*$;Z.push(pe+0,pe+1,pe+2),Z.push(pe+0,pe+2,pe+3)}return{position:I,normal:O,texcoord:q,indices:Z}}function _e(o,i,m,h,T,w,I){if(h<3)throw new Error("radialSubdivisions must be 3 or greater");if(T<1)throw new Error("verticalSubdivisions must be 1 or greater");for(var O=w===void 0?!0:w,q=I===void 0?!0:I,Z=(O?2:0)+(q?2:0),$=(h+1)*(T+1+Z),te=_(3,$),re=_(3,$),se=_(2,$),ve=_(3,h*(T+Z/2)*2,Uint16Array),ee=h+1,pe=Math.atan2(o-i,m),Oe=Math.cos(pe),Ke=Math.sin(pe),ke=O?-2:0,Ve=T+(q?2:0),we=ke;we<=Ve;++we){var De=we/T,Qe=m*De,Xe=void 0;we<0?(Qe=0,De=1,Xe=o):we>T?(Qe=m,De=1,Xe=i):Xe=o+(i-o)*(we/T),(we===-2||we===T+2)&&(Xe=0,De=0),Qe-=m/2;for(var ze=0;ze<ee;++ze){var qe=Math.sin(ze*Math.PI*2/h),Je=Math.cos(ze*Math.PI*2/h);te.push(qe*Xe,Qe,Je*Xe),we<0?re.push(0,-1,0):we>T?re.push(0,1,0):Xe===0?re.push(0,0,0):re.push(qe*Oe,Ke,Je*Oe),se.push(ze/h,1-De)}}for(var Le=0;Le<T+Z;++Le)if(!(Le===1&&O||Le===T+Z-2&&q))for(var Ne=0;Ne<h;++Ne)ve.push(ee*(Le+0)+0+Ne,ee*(Le+0)+1+Ne,ee*(Le+1)+1+Ne),ve.push(ee*(Le+0)+0+Ne,ee*(Le+1)+1+Ne,ee*(Le+1)+0+Ne);return{position:te,normal:re,texcoord:se,indices:ve}}function Ce(o,i){i=i||[];for(var m=[],h=0;h<o.length;h+=4){var T=o[h],w=o.slice(h+1,h+4);w.push.apply(w,i);for(var I=0;I<T;++I)m.push.apply(m,w)}return m}function We(){var o=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],i=[.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0],m=Ce([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),h=Ce([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),T=o.length/3,w={position:_(3,T),texcoord:_(2,T),normal:_(3,T),color:_(4,T,Uint8Array),indices:_(3,T/3,Uint16Array)};w.position.push(o),w.texcoord.push(i),w.normal.push(m),w.color.push(h);for(var I=0;I<T;++I)w.indices.push(I);return w}function Ue(o,i,m,h,T,w,I){if(T<=0)throw new Error("subdivisionDown must be > 0");w=w||0,I=I||1;var O=2,q=I-w,Z=(T+1)*2*(2+O),$=_(3,Z),te=_(3,Z),re=_(2,Z);function se(Ve,we,De){return Ve+(we-Ve)*De}function ve(Ve,we,De,Qe,Xe,ze){for(var qe=0;qe<=T;qe++){var Je=we/(O-1),Le=qe/T,Ne=(Je-.5)*2,yr=(w+Le*q)*Math.PI,lr=Math.sin(yr),Ar=Math.cos(yr),_r=se(o,Ve,lr),Ir=Ne*h,Ur=Ar*o,Gr=lr*_r;$.push(Ir,Ur,Gr);var rt=he.add(he.multiply([0,lr,Ar],De),Qe);te.push(rt),re.push(Je*Xe+ze,Le)}}for(var ee=0;ee<O;ee++){var pe=(ee/(O-1)-.5)*2;ve(i,ee,[1,1,1],[0,0,0],1,0),ve(i,ee,[0,0,0],[pe,0,0],0,0),ve(m,ee,[1,1,1],[0,0,0],1,0),ve(m,ee,[0,0,0],[pe,0,0],0,1)}var Oe=_(3,T*2*(2+O),Uint16Array);function Ke(Ve,we){for(var De=0;De<T;++De)Oe.push(Ve+De+0,Ve+De+1,we+De+0),Oe.push(Ve+De+1,we+De+1,we+De+0)}var ke=T+1;return Ke(ke*0,ke*4),Ke(ke*5,ke*7),Ke(ke*6,ke*2),Ke(ke*3,ke*1),{position:$,normal:te,texcoord:re,indices:Oe}}function Ze(o,i,m,h,T,w){return _e(o,o,i,m,h,T,w)}function He(o,i,m,h,T,w){if(m<3)throw new Error("radialSubdivisions must be 3 or greater");if(h<3)throw new Error("verticalSubdivisions must be 3 or greater");T=T||0,w=w||Math.PI*2;for(var I=w-T,O=m+1,q=h+1,Z=O*q,$=_(3,Z),te=_(3,Z),re=_(2,Z),se=_(3,m*h*2,Uint16Array),ve=0;ve<q;++ve)for(var ee=ve/h,pe=ee*Math.PI*2,Oe=Math.sin(pe),Ke=o+Oe*i,ke=Math.cos(pe),Ve=ke*i,we=0;we<O;++we){var De=we/m,Qe=T+De*I,Xe=Math.sin(Qe),ze=Math.cos(Qe),qe=Xe*Ke,Je=ze*Ke,Le=Xe*Oe,Ne=ze*Oe;$.push(qe,Ve,Je),te.push(Le,ke,Ne),re.push(De,1-ee)}for(var yr=0;yr<h;++yr)for(var lr=0;lr<m;++lr){var Ar=1+lr,_r=1+yr;se.push(O*yr+lr,O*_r+lr,O*yr+Ar),se.push(O*_r+lr,O*_r+Ar,O*yr+Ar)}return{position:$,normal:te,texcoord:re,indices:se}}function fr(o,i,m,h,T){if(i<3)throw new Error("divisions must be at least 3");m=m||1,T=T||1,h=h||0;for(var w=(i+1)*(m+1),I=_(3,w),O=_(3,w),q=_(2,w),Z=_(3,m*i*2,Uint16Array),$=0,te=o-h,re=i+1,se=0;se<=m;++se){for(var ve=h+te*Math.pow(se/m,T),ee=0;ee<=i;++ee){var pe=2*Math.PI*ee/i,Oe=ve*Math.cos(pe),Ke=ve*Math.sin(pe);if(I.push(Oe,0,Ke),O.push(0,1,0),q.push(1-ee/i,se/m),se>0&&ee!==i){var ke=$+(ee+1),Ve=$+ee,we=$+ee-re,De=$+(ee+1)-re;Z.push(ke,Ve,we),Z.push(ke,we,De)}}$+=i+1}return{position:I,normal:O,texcoord:q,indices:Z}}function Tr(o){return Math.random()*o|0}function cr(o,i){i=i||{};var m=o.position.numElements,h=_(4,m,Uint8Array),T=i.rand||function(te,re){return re<3?Tr(256):255};if(o.color=h,o.indices)for(var w=0;w<m;++w)h.push(T(w,0),T(w,1),T(w,2),T(w,3));else for(var I=i.vertsPerColor||3,O=m/I,q=0;q<O;++q)for(var Z=[T(q,0),T(q,1),T(q,2),T(q,3)],$=0;$<I;++$)h.push(Z);return o}function nr(o){return function(i){var m=o.apply(this,Array.prototype.slice.call(arguments,1));return j.createBuffersFromArrays(i,m)}}function vr(o){return function(i){var m=o.apply(null,Array.prototype.slice.call(arguments,1));return j.createBufferInfoFromArrays(i,m)}}var Sr=["numComponents","size","type","normalize","stride","offset","attrib","name","attribName"];function ue(o,i,m,h){h=h||0;for(var T=o.length,w=0;w<T;++w)i[m+w]=o[w]+h}function r(o,i){var m=D(o),h=new m.constructor(i),T=h;return m.numComponents&&m.numElements&&Y(h,m.numComponents),o.data&&(T={data:h},le.copyNamedProperties(Sr,o,T)),T}function f(o){for(var i={},m,h=function(){var $=o[T];Object.keys($).forEach(function(te){i[te]||(i[te]=[]),!m&&te!=="indices"&&(m=te);var re=$[te],se=K(re,te),ve=D(re),ee=ve.length/se;i[te].push(ee)})},T=0;T<o.length;++T)h();function w(Z){for(var $=0,te,re=0;re<o.length;++re){var se=o[re],ve=se[Z],ee=D(ve);$+=ee.length,(!te||ve.data)&&(te=ve)}return{length:$,spec:te}}function I(Z,$,te){for(var re=0,se=0,ve=0;ve<o.length;++ve){var ee=o[ve],pe=ee[Z],Oe=D(pe);Z==="indices"?(ue(Oe,te,se,re),re+=$[ve]):ue(Oe,te,se),se+=Oe.length}}var O=i[m],q={};return Object.keys(i).forEach(function(Z){var $=w(Z),te=r($.spec,$.length);I(Z,O,D(te)),q[Z]=te}),q}function c(o){var i={};return Object.keys(o).forEach(function(m){var h=o[m],T=D(h),w=r(h,T.length);ue(T,D(w),0),i[m]=w}),i}u.create3DFBufferInfo=vr(We),u.create3DFBuffers=nr(We),u.createCubeBufferInfo=vr(de),u.createCubeBuffers=nr(de),u.createPlaneBufferInfo=vr(B),u.createPlaneBuffers=nr(B),u.createSphereBufferInfo=vr(U),u.createSphereBuffers=nr(U),u.createTruncatedConeBufferInfo=vr(_e),u.createTruncatedConeBuffers=nr(_e),u.createXYQuadBufferInfo=vr(x),u.createXYQuadBuffers=nr(x);var E=u.createCrescentBufferInfo=vr(Ue),v=u.createCrescentBuffers=nr(Ue);u.createCylinderBufferInfo=vr(Ze),u.createCylinderBuffers=nr(Ze),u.createTorusBufferInfo=vr(He),u.createTorusBuffers=nr(He),u.createDiscBufferInfo=vr(fr),u.createDiscBuffers=nr(fr),u.createCresentBufferInfo=E,u.createCresentBuffers=v,u.createCresentVertices=Ue},"./src/programs.js":(z,u,H)=>{function ie(e){"@babel/helpers - typeof";return ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ie(e)}u.__esModule=!0,u.bindTransformFeedbackInfo=Nt,u.bindUniformBlock=Ut,u.createAttributeSetters=sa,u.createProgram=yt,u.createProgramAsync=void 0,u.createProgramFromScripts=ia,u.createProgramFromSources=oa,u.createProgramInfo=l,u.createProgramInfoAsync=void 0,u.createProgramInfoFromProgram=kt,u.createProgramInfos=A,u.createProgramInfosAsync=void 0,u.createPrograms=p,u.createProgramsAsync=void 0,u.createTransformFeedback=fa,u.createTransformFeedbackInfo=Mt,u.createUniformBlockInfo=la,u.createUniformBlockInfoFromProgram=ca,u.createUniformBlockSpecFromProgram=Qr,u.createUniformSetters=nt,u.setAttributes=va,u.setBlockUniforms=pn,u.setBuffersAndAttributes=dn,u.setUniformBlock=ja,u.setUniforms=Gt,u.setUniformsAndBindTextures=void 0;var j=W(H("./src/utils.js")),le=W(H("./src/helper.js"));function oe(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,n=new WeakMap;return(oe=function(b){return b?n:t})(e)}function W(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||ie(e)!="object"&&typeof e!="function")return{default:e};var n=oe(t);if(n&&n.has(e))return n.get(e);var d={__proto__:null},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var S in e)if(S!=="default"&&Object.prototype.hasOwnProperty.call(e,S)){var F=b?Object.getOwnPropertyDescriptor(e,S):null;F&&(F.get||F.set)?Object.defineProperty(d,S,F):d[S]=e[S]}return d.default=e,n&&n.set(e,d),d}function he(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */he=function(){return t};var e,t={},n=Object.prototype,d=n.hasOwnProperty,b=Object.defineProperty||function(fe,X,J){fe[X]=J.value},S=typeof Symbol=="function"?Symbol:{},F=S.iterator||"@@iterator",P=S.asyncIterator||"@@asyncIterator",M=S.toStringTag||"@@toStringTag";function L(fe,X,J){return Object.defineProperty(fe,X,{value:J,enumerable:!0,configurable:!0,writable:!0}),fe[X]}try{L({},"")}catch{L=function(J,ge,Ie){return J[ge]=Ie}}function k(fe,X,J,ge){var Ie=X&&X.prototype instanceof je?X:je,xe=Object.create(Ie.prototype),sr=new Tn(ge||[]);return b(xe,"_invoke",{value:Xn(fe,J,sr)}),xe}function ne(fe,X,J){try{return{type:"normal",arg:fe.call(X,J)}}catch(ge){return{type:"throw",arg:ge}}}t.wrap=k;var ye="suspendedStart",be="suspendedYield",Fe="executing",Me="completed",Be={};function je(){}function Ye(){}function ir(){}var mr={};L(mr,F,function(){return this});var wr=Object.getPrototypeOf,Or=wr&&wr(wr(Sn([])));Or&&Or!==n&&d.call(Or,F)&&(mr=Or);var Vr=ir.prototype=je.prototype=Object.create(mr);function Wa(fe){["next","throw","return"].forEach(function(X){L(fe,X,function(J){return this._invoke(X,J)})})}function Xa(fe,X){function J(Ie,xe,sr,Pr){var Rr=ne(fe[Ie],fe,xe);if(Rr.type!=="throw"){var dt=Rr.arg,it=dt.value;return it&&ie(it)=="object"&&d.call(it,"__await")?X.resolve(it.__await).then(function(bt){J("next",bt,sr,Pr)},function(bt){J("throw",bt,sr,Pr)}):X.resolve(it).then(function(bt){dt.value=bt,sr(dt)},function(bt){return J("throw",bt,sr,Pr)})}Pr(Rr.arg)}var ge;b(this,"_invoke",{value:function(xe,sr){function Pr(){return new X(function(Rr,dt){J(xe,sr,Rr,dt)})}return ge=ge?ge.then(Pr,Pr):Pr()}})}function Xn(fe,X,J){var ge=ye;return function(Ie,xe){if(ge===Fe)throw new Error("Generator is already running");if(ge===Me){if(Ie==="throw")throw xe;return{value:e,done:!0}}for(J.method=Ie,J.arg=xe;;){var sr=J.delegate;if(sr){var Pr=Dn(sr,J);if(Pr){if(Pr===Be)continue;return Pr}}if(J.method==="next")J.sent=J._sent=J.arg;else if(J.method==="throw"){if(ge===ye)throw ge=Me,J.arg;J.dispatchException(J.arg)}else J.method==="return"&&J.abrupt("return",J.arg);ge=Fe;var Rr=ne(fe,X,J);if(Rr.type==="normal"){if(ge=J.done?Me:be,Rr.arg===Be)continue;return{value:Rr.arg,done:J.done}}Rr.type==="throw"&&(ge=Me,J.method="throw",J.arg=Rr.arg)}}}function Dn(fe,X){var J=X.method,ge=fe.iterator[J];if(ge===e)return X.delegate=null,J==="throw"&&fe.iterator.return&&(X.method="return",X.arg=e,Dn(fe,X),X.method==="throw")||J!=="return"&&(X.method="throw",X.arg=new TypeError("The iterator does not provide a '"+J+"' method")),Be;var Ie=ne(ge,fe.iterator,X.arg);if(Ie.type==="throw")return X.method="throw",X.arg=Ie.arg,X.delegate=null,Be;var xe=Ie.arg;return xe?xe.done?(X[fe.resultName]=xe.value,X.next=fe.nextLoc,X.method!=="return"&&(X.method="next",X.arg=e),X.delegate=null,Be):xe:(X.method="throw",X.arg=new TypeError("iterator result is not an object"),X.delegate=null,Be)}function qn(fe){var X={tryLoc:fe[0]};1 in fe&&(X.catchLoc=fe[1]),2 in fe&&(X.finallyLoc=fe[2],X.afterLoc=fe[3]),this.tryEntries.push(X)}function En(fe){var X=fe.completion||{};X.type="normal",delete X.arg,fe.completion=X}function Tn(fe){this.tryEntries=[{tryLoc:"root"}],fe.forEach(qn,this),this.reset(!0)}function Sn(fe){if(fe||fe===""){var X=fe[F];if(X)return X.call(fe);if(typeof fe.next=="function")return fe;if(!isNaN(fe.length)){var J=-1,ge=function Ie(){for(;++J<fe.length;)if(d.call(fe,J))return Ie.value=fe[J],Ie.done=!1,Ie;return Ie.value=e,Ie.done=!0,Ie};return ge.next=ge}}throw new TypeError(ie(fe)+" is not iterable")}return Ye.prototype=ir,b(Vr,"constructor",{value:ir,configurable:!0}),b(ir,"constructor",{value:Ye,configurable:!0}),Ye.displayName=L(ir,M,"GeneratorFunction"),t.isGeneratorFunction=function(fe){var X=typeof fe=="function"&&fe.constructor;return!!X&&(X===Ye||(X.displayName||X.name)==="GeneratorFunction")},t.mark=function(fe){return Object.setPrototypeOf?Object.setPrototypeOf(fe,ir):(fe.__proto__=ir,L(fe,M,"GeneratorFunction")),fe.prototype=Object.create(Vr),fe},t.awrap=function(fe){return{__await:fe}},Wa(Xa.prototype),L(Xa.prototype,P,function(){return this}),t.AsyncIterator=Xa,t.async=function(fe,X,J,ge,Ie){Ie===void 0&&(Ie=Promise);var xe=new Xa(k(fe,X,J,ge),Ie);return t.isGeneratorFunction(X)?xe:xe.next().then(function(sr){return sr.done?sr.value:xe.next()})},Wa(Vr),L(Vr,M,"Generator"),L(Vr,F,function(){return this}),L(Vr,"toString",function(){return"[object Generator]"}),t.keys=function(fe){var X=Object(fe),J=[];for(var ge in X)J.push(ge);return J.reverse(),function Ie(){for(;J.length;){var xe=J.pop();if(xe in X)return Ie.value=xe,Ie.done=!1,Ie}return Ie.done=!0,Ie}},t.values=Sn,Tn.prototype={constructor:Tn,reset:function(X){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(En),!X)for(var J in this)J.charAt(0)==="t"&&d.call(this,J)&&!isNaN(+J.slice(1))&&(this[J]=e)},stop:function(){this.done=!0;var X=this.tryEntries[0].completion;if(X.type==="throw")throw X.arg;return this.rval},dispatchException:function(X){if(this.done)throw X;var J=this;function ge(dt,it){return sr.type="throw",sr.arg=X,J.next=dt,it&&(J.method="next",J.arg=e),!!it}for(var Ie=this.tryEntries.length-1;Ie>=0;--Ie){var xe=this.tryEntries[Ie],sr=xe.completion;if(xe.tryLoc==="root")return ge("end");if(xe.tryLoc<=this.prev){var Pr=d.call(xe,"catchLoc"),Rr=d.call(xe,"finallyLoc");if(Pr&&Rr){if(this.prev<xe.catchLoc)return ge(xe.catchLoc,!0);if(this.prev<xe.finallyLoc)return ge(xe.finallyLoc)}else if(Pr){if(this.prev<xe.catchLoc)return ge(xe.catchLoc,!0)}else{if(!Rr)throw new Error("try statement without catch or finally");if(this.prev<xe.finallyLoc)return ge(xe.finallyLoc)}}}},abrupt:function(X,J){for(var ge=this.tryEntries.length-1;ge>=0;--ge){var Ie=this.tryEntries[ge];if(Ie.tryLoc<=this.prev&&d.call(Ie,"finallyLoc")&&this.prev<Ie.finallyLoc){var xe=Ie;break}}xe&&(X==="break"||X==="continue")&&xe.tryLoc<=J&&J<=xe.finallyLoc&&(xe=null);var sr=xe?xe.completion:{};return sr.type=X,sr.arg=J,xe?(this.method="next",this.next=xe.finallyLoc,Be):this.complete(sr)},complete:function(X,J){if(X.type==="throw")throw X.arg;return X.type==="break"||X.type==="continue"?this.next=X.arg:X.type==="return"?(this.rval=this.arg=X.arg,this.method="return",this.next="end"):X.type==="normal"&&J&&(this.next=J),Be},finish:function(X){for(var J=this.tryEntries.length-1;J>=0;--J){var ge=this.tryEntries[J];if(ge.finallyLoc===X)return this.complete(ge.completion,ge.afterLoc),En(ge),Be}},catch:function(X){for(var J=this.tryEntries.length-1;J>=0;--J){var ge=this.tryEntries[J];if(ge.tryLoc===X){var Ie=ge.completion;if(Ie.type==="throw"){var xe=Ie.arg;En(ge)}return xe}}throw new Error("illegal catch attempt")},delegateYield:function(X,J,ge){return this.delegate={iterator:Sn(X),resultName:J,nextLoc:ge},this.method==="next"&&(this.arg=e),Be}},t}function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);t&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(e,b).enumerable})),n.push.apply(n,d)}return n}function Ae(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Q(Object(n),!0).forEach(function(d){D(e,d,n[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach(function(d){Object.defineProperty(e,d,Object.getOwnPropertyDescriptor(n,d))})}return e}function D(e,t,n){return t=K(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function K(e){var t=Y(e,"string");return ie(t)=="symbol"?t:String(t)}function Y(e,t){if(ie(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var d=n.call(e,t||"default");if(ie(d)!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _(e,t,n,d,b,S,F){try{var P=e[S](F),M=P.value}catch(L){n(L);return}P.done?t(M):Promise.resolve(M).then(d,b)}function V(e){return function(){var t=this,n=arguments;return new Promise(function(d,b){var S=e.apply(t,n);function F(M){_(S,d,b,F,P,"next",M)}function P(M){_(S,d,b,F,P,"throw",M)}F(void 0)})}}function ae(e,t){return Re(e)||Ge(e,t)||me(e,t)||Te()}function Te(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ge(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var d,b,S,F,P=[],M=!0,L=!1;try{if(S=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;M=!1}else for(;!(M=(d=S.call(n)).done)&&(P.push(d.value),P.length!==t);M=!0);}catch(k){L=!0,b=k}finally{try{if(!M&&n.return!=null&&(F=n.return(),Object(F)!==F))return}finally{if(L)throw b}}return P}}function Re(e){if(Array.isArray(e))return e}function or(e,t){var n=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=me(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var d=0,b=function(){};return{s:b,n:function(){return d>=e.length?{done:!0}:{done:!1,value:e[d++]}},e:function(L){throw L},f:b}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var S=!0,F=!1,P;return{s:function(){n=n.call(e)},n:function(){var L=n.next();return S=L.done,L},e:function(L){F=!0,P=L},f:function(){try{!S&&n.return!=null&&n.return()}finally{if(F)throw P}}}}function ur(e){return B(e)||x(e)||me(e)||rr()}function rr(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function me(e,t){if(e){if(typeof e=="string")return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,t)}}function x(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function B(e){if(Array.isArray(e))return U(e)}function U(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,d=new Array(t);n<t;n++)d[n]=e[n];return d}var g=le.error,de=le.warn;function _e(e){return typeof document<"u"&&document.getElementById?document.getElementById(e):null}var Ce=33984,We=35048,Ue=34962,Ze=34963,He=35345,fr=35982,Tr=36386,cr=35713,nr=35714,vr=35632,Sr=35633,ue=35981,r=35718,f=35721,c=35971,E=35382,v=35396,o=35398,i=35392,m=35395,h=5126,T=35664,w=35665,I=35666,O=5124,q=35667,Z=35668,$=35669,te=35670,re=35671,se=35672,ve=35673,ee=35674,pe=35675,Oe=35676,Ke=35678,ke=35680,Ve=35679,we=35682,De=35685,Qe=35686,Xe=35687,ze=35688,qe=35689,Je=35690,Le=36289,Ne=36292,yr=36293,lr=5125,Ar=36294,_r=36295,Ir=36296,Ur=36298,Gr=36299,rt=36300,_t=36303,wt=36306,Pt=36307,hr=36308,nn=36311,xt=3553,Rt=34067,$t=32879,Ft=35866,Pe={};function xa(e,t){return Pe[t].bindPoint}function on(e,t){return function(n){e.uniform1f(t,n)}}function un(e,t){return function(n){e.uniform1fv(t,n)}}function fn(e,t){return function(n){e.uniform2fv(t,n)}}function cn(e,t){return function(n){e.uniform3fv(t,n)}}function ln(e,t){return function(n){e.uniform4fv(t,n)}}function Ra(e,t){return function(n){e.uniform1i(t,n)}}function Fa(e,t){return function(n){e.uniform1iv(t,n)}}function Ca(e,t){return function(n){e.uniform2iv(t,n)}}function Da(e,t){return function(n){e.uniform3iv(t,n)}}function La(e,t){return function(n){e.uniform4iv(t,n)}}function kr(e,t){return function(n){e.uniform1ui(t,n)}}function ar(e,t){return function(n){e.uniform1uiv(t,n)}}function Ct(e,t){return function(n){e.uniform2uiv(t,n)}}function tt(e,t){return function(n){e.uniform3uiv(t,n)}}function Dt(e,t){return function(n){e.uniform4uiv(t,n)}}function Xr(e,t){return function(n){e.uniformMatrix2fv(t,!1,n)}}function pr(e,t){return function(n){e.uniformMatrix3fv(t,!1,n)}}function Ba(e,t){return function(n){e.uniformMatrix4fv(t,!1,n)}}function Ia(e,t){return function(n){e.uniformMatrix2x3fv(t,!1,n)}}function Oa(e,t){return function(n){e.uniformMatrix3x2fv(t,!1,n)}}function Fr(e,t){return function(n){e.uniformMatrix2x4fv(t,!1,n)}}function mt(e,t){return function(n){e.uniformMatrix4x2fv(t,!1,n)}}function ea(e,t){return function(n){e.uniformMatrix3x4fv(t,!1,n)}}function sn(e,t){return function(n){e.uniformMatrix4x3fv(t,!1,n)}}function br(e,t,n,d){var b=xa(e,t);return j.isWebGL2(e)?function(S){var F,P;!S||le.isTexture(e,S)?(F=S,P=null):(F=S.texture,P=S.sampler),e.uniform1i(d,n),e.activeTexture(Ce+n),e.bindTexture(b,F),e.bindSampler(n,P)}:function(S){e.uniform1i(d,n),e.activeTexture(Ce+n),e.bindTexture(b,S)}}function Er(e,t,n,d,b){for(var S=xa(e,t),F=new Int32Array(b),P=0;P<b;++P)F[P]=n+P;return j.isWebGL2(e)?function(M){e.uniform1iv(d,F),M.forEach(function(L,k){e.activeTexture(Ce+F[k]);var ne,ye;!L||le.isTexture(e,L)?(ne=L,ye=null):(ne=L.texture,ye=L.sampler),e.bindSampler(n,ye),e.bindTexture(S,ne)})}:function(M){e.uniform1iv(d,F),M.forEach(function(L,k){e.activeTexture(Ce+F[k]),e.bindTexture(S,L)})}}Pe[h]={Type:Float32Array,size:4,setter:on,arraySetter:un},Pe[T]={Type:Float32Array,size:8,setter:fn,cols:2},Pe[w]={Type:Float32Array,size:12,setter:cn,cols:3},Pe[I]={Type:Float32Array,size:16,setter:ln,cols:4},Pe[O]={Type:Int32Array,size:4,setter:Ra,arraySetter:Fa},Pe[q]={Type:Int32Array,size:8,setter:Ca,cols:2},Pe[Z]={Type:Int32Array,size:12,setter:Da,cols:3},Pe[$]={Type:Int32Array,size:16,setter:La,cols:4},Pe[lr]={Type:Uint32Array,size:4,setter:kr,arraySetter:ar},Pe[Ar]={Type:Uint32Array,size:8,setter:Ct,cols:2},Pe[_r]={Type:Uint32Array,size:12,setter:tt,cols:3},Pe[Ir]={Type:Uint32Array,size:16,setter:Dt,cols:4},Pe[te]={Type:Uint32Array,size:4,setter:Ra,arraySetter:Fa},Pe[re]={Type:Uint32Array,size:8,setter:Ca,cols:2},Pe[se]={Type:Uint32Array,size:12,setter:Da,cols:3},Pe[ve]={Type:Uint32Array,size:16,setter:La,cols:4},Pe[ee]={Type:Float32Array,size:32,setter:Xr,rows:2,cols:2},Pe[pe]={Type:Float32Array,size:48,setter:pr,rows:3,cols:3},Pe[Oe]={Type:Float32Array,size:64,setter:Ba,rows:4,cols:4},Pe[De]={Type:Float32Array,size:32,setter:Ia,rows:2,cols:3},Pe[Qe]={Type:Float32Array,size:32,setter:Fr,rows:2,cols:4},Pe[Xe]={Type:Float32Array,size:48,setter:Oa,rows:3,cols:2},Pe[ze]={Type:Float32Array,size:48,setter:ea,rows:3,cols:4},Pe[qe]={Type:Float32Array,size:64,setter:mt,rows:4,cols:2},Pe[Je]={Type:Float32Array,size:64,setter:sn,rows:4,cols:3},Pe[Ke]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:xt},Pe[ke]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Rt},Pe[Ve]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:$t},Pe[we]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:xt},Pe[Le]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Ft},Pe[Ne]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Ft},Pe[yr]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Rt},Pe[Ur]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:xt},Pe[Gr]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:$t},Pe[rt]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Rt},Pe[_t]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Ft},Pe[wt]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:xt},Pe[Pt]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:$t},Pe[hr]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Rt},Pe[nn]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Ft};function Lt(e,t){return function(n){if(n.value)switch(e.disableVertexAttribArray(t),n.value.length){case 4:e.vertexAttrib4fv(t,n.value);break;case 3:e.vertexAttrib3fv(t,n.value);break;case 2:e.vertexAttrib2fv(t,n.value);break;case 1:e.vertexAttrib1fv(t,n.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else e.bindBuffer(Ue,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,n.numComponents||n.size,n.type||h,n.normalize||!1,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function xr(e,t){return function(n){if(n.value)if(e.disableVertexAttribArray(t),n.value.length===4)e.vertexAttrib4iv(t,n.value);else throw new Error("The length of an integer constant value must be 4!");else e.bindBuffer(Ue,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,n.numComponents||n.size,n.type||O,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function Dr(e,t){return function(n){if(n.value)if(e.disableVertexAttribArray(t),n.value.length===4)e.vertexAttrib4uiv(t,n.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else e.bindBuffer(Ue,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,n.numComponents||n.size,n.type||lr,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function qr(e,t,n){var d=n.size,b=n.count;return function(S){e.bindBuffer(Ue,S.buffer);for(var F=S.size||S.numComponents||d,P=F/b,M=S.type||h,L=Pe[M],k=L.size*F,ne=S.normalize||!1,ye=S.offset||0,be=k/b,Fe=0;Fe<b;++Fe)e.enableVertexAttribArray(t+Fe),e.vertexAttribPointer(t+Fe,P,M,ne,k,ye+be*Fe),e.vertexAttribDivisor&&e.vertexAttribDivisor(t+Fe,S.divisor||0)}}var tr={};tr[h]={size:4,setter:Lt},tr[T]={size:8,setter:Lt},tr[w]={size:12,setter:Lt},tr[I]={size:16,setter:Lt},tr[O]={size:4,setter:xr},tr[q]={size:8,setter:xr},tr[Z]={size:12,setter:xr},tr[$]={size:16,setter:xr},tr[lr]={size:4,setter:Dr},tr[Ar]={size:8,setter:Dr},tr[_r]={size:12,setter:Dr},tr[Ir]={size:16,setter:Dr},tr[te]={size:4,setter:xr},tr[re]={size:8,setter:xr},tr[se]={size:12,setter:xr},tr[ve]={size:16,setter:xr},tr[ee]={size:4,setter:qr,count:2},tr[pe]={size:9,setter:qr,count:3},tr[Oe]={size:16,setter:qr,count:4};var Hr=/ERROR:\s*\d+:(\d+)/gi;function jr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,d=ur(t.matchAll(Hr)),b=new Map(d.map(function(S,F){var P=parseInt(S[1]),M=d[F+1],L=M?M.index:t.length,k=t.substring(S.index,L);return[P-1,k]}));return e.split(`
`).map(function(S,F){var P=b.get(F);return"".concat(F+1+n,": ").concat(S).concat(P?`

^^^ `.concat(P):"")}).join(`
`)}var ra=/^[ \t]*\n/;function dr(e){var t=0;return ra.test(e)&&(t=1,e=e.replace(ra,"")),{lineOffset:t,shaderSource:e}}function Bt(e,t){return e.errorCallback(t),e.callback&&setTimeout(function(){e.callback("".concat(t,`
`).concat(e.errors.join(`
`)))}),null}function It(e,t,n,d){d=d||g;var b=e.getShaderParameter(n,cr);if(!b){var S=e.getShaderInfoLog(n),F=dr(e.getShaderSource(n)),P=F.lineOffset,M=F.shaderSource,L="".concat(jr(M,S,P),`
Error compiling `).concat(j.glEnumToString(e,t),": ").concat(S);return d(L),L}return""}function Kr(e,t,n){var d,b,S;if(typeof t=="function"&&(n=t,t=void 0),typeof e=="function")n=e,e=void 0;else if(e&&!Array.isArray(e)){var F=e;n=F.errorCallback,e=F.attribLocations,d=F.transformFeedbackVaryings,b=F.transformFeedbackMode,S=F.callback}var P=n||g,M=[],L={errorCallback:function(ye){M.push(ye);for(var be=arguments.length,Fe=new Array(be>1?be-1:0),Me=1;Me<be;Me++)Fe[Me-1]=arguments[Me];P.apply(void 0,[ye].concat(Fe))},transformFeedbackVaryings:d,transformFeedbackMode:b,callback:S,errors:M};{var k={};Array.isArray(e)?e.forEach(function(ne,ye){k[ne]=t?t[ye]:ye}):k=e||{},L.attribLocations=k}return L}var Yr=["VERTEX_SHADER","FRAGMENT_SHADER"];function Ma(e,t){if(t.indexOf("frag")>=0)return vr;if(t.indexOf("vert")>=0)return Sr}function Na(e,t,n){var d=e.getAttachedShaders(t),b=or(d),S;try{for(b.s();!(S=b.n()).done;){var F=S.value;n.has(F)&&e.deleteShader(F)}}catch(P){b.e(P)}finally{b.f()}e.deleteProgram(t)}var Ua=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new Promise(function(n){return setTimeout(n,t)})};function Ga(e,t,n){for(var d=e.createProgram(),b=Kr(n),S=b.attribLocations,F=b.transformFeedbackVaryings,P=b.transformFeedbackMode,M=0;M<t.length;++M){var L=t[M];if(typeof L=="string"){var k=_e(L),ne=k?k.text:L,ye=e[Yr[M]];k&&k.type&&(ye=Ma(e,k.type)||ye),L=e.createShader(ye),e.shaderSource(L,dr(ne).shaderSource),e.compileShader(L),e.attachShader(d,L)}}Object.entries(S).forEach(function(Fe){var Me=ae(Fe,2),Be=Me[0],je=Me[1];return e.bindAttribLocation(d,je,Be)});{var be=F;be&&(be.attribs&&(be=be.attribs),Array.isArray(be)||(be=Object.keys(be)),e.transformFeedbackVaryings(d,be,P||ue))}return e.linkProgram(d),d}function yt(e,t,n,d,b){var S=Kr(n,d,b),F=new Set(t),P=Ga(e,t,S);function M(L,k){var ne=na(L,k,S.errorCallback);return ne&&Na(L,k,F),ne}if(S.callback){ta(e,P).then(function(){var L=M(e,P);S.callback(L,L?void 0:P)});return}return M(e,P)?void 0:P}function zr(e){return function(t,n){for(var d=arguments.length,b=new Array(d>2?d-2:0),S=2;S<d;S++)b[S-2]=arguments[S];return new Promise(function(F,P){var M=Kr.apply(void 0,b);M.callback=function(L,k){L?P(L):F(k)},e(t,n,M)})}}u.createProgramAsync=zr(yt),u.createProgramInfoAsync=zr(l);function ta(e,t){return aa.apply(this,arguments)}function aa(){return aa=V(he().mark(function e(t,n){var d,b,S;return he().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:d=t.getExtension("KHR_parallel_shader_compile"),b=d?function(M,L){return M.getProgramParameter(L,d.COMPLETION_STATUS_KHR)}:function(){return!0},S=0;case 3:return P.next=5,Ua(S);case 5:S=16.666666666666668;case 6:if(!b(t,n)){P.next=3;break}case 7:case"end":return P.stop()}},e)})),aa.apply(this,arguments)}function at(e,t){return Ot.apply(this,arguments)}function Ot(){return Ot=V(he().mark(function e(t,n){var d,b,S;return he().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:d=0,b=Object.values(n);case 1:if(!(d<b.length)){P.next=8;break}return S=b[d],P.next=5,ta(t,S);case 5:d++,P.next=1;break;case 8:case"end":return P.stop()}},e)})),Ot.apply(this,arguments)}function na(e,t,n){n=n||g;var d=e.getProgramParameter(t,nr);if(!d){var b=e.getProgramInfoLog(t);n("Error in program linking: ".concat(b));var S=e.getAttachedShaders(t),F=S.map(function(P){return It(e,e.getShaderParameter(P,e.SHADER_TYPE),P,n)});return"".concat(b,`
`).concat(F.filter(function(P){return P}).join(`
`))}}function ia(e,t,n,d,b){var S=Kr(n,d,b),F=[],P=or(t),M;try{for(P.s();!(M=P.n()).done;){var L=M.value,k=_e(L);if(!k)return Bt(S,"unknown script element: ".concat(L));F.push(k.text)}}catch(ne){P.e(ne)}finally{P.f()}return yt(e,F,S)}function oa(e,t,n,d,b){return yt(e,t,n,d,b)}function ua(e){var t=e.name;return t.startsWith("gl_")||t.startsWith("webgl_")}var vn=/(\.|\[|]|\w+)/g,hn=function(t){return t>="0"&&t<="9"};function pt(e,t,n,d){for(var b=e.split(vn).filter(function(Fe){return Fe!==""}),S=0,F="";;){var P=b[S++];F+=P;var M=hn(P[0]),L=M?parseInt(P):P;M&&(F+=b[S++]);var k=S===b.length;if(k){n[L]=t;break}else{var ne=b[S++],ye=ne==="[",be=n[L]||(ye?[]:{});n[L]=be,n=be,d[F]=d[F]||function(Fe){return function(Me){Va(Fe,Me)}}(be),F+=ne}}}function nt(e,t){var n=0;function d(ye,be,Fe){var Me=be.name.endsWith("[0]"),Be=be.type,je=Pe[Be];if(!je)throw new Error("unknown type: 0x".concat(Be.toString(16)));var Ye;if(je.bindPoint){var ir=n;n+=be.size,Me?Ye=je.arraySetter(e,Be,ir,Fe,be.size):Ye=je.setter(e,Be,ir,Fe,be.size)}else je.arraySetter&&Me?Ye=je.arraySetter(e,Fe):Ye=je.setter(e,Fe);return Ye.location=Fe,Ye}for(var b={},S={},F=e.getProgramParameter(t,r),P=0;P<F;++P){var M=e.getActiveUniform(t,P);if(!ua(M)){var L=M.name;L.endsWith("[0]")&&(L=L.substr(0,L.length-3));var k=e.getUniformLocation(t,M.name);if(k){var ne=d(t,M,k);b[L]=ne,pt(L,ne,S,b)}}}return b}function Mt(e,t){for(var n={},d=e.getProgramParameter(t,c),b=0;b<d;++b){var S=e.getTransformFeedbackVarying(t,b);n[S.name]={index:b,type:S.type,size:S.size}}return n}function Nt(e,t,n){t.transformFeedbackInfo&&(t=t.transformFeedbackInfo),n.attribs&&(n=n.attribs);for(var d in n){var b=t[d];if(b){var S=n[d];S.offset?e.bindBufferRange(fr,b.index,S.buffer,S.offset,S.size):e.bindBufferBase(fr,b.index,S.buffer)}}}function fa(e,t,n){var d=e.createTransformFeedback();return e.bindTransformFeedback(Tr,d),e.useProgram(t.program),Nt(e,t,n),e.bindTransformFeedback(Tr,null),d}function Qr(e,t){for(var n=e.getProgramParameter(t,r),d=[],b=[],S=0;S<n;++S){b.push(S),d.push({});var F=e.getActiveUniform(t,S);d[S].name=F.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(ye){var be=ye[0],Fe=ye[1];e.getActiveUniforms(t,b,e[be]).forEach(function(Me,Be){d[Be][Fe]=Me})});for(var P={},M=e.getProgramParameter(t,E),L=0;L<M;++L){var k=e.getActiveUniformBlockName(t,L),ne={index:e.getUniformBlockIndex(t,k),usedByVertexShader:e.getActiveUniformBlockParameter(t,L,v),usedByFragmentShader:e.getActiveUniformBlockParameter(t,L,o),size:e.getActiveUniformBlockParameter(t,L,i),uniformIndices:e.getActiveUniformBlockParameter(t,L,m)};ne.used=ne.usedByVertexShader||ne.usedByFragmentShader,P[k]=ne}return{blockSpecs:P,uniformData:d}}var ka=/\[\d+\]\.$/,mn=function(t,n){return((t+(n-1))/n|0)*n};function yn(e,t,n,d){if(t||n){d=d||1;var b=e.length,S=b/4;return function(F){for(var P=0,M=0,L=0;L<S;++L){for(var k=0;k<d;++k)e[P++]=F[M++];P+=4-d}}}else return function(F){F.length?e.set(F):e[0]=F}}function ca(e,t,n,d){var b=n.blockSpecs,S=n.uniformData,F=b[d];if(!F)return de("no uniform block object named:",d),{name:d,uniforms:{}};var P=new ArrayBuffer(F.size),M=e.createBuffer(),L=F.index;e.bindBuffer(He,M),e.uniformBlockBinding(t,F.index,L);var k=d+".";ka.test(k)&&(k=k.replace(ka,"."));var ne={},ye={},be={};return F.uniformIndices.forEach(function(Fe){var Me=S[Fe],Be=Me.name;Be.startsWith(k)&&(Be=Be.substr(k.length));var je=Be.endsWith("[0]");je&&(Be=Be.substr(0,Be.length-3));var Ye=Pe[Me.type],ir=Ye.Type,mr=je?mn(Ye.size,16)*Me.size:Ye.size*Me.size,wr=new ir(P,Me.offset,mr/ir.BYTES_PER_ELEMENT);ne[Be]=wr;var Or=yn(wr,je,Ye.rows,Ye.cols);ye[Be]=Or,pt(Be,Or,be,ye)}),{name:d,array:P,asFloat:new Float32Array(P),buffer:M,uniforms:ne,setters:ye}}function la(e,t,n){return ca(e,t.program,t.uniformBlockSpec,n)}function Ut(e,t,n){var d=t.uniformBlockSpec||t,b=d.blockSpecs[n.name];if(b){var S=b.index;return e.bindBufferRange(He,S,n.buffer,n.offset||0,n.array.byteLength),!0}return!1}function ja(e,t,n){Ut(e,t,n)&&e.bufferData(He,n.array,We)}function pn(e,t){var n=e.setters;for(var d in t){var b=n[d];if(b){var S=t[d];b(S)}}}function Va(e,t){for(var n in t){var d=e[n];typeof d=="function"?d(t[n]):Va(e[n],t[n])}}function Gt(e){for(var t=e.uniformSetters||e,n=arguments.length<=1?0:arguments.length-1,d=0;d<n;++d){var b=d+1<1||arguments.length<=d+1?void 0:arguments[d+1];if(Array.isArray(b))for(var S=b.length,F=0;F<S;++F)Gt(t,b[F]);else for(var P in b){var M=t[P];M&&M(b[P])}}}u.setUniformsAndBindTextures=Gt;function sa(e,t){for(var n={},d=e.getProgramParameter(t,f),b=0;b<d;++b){var S=e.getActiveAttrib(t,b);if(!ua(S)){var F=e.getAttribLocation(t,S.name),P=tr[S.type],M=P.setter(e,F,P);M.location=F,n[S.name]=M}}return n}function va(e,t){for(var n in t){var d=e[n];d&&d(t[n])}}function dn(e,t,n){n.vertexArrayObject?e.bindVertexArray(n.vertexArrayObject):(va(t.attribSetters||t,n.attribs),n.indices&&e.bindBuffer(Ze,n.indices))}function kt(e,t){var n=nt(e,t),d=sa(e,t),b={program:t,uniformSetters:n,attribSetters:d};return j.isWebGL2(e)&&(b.uniformBlockSpec=Qr(e,t),b.transformFeedbackInfo=Mt(e,t)),b}var bn=/\s|{|}|;/;function l(e,t,n,d,b){var S=Kr(n,d,b),F=[];if(t=t.map(function(L){if(!bn.test(L)){var k=_e(L);if(k)L=k.text;else{var ne="no element with id: ".concat(L);S.errorCallback(ne),F.push(ne)}}return L}),F.length)return Bt(S,"");var P=S.callback;P&&(S.callback=function(L,k){P(L,L?void 0:kt(e,k))});var M=oa(e,t,S);return M?kt(e,M):null}function y(e,t,n,d,b){for(var S=0,F=Object.entries(t);S<F.length;S++){var P=ae(F[S],2),M=P[0],L=P[1],k=Ae({},b),ne=n[M];Array.isArray(ne)||Object.assign(k,ne);var ye=na(e,L,k.errorCallback);if(ye){for(var be=0,Fe=Object.values(t);be<Fe.length;be++){var Me=Fe[be],Be=e.getAttachedShaders(Me);e.deleteProgram(Me);var je=or(Be),Ye;try{for(je.s();!(Ye=je.n()).done;){var ir=Ye.value;d.has(ir)||e.deleteShader(ir)}}catch(mr){je.e(mr)}finally{je.f()}}return ye}}}function p(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},d=new Set,b=Object.fromEntries(Object.entries(t).map(function(F){var P=ae(F,2),M=P[0],L=P[1],k=Ae({},n),ne=Array.isArray(L)?L:L.shaders;return Array.isArray(L)||Object.assign(k,L),ne.forEach(d.add,d),[M,Ga(e,ne,k)]}));if(n.callback){at(e,b).then(function(){var F=y(e,b,t,d,n);n.callback(F,F?void 0:b)});return}var S=y(e,b,t,d,n);return S?void 0:b}function A(e,t,n){n=Kr(n);function d(F,P){return Object.fromEntries(Object.entries(P).map(function(M){var L=ae(M,2),k=L[0],ne=L[1];return[k,kt(F,ne)]}))}var b=n.callback;b&&(n.callback=function(F,P){b(F,F?void 0:d(e,P))});var S=p(e,t,n);if(!(b||!S))return d(e,S)}u.createProgramsAsync=zr(p),u.createProgramInfosAsync=zr(A)},"./src/textures.js":(z,u,H)=>{function ie(l){"@babel/helpers - typeof";return ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},ie(l)}u.__esModule=!0,u.canFilter=Ua,u.canGenerateMipmap=Na,u.createSampler=ua,u.createSamplers=vn,u.createTexture=va,u.createTextures=bn,u.getBytesPerElementForInternalFormat=Kr,u.getFormatAndTypeForInternalFormat=Yr,u.getNumComponentsForFormat=Ga,u.loadTextureFromUrl=ja,u.resizeTexture=dn,u.setDefaultTextureColor=ta,u.setEmptyTexture=sa,u.setSamplerParameters=oa,u.setTextureDefaults_=aa,u.setTextureFilteringForSize=pt,u.setTextureFromArray=Gt,u.setTextureFromElement=fa,u.setTextureParameters=ia;var j=he(H("./src/utils.js")),le=he(H("./src/typedarrays.js")),oe=he(H("./src/helper.js"));function W(l){if(typeof WeakMap!="function")return null;var y=new WeakMap,p=new WeakMap;return(W=function(e){return e?p:y})(l)}function he(l,y){if(!y&&l&&l.__esModule)return l;if(l===null||ie(l)!="object"&&typeof l!="function")return{default:l};var p=W(y);if(p&&p.has(l))return p.get(l);var A={__proto__:null},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var t in l)if(t!=="default"&&Object.prototype.hasOwnProperty.call(l,t)){var n=e?Object.getOwnPropertyDescriptor(l,t):null;n&&(n.get||n.set)?Object.defineProperty(A,t,n):A[t]=l[t]}return A.default=l,p&&p.set(l,A),A}var Q={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},Ae=le.isArrayBuffer,D=function(){var l;return function(){return l=l||(typeof document<"u"&&document.createElement?document.createElement("canvas").getContext("2d"):null),l}}(),K=6406,Y=6407,_=6408,V=6409,ae=6410,Te=6402,Ge=34041,Re=33071,or=9728,ur=9729,rr=3553,me=34067,x=32879,B=35866,U=34069,g=34070,de=34071,_e=34072,Ce=34073,We=34074,Ue=10241,Ze=10240,He=10242,fr=10243,Tr=32882,cr=33082,nr=33083,vr=33084,Sr=33085,ue=34892,r=34893,f=3317,c=3314,E=32878,v=3316,o=3315,i=32877,m=37443,h=37441,T=37440,w=33321,I=36756,O=33325,q=33326,Z=33330,$=33329,te=33338,re=33337,se=33340,ve=33339,ee=33323,pe=36757,Oe=33327,Ke=33328,ke=33336,Ve=33335,we=33332,De=33331,Qe=33334,Xe=33333,ze=32849,qe=35905,Je=36194,Le=36758,Ne=35898,yr=35901,lr=34843,Ar=34837,_r=36221,Ir=36239,Ur=36215,Gr=36233,rt=36209,_t=36227,wt=32856,Pt=35907,hr=36759,nn=32855,xt=32854,Rt=32857,$t=34842,Ft=34836,Pe=36220,xa=36238,on=36975,un=36214,fn=36232,cn=36226,ln=36208,Ra=33189,Fa=33190,Ca=36012,Da=36013,La=35056,kr=5120,ar=5121,Ct=5122,tt=5123,Dt=5124,Xr=5125,pr=5126,Ba=32819,Ia=32820,Oa=33635,Fr=5131,mt=36193,ea=33640,sn=35899,br=35902,Er=36269,Lt=34042,xr=33319,Dr=33320,qr=6403,tr=36244,Hr=36248,jr=36249,ra={};{var dr=ra;dr[K]={numColorComponents:1},dr[V]={numColorComponents:1},dr[ae]={numColorComponents:2},dr[Y]={numColorComponents:3},dr[_]={numColorComponents:4},dr[qr]={numColorComponents:1},dr[tr]={numColorComponents:1},dr[xr]={numColorComponents:2},dr[Dr]={numColorComponents:2},dr[Y]={numColorComponents:3},dr[Hr]={numColorComponents:3},dr[_]={numColorComponents:4},dr[jr]={numColorComponents:4},dr[Te]={numColorComponents:1},dr[Ge]={numColorComponents:2}}var Bt;function It(l){if(!Bt){var y={};y[K]={textureFormat:K,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[ar,Fr,mt,pr]},y[V]={textureFormat:V,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[ar,Fr,mt,pr]},y[ae]={textureFormat:ae,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[ar,Fr,mt,pr]},y[Y]={textureFormat:Y,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[ar,Fr,mt,pr,Oa]},y[_]={textureFormat:_,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[ar,Fr,mt,pr,Ba,Ia]},y[Te]={textureFormat:Te,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[Xr,tt]},y[w]={textureFormat:qr,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[ar]},y[I]={textureFormat:qr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[kr]},y[O]={textureFormat:qr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[pr,Fr]},y[q]={textureFormat:qr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[pr]},y[Z]={textureFormat:tr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[ar]},y[$]={textureFormat:tr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[kr]},y[we]={textureFormat:tr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[tt]},y[De]={textureFormat:tr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Ct]},y[Qe]={textureFormat:tr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Xr]},y[Xe]={textureFormat:tr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Dt]},y[ee]={textureFormat:xr,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[ar]},y[pe]={textureFormat:xr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[kr]},y[Oe]={textureFormat:xr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[pr,Fr]},y[Ke]={textureFormat:xr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[pr]},y[ke]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[ar]},y[Ve]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[kr]},y[te]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[tt]},y[re]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Ct]},y[se]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Xr]},y[ve]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Dt]},y[ze]={textureFormat:Y,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[ar]},y[qe]={textureFormat:Y,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[ar]},y[Je]={textureFormat:Y,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[ar,Oa]},y[Le]={textureFormat:Y,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[kr]},y[Ne]={textureFormat:Y,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[pr,Fr,sn]},y[yr]={textureFormat:Y,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[pr,Fr,br]},y[lr]={textureFormat:Y,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[pr,Fr]},y[Ar]={textureFormat:Y,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[pr]},y[_r]={textureFormat:Hr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[ar]},y[Ir]={textureFormat:Hr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[kr]},y[Ur]={textureFormat:Hr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[tt]},y[Gr]={textureFormat:Hr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[Ct]},y[rt]={textureFormat:Hr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[Xr]},y[_t]={textureFormat:Hr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[Dt]},y[wt]={textureFormat:_,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[ar]},y[Pt]={textureFormat:_,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[ar]},y[hr]={textureFormat:_,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[kr]},y[nn]={textureFormat:_,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[ar,Ia,ea]},y[xt]={textureFormat:_,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[ar,Ba]},y[Rt]={textureFormat:_,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[ea]},y[$t]={textureFormat:_,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[pr,Fr]},y[Ft]={textureFormat:_,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[pr]},y[Pe]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ar]},y[xa]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[kr]},y[on]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ea]},y[un]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[tt]},y[fn]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Ct]},y[cn]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[Dt]},y[ln]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[Xr]},y[Ra]={textureFormat:Te,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[tt,Xr]},y[Fa]={textureFormat:Te,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Xr]},y[Ca]={textureFormat:Te,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[pr]},y[La]={textureFormat:Ge,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Lt]},y[Da]={textureFormat:Ge,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Er]},Object.keys(y).forEach(function(p){var A=y[p];A.bytesPerElementMap={},A.bytesPerElement.forEach(function(e,t){var n=A.type[t];A.bytesPerElementMap[n]=e})}),Bt=y}return Bt[l]}function Kr(l,y){var p=It(l);if(!p)throw"unknown internal format";var A=p.bytesPerElementMap[y];if(A===void 0)throw"unknown internal format";return A}function Yr(l){var y=It(l);if(!y)throw"unknown internal format";return{format:y.textureFormat,type:y.type[0]}}function Ma(l){return(l&l-1)===0}function Na(l,y,p,A){if(!j.isWebGL2(l))return Ma(y)&&Ma(p);var e=It(A);if(!e)throw"unknown internal format";return e.colorRenderable&&e.textureFilterable}function Ua(l){var y=It(l);if(!y)throw"unknown internal format";return y.textureFilterable}function Ga(l){var y=ra[l];if(!y)throw"unknown format: "+l;return y.numColorComponents}function yt(l,y,p){return Ae(y)?le.getGLTypeForTypedArray(y):p||ar}function zr(l,y,p,A,e){if(e%1!==0)throw"can't guess dimensions";if(!p&&!A){var t=Math.sqrt(e/(y===me?6:1));t%1===0?(p=t,A=t):(p=e,A=1)}else if(A){if(!p&&(p=e/A,p%1))throw"can't guess dimensions"}else if(A=e/p,A%1)throw"can't guess dimensions";return{width:p,height:A}}function ta(l){Q.textureColor=new Uint8Array([l[0]*255,l[1]*255,l[2]*255,l[3]*255])}function aa(l){oe.copyExistingProperties(l,Q),l.textureColor&&ta(l.textureColor)}function at(l,y){y.colorspaceConversion!==void 0&&l.pixelStorei(m,y.colorspaceConversion),y.premultiplyAlpha!==void 0&&l.pixelStorei(h,y.premultiplyAlpha),y.flipY!==void 0&&l.pixelStorei(T,y.flipY)}function Ot(l){l.pixelStorei(f,4),j.isWebGL2(l)&&(l.pixelStorei(c,0),l.pixelStorei(E,0),l.pixelStorei(v,0),l.pixelStorei(o,0),l.pixelStorei(i,0))}function na(l,y,p,A){A.minMag&&(p.call(l,y,Ue,A.minMag),p.call(l,y,Ze,A.minMag)),A.min&&p.call(l,y,Ue,A.min),A.mag&&p.call(l,y,Ze,A.mag),A.wrap&&(p.call(l,y,He,A.wrap),p.call(l,y,fr,A.wrap),(y===x||oe.isSampler(l,y))&&p.call(l,y,Tr,A.wrap)),A.wrapR&&p.call(l,y,Tr,A.wrapR),A.wrapS&&p.call(l,y,He,A.wrapS),A.wrapT&&p.call(l,y,fr,A.wrapT),A.minLod!==void 0&&p.call(l,y,cr,A.minLod),A.maxLod!==void 0&&p.call(l,y,nr,A.maxLod),A.baseLevel!==void 0&&p.call(l,y,vr,A.baseLevel),A.maxLevel!==void 0&&p.call(l,y,Sr,A.maxLevel),A.compareFunc!==void 0&&p.call(l,y,r,A.compareFunc),A.compareMode!==void 0&&p.call(l,y,ue,A.compareMode)}function ia(l,y,p){var A=p.target||rr;l.bindTexture(A,y),na(l,A,l.texParameteri,p)}function oa(l,y,p){na(l,y,l.samplerParameteri,p)}function ua(l,y){var p=l.createSampler();return oa(l,p,y),p}function vn(l,y){var p={};return Object.keys(y).forEach(function(A){p[A]=ua(l,y[A])}),p}function hn(l){return l=l||Q.textureColor,Ae(l)?l:new Uint8Array([l[0]*255,l[1]*255,l[2]*255,l[3]*255])}function pt(l,y,p,A,e,t){p=p||Q.textureOptions,t=t||_;var n=p.target||rr;if(A=A||p.width,e=e||p.height,l.bindTexture(n,y),Na(l,A,e,t))l.generateMipmap(n);else{var d=Ua(t)?ur:or;l.texParameteri(n,Ue,d),l.texParameteri(n,Ze,d),l.texParameteri(n,He,Re),l.texParameteri(n,fr,Re)}}function nt(l){return l.auto===!0||l.auto===void 0&&l.level===void 0}function Mt(l,y){return y=y||{},y.cubeFaceOrder||[U,g,de,_e,Ce,We]}function Nt(l,y){var p=Mt(l,y),A=p.map(function(e,t){return{face:e,ndx:t}});return A.sort(function(e,t){return e.face-t.face}),A}function fa(l,y,p,A){A=A||Q.textureOptions;var e=A.target||rr,t=A.level||0,n=p.width,d=p.height,b=A.internalFormat||A.format||_,S=Yr(b),F=A.format||S.format,P=A.type||S.type;if(at(l,A),l.bindTexture(e,y),e===me){var M=p.width,L=p.height,k,ne;if(M/6===L)k=L,ne=[0,0,1,0,2,0,3,0,4,0,5,0];else if(L/6===M)k=M,ne=[0,0,0,1,0,2,0,3,0,4,0,5];else if(M/3===L/2)k=M/3,ne=[0,0,1,0,2,0,0,1,1,1,2,1];else if(M/2===L/3)k=M/2,ne=[0,0,1,0,0,1,1,1,0,2,1,2];else throw"can't figure out cube map from element: "+(p.src?p.src:p.nodeName);var ye=D();ye?(ye.canvas.width=k,ye.canvas.height=k,n=k,d=k,Nt(l,A).forEach(function(wr){var Or=ne[wr.ndx*2+0]*k,Vr=ne[wr.ndx*2+1]*k;ye.drawImage(p,Or,Vr,k,k,0,0,k,k),l.texImage2D(wr.face,t,b,F,P,ye.canvas)}),ye.canvas.width=1,ye.canvas.height=1):typeof createImageBitmap<"u"&&(n=k,d=k,Nt(l,A).forEach(function(wr){var Or=ne[wr.ndx*2+0]*k,Vr=ne[wr.ndx*2+1]*k;l.texImage2D(wr.face,t,b,k,k,0,F,P,null),createImageBitmap(p,Or,Vr,k,k,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(function(Wa){at(l,A),l.bindTexture(e,y),l.texImage2D(wr.face,t,b,F,P,Wa),nt(A)&&pt(l,y,A,n,d,b)})}))}else if(e===x||e===B){var be=Math.min(p.width,p.height),Fe=Math.max(p.width,p.height),Me=Fe/be;if(Me%1!==0)throw"can not compute 3D dimensions of element";var Be=p.width===Fe?1:0,je=p.height===Fe?1:0;l.pixelStorei(f,1),l.pixelStorei(c,p.width),l.pixelStorei(E,0),l.pixelStorei(i,0),l.texImage3D(e,t,b,be,be,be,0,F,P,null);for(var Ye=0;Ye<Me;++Ye){var ir=Ye*be*Be,mr=Ye*be*je;l.pixelStorei(v,ir),l.pixelStorei(o,mr),l.texSubImage3D(e,t,0,0,Ye,be,be,1,F,P,p)}Ot(l)}else l.texImage2D(e,t,b,F,P,p);nt(A)&&pt(l,y,A,n,d,b),ia(l,y,A)}function Qr(){}function ka(l){if(typeof document<"u"){var y=document.createElement("a");return y.href=l,y.hostname===location.hostname&&y.port===location.port&&y.protocol===location.protocol}else{var p=new URL(location.href).origin,A=new URL(l,location.href).origin;return A===p}}function mn(l,y){return y===void 0&&!ka(l)?"anonymous":y}function yn(l,y,p){p=p||Qr;var A;if(y=y!==void 0?y:Q.crossOrigin,y=mn(l,y),typeof Image<"u"){A=new Image,y!==void 0&&(A.crossOrigin=y);var e=function(){A.removeEventListener("error",t),A.removeEventListener("load",n),A=null},t=function(){var M="couldn't load image: "+l;oe.error(M),p(M,A),e()},n=function(){p(null,A),e()};return A.addEventListener("error",t),A.addEventListener("load",n),A.src=l,A}else if(typeof ImageBitmap<"u"){var d,b,S=function(){p(d,b)},F={};y&&(F.mode="cors"),fetch(l,F).then(function(P){if(!P.ok)throw P;return P.blob()}).then(function(P){return createImageBitmap(P,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}).then(function(P){b=P,setTimeout(S)}).catch(function(P){d=P,setTimeout(S)}),A=null}return A}function ca(l){return typeof ImageBitmap<"u"&&l instanceof ImageBitmap||typeof ImageData<"u"&&l instanceof ImageData||typeof HTMLElement<"u"&&l instanceof HTMLElement}function la(l,y,p){return ca(l)?(setTimeout(function(){p(null,l)}),l):yn(l,y,p)}function Ut(l,y,p){p=p||Q.textureOptions;var A=p.target||rr;if(l.bindTexture(A,y),p.color!==!1){var e=hn(p.color);if(A===me)for(var t=0;t<6;++t)l.texImage2D(U+t,0,_,1,1,0,_,ar,e);else A===x||A===B?l.texImage3D(A,0,_,1,1,1,0,_,ar,e):l.texImage2D(A,0,_,1,1,0,_,ar,e)}}function ja(l,y,p,A){A=A||Qr,p=p||Q.textureOptions,Ut(l,y,p),p=Object.assign({},p);var e=la(p.src,p.crossOrigin,function(t,n){t?A(t,y,n):(fa(l,y,n,p),A(null,y,n))});return e}function pn(l,y,p,A){A=A||Qr;var e=p.src;if(e.length!==6)throw"there must be 6 urls for a cubemap";var t=p.level||0,n=p.internalFormat||p.format||_,d=Yr(n),b=p.format||d.format,S=p.type||ar,F=p.target||rr;if(F!==me)throw"target must be TEXTURE_CUBE_MAP";Ut(l,y,p),p=Object.assign({},p);var P=6,M=[],L=Mt(l,p),k;function ne(ye){return function(be,Fe){--P,be?M.push(be):Fe.width!==Fe.height?M.push("cubemap face img is not a square: "+Fe.src):(at(l,p),l.bindTexture(F,y),P===5?Mt().forEach(function(Me){l.texImage2D(Me,t,n,b,S,Fe)}):l.texImage2D(ye,t,n,b,S,Fe),nt(p)&&l.generateMipmap(F)),P===0&&A(M.length?M:void 0,y,k)}}k=e.map(function(ye,be){return la(ye,p.crossOrigin,ne(L[be]))})}function Va(l,y,p,A){A=A||Qr;var e=p.src,t=p.internalFormat||p.format||_,n=Yr(t),d=p.format||n.format,b=p.type||ar,S=p.target||B;if(S!==x&&S!==B)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";Ut(l,y,p),p=Object.assign({},p);var F=e.length,P=[],M,L=p.level||0,k=p.width,ne=p.height,ye=e.length,be=!0;function Fe(Me){return function(Be,je){if(--F,Be)P.push(Be);else{if(at(l,p),l.bindTexture(S,y),be){be=!1,k=p.width||je.width,ne=p.height||je.height,l.texImage3D(S,L,t,k,ne,ye,0,d,b,null);for(var Ye=0;Ye<ye;++Ye)l.texSubImage3D(S,L,0,0,Ye,k,ne,1,d,b,je)}else{var ir=je,mr;(je.width!==k||je.height!==ne)&&(mr=D(),ir=mr.canvas,mr.canvas.width=k,mr.canvas.height=ne,mr.drawImage(je,0,0,k,ne)),l.texSubImage3D(S,L,0,0,Me,k,ne,1,d,b,ir),mr&&ir===mr.canvas&&(mr.canvas.width=0,mr.canvas.height=0)}nt(p)&&l.generateMipmap(S)}F===0&&A(P.length?P:void 0,y,M)}}M=e.map(function(Me,Be){return la(Me,p.crossOrigin,Fe(Be))})}function Gt(l,y,p,A){A=A||Q.textureOptions;var e=A.target||rr;l.bindTexture(e,y);var t=A.width,n=A.height,d=A.depth,b=A.level||0,S=A.internalFormat||A.format||_,F=Yr(S),P=A.format||F.format,M=A.type||yt(l,p,F.type);if(Ae(p))p instanceof Uint8ClampedArray&&(p=new Uint8Array(p.buffer));else{var L=le.getTypedArrayTypeForGLType(M);p=new L(p)}var k=Kr(S,M),ne=p.byteLength/k;if(ne%1)throw"length wrong size for format: "+j.glEnumToString(l,P);var ye;if(e===x||e===B)if(!t&&!n&&!d){var be=Math.cbrt(ne);if(be%1!==0)throw"can't guess cube size of array of numElements: "+ne;t=be,n=be,d=be}else t&&(!n||!d)?(ye=zr(l,e,n,d,ne/t),n=ye.width,d=ye.height):n&&(!t||!d)?(ye=zr(l,e,t,d,ne/n),t=ye.width,d=ye.height):(ye=zr(l,e,t,n,ne/d),t=ye.width,n=ye.height);else ye=zr(l,e,t,n,ne),t=ye.width,n=ye.height;if(Ot(l),l.pixelStorei(f,A.unpackAlignment||1),at(l,A),e===me){var Fe=k/p.BYTES_PER_ELEMENT,Me=ne/6*Fe;Nt(l,A).forEach(function(Be){var je=Me*Be.ndx,Ye=p.subarray(je,je+Me);l.texImage2D(Be.face,b,S,t,n,0,P,M,Ye)})}else e===x||e===B?l.texImage3D(e,b,S,t,n,d,0,P,M,p):l.texImage2D(e,b,S,t,n,0,P,M,p);return{width:t,height:n,depth:d,type:M}}function sa(l,y,p){var A=p.target||rr;l.bindTexture(A,y);var e=p.level||0,t=p.internalFormat||p.format||_,n=Yr(t),d=p.format||n.format,b=p.type||n.type;if(at(l,p),A===me)for(var S=0;S<6;++S)l.texImage2D(U+S,e,t,p.width,p.height,0,d,b,null);else A===x||A===B?l.texImage3D(A,e,t,p.width,p.height,p.depth,0,d,b,null):l.texImage2D(A,e,t,p.width,p.height,0,d,b,null)}function va(l,y,p){p=p||Qr,y=y||Q.textureOptions;var A=l.createTexture(),e=y.target||rr,t=y.width||1,n=y.height||1,d=y.internalFormat||_;l.bindTexture(e,A),e===me&&(l.texParameteri(e,He,Re),l.texParameteri(e,fr,Re));var b=y.src;if(b)if(typeof b=="function"&&(b=b(l,y)),typeof b=="string")ja(l,A,y,p);else if(Ae(b)||Array.isArray(b)&&(typeof b[0]=="number"||Array.isArray(b[0])||Ae(b[0]))){var S=Gt(l,A,b,y);t=S.width,n=S.height}else Array.isArray(b)&&(typeof b[0]=="string"||ca(b[0]))?e===me?pn(l,A,y,p):Va(l,A,y,p):(fa(l,A,b,y),t=b.width,n=b.height);else sa(l,A,y);return nt(y)&&pt(l,A,y,t,n,d),ia(l,A,y),A}function dn(l,y,p,A,e,t){A=A||p.width,e=e||p.height,t=t||p.depth;var n=p.target||rr;l.bindTexture(n,y);var d=p.level||0,b=p.internalFormat||p.format||_,S=Yr(b),F=p.format||S.format,P,M=p.src;if(M&&(Ae(M)||Array.isArray(M)&&typeof M[0]=="number")?P=p.type||yt(l,M,S.type):P=p.type||S.type,n===me)for(var L=0;L<6;++L)l.texImage2D(U+L,d,b,A,e,0,F,P,null);else n===x||n===B?l.texImage3D(n,d,b,A,e,t,0,F,P,null):l.texImage2D(n,d,b,A,e,0,F,P,null)}function kt(l){return typeof l=="string"||Array.isArray(l)&&typeof l[0]=="string"}function bn(l,y,p){p=p||Qr;var A=0,e=[],t={},n={};function d(){A===0&&setTimeout(function(){p(e.length?e:void 0,t,n)},0)}return Object.keys(y).forEach(function(b){var S=y[b],F;kt(S.src)&&(F=function(M,L,k){n[b]=k,--A,M&&e.push(M),d()},++A),t[b]=va(l,S,F)}),d(),t}},"./src/twgl-full.js":(z,u,H)=>{function ie(D){"@babel/helpers - typeof";return ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(K){return typeof K}:function(K){return K&&typeof Symbol=="function"&&K.constructor===Symbol&&K!==Symbol.prototype?"symbol":typeof K},ie(D)}u.__esModule=!0;var j={m4:!0,v3:!0,primitives:!0};u.v3=u.primitives=u.m4=void 0;var le=Ae(H("./src/m4.js"));u.m4=le;var oe=Ae(H("./src/v3.js"));u.v3=oe;var W=Ae(H("./src/primitives.js"));u.primitives=W;var he=H("./src/twgl.js");Object.keys(he).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(j,D)||D in u&&u[D]===he[D]||(u[D]=he[D])});function Q(D){if(typeof WeakMap!="function")return null;var K=new WeakMap,Y=new WeakMap;return(Q=function(V){return V?Y:K})(D)}function Ae(D,K){if(!K&&D&&D.__esModule)return D;if(D===null||ie(D)!="object"&&typeof D!="function")return{default:D};var Y=Q(K);if(Y&&Y.has(D))return Y.get(D);var _={__proto__:null},V=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ae in D)if(ae!=="default"&&Object.prototype.hasOwnProperty.call(D,ae)){var Te=V?Object.getOwnPropertyDescriptor(D,ae):null;Te&&(Te.get||Te.set)?Object.defineProperty(_,ae,Te):_[ae]=D[ae]}return _.default=D,Y&&Y.set(D,_),_}},"./src/twgl.js":(z,u,H)=>{function ie(g){"@babel/helpers - typeof";return ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(de){return typeof de}:function(de){return de&&typeof Symbol=="function"&&de.constructor===Symbol&&de!==Symbol.prototype?"symbol":typeof de},ie(g)}u.__esModule=!0;var j={addExtensionsToContext:!0,getContext:!0,getWebGLContext:!0,resizeCanvasToDisplaySize:!0,setDefaults:!0,attributes:!0,textures:!0,utils:!0,draw:!0,framebuffers:!0,programs:!0,typedarrays:!0,vertexArrays:!0};u.addExtensionsToContext=ur,u.framebuffers=u.draw=u.attributes=void 0,u.getContext=B,u.getWebGLContext=me,u.programs=void 0,u.resizeCanvasToDisplaySize=U,u.setDefaults=Te,u.vertexArrays=u.utils=u.typedarrays=u.textures=void 0;var le=V(H("./src/attributes.js"));u.attributes=le,Object.keys(le).forEach(function(g){g==="default"||g==="__esModule"||Object.prototype.hasOwnProperty.call(j,g)||g in u&&u[g]===le[g]||(u[g]=le[g])});var oe=V(H("./src/textures.js"));u.textures=oe,Object.keys(oe).forEach(function(g){g==="default"||g==="__esModule"||Object.prototype.hasOwnProperty.call(j,g)||g in u&&u[g]===oe[g]||(u[g]=oe[g])});var W=V(H("./src/helper.js")),he=V(H("./src/utils.js"));u.utils=he,Object.keys(he).forEach(function(g){g==="default"||g==="__esModule"||Object.prototype.hasOwnProperty.call(j,g)||g in u&&u[g]===he[g]||(u[g]=he[g])});var Q=V(H("./src/draw.js"));u.draw=Q,Object.keys(Q).forEach(function(g){g==="default"||g==="__esModule"||Object.prototype.hasOwnProperty.call(j,g)||g in u&&u[g]===Q[g]||(u[g]=Q[g])});var Ae=V(H("./src/framebuffers.js"));u.framebuffers=Ae,Object.keys(Ae).forEach(function(g){g==="default"||g==="__esModule"||Object.prototype.hasOwnProperty.call(j,g)||g in u&&u[g]===Ae[g]||(u[g]=Ae[g])});var D=V(H("./src/programs.js"));u.programs=D,Object.keys(D).forEach(function(g){g==="default"||g==="__esModule"||Object.prototype.hasOwnProperty.call(j,g)||g in u&&u[g]===D[g]||(u[g]=D[g])});var K=V(H("./src/typedarrays.js"));u.typedarrays=K,Object.keys(K).forEach(function(g){g==="default"||g==="__esModule"||Object.prototype.hasOwnProperty.call(j,g)||g in u&&u[g]===K[g]||(u[g]=K[g])});var Y=V(H("./src/vertex-arrays.js"));u.vertexArrays=Y,Object.keys(Y).forEach(function(g){g==="default"||g==="__esModule"||Object.prototype.hasOwnProperty.call(j,g)||g in u&&u[g]===Y[g]||(u[g]=Y[g])});function _(g){if(typeof WeakMap!="function")return null;var de=new WeakMap,_e=new WeakMap;return(_=function(We){return We?_e:de})(g)}function V(g,de){if(!de&&g&&g.__esModule)return g;if(g===null||ie(g)!="object"&&typeof g!="function")return{default:g};var _e=_(de);if(_e&&_e.has(g))return _e.get(g);var Ce={__proto__:null},We=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Ue in g)if(Ue!=="default"&&Object.prototype.hasOwnProperty.call(g,Ue)){var Ze=We?Object.getOwnPropertyDescriptor(g,Ue):null;Ze&&(Ze.get||Ze.set)?Object.defineProperty(Ce,Ue,Ze):Ce[Ue]=g[Ue]}return Ce.default=g,_e&&_e.set(g,Ce),Ce}var ae={addExtensionsToContext:!0};function Te(g){W.copyExistingProperties(g,ae),le.setAttributeDefaults_(g),oe.setTextureDefaults_(g)}var Ge=/^(.*?)_/;function Re(g,de){he.glEnumToString(g,0);var _e=g.getExtension(de);if(_e){var Ce={},We=Ge.exec(de)[1],Ue="_"+We;for(var Ze in _e){var He=_e[Ze],fr=typeof He=="function",Tr=fr?We:Ue,cr=Ze;Ze.endsWith(Tr)&&(cr=Ze.substring(0,Ze.length-Tr.length)),g[cr]!==void 0?!fr&&g[cr]!==He&&W.warn(cr,g[cr],He,Ze):fr?g[cr]=function(nr){return function(){return nr.apply(_e,arguments)}}(He):(g[cr]=He,Ce[cr]=He)}Ce.constructor={name:_e.constructor.name},he.glEnumToString(Ce,0)}return _e}var or=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_depth_texture","WEBGL_draw_buffers"];function ur(g){for(var de=0;de<or.length;++de)Re(g,or[de])}function rr(g,de){for(var _e=["webgl","experimental-webgl"],Ce=null,We=0;We<_e.length;++We)if(Ce=g.getContext(_e[We],de),Ce){ae.addExtensionsToContext&&ur(Ce);break}return Ce}function me(g,de){var _e=rr(g,de);return _e}function x(g,de){for(var _e=["webgl2","webgl","experimental-webgl"],Ce=null,We=0;We<_e.length;++We)if(Ce=g.getContext(_e[We],de),Ce){ae.addExtensionsToContext&&ur(Ce);break}return Ce}function B(g,de){var _e=x(g,de);return _e}function U(g,de){de=de||1,de=Math.max(0,de);var _e=g.clientWidth*de|0,Ce=g.clientHeight*de|0;return g.width!==_e||g.height!==Ce?(g.width=_e,g.height=Ce,!0):!1}},"./src/typedarrays.js":(z,u)=>{u.__esModule=!0,u.getGLTypeForTypedArray=or,u.getGLTypeForTypedArrayType=ur,u.getTypedArrayTypeForGLType=rr,u.isArrayBuffer=void 0;var H=5120,ie=5121,j=5122,le=5123,oe=5124,W=5125,he=5126,Q=32819,Ae=32820,D=33635,K=5131,Y=33640,_=35899,V=35902,ae=36269,Te=34042,Ge={};{var Re=Ge;Re[H]=Int8Array,Re[ie]=Uint8Array,Re[j]=Int16Array,Re[le]=Uint16Array,Re[oe]=Int32Array,Re[W]=Uint32Array,Re[he]=Float32Array,Re[Q]=Uint16Array,Re[Ae]=Uint16Array,Re[D]=Uint16Array,Re[K]=Uint16Array,Re[Y]=Uint32Array,Re[_]=Uint32Array,Re[V]=Uint32Array,Re[ae]=Uint32Array,Re[Te]=Uint32Array}function or(me){if(me instanceof Int8Array)return H;if(me instanceof Uint8Array||me instanceof Uint8ClampedArray)return ie;if(me instanceof Int16Array)return j;if(me instanceof Uint16Array)return le;if(me instanceof Int32Array)return oe;if(me instanceof Uint32Array)return W;if(me instanceof Float32Array)return he;throw new Error("unsupported typed array type")}function ur(me){if(me===Int8Array)return H;if(me===Uint8Array||me===Uint8ClampedArray)return ie;if(me===Int16Array)return j;if(me===Uint16Array)return le;if(me===Int32Array)return oe;if(me===Uint32Array)return W;if(me===Float32Array)return he;throw new Error("unsupported typed array type")}function rr(me){var x=Ge[me];if(!x)throw new Error("unknown gl type");return x}u.isArrayBuffer=typeof SharedArrayBuffer<"u"?function(x){return x&&x.buffer&&(x.buffer instanceof ArrayBuffer||x.buffer instanceof SharedArrayBuffer)}:function(x){return x&&x.buffer&&x.buffer instanceof ArrayBuffer}},"./src/utils.js":(z,u)=>{u.__esModule=!0,u.glEnumToString=void 0,u.isWebGL1=ie,u.isWebGL2=H;function H(j){return!!j.texStorage2D}function ie(j){return!j.texStorage2D}u.glEnumToString=function(){var j={},le={};function oe(W){var he=W.constructor.name;if(!j[he]){for(var Q in W)if(typeof W[Q]=="number"){var Ae=le[W[Q]];le[W[Q]]=Ae?"".concat(Ae," | ").concat(Q):Q}j[he]=!0}}return function(he,Q){return oe(he),le[Q]||(typeof Q=="number"?"0x".concat(Q.toString(16)):Q)}}()},"./src/v3.js":(z,u)=>{u.__esModule=!0,u.add=le,u.copy=ur,u.create=j,u.cross=Y,u.distance=Te,u.distanceSq=Ge,u.divScalar=K,u.divide=me,u.dot=_,u.length=V,u.lengthSq=ae,u.lerp=W,u.lerpV=he,u.max=Q,u.min=Ae,u.mulScalar=D,u.multiply=rr,u.negate=or,u.normalize=Re,u.setDefaultType=ie,u.subtract=oe;var H=Float32Array;function ie(x){var B=H;return H=x,B}function j(x,B,U){var g=new H(3);return x&&(g[0]=x),B&&(g[1]=B),U&&(g[2]=U),g}function le(x,B,U){return U=U||new H(3),U[0]=x[0]+B[0],U[1]=x[1]+B[1],U[2]=x[2]+B[2],U}function oe(x,B,U){return U=U||new H(3),U[0]=x[0]-B[0],U[1]=x[1]-B[1],U[2]=x[2]-B[2],U}function W(x,B,U,g){return g=g||new H(3),g[0]=x[0]+U*(B[0]-x[0]),g[1]=x[1]+U*(B[1]-x[1]),g[2]=x[2]+U*(B[2]-x[2]),g}function he(x,B,U,g){return g=g||new H(3),g[0]=x[0]+U[0]*(B[0]-x[0]),g[1]=x[1]+U[1]*(B[1]-x[1]),g[2]=x[2]+U[2]*(B[2]-x[2]),g}function Q(x,B,U){return U=U||new H(3),U[0]=Math.max(x[0],B[0]),U[1]=Math.max(x[1],B[1]),U[2]=Math.max(x[2],B[2]),U}function Ae(x,B,U){return U=U||new H(3),U[0]=Math.min(x[0],B[0]),U[1]=Math.min(x[1],B[1]),U[2]=Math.min(x[2],B[2]),U}function D(x,B,U){return U=U||new H(3),U[0]=x[0]*B,U[1]=x[1]*B,U[2]=x[2]*B,U}function K(x,B,U){return U=U||new H(3),U[0]=x[0]/B,U[1]=x[1]/B,U[2]=x[2]/B,U}function Y(x,B,U){U=U||new H(3);var g=x[2]*B[0]-x[0]*B[2],de=x[0]*B[1]-x[1]*B[0];return U[0]=x[1]*B[2]-x[2]*B[1],U[1]=g,U[2]=de,U}function _(x,B){return x[0]*B[0]+x[1]*B[1]+x[2]*B[2]}function V(x){return Math.sqrt(x[0]*x[0]+x[1]*x[1]+x[2]*x[2])}function ae(x){return x[0]*x[0]+x[1]*x[1]+x[2]*x[2]}function Te(x,B){var U=x[0]-B[0],g=x[1]-B[1],de=x[2]-B[2];return Math.sqrt(U*U+g*g+de*de)}function Ge(x,B){var U=x[0]-B[0],g=x[1]-B[1],de=x[2]-B[2];return U*U+g*g+de*de}function Re(x,B){B=B||new H(3);var U=x[0]*x[0]+x[1]*x[1]+x[2]*x[2],g=Math.sqrt(U);return g>1e-5?(B[0]=x[0]/g,B[1]=x[1]/g,B[2]=x[2]/g):(B[0]=0,B[1]=0,B[2]=0),B}function or(x,B){return B=B||new H(3),B[0]=-x[0],B[1]=-x[1],B[2]=-x[2],B}function ur(x,B){return B=B||new H(3),B[0]=x[0],B[1]=x[1],B[2]=x[2],B}function rr(x,B,U){return U=U||new H(3),U[0]=x[0]*B[0],U[1]=x[1]*B[1],U[2]=x[2]*B[2],U}function me(x,B,U){return U=U||new H(3),U[0]=x[0]/B[0],U[1]=x[1]/B[1],U[2]=x[2]/B[2],U}},"./src/vertex-arrays.js":(z,u,H)=>{function ie(D){"@babel/helpers - typeof";return ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(K){return typeof K}:function(K){return K&&typeof Symbol=="function"&&K.constructor===Symbol&&K!==Symbol.prototype?"symbol":typeof K},ie(D)}u.__esModule=!0,u.createVAOAndSetAttributes=Q,u.createVAOFromBufferInfo=Ae,u.createVertexArrayInfo=he;var j=oe(H("./src/programs.js"));function le(D){if(typeof WeakMap!="function")return null;var K=new WeakMap,Y=new WeakMap;return(le=function(V){return V?Y:K})(D)}function oe(D,K){if(!K&&D&&D.__esModule)return D;if(D===null||ie(D)!="object"&&typeof D!="function")return{default:D};var Y=le(K);if(Y&&Y.has(D))return Y.get(D);var _={__proto__:null},V=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ae in D)if(ae!=="default"&&Object.prototype.hasOwnProperty.call(D,ae)){var Te=V?Object.getOwnPropertyDescriptor(D,ae):null;Te&&(Te.get||Te.set)?Object.defineProperty(_,ae,Te):_[ae]=D[ae]}return _.default=D,Y&&Y.set(D,_),_}var W=34963;function he(D,K,Y){var _=D.createVertexArray();return D.bindVertexArray(_),K.length||(K=[K]),K.forEach(function(V){j.setBuffersAndAttributes(D,V,Y)}),D.bindVertexArray(null),{numElements:Y.numElements,elementType:Y.elementType,vertexArrayObject:_}}function Q(D,K,Y,_){var V=D.createVertexArray();return D.bindVertexArray(V),j.setAttributes(K,Y),_&&D.bindBuffer(W,_),D.bindVertexArray(null),V}function Ae(D,K,Y){return Q(D,K.attribSetters||K,Y.attribs,Y.indices)}}},R={};function C(z){var u=R[z];if(u!==void 0)return u.exports;var H=R[z]={exports:{}};return s[z](H,H.exports,C),H.exports}var G=C("./src/twgl-full.js");return G})())})(Un);var Zr=Un.exports,Cr,Br,ut,qt,ft,gr,ct,Nr,Ht,Kt,Ea,Ta,Sa,en,Gn,rn,kn,tn,jn,Aa,Fn,an,Vn;class Qn{constructor(){Ee(this,en);Ee(this,rn);Ee(this,tn);Ee(this,Aa);Ee(this,an);$e(this,"canvas",document.querySelector("#canvas"));$e(this,"gl");Ee(this,Cr,new Map);Ee(this,Br,new Map);Ee(this,ut,void 0);Ee(this,qt,void 0);Ee(this,ft,void 0);Ee(this,gr,new Uint8Array(600));Ee(this,ct,void 0);Ee(this,Nr,new Uint8Array(3*40));Ee(this,Ht,void 0);Ee(this,Kt,void 0);Ee(this,Ea,document.createTextNode("0"));Ee(this,Ta,document.createTextNode("1"));Ee(this,Sa,document.createTextNode("0"));document.querySelector("#linesCleared").appendChild(N(this,Ea)),document.querySelector("#speedLevel").appendChild(N(this,Ta)),document.querySelector("#score").appendChild(N(this,Sa)),N(this,Cr).set(1,[255,0,0]),N(this,Cr).set(2,[0,255,0]),N(this,Cr).set(3,[255,255,0]),N(this,Cr).set(4,[0,0,255]),N(this,Cr).set(5,[180,90,246]),N(this,Cr).set(6,[0,255,255]),N(this,Cr).set(7,[255,140,40]),N(this,Br).set("Z",1),N(this,Br).set("S",2),N(this,Br).set("O",3),N(this,Br).set("J",4),N(this,Br).set("T",5),N(this,Br).set("I",6),N(this,Br).set("L",7);let a=this.canvas.getContext("webgl");this.gl=a,a||document.body.appendChild(document.createTextNode("WebGL is not supported."));function s(j,le,oe,W){return[j,le+W,j+oe,le+W,j+oe,le,j,le]}function R(j,le,oe,W){let he=[j/2,j],Q=[],Ae=(500-he[1])/2,D=(400-he[0])/2;Q.push(...s(D,Ae,he[0],he[1])),Q.push(...s(D-le-W,Ae,W,W));for(let K=0;K<3;K++)Q.push(...s(D+le+he[0],Ae+K*(W+oe),W,W));return Q}const C={a_Position:{numComponents:2,data:R(500,5,0,70)},a_GridPos:{numComponents:2,data:[0,0,10,0,10,20,0,20,0,0,4,0,4,4,0,4,0,0,4,0,4,4,0,4,0,0,4,0,4,4,0,4,0,0,4,0,4,4,0,4]},a_QueueID:{numComponents:1,data:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3]},a_ShaderID:{numComponents:1,data:[0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},indices:{numComponents:3,data:[0,1,2,2,3,0,4,5,6,6,7,4,8,9,10,10,11,8,12,13,14,14,15,12,16,17,18,18,19,16]}};Se(this,qt,Zr.createBufferInfoFromArrays(a,C));let G=document.querySelector("#vertex-shader-2d").text,z=document.querySelector("#fragment-shader-2d").text;Se(this,ut,Zr.createProgramInfo(a,[G,z]));let u={src:"textures/block.png",mag:a.LINEAR};Se(this,Ht,Zr.createTexture(this.gl,u));let H={src:"textures/outline.png",mag:a.LINEAR};Se(this,Kt,Zr.createTexture(this.gl,H)),Se(this,ft,a.createTexture()),a.bindTexture(a.TEXTURE_2D,N(this,ft)),a.pixelStorei(a.UNPACK_ALIGNMENT,1),a.texImage2D(a.TEXTURE_2D,0,a.RGB,10,20,0,a.RGB,a.UNSIGNED_BYTE,null),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),Se(this,ct,a.createTexture()),a.bindTexture(a.TEXTURE_2D,N(this,ct)),a.pixelStorei(a.UNPACK_ALIGNMENT,1),a.texImage2D(a.TEXTURE_2D,0,a.RGB,4,2*5,0,a.RGB,a.UNSIGNED_BYTE,null),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.useProgram(N(this,ut).program),Zr.setBuffersAndAttributes(a,N(this,ut),N(this,qt));let ie={u_GridData:N(this,ft),u_QueueData:N(this,ct),u_BlockTexture:N(this,Ht),u_OutlineTexture:N(this,Kt)};Zr.setUniforms(N(this,ut),ie)}updateData(a){er(this,en,Gn).call(this,a),er(this,tn,jn).call(this,a),er(this,an,Vn).call(this,a)}renderGame(){Zr.resizeCanvasToDisplaySize(this.gl.canvas),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height);let a={u_GridData:N(this,ft),u_QueueData:N(this,ct),u_BlockTexture:N(this,Ht),u_OutlineTexture:N(this,Kt)};Zr.setUniforms(N(this,ut),a),Zr.drawBufferInfo(this.gl,N(this,qt))}}Cr=new WeakMap,Br=new WeakMap,ut=new WeakMap,qt=new WeakMap,ft=new WeakMap,gr=new WeakMap,ct=new WeakMap,Nr=new WeakMap,Ht=new WeakMap,Kt=new WeakMap,Ea=new WeakMap,Ta=new WeakMap,Sa=new WeakMap,en=new WeakSet,Gn=function(a){for(let s=0;s<20;s++){let R=a.gridData[s];for(let C=0;C<10;C++){let G=er(this,rn,kn).call(this,R,C),z=3*(10*s+C);if(G!=0){let u=N(this,Cr).get(G);N(this,gr)[z]=u[0],N(this,gr)[z+1]=u[1],N(this,gr)[z+2]=u[2]}else N(this,gr)[z]=0,N(this,gr)[z+1]=0,N(this,gr)[z+2]=0}}if(a.playerPiece.active){let s=170;for(let C=0;C<4;C++){let G=3*(10*a.ghostBlocks[C][1]+a.ghostBlocks[C][0]);N(this,gr)[G]=s,N(this,gr)[G+1]=s,N(this,gr)[G+2]=s}let R=a.playerPiece.shape;for(let C=0;C<4;C++){let G=N(this,Cr).get(N(this,Br).get(R)),z=3*(10*a.playerPiece.blocks[C][1]+a.playerPiece.blocks[C][0]);N(this,gr)[z]=G[0],N(this,gr)[z+1]=G[1],N(this,gr)[z+2]=G[2]}}this.gl.bindTexture(this.gl.TEXTURE_2D,N(this,ft)),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,10,20,this.gl.RGB,this.gl.UNSIGNED_BYTE,N(this,gr))},rn=new WeakSet,kn=function(a,s){const R=32-(3+3*s),C=7<<R;return(a&C)>>>R},tn=new WeakSet,jn=function(a){for(let s=0;s<N(this,Nr).length;s++)N(this,Nr)[s]=0;a.heldPiece!=null&&er(this,Aa,Fn).call(this,a.heldPiece,0);for(let s=0;s<4;s++)er(this,Aa,Fn).call(this,a.pieceQueue[s],24*(1+s));this.gl.bindTexture(this.gl.TEXTURE_2D,N(this,ct)),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,4,10,this.gl.RGB,this.gl.UNSIGNED_BYTE,N(this,Nr))},Aa=new WeakSet,Fn=function(a,s){let R=ot.getBaseShape(a),C=N(this,Cr).get(N(this,Br).get(a));for(let G=0;G<4;G++){let z=R[G],u=s+3*(z[1]*4+z[0]);N(this,Nr)[u]=C[0],N(this,Nr)[u+1]=C[1],N(this,Nr)[u+2]=C[2]}if(a!="I"&&a!="O"){let G=s+21;N(this,Nr)[G]=255}else a=="I"&&(N(this,Nr)[s+21+1]=255)},an=new WeakSet,Vn=function(a){N(this,Ea).nodeValue=a.linesCleared,N(this,Ta).nodeValue=a.speedLevel==11?"MAX":a.speedLevel,N(this,Sa).nodeValue=a.score};var Yt,zt,At,lt,st,vt,et,Qt,ga;class Zn{constructor(a,s){$e(this,"leftQueue",0);$e(this,"rightQueue",0);$e(this,"moveDown",!1);$e(this,"rotate",{left:!1,right:!1});$e(this,"hardDrop",!1);$e(this,"hold",!1);$e(this,"dragSensitivity",40);$e(this,"slamThreshold",150);$e(this,"slamTimeLimit",400);$e(this,"turnaroundFactor",.5);Ee(this,Yt,void 0);Ee(this,zt,void 0);Ee(this,At,void 0);Ee(this,lt,void 0);Ee(this,st,!1);Ee(this,vt,null);Ee(this,et,{startTime:0,startY:0,endY:0});Ee(this,Qt,void 0);Ee(this,ga,!1);a.addEventListener("touchmove",R=>{this.dragEvent(R)}),a.addEventListener("touchstart",R=>{this.touchStart(R)}),a.addEventListener("touchend",R=>{this.touchEnd(R)}),a.addEventListener("touchcancel",R=>{this.touchEnd(R)}),Se(this,Yt,a),s.addEventListener("click",R=>{this.hold=!0})}touchStart(a){if(N(this,vt)===null&&a.target.closest(".blockGestures")===null){let s=a.touches.item(0);Se(this,vt,s.identifier),Se(this,At,s.pageX),Se(this,lt,s.pageY),Se(this,zt,s.pageX),Se(this,Qt,Date.now()),Se(this,ga,s.clientX<N(this,Yt).getBoundingClientRect().x+N(this,Yt).getBoundingClientRect().width*.5),Se(this,et,{startTime:Date.now(),startY:s.pageY,endY:s.pageY})}}touchEnd(a){let s=!0;for(let R=0;R<a.touches.length&&s;R++)a.touches.item(R).identifier===N(this,vt)&&(s=!1);s&&(Date.now()-N(this,Qt)<300&&this.leftQueue==0&&this.rightQueue==0&&(N(this,ga)?this.rotate.left=!0:this.rotate.right=!0),Date.now()-N(this,et).startTime<=this.slamTimeLimit&&N(this,et).endY-N(this,et).startY>this.slamThreshold&&(this.hardDrop=!0),Se(this,vt,null),this.leftQueue=0,this.rightQueue=0,this.moveDown=!1)}dragEvent(a){let s=!1,R=null;for(let C=0;C<a.changedTouches.length;C++)if(a.changedTouches.item(C).identifier===N(this,vt)){R=a.changedTouches.item(C);break}R!==null&&((R.pageX-N(this,zt))*(N(this,st)?1:-1)>0&&(Se(this,st,!N(this,st)),Se(this,At,R.pageX+this.dragSensitivity*this.turnaroundFactor*(N(this,st)?1:-1)),Se(this,lt,R.pageY)),Math.abs(R.pageX-N(this,At))>this.dragSensitivity&&(N(this,st)?(this.leftQueue++,this.rightQueue=0):(this.rightQueue++,this.leftQueue=0),s=!0,N(this,et).startTime=0,this.moveDown=!1),R.pageY-N(this,lt)>this.dragSensitivity?(this.moveDown=!0,this.leftQueue=0,this.rightQueue=0,s=!0):N(this,lt)-R.pageY>this.dragSensitivity&&(this.moveDown=!1,s=!0),s&&(Se(this,At,R.pageX),Se(this,lt,R.pageY),Se(this,Qt,0)),Se(this,zt,R.pageX),N(this,et).endY=R.pageY)}}Yt=new WeakMap,zt=new WeakMap,At=new WeakMap,lt=new WeakMap,st=new WeakMap,vt=new WeakMap,et=new WeakMap,Qt=new WeakMap,ga=new WeakMap;class Jn{constructor(a,s,R,C,G,z,u){$e(this,"inputStates",new Map);$e(this,"frameCounter",{moveLeft:0,moveRight:0,softDrop:0});this.inputStates.set("moveLeft",!1),this.inputStates.set("moveRight",!1),this.inputStates.set("softDrop",!1),this.inputStates.set("hold",!1),this.inputStates.set("hardDrop",!1),this.inputStates.set("rotateClockwise",!1),this.inputStates.set("rotateAnticlockwise",!1),this.addStateListeners(s,"moveLeft"),this.addStateListeners(R,"moveRight"),this.addStateListeners(C,"softDrop"),this.addFlagListners(G,"hardDrop"),this.addFlagListners(z,"rotateClockwise"),this.addFlagListners(u,"rotateAnticlockwise"),this.addFlagListners(a,"hold")}addCommonListeners(a,s){a.addEventListener("pointerdown",R=>{this.inputStates.set(s,!0),a.classList.add("pressed")}),a.addEventListener("pointerleave",R=>{a.classList.remove("pressed")}),a.addEventListener("touchstart",R=>{R.preventDefault()})}addFlagListners(a,s){a.addEventListener("click",R=>{R.pointerType===""&&this.inputStates.set(s,!0)}),this.addCommonListeners(a,s)}addStateListeners(a,s){a.addEventListener("pointerleave",R=>{switch(this.inputStates.set(s,!1),a.classList.remove("pressed"),s){case"moveLeft":this.frameCounter.moveLeft=0;break;case"moveRight":this.frameCounter.moveRight=0;break;case"softDrop":this.frameCounter.softDrop=0;break}}),a.addEventListener("click",R=>{R.pointerType===""&&(s==="moveLeft"?this.frameCounter.moveLeft++:s==="moveRight"?this.frameCounter.moveRight++:s==="softDrop"&&this.frameCounter.softDrop++)}),this.addCommonListeners(a,s)}countFrame(){this.inputStates.get("moveLeft")&&this.frameCounter.moveLeft++,this.inputStates.get("moveRight")&&this.frameCounter.moveRight++,this.inputStates.get("softDrop")&&this.frameCounter.softDrop++}resetFlags(){this.inputStates.set("hold",!1),this.inputStates.set("hardDrop",!1),this.inputStates.set("rotateClockwise",!1),this.inputStates.set("rotateAnticlockwise",!1)}getInput(a){return this.inputStates.get(a)}}let ma=null,Cn=new Map,Wn;function $n(ce){ce.inputKeys.forEach(function(s,R,C){localStorage.setItem(s,R)})}function ei(ce){let a=[];ce.inputKeys.forEach(function(s,R,C){const G=localStorage.getItem(s);G!=null&&a.push({action:s,oldKey:R,newKey:G})});for(let s=0;s<a.length;s++)ce.inputKeys.delete(a[s].oldKey);for(let s=0;s<a.length;s++)ce.inputKeys.set(a[s].newKey,a[s].action)}function ri(ce,a){const s=document.querySelectorAll(ce);for(let G=0;G<s.length;G++){let z=s[G];z.classList.add("ready"),z.addEventListener("click",function(){a.selectedSpan!=null&&(a.selectedKey="Escape",C()),a.originalKeybind=z.innerText,a.selectedSpan=z,a.selectedAction=z.id.substring(2),ma.textContent="Rebinding "+a.selectedAction+" action (press key to rebind)...",document.addEventListener("keydown",R),z.classList.remove("ready"),z.classList.add("waiting"),z.innerText="..."}),z.innerText=a.actionToKey(z.id.substring(2)),z.innerText==" "&&(z.innerText="Space")}function R(G){a.selectedKey=G.key.length>1?G.key:G.key.toUpperCase(),C()}function C(){a.selectedKey=="Escape"||Wn.classList.contains("hide")?(a.selectedKey=a.originalKeybind,G(),ma.textContent="Rebind canceled.",a.updateCounters()):a.rebindControl(a.selectedAction,a.selectedKey)?(ma.textContent="Rebind successful!",G(),$n(a)):ma.textContent="'"+a.selectedKey+"' is already in use (press another key)...";function G(){document.removeEventListener("keydown",R);const z=a.selectedKey==" "?"Space":a.selectedKey;a.selectedSpan.innerText=z,Cn.get(a.selectedAction).forEach(function(u,H,ie){u.innerText=z}),a.selectedAction="",a.selectedKey="",a.selectedSpan.classList.remove("waiting"),a.selectedSpan.classList.add("ready"),a.selectedSpan=null}}}function ti(ce,a,s,R){Wn=R,ma=s,ri(ce,a),a.actionStates.forEach(function(C,G,z){Cn.set(G,document.querySelectorAll("span.cd_"+G)),Cn.get(G).forEach(function(u,H,ie){const j=a.actionToKey(G);u.innerText=j==" "?"Space":j})})}var _a,wa,Pa,Wr,ht,Zt,gt,Jt;class ai{constructor(a,s,R,C){Ee(this,_a,void 0);Ee(this,wa,void 0);Ee(this,Pa,void 0);Ee(this,Wr,{gestureEnable:!1,buttonEnable:!0,keyboardRepeatDelay:5,gestureGridIncrement:40,gestureDirectionSwapAssist:0,gestureHardDropDistance:150,gestureHardDropTimer:200,buttonRepeatDelay:5});$e(this,"settingsValues");Ee(this,ht,void 0);Ee(this,Zt,void 0);Ee(this,gt,void 0);Ee(this,Jt,void 0);N(this,Wr).buttonEnable=window.matchMedia("(pointer: coarse)").matches,Se(this,_a,document.querySelector("div."+a)),Se(this,wa,document.querySelector("div."+s)),Se(this,Pa,document.querySelector("div."+R)),document.querySelector("button."+a).addEventListener("click",G=>{_n(N(this,_a))}),document.querySelector("button."+s).addEventListener("click",G=>{_n(N(this,wa))}),document.querySelector("button."+R).addEventListener("click",G=>{_n(N(this,Pa))}),this.settingsValues={...N(this,Wr)},this.loadValues(),Object.keys(N(this,Wr)).forEach((G,z,u)=>{this.linkInput(G)}),Se(this,ht,C),Se(this,Zt,document.querySelector(".canvasSpace")),Se(this,gt,document.querySelector(".controller")),Se(this,Jt,!N(this,gt).classList.contains("hide")),this.updateValues()}linkInput(a){let s=document.querySelector("input."+a);if(s===null){console.log("Could not find input element for the '"+a+"' setting.");return}if(s.getAttribute("type")==="checkbox"){let C=s.closest(".menu");s.addEventListener("input",G=>{this.settingsValues[a]=s.checked,s.checked?C.classList.remove("disabled"):C.classList.add("disabled"),this.updateValues()}),s.checked=this.settingsValues[a],s.checked||C.classList.add("disabled");return}s.value=this.settingsValues[a];let R=document.querySelector("span."+a);R.innerHTML=s.value,s.addEventListener("input",C=>{R.innerHTML=s.value,this.settingsValues[a]=s.value,this.updateValues()})}updateValues(){N(this,ht).dragSensitivity=this.settingsValues.gestureGridIncrement,N(this,ht).slamThreshold=this.settingsValues.gestureHardDropDistance,N(this,ht).slamTimeLimit=this.settingsValues.gestureHardDropTimer,N(this,ht).turnaroundFactor=this.settingsValues.gestureDirectionSwapAssist/100,N(this,Jt)!==this.settingsValues.buttonEnable&&(Se(this,Jt,this.settingsValues.buttonEnable),this.settingsValues.buttonEnable?(N(this,gt).classList.remove("hide"),N(this,Zt).classList.add("giveControllerSpace")):(N(this,gt).classList.add("hide"),N(this,Zt).classList.remove("giveControllerSpace"))),this.saveValues()}saveValues(){localStorage.setItem("settings",JSON.stringify(this.settingsValues))}loadValues(){let a=JSON.parse(localStorage.getItem("settings"));a!==null&&Object.keys(a).forEach((s,R,C)=>{this.settingsValues[s]=a[s]})}resetToDefault(){this.settingsValues={...N(this,Wr)},this.updateValues(),Object.keys(N(this,Wr)).forEach((a,s,R)=>{let C=document.querySelector("input."+a);if(C===null)return;if(C.getAttribute("type")==="checkbox"){C.checked=N(this,Wr)[a];let z=C.closest(".menu");C.checked?z.classList.remove("disabled"):z.classList.add("disabled")}else C.value=N(this,Wr)[a];let G=document.querySelector("span."+a);G!==null&&(G.innerHTML=C.value)})}}_a=new WeakMap,wa=new WeakMap,Pa=new WeakMap,Wr=new WeakMap,ht=new WeakMap,Zt=new WeakMap,gt=new WeakMap,Jt=new WeakMap;function _n(ce){ce.classList.contains("hide")?ce.classList.remove("hide"):ce.classList.add("hide")}function ni(){const ce=document.querySelector("#startButton");let a=new Yn;ei(a),document.addEventListener("keydown",function(_){a.setInputState(_.key,!0)}),document.addEventListener("keyup",function(_){a.setInputState(_.key,!1)});let s=new Zn(document.querySelector(".container"),document.querySelector("#heldPiece")),R=new Jn(document.querySelector("#tib_hold"),document.querySelector("#tib_moveLeft"),document.querySelector("#tib_moveRight"),document.querySelector("#tib_softDrop"),document.querySelector("#tib_hardDrop"),document.querySelector("#tib_rotateClockwise"),document.querySelector("#tib_rotateAnticlockwise")),C=new ai("keyboardSettings","gestureSettings","buttonSettings",s);document.querySelector("#resetDefaultSettings").addEventListener("click",_=>{C.resetToDefault()});let G=new wn,z=new Qn;const u=document.querySelector("#titleScreen"),H=document.querySelector("#pauseScreen"),ie=document.querySelector("#gameOverScreen"),j=document.querySelector("#settingsScreen"),le=document.querySelector("#howToScreen");let oe=!0;const W=document.createTextNode("0"),he=document.createTextNode("0");document.querySelector("#finalScore").appendChild(W),document.querySelector("#finalLines").append(he);let Q=0,Ae=0;function D(_){let V=(_-Ae)*.001;Ae=_,Q+=V,j.classList.contains("hide")?G.gameState.gameOver?oe||ie.classList.contains("hide")&&(ie.classList.remove("hide"),W.textContent=G.gameState.score,he.textContent=G.gameState.linesCleared):(Q>=G.gameTickTime&&(Q=Math.min(Q-G.gameTickTime,G.gameTickTime),a.updateCounters(),ii(G,a,s,R,C.settingsValues),G.runTick(),a.getCounter("pause")==1&&(G.gameState.isPaused?(G.pauseGame(!1),H.classList.add("hide"),le.classList.add("hide")):(G.pauseGame(!0),H.classList.remove("hide")))),G.isStateChanged&&z.updateData(G.gameState)):(a.updateCounters(),a.getCounter("pause")==1&&j.classList.add("hide")),z.renderGame(),requestAnimationFrame(D)}function K(){G.startNewGame(),z.updateData(G.gameState),z.renderGame(),document.querySelector("#titleScreen").classList.add("hide"),requestAnimationFrame(D),oe=!1}ce.addEventListener("click",K),document.querySelector("#unpauseButton").addEventListener("click",function(){G.gameState.isPaused=!1,H.classList.add("hide")}),document.querySelector("#replayButton").addEventListener("click",function(){G.startNewGame(),z.updateData(G.gameState),z.renderGame(),ie.classList.add("hide")}),document.querySelector("#returnToTitleButton").addEventListener("click",function(){u.classList.remove("hide"),ie.classList.add("hide"),oe=!0}),requestAnimationFrame(D),document.querySelector("#pauseButton").addEventListener("click",_=>{G.pauseGame(!0),H.classList.remove("hide")});let Y=document.createTextNode("");document.querySelector("#settingsConsoleText").appendChild(Y),ti(".controlRebind",a,Y,j),document.querySelector("#exitSettingsButton").addEventListener("click",function(){j.classList.add("hide")}),document.querySelectorAll(".settingsButton").forEach(function(_,V,ae){_.addEventListener("click",function(){j.classList.remove("hide")})}),document.querySelectorAll(".closeHowTo").forEach((_,V,ae)=>{_.addEventListener("click",Te=>{le.classList.add("hide")})}),document.querySelectorAll(".howToButton").forEach((_,V,ae)=>{_.addEventListener("click",Te=>{le.classList.remove("hide")})})}function ii(ce,a,s,R,C){let G=C.keyboardRepeatDelay,z=C.buttonRepeatDelay;a.getCounter("hardDrop")==1&&(ce.input.hardDrop=!0),a.getCounter("hold")==1&&(ce.input.hold=!0),a.getCounter("rotateClockwise")==1&&(ce.input.rotateClockwise=!0),a.getCounter("rotateAnticlockwise")==1&&(ce.input.rotateAnticlockwise=!0),a.getInputState("softDrop")&&(ce.input.softDrop=!0),(a.getCounter("moveLeft")==1||a.getCounter("moveLeft")>G)&&(ce.input.moveLeft=!0),(a.getCounter("moveRight")==1||a.getCounter("moveRight")>G)&&(ce.input.moveRight=!0),C.gestureEnable&&(s.leftQueue>0&&(ce.input.moveLeft=!0,s.leftQueue--),s.rightQueue>0&&(ce.input.moveRight=!0,s.rightQueue--),s.moveDown&&(ce.input.softDrop=!0),s.rotate.left?ce.input.rotateAnticlockwise=!0:s.rotate.right&&(ce.input.rotateClockwise=!0),s.rotate={left:!1,right:!1},s.hardDrop&&(ce.input.hardDrop=!0,s.hardDrop=!1)),s.hold&&(ce.input.hold=!0,s.hold=!1),C.buttonEnable&&(R.countFrame(),(R.frameCounter.moveLeft==1||R.frameCounter.moveLeft>z)&&(ce.input.moveLeft=!0),(R.frameCounter.moveRight==1||R.frameCounter.moveRight>z)&&(ce.input.moveRight=!0),R.frameCounter.softDrop>=1&&(ce.input.softDrop=!0),R.getInput("hold")&&(ce.input.hold=!0),R.getInput("rotateClockwise")&&(ce.input.rotateClockwise=!0),R.getInput("rotateAnticlockwise")&&(ce.input.rotateAnticlockwise=!0),R.getInput("hardDrop")&&(ce.input.hardDrop=!0),R.resetFlags())}ni();
