var io=Object.defineProperty;var ao=(c,e,t)=>e in c?io(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t;var wt=(c,e,t)=>(ao(c,typeof e!="symbol"?e+"":e,t),t),ca=(c,e,t)=>{if(!e.has(c))throw TypeError("Cannot "+t)};var re=(c,e,t)=>(ca(c,e,"read from private field"),t?t.call(c):e.get(c)),Ae=(c,e,t)=>{if(e.has(c))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(c):e.set(c,t)},ke=(c,e,t,r)=>(ca(c,e,"write to private field"),r?r.call(c,t):e.set(c,t),t);var ha=(c,e,t,r)=>({set _(n){ke(c,e,n,t)},get _(){return re(c,e,r)}}),$e=(c,e,t)=>(ca(c,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();var vn,mr,yr,Ci,Ur,xn,Zt,kr,Ri,Es,Pi,_s,Ni,ws,Di,As,gn,Mi,Gr,kn,Vn,Ea,Ii,Ss,Xn,_a,Bi,Ms,bn,Fi,qn,wa;const jn=class jn{constructor(){Ae(this,Ri);Ae(this,Pi);Ae(this,Ni);Ae(this,Di);Ae(this,gn);Ae(this,Gr);Ae(this,Vn);Ae(this,Ii);Ae(this,Xn);Ae(this,Bi);Ae(this,bn);Ae(this,qn);wt(this,"input",{moveLeft:!1,moveRight:!1,hardDrop:!1,softDrop:!1,hold:!1,rotClockwise:!1,rotAntiClockwise:!1});wt(this,"numRows",21);wt(this,"graceTimerDuration",.5);wt(this,"gameTickTime",1/30);wt(this,"pieceMap",new Map);wt(this,"gameState",{isPaused:!1,gameOver:!0,gridData:new Uint32Array(this.numRows),playerPiece:null,pieceQueue:[],heldPiece:null,ghostBlocks:[[0,0],[0,0],[0,0],[0,0]],linesCleared:0,speedLevel:1,score:0});Ae(this,vn,15);Ae(this,mr,!0);Ae(this,yr,0);Ae(this,Ci,!1);Ae(this,Ur,-1);Ae(this,xn,0);Ae(this,Zt,!1);Ae(this,kr,!1);$e(this,gn,Mi).call(this),$e(this,Gr,kn).call(this),$e(this,bn,Fi).call(this),ke(this,vn,15),this.pieceMap.set("Z",1),this.pieceMap.set("S",2),this.pieceMap.set("O",3),this.pieceMap.set("J",4),this.pieceMap.set("T",5),this.pieceMap.set("I",6),this.pieceMap.set("L",7),this.gameState.isPaused=!0}get isStateChanged(){const e=re(this,mr);return ke(this,mr,!1),e}runTick(){if(this.gameState.isPaused)return;let e=!1;if(re(this,kr)){this.animationCount==null||this.rowCount==null?(this.animationCount=0,this.rowCount=0):(this.animationCount++,this.rowCount<this.numRows&&this.animationCount%4==0?(this.clearRow(0),this.rowCount++,ke(this,mr,!0)):this.rowCount==this.numRows&&(this.rowCount++,this.gameState.gameOver=!0));return}if(this.input.hardDrop)this.hardDropPlayerPiece(),this.finishWithPiece(),e=!0;else if(this.input.hold)this.holdPiece(),e=!0;else{re(this,Zt)&&$e(this,Ii,Ss).call(this,this.gameTickTime),this.input.softDrop&&(e=this.tryMovePiece(0,-1)||e);let t=0;this.input.rotClockwise&&(t+=1),this.input.rotAntiClockwise&&(t-=1),t!=0&&(e=this.tryRotatePiece(t==1)||e);let r=0;if(this.input.moveLeft&&(r-=1),this.input.moveRight&&(r+=1),r!=0&&(e=this.tryMovePiece(r,0)||e),ha(this,yr)._++,re(this,yr)>=re(this,vn)){let n=!this.tryMovePiece(0,-1);e||(e=!n),ke(this,yr,0),n&&!re(this,Zt)&&$e(this,Vn,Ea).call(this)}if(re(this,Zt)&&re(this,Ur)<=0){let n=!this.tryMovePiece(0,-1);e=!0,n&&this.finishWithPiece()}else if(!re(this,Zt)){let n=!1;for(const a of this.gameState.playerPiece.blocks)n=n||this.isBlockHere(a[0],a[1]-1);n&&$e(this,Vn,Ea).call(this)}}e&&($e(this,bn,Fi).call(this),ke(this,mr,!0)),this.input={moveLeft:!1,moveRight:!1,hardDrop:!1,softDrop:!1,hold:!1,rotClockwise:!1,rotAntiClockwise:!1}}pauseGame(e){this.gameState.isPaused=e}startNewGame(){this.gameState.gameOver=!1,this.gameState.isPaused=!1,ke(this,kr,!1),this.animationCount=null,this.rowCount=null;for(let e=0;e<this.gameState.gridData.length;e++)this.gameState.gridData[e]=0;this.gameState.linesCleared=0,this.gameState.speedLevel=0,this.gameState.score=0,this.gameState.pieceQueue=[],this.gameState.heldPiece=null,$e(this,gn,Mi).call(this),$e(this,Gr,kn).call(this),$e(this,bn,Fi).call(this),$e(this,qn,wa).call(this)}tryMovePiece(e,t){let r=!0;for(let n=0;n<4&&r;n++){let a=this.gameState.playerPiece.blocks[n][0]+e,u=this.gameState.playerPiece.blocks[n][1]+t;this.isBlockHere(a,u)&&(r=!1)}return r&&($e(this,Pi,_s).call(this,e,t),e!=0&&$e(this,Xn,_a).call(this),t!=0&&ke(this,Zt,!1)),r}hardDropPlayerPiece(){for(;this.tryMovePiece(0,-1););}tryRotatePiece(e){let t=$e(this,Ni,ws).call(this,e);return t&&$e(this,Xn,_a).call(this),t}holdPiece(){if(this.gameState.heldPiece==null)this.gameState.heldPiece=this.gameState.playerPiece.shape,$e(this,Gr,kn).call(this),ke(this,mr,!0),ke(this,yr,0);else if(!this.gameState.playerPiece.wasHeld){let e=this.gameState.heldPiece;this.gameState.heldPiece=this.gameState.playerPiece.shape,this.gameState.playerPiece=new Sr(e),this.gameState.playerPiece.wasHeld=!0,ke(this,mr,!0),ke(this,yr,0),this.isPlayerPieceValid()||(this.gameState.playerPiece.active=!1,ke(this,kr,!0))}}finishWithPiece(){const e=this.gameState.linesCleared;this.gameState.playerPiece.shape=="T"&&ke(this,Ci,!0),$e(this,Di,As).call(this),$e(this,Gr,kn).call(this),ke(this,Zt,!1),$e(this,Bi,Ms).call(this),this.gameState.linesCleared!=e&&($e(this,qn,wa).call(this),this.gameState.score+=Math.pow(this.gameState.linesCleared-e,2)*100)}clearRow(e){for(let t=e;t<this.numRows-1;t++)this.gameState.gridData[t]=this.gameState.gridData[t+1];this.gameState.gridData[this.numRows-1]=0}isBlockHere(e,t){if(e<0||t<0||e>=10||t>=this.numRows)return!0;const r=this.gameState.gridData[t],n=7<<32-(3+3*e);return(r&n)!=0}getBlockData(e,t){const r=this.gameState.gridData[t],n=32-(3+3*e),a=7<<n;return(r&a)>>>n}isPlayerPieceValid(){let e=!0;for(let t=0;t<4&&e;t++)this.isBlockHere(this.gameState.playerPiece.blocks[t][0],this.gameState.playerPiece.blocks[t][1])&&(e=!1);return e}};vn=new WeakMap,mr=new WeakMap,yr=new WeakMap,Ci=new WeakMap,Ur=new WeakMap,xn=new WeakMap,Zt=new WeakMap,kr=new WeakMap,Ri=new WeakSet,Es=function(e,t,r){const a=~(7<<32-(3+3*e));this.gameState.gridData[t]&=a;const u=r<<32-(3+3*e);this.gameState.gridData[t]|=u},Pi=new WeakSet,_s=function(e,t){for(let r=0;r<4;r++)this.gameState.playerPiece.blocks[r][0]+=e,this.gameState.playerPiece.blocks[r][1]+=t},Ni=new WeakSet,ws=function(e){let t=(this.gameState.playerPiece.rotationIndex+4+(e?1:-1))%4,r=[...this.gameState.playerPiece.blocks[0]],n=[];for(let _=0;_<4;_++)n.push([...this.gameState.playerPiece.blocks[_]]);let a=1,u=1;e?u=-1:a=-1;let i;for(let _=0;_<4;_++)n[_][0]-=r[0],n[_][1]-=r[1],i=n[_][0],n[_][0]=a*n[_][1],n[_][1]=u*i,n[_][0]+=r[0],n[_][1]+=r[1];let h;switch(this.gameState.playerPiece.shape){case"O":h=Sr.offsets.O;break;case"I":h=Sr.offsets.I;break;default:h=Sr.offsets.OTHER;break}let v,d,g=!1;for(let _=0;_<5&&!g;_++){v=h[_],d=[v[this.gameState.playerPiece.rotationIndex][0]-v[t][0],v[this.gameState.playerPiece.rotationIndex][1]-v[t][1]],g=!0;for(let b=0;b<4;b++)n[b][0]+=d[0],n[b][1]+=d[1],this.isBlockHere(n[b][0],n[b][1])&&(g=!1);if(!g)for(let b=0;b<4;b++)n[b][0]-=d[0],n[b][1]-=d[1]}if(g){for(let _=0;_<4;_++)this.gameState.playerPiece.blocks[_]=[...n[_]];this.gameState.playerPiece.rotationIndex=t}return g},Di=new WeakSet,As=function(){let e,t,r=this.pieceMap.get(this.gameState.playerPiece.shape);for(let n=0;n<4;n++)e=this.gameState.playerPiece.blocks[n][0],t=this.gameState.playerPiece.blocks[n][1],$e(this,Ri,Es).call(this,e,t,r)},gn=new WeakSet,Mi=function(){let e=["O","I","T","J","L","S","Z"],t;for(let r=0;r<7;r++)t=Math.floor(Math.random()*e.length),this.gameState.pieceQueue.push(e[t]),e.splice(t,1)},Gr=new WeakSet,kn=function(){let e=this.gameState.pieceQueue[0];this.gameState.pieceQueue.splice(0,1),this.gameState.pieceQueue.length<7&&$e(this,gn,Mi).call(this),delete this.gameState.playerPiece,this.gameState.playerPiece=new Sr(e),this.isPlayerPieceValid()||(this.gameState.playerPiece.active=!1,ke(this,kr,!0)),ke(this,yr,0)},Vn=new WeakSet,Ea=function(){ke(this,Ur,this.graceTimerDuration),ke(this,Zt,!0),ke(this,xn,0)},Ii=new WeakSet,Ss=function(e){ke(this,Ur,re(this,Ur)-e)},Xn=new WeakSet,_a=function(){re(this,Zt)&&re(this,xn)<30&&(ke(this,Ur,this.graceTimerDuration),ha(this,xn)._++)},Bi=new WeakSet,Ms=function(){for(let e=0;e<this.numRows;e++){let t=!0;for(let r=0;r<10&&t;r++)this.isBlockHere(r,e)||(t=!1);t&&(this.clearRow(e),this.gameState.linesCleared++,e--)}},bn=new WeakSet,Fi=function(){for(let t=0;t<4;t++)this.gameState.ghostBlocks[t]=[...this.gameState.playerPiece.blocks[t]];let e=!1;for(;!e;){for(let t=0;t<4;t++)this.isBlockHere(this.gameState.ghostBlocks[t][0],this.gameState.ghostBlocks[t][1]-1)&&(e=!0);if(!e)for(let t=0;t<4;t++)this.gameState.ghostBlocks[t][1]-=1}},qn=new WeakSet,wa=function(){this.gameState.speedLevel=Math.min(Math.floor(this.gameState.linesCleared/10)+1,jn.levels.max),ke(this,vn,jn.levels[this.gameState.speedLevel])},wt(jn,"levels",{1:25,2:20,3:16,4:12,5:10,6:8,7:6,8:5,9:4,10:2,11:1,max:11});let Ta=jn;const Vt=class Vt{constructor(e){this.blocks=[],this.shape=e,this.rotationIndex=0,this.active=!0,this.wasHeld=!1;let t=Vt.getBaseShape(e);for(let r=0;r<4;r++)this.blocks.push([...t[r]]),this.blocks[r][0]+=3,this.blocks[r][1]+=19}static getBaseShape(e){let t;switch(e){case"O":t=Vt.pieces.O;break;case"I":t=Vt.pieces.I;break;case"L":t=Vt.pieces.L;break;case"J":t=Vt.pieces.J;break;case"T":t=Vt.pieces.T;break;case"S":t=Vt.pieces.S;break;case"Z":t=Vt.pieces.Z;break;default:t=[[0,0],[0,0],[0,0],[0,0]]}return t}};wt(Vt,"offsets",{O:[[[0,0],[0,-1],[-1,-1],[-1,0]]],I:[[[0,0],[-1,0],[-1,1],[0,1]],[[-1,0],[0,0],[1,1],[0,1]],[[2,0],[0,0],[-2,1],[0,1]],[[-1,0],[0,1],[1,0],[0,-1]],[[2,0],[0,-2],[-2,0],[0,2]]],OTHER:[[[0,0],[0,0],[0,0],[0,0]],[[0,0],[1,0],[0,0],[-1,0]],[[0,0],[1,-1],[0,0],[-1,-1]],[[0,0],[0,2],[0,0],[0,2]],[[0,0],[1,2],[0,0],[-1,2]]]}),wt(Vt,"pieces",{O:[[1,0],[1,1],[2,1],[2,0]],I:[[1,0],[0,0],[2,0],[3,0]],L:[[1,0],[0,0],[2,0],[2,1]],J:[[1,0],[0,0],[0,1],[2,0]],T:[[1,0],[0,0],[2,0],[1,1]],S:[[1,0],[0,0],[1,1],[2,1]],Z:[[1,0],[2,0],[1,1],[0,1]]});let Sr=Vt;class so{constructor(){wt(this,"selectedKey","");wt(this,"originalKeybind","");wt(this,"selectedAction","");wt(this,"selectedSpan",null);this.actionStates=new Map,this.actionStates.set("HardDrop",!1),this.actionStates.set("SoftDrop",!1),this.actionStates.set("MoveLeft",!1),this.actionStates.set("MoveRight",!1),this.actionStates.set("Hold",!1),this.actionStates.set("RotateClockwise",!1),this.actionStates.set("RotateAntiClockwise",!1),this.actionStates.set("Pause",!1),this.inputKeys=new Map,this.inputKeys.set("A","MoveLeft"),this.inputKeys.set("D","MoveRight"),this.inputKeys.set("W","HardDrop"),this.inputKeys.set("S","SoftDrop"),this.inputKeys.set("E","Hold"),this.inputKeys.set("ArrowLeft","RotateAntiClockwise"),this.inputKeys.set("ArrowRight","RotateClockwise"),this.inputKeys.set("Escape","Pause"),this.counters=new Map,this.counters.set("MoveLeft",0),this.counters.set("MoveRight",0),this.counters.set("RotateClockwise",0),this.counters.set("RotateAntiClockwise",0),this.counters.set("HardDrop",0),this.counters.set("Hold",0),this.counters.set("Pause",0)}keyToState(e){return e.length==1&&(e=e.toUpperCase()),this.inputKeys.get(e)}actionToKey(e){let t="";return this.inputKeys.forEach(function(r,n,a){r==e&&(t=n)}),t}rebindControl(e,t){let r=!1,n="";return this.inputKeys.forEach(function(a,u,i){a==e&&(n=u)}),n!=""&&(this.inputKeys.has(t)&&t!=n||(this.inputKeys.delete(n),this.inputKeys.set(t,e),r=!0)),r}setInputState(e,t){let r=this.keyToState(e);r!=null&&this.actionStates.set(r,t)}getInputState(e){return this.actionStates.has(e)?this.actionStates.get(e):(console.log("ERROR: trying to access an input action that doesn't exist ("+e+"). The allowed options are:"),this.actionStates.forEach(function(t,r,n){console.log("    - "+r)}),null)}updateCounters(){for(const[e,t]of this.counters)this.getInputState(e)?this.counters.set(e,t+1):this.counters.set(e,0)}getCounter(e){return this.counters.has(e)?this.counters.get(e):(console.log("ERROR: trying to access input action that doesn't have a counter ("+e+"). The counters are:"),this.counters.forEach(function(t,r,n){console.log("    - "+r+": "+t)}),null)}}var oo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Fs={exports:{}};/*!
 * @license twgl.js 5.5.4 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
 * Available via the MIT license.
 * see: http://github.com/greggman/twgl.js for details
 */(function(c,e){(function(r,n){c.exports=n()})(typeof self<"u"?self:oo,()=>(()=>{var t={"./src/attributes.js":(u,i,h)=>{function v(E){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},v(E)}i.__esModule=!0,i.createAttribsFromArrays=yt,i.createBufferFromArray=x,i.createBufferFromTypedArray=ge,i.createBufferInfoFromArrays=p,i.createBuffersFromArrays=I,i.getArray_=Z,i.getNumComponents_=Me,i.setAttribInfoBufferFromArray=lt,i.setAttributeDefaults_=ot,i.setAttributePrefix=st;var d=b(h("./src/typedarrays.js")),g=b(h("./src/helper.js"));function _(E){if(typeof WeakMap!="function")return null;var y=new WeakMap,m=new WeakMap;return(_=function(w){return w?m:y})(E)}function b(E,y){if(!y&&E&&E.__esModule)return E;if(E===null||v(E)!="object"&&typeof E!="function")return{default:E};var m=_(y);if(m&&m.has(E))return m.get(E);var A={__proto__:null},w=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var B in E)if(B!=="default"&&Object.prototype.hasOwnProperty.call(E,B)){var k=w?Object.getOwnPropertyDescriptor(E,B):null;k&&(k.get||k.set)?Object.defineProperty(A,B,k):A[B]=E[B]}return A.default=E,m&&m.set(E,A),A}var C=35044,U=34962,ee=34963,R=34660,$=5120,J=5121,z=5122,q=5123,ie=5124,se=5125,De=5126,Se={attribPrefix:""};function st(E){Se.attribPrefix=E}function ot(E){g.copyExistingProperties(E,Se)}function He(E,y,m,A,w){E.bindBuffer(y,m),E.bufferData(y,A,w||C)}function ge(E,y,m,A){if(g.isBuffer(E,y))return y;m=m||U;var w=E.createBuffer();return He(E,m,w,y,A),w}function G(E){return E==="indices"}function V(E){return E===Int8Array||E===Uint8Array}function Z(E){return E.length?E:E.data}var D=/coord|texture/i,be=/color|colour/i;function we(E,y){var m;if(D.test(E)?m=2:be.test(E)?m=4:m=3,y%m>0)throw new Error("Can not guess numComponents for attribute '".concat(E,"'. Tried ").concat(m," but ").concat(y," values is not evenly divisible by ").concat(m,". You should specify it."));return m}function Me(E,y,m){return E.numComponents||E.size||we(y,m||Z(E).length)}function We(E,y){if(d.isArrayBuffer(E))return E;if(d.isArrayBuffer(E.data))return E.data;Array.isArray(E)&&(E={data:E});var m=E.type?rt(E.type):void 0;return m||(G(y)?m=Uint16Array:m=Float32Array),new m(E.data)}function je(E){return typeof E=="number"?E:E?d.getGLTypeForTypedArrayType(E):De}function rt(E){return typeof E=="number"?d.getTypedArrayTypeForGLType(E):E||Float32Array}function Qe(E,y){return{buffer:y.buffer,numValues:24,type:je(y.type),arrayType:rt(y.type)}}function mt(E,y){var m=y.data||y,A=rt(y.type),w=m*A.BYTES_PER_ELEMENT,B=E.createBuffer();return E.bindBuffer(U,B),E.bufferData(U,w,y.drawType||C),{buffer:B,numValues:m,type:d.getGLTypeForTypedArrayType(A),arrayType:A}}function Ft(E,y,m){var A=We(y,m);return{arrayType:A.constructor,buffer:ge(E,A,void 0,y.drawType),type:d.getGLTypeForTypedArray(A),numValues:0}}function yt(E,y){var m={};return Object.keys(y).forEach(function(A){if(!G(A)){var w=y[A],B=w.attrib||w.name||w.attribName||Se.attribPrefix+A;if(w.value){if(!Array.isArray(w.value)&&!d.isArrayBuffer(w.value))throw new Error("array.value is not array or typedarray");m[B]={value:w.value}}else{var k;w.buffer&&w.buffer instanceof WebGLBuffer?k=Qe:typeof w=="number"||typeof w.data=="number"?k=mt:k=Ft;var H=k(E,w,A),Y=H.buffer,ae=H.type,oe=H.numValues,ce=H.arrayType,me=w.normalize!==void 0?w.normalize:V(ce),fe=Me(w,A,oe);m[B]={buffer:Y,numComponents:fe,type:ae,normalize:me,stride:w.stride||0,offset:w.offset||0,divisor:w.divisor===void 0?void 0:w.divisor,drawType:w.drawType}}}}),E.bindBuffer(U,null),m}function lt(E,y,m,A){m=We(m),A!==void 0?(E.bindBuffer(U,y.buffer),E.bufferSubData(U,A,m)):He(E,U,y.buffer,m,y.drawType)}function vt(E,y){return y===$||y===J?1:y===z||y===q?2:y===ie||y===se||y===De?4:0}var Ct=["position","positions","a_position"];function de(E){var y,m;for(m=0;m<Ct.length&&(y=Ct[m],!(y in E));++m);m===Ct.length&&(y=Object.keys(E)[0]);var A=E[y],w=Z(A).length;if(w===void 0)return 1;var B=Me(A,y),k=w/B;if(w%B>0)throw new Error("numComponents ".concat(B," not correct for length ").concat(w));return k}function o(E,y){var m,A;for(A=0;A<Ct.length&&(m=Ct[A],!(m in y||(m=Se.attribPrefix+m,m in y)));++A);A===Ct.length&&(m=Object.keys(y)[0]);var w=y[m];if(!w.buffer)return 1;E.bindBuffer(U,w.buffer);var B=E.getBufferParameter(U,R);E.bindBuffer(U,null);var k=vt(E,w.type),H=B/k,Y=w.numComponents||w.size,ae=H/Y;if(ae%1!==0)throw new Error("numComponents ".concat(Y," not correct for length ").concat(length));return ae}function p(E,y,m){var A=yt(E,y),w=Object.assign({},m||{});w.attribs=Object.assign({},m?m.attribs:{},A);var B=y.indices;if(B){var k=We(B,"indices");w.indices=ge(E,k,ee),w.numElements=k.length,w.elementType=d.getGLTypeForTypedArray(k)}else w.numElements||(w.numElements=o(E,w.attribs));return w}function x(E,y,m){var A=m==="indices"?ee:U,w=We(y,m);return ge(E,w,A)}function I(E,y){var m={};return Object.keys(y).forEach(function(A){m[A]=x(E,y[A],A)}),y.indices?(m.numElements=y.indices.length,m.elementType=d.getGLTypeForTypedArray(We(y.indices),"indices")):m.numElements=de(y),m}},"./src/draw.js":(u,i,h)=>{function v(R){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $},v(R)}i.__esModule=!0,i.drawBufferInfo=U,i.drawObjectList=ee;var d=_(h("./src/programs.js"));function g(R){if(typeof WeakMap!="function")return null;var $=new WeakMap,J=new WeakMap;return(g=function(q){return q?J:$})(R)}function _(R,$){if(!$&&R&&R.__esModule)return R;if(R===null||v(R)!="object"&&typeof R!="function")return{default:R};var J=g($);if(J&&J.has(R))return J.get(R);var z={__proto__:null},q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ie in R)if(ie!=="default"&&Object.prototype.hasOwnProperty.call(R,ie)){var se=q?Object.getOwnPropertyDescriptor(R,ie):null;se&&(se.get||se.set)?Object.defineProperty(z,ie,se):z[ie]=R[ie]}return z.default=R,J&&J.set(R,z),z}var b=4,C=5123;function U(R,$,J,z,q,ie){J=J===void 0?b:J;var se=$.indices,De=$.elementType,Se=z===void 0?$.numElements:z;q=q===void 0?0:q,De||se?ie!==void 0?R.drawElementsInstanced(J,Se,De===void 0?C:$.elementType,q,ie):R.drawElements(J,Se,De===void 0?C:$.elementType,q):ie!==void 0?R.drawArraysInstanced(J,q,Se,ie):R.drawArrays(J,q,Se)}function ee(R,$){var J=null,z=null;$.forEach(function(q){if(q.active!==!1){var ie=q.programInfo,se=q.vertexArrayInfo||q.bufferInfo,De=!1,Se=q.type===void 0?b:q.type;ie!==J&&(J=ie,R.useProgram(ie.program),De=!0),(De||se!==z)&&(z&&z.vertexArrayObject&&!se.vertexArrayObject&&R.bindVertexArray(null),z=se,d.setBuffersAndAttributes(R,ie,se)),d.setUniforms(ie,q.uniforms),U(R,se,Se,q.count,q.offset,q.instanceCount)}}),z&&z.vertexArrayObject&&R.bindVertexArray(null)}},"./src/framebuffers.js":(u,i,h)=>{function v(de){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},v(de)}i.__esModule=!0,i.bindFramebufferInfo=Ct,i.createFramebufferInfo=lt,i.resizeFramebufferInfo=vt;var d=b(h("./src/textures.js")),g=b(h("./src/helper.js"));function _(de){if(typeof WeakMap!="function")return null;var o=new WeakMap,p=new WeakMap;return(_=function(I){return I?p:o})(de)}function b(de,o){if(!o&&de&&de.__esModule)return de;if(de===null||v(de)!="object"&&typeof de!="function")return{default:de};var p=_(o);if(p&&p.has(de))return p.get(de);var x={__proto__:null},I=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var E in de)if(E!=="default"&&Object.prototype.hasOwnProperty.call(de,E)){var y=I?Object.getOwnPropertyDescriptor(de,E):null;y&&(y.get||y.set)?Object.defineProperty(x,E,y):x[E]=de[E]}return x.default=de,p&&p.set(de,x),x}var C=36160,U=36161,ee=3553,R=5121,$=6402,J=6408,z=33190,q=36012,ie=35056,se=36013,De=32854,Se=32855,st=36194,ot=33189,He=6401,ge=36168,G=34041,V=36064,Z=36096,D=36128,be=33306,we=33071,Me=9729,We=[{format:J,type:R,min:Me,wrap:we},{format:G}],je={};je[G]=be,je[He]=D,je[ge]=D,je[$]=Z,je[ot]=Z,je[z]=Z,je[q]=Z,je[ie]=be,je[se]=be;function rt(de,o){return je[de]||je[o]}var Qe={};Qe[De]=!0,Qe[Se]=!0,Qe[st]=!0,Qe[G]=!0,Qe[ot]=!0,Qe[He]=!0,Qe[ge]=!0;function mt(de){return Qe[de]}var Ft=32;function yt(de){return de>=V&&de<V+Ft}function lt(de,o,p,x){var I=C,E=de.createFramebuffer();de.bindFramebuffer(I,E),p=p||de.drawingBufferWidth,x=x||de.drawingBufferHeight,o=o||We;var y=[],m={framebuffer:E,attachments:[],width:p,height:x};return o.forEach(function(A,w){var B=A.attachment,k=A.samples,H=A.format,Y=A.attachmentPoint||rt(H,A.internalFormat);if(Y||(Y=V+w),yt(Y)&&y.push(Y),!B)if(k!==void 0||mt(H))B=de.createRenderbuffer(),de.bindRenderbuffer(U,B),k>1?de.renderbufferStorageMultisample(U,k,H,p,x):de.renderbufferStorage(U,H,p,x);else{var ae=Object.assign({},A);ae.width=p,ae.height=x,ae.auto===void 0&&(ae.auto=!1,ae.min=ae.min||ae.minMag||Me,ae.mag=ae.mag||ae.minMag||Me,ae.wrapS=ae.wrapS||ae.wrap||we,ae.wrapT=ae.wrapT||ae.wrap||we),B=d.createTexture(de,ae)}if(g.isRenderbuffer(de,B))de.framebufferRenderbuffer(I,Y,U,B);else if(g.isTexture(de,B))A.layer!==void 0?de.framebufferTextureLayer(I,Y,B,A.level||0,A.layer):de.framebufferTexture2D(I,Y,A.target||ee,B,A.level||0);else throw new Error("unknown attachment type");m.attachments.push(B)}),de.drawBuffers&&de.drawBuffers(y),m}function vt(de,o,p,x,I){x=x||de.drawingBufferWidth,I=I||de.drawingBufferHeight,o.width=x,o.height=I,p=p||We,p.forEach(function(E,y){var m=o.attachments[y],A=E.format,w=E.samples;if(w!==void 0||g.isRenderbuffer(de,m))de.bindRenderbuffer(U,m),w>1?de.renderbufferStorageMultisample(U,w,A,x,I):de.renderbufferStorage(U,A,x,I);else if(g.isTexture(de,m))d.resizeTexture(de,m,E,x,I);else throw new Error("unknown attachment type")})}function Ct(de,o,p){p=p||C,o?(de.bindFramebuffer(p,o.framebuffer),de.viewport(0,0,o.width,o.height)):(de.bindFramebuffer(p,null),de.viewport(0,0,de.drawingBufferWidth,de.drawingBufferHeight))}},"./src/helper.js":(u,i)=>{i.__esModule=!0,i.copyExistingProperties=d,i.copyNamedProperties=v,i.error=g,i.isBuffer=U,i.isRenderbuffer=ee,i.isSampler=J,i.isShader=R,i.isTexture=$,i.warn=_;function h(z){"@babel/helpers - typeof";return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(q){return typeof q}:function(q){return q&&typeof Symbol=="function"&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q},h(z)}function v(z,q,ie){z.forEach(function(se){var De=q[se];De!==void 0&&(ie[se]=De)})}function d(z,q){Object.keys(q).forEach(function(ie){q.hasOwnProperty(ie)&&z.hasOwnProperty(ie)&&(q[ie]=z[ie])})}function g(){var z;(z=console).error.apply(z,arguments)}function _(){var z;(z=console).warn.apply(z,arguments)}var b=new Map;function C(z,q){if(!z||h(z)!=="object")return!1;var ie=b.get(q);ie||(ie=new WeakMap,b.set(q,ie));var se=ie.get(z);if(se===void 0){var De=Object.prototype.toString.call(z);se=De.substring(8,De.length-1)===q,ie.set(z,se)}return se}function U(z,q){return typeof WebGLBuffer<"u"&&C(q,"WebGLBuffer")}function ee(z,q){return typeof WebGLRenderbuffer<"u"&&C(q,"WebGLRenderbuffer")}function R(z,q){return typeof WebGLShader<"u"&&C(q,"WebGLShader")}function $(z,q){return typeof WebGLTexture<"u"&&C(q,"WebGLTexture")}function J(z,q){return typeof WebGLSampler<"u"&&C(q,"WebGLSampler")}},"./src/m4.js":(u,i,h)=>{function v(o){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},v(o)}i.__esModule=!0,i.axisRotate=Ft,i.axisRotation=mt,i.copy=R,i.create=ee,i.frustum=He,i.getAxis=De,i.getTranslation=se,i.identity=$,i.inverse=z,i.lookAt=Z,i.multiply=q,i.negate=U,i.ortho=ot,i.perspective=st,i.rotateX=Me,i.rotateY=je,i.rotateZ=Qe,i.rotationX=we,i.rotationY=We,i.rotationZ=rt,i.scale=lt,i.scaling=yt,i.setAxis=Se,i.setDefaultType=C,i.setTranslation=ie,i.transformDirection=Ct,i.transformNormal=de,i.transformPoint=vt,i.translate=be,i.translation=D,i.transpose=J;var d=_(h("./src/v3.js"));function g(o){if(typeof WeakMap!="function")return null;var p=new WeakMap,x=new WeakMap;return(g=function(E){return E?x:p})(o)}function _(o,p){if(!p&&o&&o.__esModule)return o;if(o===null||v(o)!="object"&&typeof o!="function")return{default:o};var x=g(p);if(x&&x.has(o))return x.get(o);var I={__proto__:null},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in o)if(y!=="default"&&Object.prototype.hasOwnProperty.call(o,y)){var m=E?Object.getOwnPropertyDescriptor(o,y):null;m&&(m.get||m.set)?Object.defineProperty(I,y,m):I[y]=o[y]}return I.default=o,x&&x.set(o,I),I}var b=Float32Array;function C(o){var p=b;return b=o,p}function U(o,p){return p=p||new b(16),p[0]=-o[0],p[1]=-o[1],p[2]=-o[2],p[3]=-o[3],p[4]=-o[4],p[5]=-o[5],p[6]=-o[6],p[7]=-o[7],p[8]=-o[8],p[9]=-o[9],p[10]=-o[10],p[11]=-o[11],p[12]=-o[12],p[13]=-o[13],p[14]=-o[14],p[15]=-o[15],p}function ee(){return new b(16).fill(0)}function R(o,p){return p=p||new b(16),p[0]=o[0],p[1]=o[1],p[2]=o[2],p[3]=o[3],p[4]=o[4],p[5]=o[5],p[6]=o[6],p[7]=o[7],p[8]=o[8],p[9]=o[9],p[10]=o[10],p[11]=o[11],p[12]=o[12],p[13]=o[13],p[14]=o[14],p[15]=o[15],p}function $(o){return o=o||new b(16),o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function J(o,p){if(p=p||new b(16),p===o){var x;return x=o[1],o[1]=o[4],o[4]=x,x=o[2],o[2]=o[8],o[8]=x,x=o[3],o[3]=o[12],o[12]=x,x=o[6],o[6]=o[9],o[9]=x,x=o[7],o[7]=o[13],o[13]=x,x=o[11],o[11]=o[14],o[14]=x,p}var I=o[0*4+0],E=o[0*4+1],y=o[0*4+2],m=o[0*4+3],A=o[1*4+0],w=o[1*4+1],B=o[1*4+2],k=o[1*4+3],H=o[2*4+0],Y=o[2*4+1],ae=o[2*4+2],oe=o[2*4+3],ce=o[3*4+0],me=o[3*4+1],fe=o[3*4+2],ve=o[3*4+3];return p[0]=I,p[1]=A,p[2]=H,p[3]=ce,p[4]=E,p[5]=w,p[6]=Y,p[7]=me,p[8]=y,p[9]=B,p[10]=ae,p[11]=fe,p[12]=m,p[13]=k,p[14]=oe,p[15]=ve,p}function z(o,p){p=p||new b(16);var x=o[0*4+0],I=o[0*4+1],E=o[0*4+2],y=o[0*4+3],m=o[1*4+0],A=o[1*4+1],w=o[1*4+2],B=o[1*4+3],k=o[2*4+0],H=o[2*4+1],Y=o[2*4+2],ae=o[2*4+3],oe=o[3*4+0],ce=o[3*4+1],me=o[3*4+2],fe=o[3*4+3],ve=Y*fe,xe=me*ae,le=w*fe,Ee=me*B,ze=w*ae,Ze=Y*B,Ve=E*fe,qe=me*y,Ce=E*ae,Ie=Y*y,tt=E*B,Ye=w*y,et=k*ce,Ke=oe*H,nt=m*ce,Be=oe*A,Ge=m*H,Tt=k*A,dt=x*ce,Rt=oe*I,It=x*H,Yt=k*I,Jt=x*A,er=m*I,vr=ve*A+Ee*H+ze*ce-(xe*A+le*H+Ze*ce),Hr=xe*I+Ve*H+Ie*ce-(ve*I+qe*H+Ce*ce),Yr=le*I+qe*A+tt*ce-(Ee*I+Ve*A+Ye*ce),Kr=Ze*I+Ce*A+Ye*H-(ze*I+Ie*A+tt*H),xt=1/(x*vr+m*Hr+k*Yr+oe*Kr);return p[0]=xt*vr,p[1]=xt*Hr,p[2]=xt*Yr,p[3]=xt*Kr,p[4]=xt*(xe*m+le*k+Ze*oe-(ve*m+Ee*k+ze*oe)),p[5]=xt*(ve*x+qe*k+Ce*oe-(xe*x+Ve*k+Ie*oe)),p[6]=xt*(Ee*x+Ve*m+Ye*oe-(le*x+qe*m+tt*oe)),p[7]=xt*(ze*x+Ie*m+tt*k-(Ze*x+Ce*m+Ye*k)),p[8]=xt*(et*B+Be*ae+Ge*fe-(Ke*B+nt*ae+Tt*fe)),p[9]=xt*(Ke*y+dt*ae+Yt*fe-(et*y+Rt*ae+It*fe)),p[10]=xt*(nt*y+Rt*B+Jt*fe-(Be*y+dt*B+er*fe)),p[11]=xt*(Tt*y+It*B+er*ae-(Ge*y+Yt*B+Jt*ae)),p[12]=xt*(nt*Y+Tt*me+Ke*w-(Ge*me+et*w+Be*Y)),p[13]=xt*(It*me+et*E+Rt*Y-(dt*Y+Yt*me+Ke*E)),p[14]=xt*(dt*w+er*me+Be*E-(Jt*me+nt*E+Rt*w)),p[15]=xt*(Jt*Y+Ge*E+Yt*w-(It*w+er*Y+Tt*E)),p}function q(o,p,x){x=x||new b(16);var I=o[0],E=o[1],y=o[2],m=o[3],A=o[4],w=o[5],B=o[6],k=o[7],H=o[8],Y=o[9],ae=o[10],oe=o[11],ce=o[12],me=o[13],fe=o[14],ve=o[15],xe=p[0],le=p[1],Ee=p[2],ze=p[3],Ze=p[4],Ve=p[5],qe=p[6],Ce=p[7],Ie=p[8],tt=p[9],Ye=p[10],et=p[11],Ke=p[12],nt=p[13],Be=p[14],Ge=p[15];return x[0]=I*xe+A*le+H*Ee+ce*ze,x[1]=E*xe+w*le+Y*Ee+me*ze,x[2]=y*xe+B*le+ae*Ee+fe*ze,x[3]=m*xe+k*le+oe*Ee+ve*ze,x[4]=I*Ze+A*Ve+H*qe+ce*Ce,x[5]=E*Ze+w*Ve+Y*qe+me*Ce,x[6]=y*Ze+B*Ve+ae*qe+fe*Ce,x[7]=m*Ze+k*Ve+oe*qe+ve*Ce,x[8]=I*Ie+A*tt+H*Ye+ce*et,x[9]=E*Ie+w*tt+Y*Ye+me*et,x[10]=y*Ie+B*tt+ae*Ye+fe*et,x[11]=m*Ie+k*tt+oe*Ye+ve*et,x[12]=I*Ke+A*nt+H*Be+ce*Ge,x[13]=E*Ke+w*nt+Y*Be+me*Ge,x[14]=y*Ke+B*nt+ae*Be+fe*Ge,x[15]=m*Ke+k*nt+oe*Be+ve*Ge,x}function ie(o,p,x){return x=x||$(),o!==x&&(x[0]=o[0],x[1]=o[1],x[2]=o[2],x[3]=o[3],x[4]=o[4],x[5]=o[5],x[6]=o[6],x[7]=o[7],x[8]=o[8],x[9]=o[9],x[10]=o[10],x[11]=o[11]),x[12]=p[0],x[13]=p[1],x[14]=p[2],x[15]=1,x}function se(o,p){return p=p||d.create(),p[0]=o[12],p[1]=o[13],p[2]=o[14],p}function De(o,p,x){x=x||d.create();var I=p*4;return x[0]=o[I+0],x[1]=o[I+1],x[2]=o[I+2],x}function Se(o,p,x,I){I!==o&&(I=R(o,I));var E=x*4;return I[E+0]=p[0],I[E+1]=p[1],I[E+2]=p[2],I}function st(o,p,x,I,E){E=E||new b(16);var y=Math.tan(Math.PI*.5-.5*o),m=1/(x-I);return E[0]=y/p,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=y,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=(x+I)*m,E[11]=-1,E[12]=0,E[13]=0,E[14]=x*I*m*2,E[15]=0,E}function ot(o,p,x,I,E,y,m){return m=m||new b(16),m[0]=2/(p-o),m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=2/(I-x),m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=2/(E-y),m[11]=0,m[12]=(p+o)/(o-p),m[13]=(I+x)/(x-I),m[14]=(y+E)/(E-y),m[15]=1,m}function He(o,p,x,I,E,y,m){m=m||new b(16);var A=p-o,w=I-x,B=E-y;return m[0]=2*E/A,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=2*E/w,m[6]=0,m[7]=0,m[8]=(o+p)/A,m[9]=(I+x)/w,m[10]=y/B,m[11]=-1,m[12]=0,m[13]=0,m[14]=E*y/B,m[15]=0,m}var ge,G,V;function Z(o,p,x,I){return I=I||new b(16),ge=ge||d.create(),G=G||d.create(),V=V||d.create(),d.normalize(d.subtract(o,p,V),V),d.normalize(d.cross(x,V,ge),ge),d.normalize(d.cross(V,ge,G),G),I[0]=ge[0],I[1]=ge[1],I[2]=ge[2],I[3]=0,I[4]=G[0],I[5]=G[1],I[6]=G[2],I[7]=0,I[8]=V[0],I[9]=V[1],I[10]=V[2],I[11]=0,I[12]=o[0],I[13]=o[1],I[14]=o[2],I[15]=1,I}function D(o,p){return p=p||new b(16),p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=o[0],p[13]=o[1],p[14]=o[2],p[15]=1,p}function be(o,p,x){x=x||new b(16);var I=p[0],E=p[1],y=p[2],m=o[0],A=o[1],w=o[2],B=o[3],k=o[1*4+0],H=o[1*4+1],Y=o[1*4+2],ae=o[1*4+3],oe=o[2*4+0],ce=o[2*4+1],me=o[2*4+2],fe=o[2*4+3],ve=o[3*4+0],xe=o[3*4+1],le=o[3*4+2],Ee=o[3*4+3];return o!==x&&(x[0]=m,x[1]=A,x[2]=w,x[3]=B,x[4]=k,x[5]=H,x[6]=Y,x[7]=ae,x[8]=oe,x[9]=ce,x[10]=me,x[11]=fe),x[12]=m*I+k*E+oe*y+ve,x[13]=A*I+H*E+ce*y+xe,x[14]=w*I+Y*E+me*y+le,x[15]=B*I+ae*E+fe*y+Ee,x}function we(o,p){p=p||new b(16);var x=Math.cos(o),I=Math.sin(o);return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=x,p[6]=I,p[7]=0,p[8]=0,p[9]=-I,p[10]=x,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}function Me(o,p,x){x=x||new b(16);var I=o[4],E=o[5],y=o[6],m=o[7],A=o[8],w=o[9],B=o[10],k=o[11],H=Math.cos(p),Y=Math.sin(p);return x[4]=H*I+Y*A,x[5]=H*E+Y*w,x[6]=H*y+Y*B,x[7]=H*m+Y*k,x[8]=H*A-Y*I,x[9]=H*w-Y*E,x[10]=H*B-Y*y,x[11]=H*k-Y*m,o!==x&&(x[0]=o[0],x[1]=o[1],x[2]=o[2],x[3]=o[3],x[12]=o[12],x[13]=o[13],x[14]=o[14],x[15]=o[15]),x}function We(o,p){p=p||new b(16);var x=Math.cos(o),I=Math.sin(o);return p[0]=x,p[1]=0,p[2]=-I,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=I,p[9]=0,p[10]=x,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}function je(o,p,x){x=x||new b(16);var I=o[0*4+0],E=o[0*4+1],y=o[0*4+2],m=o[0*4+3],A=o[2*4+0],w=o[2*4+1],B=o[2*4+2],k=o[2*4+3],H=Math.cos(p),Y=Math.sin(p);return x[0]=H*I-Y*A,x[1]=H*E-Y*w,x[2]=H*y-Y*B,x[3]=H*m-Y*k,x[8]=H*A+Y*I,x[9]=H*w+Y*E,x[10]=H*B+Y*y,x[11]=H*k+Y*m,o!==x&&(x[4]=o[4],x[5]=o[5],x[6]=o[6],x[7]=o[7],x[12]=o[12],x[13]=o[13],x[14]=o[14],x[15]=o[15]),x}function rt(o,p){p=p||new b(16);var x=Math.cos(o),I=Math.sin(o);return p[0]=x,p[1]=I,p[2]=0,p[3]=0,p[4]=-I,p[5]=x,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}function Qe(o,p,x){x=x||new b(16);var I=o[0*4+0],E=o[0*4+1],y=o[0*4+2],m=o[0*4+3],A=o[1*4+0],w=o[1*4+1],B=o[1*4+2],k=o[1*4+3],H=Math.cos(p),Y=Math.sin(p);return x[0]=H*I+Y*A,x[1]=H*E+Y*w,x[2]=H*y+Y*B,x[3]=H*m+Y*k,x[4]=H*A-Y*I,x[5]=H*w-Y*E,x[6]=H*B-Y*y,x[7]=H*k-Y*m,o!==x&&(x[8]=o[8],x[9]=o[9],x[10]=o[10],x[11]=o[11],x[12]=o[12],x[13]=o[13],x[14]=o[14],x[15]=o[15]),x}function mt(o,p,x){x=x||new b(16);var I=o[0],E=o[1],y=o[2],m=Math.sqrt(I*I+E*E+y*y);I/=m,E/=m,y/=m;var A=I*I,w=E*E,B=y*y,k=Math.cos(p),H=Math.sin(p),Y=1-k;return x[0]=A+(1-A)*k,x[1]=I*E*Y+y*H,x[2]=I*y*Y-E*H,x[3]=0,x[4]=I*E*Y-y*H,x[5]=w+(1-w)*k,x[6]=E*y*Y+I*H,x[7]=0,x[8]=I*y*Y+E*H,x[9]=E*y*Y-I*H,x[10]=B+(1-B)*k,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x}function Ft(o,p,x,I){I=I||new b(16);var E=p[0],y=p[1],m=p[2],A=Math.sqrt(E*E+y*y+m*m);E/=A,y/=A,m/=A;var w=E*E,B=y*y,k=m*m,H=Math.cos(x),Y=Math.sin(x),ae=1-H,oe=w+(1-w)*H,ce=E*y*ae+m*Y,me=E*m*ae-y*Y,fe=E*y*ae-m*Y,ve=B+(1-B)*H,xe=y*m*ae+E*Y,le=E*m*ae+y*Y,Ee=y*m*ae-E*Y,ze=k+(1-k)*H,Ze=o[0],Ve=o[1],qe=o[2],Ce=o[3],Ie=o[4],tt=o[5],Ye=o[6],et=o[7],Ke=o[8],nt=o[9],Be=o[10],Ge=o[11];return I[0]=oe*Ze+ce*Ie+me*Ke,I[1]=oe*Ve+ce*tt+me*nt,I[2]=oe*qe+ce*Ye+me*Be,I[3]=oe*Ce+ce*et+me*Ge,I[4]=fe*Ze+ve*Ie+xe*Ke,I[5]=fe*Ve+ve*tt+xe*nt,I[6]=fe*qe+ve*Ye+xe*Be,I[7]=fe*Ce+ve*et+xe*Ge,I[8]=le*Ze+Ee*Ie+ze*Ke,I[9]=le*Ve+Ee*tt+ze*nt,I[10]=le*qe+Ee*Ye+ze*Be,I[11]=le*Ce+Ee*et+ze*Ge,o!==I&&(I[12]=o[12],I[13]=o[13],I[14]=o[14],I[15]=o[15]),I}function yt(o,p){return p=p||new b(16),p[0]=o[0],p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=o[1],p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=o[2],p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}function lt(o,p,x){x=x||new b(16);var I=p[0],E=p[1],y=p[2];return x[0]=I*o[0],x[1]=I*o[1],x[2]=I*o[2],x[3]=I*o[3],x[4]=E*o[4],x[5]=E*o[5],x[6]=E*o[6],x[7]=E*o[7],x[8]=y*o[8],x[9]=y*o[9],x[10]=y*o[10],x[11]=y*o[11],o!==x&&(x[12]=o[12],x[13]=o[13],x[14]=o[14],x[15]=o[15]),x}function vt(o,p,x){x=x||d.create();var I=p[0],E=p[1],y=p[2],m=I*o[0*4+3]+E*o[1*4+3]+y*o[2*4+3]+o[3*4+3];return x[0]=(I*o[0]+E*o[4]+y*o[8]+o[12])/m,x[1]=(I*o[1]+E*o[5]+y*o[9]+o[13])/m,x[2]=(I*o[2]+E*o[6]+y*o[10]+o[14])/m,x}function Ct(o,p,x){x=x||d.create();var I=p[0],E=p[1],y=p[2];return x[0]=I*o[0]+E*o[4]+y*o[8],x[1]=I*o[1]+E*o[5]+y*o[9],x[2]=I*o[2]+E*o[6]+y*o[10],x}function de(o,p,x){x=x||d.create();var I=z(o),E=p[0],y=p[1],m=p[2];return x[0]=E*I[0]+y*I[1]+m*I[2],x[1]=E*I[4]+y*I[5]+m*I[6],x[2]=E*I[8]+y*I[9]+m*I[10],x}},"./src/primitives.js":(u,i,h)=>{function v(y){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},v(y)}i.__esModule=!0,i.concatVertices=p,i.create3DFBuffers=i.create3DFBufferInfo=void 0,i.create3DFVertices=We,i.createAugmentedTypedArray=z,i.createCrescentBuffers=i.createCrescentBufferInfo=void 0,i.createCrescentVertices=je,i.createCubeBuffers=i.createCubeBufferInfo=i.createCresentVertices=i.createCresentBuffers=i.createCresentBufferInfo=void 0,i.createCubeVertices=be,i.createCylinderBuffers=i.createCylinderBufferInfo=void 0,i.createCylinderVertices=rt,i.createDiscBuffers=i.createDiscBufferInfo=void 0,i.createDiscVertices=mt,i.createPlaneBuffers=i.createPlaneBufferInfo=void 0,i.createPlaneVertices=V,i.createSphereBuffers=i.createSphereBufferInfo=void 0,i.createSphereVertices=Z,i.createTorusBuffers=i.createTorusBufferInfo=void 0,i.createTorusVertices=Qe,i.createTruncatedConeBuffers=i.createTruncatedConeBufferInfo=void 0,i.createTruncatedConeVertices=we,i.createXYQuadBuffers=i.createXYQuadBufferInfo=void 0,i.createXYQuadVertices=G,i.deindexVertices=ie,i.duplicateVertices=x,i.flattenNormals=se,i.makeRandomVertexColors=yt,i.reorientDirections=st,i.reorientNormals=ot,i.reorientPositions=He,i.reorientVertices=ge;var d=ee(h("./src/attributes.js")),g=ee(h("./src/helper.js")),_=ee(h("./src/typedarrays.js")),b=ee(h("./src/m4.js")),C=ee(h("./src/v3.js"));function U(y){if(typeof WeakMap!="function")return null;var m=new WeakMap,A=new WeakMap;return(U=function(B){return B?A:m})(y)}function ee(y,m){if(!m&&y&&y.__esModule)return y;if(y===null||v(y)!="object"&&typeof y!="function")return{default:y};var A=U(m);if(A&&A.has(y))return A.get(y);var w={__proto__:null},B=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var k in y)if(k!=="default"&&Object.prototype.hasOwnProperty.call(y,k)){var H=B?Object.getOwnPropertyDescriptor(y,k):null;H&&(H.get||H.set)?Object.defineProperty(w,k,H):w[k]=y[k]}return w.default=y,A&&A.set(y,w),w}var R=d.getArray_,$=d.getNumComponents_;function J(y,m){var A=0;return y.push=function(){for(var w=0;w<arguments.length;++w){var B=arguments[w];if(B instanceof Array||_.isArrayBuffer(B))for(var k=0;k<B.length;++k)y[A++]=B[k];else y[A++]=B}},y.reset=function(w){A=w||0},y.numComponents=m,Object.defineProperty(y,"numElements",{get:function(){return this.length/this.numComponents|0}}),y}function z(y,m,A){var w=A||Float32Array;return J(new w(y*m),y)}function q(y){return y!=="indices"}function ie(y){var m=y.indices,A={},w=m.length;function B(k){for(var H=y[k],Y=H.numComponents,ae=z(Y,w,H.constructor),oe=0;oe<w;++oe)for(var ce=m[oe],me=ce*Y,fe=0;fe<Y;++fe)ae.push(H[me+fe]);A[k]=ae}return Object.keys(y).filter(q).forEach(B),A}function se(y){if(y.indices)throw new Error("can not flatten normals of indexed vertices. deindex them first");for(var m=y.normal,A=m.length,w=0;w<A;w+=9){var B=m[w+0],k=m[w+1],H=m[w+2],Y=m[w+3],ae=m[w+4],oe=m[w+5],ce=m[w+6],me=m[w+7],fe=m[w+8],ve=B+Y+ce,xe=k+ae+me,le=H+oe+fe,Ee=Math.sqrt(ve*ve+xe*xe+le*le);ve/=Ee,xe/=Ee,le/=Ee,m[w+0]=ve,m[w+1]=xe,m[w+2]=le,m[w+3]=ve,m[w+4]=xe,m[w+5]=le,m[w+6]=ve,m[w+7]=xe,m[w+8]=le}return y}function De(y,m,A){for(var w=y.length,B=new Float32Array(3),k=0;k<w;k+=3)A(m,[y[k],y[k+1],y[k+2]],B),y[k]=B[0],y[k+1]=B[1],y[k+2]=B[2]}function Se(y,m,A){A=A||C.create();var w=m[0],B=m[1],k=m[2];return A[0]=w*y[0]+B*y[1]+k*y[2],A[1]=w*y[4]+B*y[5]+k*y[6],A[2]=w*y[8]+B*y[9]+k*y[10],A}function st(y,m){return De(y,m,b.transformDirection),y}function ot(y,m){return De(y,b.inverse(m),Se),y}function He(y,m){return De(y,m,b.transformPoint),y}function ge(y,m){return Object.keys(y).forEach(function(A){var w=y[A];A.indexOf("pos")>=0?He(w,m):A.indexOf("tan")>=0||A.indexOf("binorm")>=0?st(w,m):A.indexOf("norm")>=0&&ot(w,m)}),y}function G(y,m,A){return y=y||2,m=m||0,A=A||0,y*=.5,{position:{numComponents:2,data:[m+-1*y,A+-1*y,m+1*y,A+-1*y,m+-1*y,A+1*y,m+1*y,A+1*y]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function V(y,m,A,w,B){y=y||1,m=m||1,A=A||1,w=w||1,B=B||b.identity();for(var k=(A+1)*(w+1),H=z(3,k),Y=z(3,k),ae=z(2,k),oe=0;oe<=w;oe++)for(var ce=0;ce<=A;ce++){var me=ce/A,fe=oe/w;H.push(y*me-y*.5,0,m*fe-m*.5),Y.push(0,1,0),ae.push(me,fe)}for(var ve=A+1,xe=z(3,A*w*2,Uint16Array),le=0;le<w;le++)for(var Ee=0;Ee<A;Ee++)xe.push((le+0)*ve+Ee,(le+1)*ve+Ee,(le+0)*ve+Ee+1),xe.push((le+1)*ve+Ee,(le+1)*ve+Ee+1,(le+0)*ve+Ee+1);var ze=ge({position:H,normal:Y,texcoord:ae,indices:xe},B);return ze}function Z(y,m,A,w,B,k,H){if(m<=0||A<=0)throw new Error("subdivisionAxis and subdivisionHeight must be > 0");w=w||0,B=B||Math.PI,k=k||0,H=H||Math.PI*2;for(var Y=B-w,ae=H-k,oe=(m+1)*(A+1),ce=z(3,oe),me=z(3,oe),fe=z(2,oe),ve=0;ve<=A;ve++)for(var xe=0;xe<=m;xe++){var le=xe/m,Ee=ve/A,ze=ae*le+k,Ze=Y*Ee+w,Ve=Math.sin(ze),qe=Math.cos(ze),Ce=Math.sin(Ze),Ie=Math.cos(Ze),tt=qe*Ce,Ye=Ie,et=Ve*Ce;ce.push(y*tt,y*Ye,y*et),me.push(tt,Ye,et),fe.push(1-le,Ee)}for(var Ke=m+1,nt=z(3,m*A*2,Uint16Array),Be=0;Be<m;Be++)for(var Ge=0;Ge<A;Ge++)nt.push((Ge+0)*Ke+Be,(Ge+0)*Ke+Be+1,(Ge+1)*Ke+Be),nt.push((Ge+1)*Ke+Be,(Ge+0)*Ke+Be+1,(Ge+1)*Ke+Be+1);return{position:ce,normal:me,texcoord:fe,indices:nt}}var D=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function be(y){y=y||1;for(var m=y/2,A=[[-m,-m,-m],[+m,-m,-m],[-m,+m,-m],[+m,+m,-m],[-m,-m,+m],[+m,-m,+m],[-m,+m,+m],[+m,+m,+m]],w=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],B=[[1,0],[0,0],[0,1],[1,1]],k=6*4,H=z(3,k),Y=z(3,k),ae=z(2,k),oe=z(3,6*2,Uint16Array),ce=0;ce<6;++ce){for(var me=D[ce],fe=0;fe<4;++fe){var ve=A[me[fe]],xe=w[ce],le=B[fe];H.push(ve),Y.push(xe),ae.push(le)}var Ee=4*ce;oe.push(Ee+0,Ee+1,Ee+2),oe.push(Ee+0,Ee+2,Ee+3)}return{position:H,normal:Y,texcoord:ae,indices:oe}}function we(y,m,A,w,B,k,H){if(w<3)throw new Error("radialSubdivisions must be 3 or greater");if(B<1)throw new Error("verticalSubdivisions must be 1 or greater");for(var Y=k===void 0?!0:k,ae=H===void 0?!0:H,oe=(Y?2:0)+(ae?2:0),ce=(w+1)*(B+1+oe),me=z(3,ce),fe=z(3,ce),ve=z(2,ce),xe=z(3,w*(B+oe/2)*2,Uint16Array),le=w+1,Ee=Math.atan2(y-m,A),ze=Math.cos(Ee),Ze=Math.sin(Ee),Ve=Y?-2:0,qe=B+(ae?2:0),Ce=Ve;Ce<=qe;++Ce){var Ie=Ce/B,tt=A*Ie,Ye=void 0;Ce<0?(tt=0,Ie=1,Ye=y):Ce>B?(tt=A,Ie=1,Ye=m):Ye=y+(m-y)*(Ce/B),(Ce===-2||Ce===B+2)&&(Ye=0,Ie=0),tt-=A/2;for(var et=0;et<le;++et){var Ke=Math.sin(et*Math.PI*2/w),nt=Math.cos(et*Math.PI*2/w);me.push(Ke*Ye,tt,nt*Ye),Ce<0?fe.push(0,-1,0):Ce>B?fe.push(0,1,0):Ye===0?fe.push(0,0,0):fe.push(Ke*ze,Ze,nt*ze),ve.push(et/w,1-Ie)}}for(var Be=0;Be<B+oe;++Be)if(!(Be===1&&Y||Be===B+oe-2&&ae))for(var Ge=0;Ge<w;++Ge)xe.push(le*(Be+0)+0+Ge,le*(Be+0)+1+Ge,le*(Be+1)+1+Ge),xe.push(le*(Be+0)+0+Ge,le*(Be+1)+1+Ge,le*(Be+1)+0+Ge);return{position:me,normal:fe,texcoord:ve,indices:xe}}function Me(y,m){m=m||[];for(var A=[],w=0;w<y.length;w+=4){var B=y[w],k=y.slice(w+1,w+4);k.push.apply(k,m);for(var H=0;H<B;++H)A.push.apply(A,k)}return A}function We(){var y=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],m=[.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0],A=Me([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),w=Me([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),B=y.length/3,k={position:z(3,B),texcoord:z(2,B),normal:z(3,B),color:z(4,B,Uint8Array),indices:z(3,B/3,Uint16Array)};k.position.push(y),k.texcoord.push(m),k.normal.push(A),k.color.push(w);for(var H=0;H<B;++H)k.indices.push(H);return k}function je(y,m,A,w,B,k,H){if(B<=0)throw new Error("subdivisionDown must be > 0");k=k||0,H=H||1;var Y=2,ae=H-k,oe=(B+1)*2*(2+Y),ce=z(3,oe),me=z(3,oe),fe=z(2,oe);function ve(qe,Ce,Ie){return qe+(Ce-qe)*Ie}function xe(qe,Ce,Ie,tt,Ye,et){for(var Ke=0;Ke<=B;Ke++){var nt=Ce/(Y-1),Be=Ke/B,Ge=(nt-.5)*2,Tt=(k+Be*ae)*Math.PI,dt=Math.sin(Tt),Rt=Math.cos(Tt),It=ve(y,qe,dt),Yt=Ge*w,Jt=Rt*y,er=dt*It;ce.push(Yt,Jt,er);var vr=C.add(C.multiply([0,dt,Rt],Ie),tt);me.push(vr),fe.push(nt*Ye+et,Be)}}for(var le=0;le<Y;le++){var Ee=(le/(Y-1)-.5)*2;xe(m,le,[1,1,1],[0,0,0],1,0),xe(m,le,[0,0,0],[Ee,0,0],0,0),xe(A,le,[1,1,1],[0,0,0],1,0),xe(A,le,[0,0,0],[Ee,0,0],0,1)}var ze=z(3,B*2*(2+Y),Uint16Array);function Ze(qe,Ce){for(var Ie=0;Ie<B;++Ie)ze.push(qe+Ie+0,qe+Ie+1,Ce+Ie+0),ze.push(qe+Ie+1,Ce+Ie+1,Ce+Ie+0)}var Ve=B+1;return Ze(Ve*0,Ve*4),Ze(Ve*5,Ve*7),Ze(Ve*6,Ve*2),Ze(Ve*3,Ve*1),{position:ce,normal:me,texcoord:fe,indices:ze}}function rt(y,m,A,w,B,k){return we(y,y,m,A,w,B,k)}function Qe(y,m,A,w,B,k){if(A<3)throw new Error("radialSubdivisions must be 3 or greater");if(w<3)throw new Error("verticalSubdivisions must be 3 or greater");B=B||0,k=k||Math.PI*2;for(var H=k-B,Y=A+1,ae=w+1,oe=Y*ae,ce=z(3,oe),me=z(3,oe),fe=z(2,oe),ve=z(3,A*w*2,Uint16Array),xe=0;xe<ae;++xe)for(var le=xe/w,Ee=le*Math.PI*2,ze=Math.sin(Ee),Ze=y+ze*m,Ve=Math.cos(Ee),qe=Ve*m,Ce=0;Ce<Y;++Ce){var Ie=Ce/A,tt=B+Ie*H,Ye=Math.sin(tt),et=Math.cos(tt),Ke=Ye*Ze,nt=et*Ze,Be=Ye*ze,Ge=et*ze;ce.push(Ke,qe,nt),me.push(Be,Ve,Ge),fe.push(Ie,1-le)}for(var Tt=0;Tt<w;++Tt)for(var dt=0;dt<A;++dt){var Rt=1+dt,It=1+Tt;ve.push(Y*Tt+dt,Y*It+dt,Y*Tt+Rt),ve.push(Y*It+dt,Y*It+Rt,Y*Tt+Rt)}return{position:ce,normal:me,texcoord:fe,indices:ve}}function mt(y,m,A,w,B){if(m<3)throw new Error("divisions must be at least 3");A=A||1,B=B||1,w=w||0;for(var k=(m+1)*(A+1),H=z(3,k),Y=z(3,k),ae=z(2,k),oe=z(3,A*m*2,Uint16Array),ce=0,me=y-w,fe=m+1,ve=0;ve<=A;++ve){for(var xe=w+me*Math.pow(ve/A,B),le=0;le<=m;++le){var Ee=2*Math.PI*le/m,ze=xe*Math.cos(Ee),Ze=xe*Math.sin(Ee);if(H.push(ze,0,Ze),Y.push(0,1,0),ae.push(1-le/m,ve/A),ve>0&&le!==m){var Ve=ce+(le+1),qe=ce+le,Ce=ce+le-fe,Ie=ce+(le+1)-fe;oe.push(Ve,qe,Ce),oe.push(Ve,Ce,Ie)}}ce+=m+1}return{position:H,normal:Y,texcoord:ae,indices:oe}}function Ft(y){return Math.random()*y|0}function yt(y,m){m=m||{};var A=y.position.numElements,w=z(4,A,Uint8Array),B=m.rand||function(me,fe){return fe<3?Ft(256):255};if(y.color=w,y.indices)for(var k=0;k<A;++k)w.push(B(k,0),B(k,1),B(k,2),B(k,3));else for(var H=m.vertsPerColor||3,Y=A/H,ae=0;ae<Y;++ae)for(var oe=[B(ae,0),B(ae,1),B(ae,2),B(ae,3)],ce=0;ce<H;++ce)w.push(oe);return y}function lt(y){return function(m){var A=y.apply(this,Array.prototype.slice.call(arguments,1));return d.createBuffersFromArrays(m,A)}}function vt(y){return function(m){var A=y.apply(null,Array.prototype.slice.call(arguments,1));return d.createBufferInfoFromArrays(m,A)}}var Ct=["numComponents","size","type","normalize","stride","offset","attrib","name","attribName"];function de(y,m,A,w){w=w||0;for(var B=y.length,k=0;k<B;++k)m[A+k]=y[k]+w}function o(y,m){var A=R(y),w=new A.constructor(m),B=w;return A.numComponents&&A.numElements&&J(w,A.numComponents),y.data&&(B={data:w},g.copyNamedProperties(Ct,y,B)),B}function p(y){for(var m={},A,w=function(){var ce=y[B];Object.keys(ce).forEach(function(me){m[me]||(m[me]=[]),!A&&me!=="indices"&&(A=me);var fe=ce[me],ve=$(fe,me),xe=R(fe),le=xe.length/ve;m[me].push(le)})},B=0;B<y.length;++B)w();function k(oe){for(var ce=0,me,fe=0;fe<y.length;++fe){var ve=y[fe],xe=ve[oe],le=R(xe);ce+=le.length,(!me||xe.data)&&(me=xe)}return{length:ce,spec:me}}function H(oe,ce,me){for(var fe=0,ve=0,xe=0;xe<y.length;++xe){var le=y[xe],Ee=le[oe],ze=R(Ee);oe==="indices"?(de(ze,me,ve,fe),fe+=ce[xe]):de(ze,me,ve),ve+=ze.length}}var Y=m[A],ae={};return Object.keys(m).forEach(function(oe){var ce=k(oe),me=o(ce.spec,ce.length);H(oe,Y,R(me)),ae[oe]=me}),ae}function x(y){var m={};return Object.keys(y).forEach(function(A){var w=y[A],B=R(w),k=o(w,B.length);de(B,R(k),0),m[A]=k}),m}i.create3DFBufferInfo=vt(We),i.create3DFBuffers=lt(We),i.createCubeBufferInfo=vt(be),i.createCubeBuffers=lt(be),i.createPlaneBufferInfo=vt(V),i.createPlaneBuffers=lt(V),i.createSphereBufferInfo=vt(Z),i.createSphereBuffers=lt(Z),i.createTruncatedConeBufferInfo=vt(we),i.createTruncatedConeBuffers=lt(we),i.createXYQuadBufferInfo=vt(G),i.createXYQuadBuffers=lt(G);var I=i.createCrescentBufferInfo=vt(je),E=i.createCrescentBuffers=lt(je);i.createCylinderBufferInfo=vt(rt),i.createCylinderBuffers=lt(rt),i.createTorusBufferInfo=vt(Qe),i.createTorusBuffers=lt(Qe),i.createDiscBufferInfo=vt(mt),i.createDiscBuffers=lt(mt),i.createCresentBufferInfo=I,i.createCresentBuffers=E,i.createCresentVertices=je},"./src/programs.js":(u,i,h)=>{function v(s){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(l){return typeof l}:function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},v(s)}i.__esModule=!0,i.bindTransformFeedbackInfo=on,i.bindUniformBlock=un,i.createAttributeSetters=On,i.createProgram=Br,i.createProgramAsync=void 0,i.createProgramFromScripts=Pn,i.createProgramFromSources=Nn,i.createProgramInfo=T,i.createProgramInfoAsync=void 0,i.createProgramInfoFromProgram=hn,i.createProgramInfos=O,i.createProgramInfosAsync=void 0,i.createPrograms=M,i.createProgramsAsync=void 0,i.createTransformFeedback=In,i.createTransformFeedbackInfo=sn,i.createUniformBlockInfo=Ln,i.createUniformBlockInfoFromProgram=Bn,i.createUniformBlockSpecFromProgram=lr,i.createUniformSetters=br,i.setAttributes=zn,i.setBlockUniforms=na,i.setBuffersAndAttributes=ia,i.setUniformBlock=vi,i.setUniforms=cn,i.setUniformsAndBindTextures=void 0;var d=b(h("./src/utils.js")),g=b(h("./src/helper.js"));function _(s){if(typeof WeakMap!="function")return null;var l=new WeakMap,f=new WeakMap;return(_=function(P){return P?f:l})(s)}function b(s,l){if(!l&&s&&s.__esModule)return s;if(s===null||v(s)!="object"&&typeof s!="function")return{default:s};var f=_(l);if(f&&f.has(s))return f.get(s);var F={__proto__:null},P=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var L in s)if(L!=="default"&&Object.prototype.hasOwnProperty.call(s,L)){var j=P?Object.getOwnPropertyDescriptor(s,L):null;j&&(j.get||j.set)?Object.defineProperty(F,L,j):F[L]=s[L]}return F.default=s,f&&f.set(s,F),F}function C(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */C=function(){return l};var s,l={},f=Object.prototype,F=f.hasOwnProperty,P=Object.defineProperty||function(pe,ne,ue){pe[ne]=ue.value},L=typeof Symbol=="function"?Symbol:{},j=L.iterator||"@@iterator",W=L.asyncIterator||"@@asyncIterator",K=L.toStringTag||"@@toStringTag";function X(pe,ne,ue){return Object.defineProperty(pe,ne,{value:ue,enumerable:!0,configurable:!0,writable:!0}),pe[ne]}try{X({},"")}catch{X=function(ue,Fe,Oe){return ue[Fe]=Oe}}function te(pe,ne,ue,Fe){var Oe=ne&&ne.prototype instanceof Xe?ne:Xe,Pe=Object.create(Oe.prototype),pt=new oa(Fe||[]);return P(Pe,"_invoke",{value:ro(pe,ue,pt)}),Pe}function ye(pe,ne,ue){try{return{type:"normal",arg:pe.call(ne,ue)}}catch(Fe){return{type:"throw",arg:Fe}}}l.wrap=te;var Te="suspendedStart",_e="suspendedYield",Ne="executing",Ue="completed",Le={};function Xe(){}function Je(){}function ft(){}var bt={};X(bt,j,function(){return this});var Bt=Object.getPrototypeOf,Kt=Bt&&Bt(Bt(ua([])));Kt&&Kt!==f&&F.call(Kt,j)&&(bt=Kt);var nr=ft.prototype=Xe.prototype=Object.create(bt);function gi(pe){["next","throw","return"].forEach(function(ne){X(pe,ne,function(ue){return this._invoke(ne,ue)})})}function bi(pe,ne){function ue(Oe,Pe,pt,Lt){var Ut=ye(pe[Oe],pe,Pe);if(Ut.type!=="throw"){var Or=Ut.arg,Tr=Or.value;return Tr&&v(Tr)=="object"&&F.call(Tr,"__await")?ne.resolve(Tr.__await).then(function(zr){ue("next",zr,pt,Lt)},function(zr){ue("throw",zr,pt,Lt)}):ne.resolve(Tr).then(function(zr){Or.value=zr,pt(Or)},function(zr){return ue("throw",zr,pt,Lt)})}Lt(Ut.arg)}var Fe;P(this,"_invoke",{value:function(Pe,pt){function Lt(){return new ne(function(Ut,Or){ue(Pe,pt,Ut,Or)})}return Fe=Fe?Fe.then(Lt,Lt):Lt()}})}function ro(pe,ne,ue){var Fe=Te;return function(Oe,Pe){if(Fe===Ne)throw new Error("Generator is already running");if(Fe===Ue){if(Oe==="throw")throw Pe;return{value:s,done:!0}}for(ue.method=Oe,ue.arg=Pe;;){var pt=ue.delegate;if(pt){var Lt=Qa(pt,ue);if(Lt){if(Lt===Le)continue;return Lt}}if(ue.method==="next")ue.sent=ue._sent=ue.arg;else if(ue.method==="throw"){if(Fe===Te)throw Fe=Ue,ue.arg;ue.dispatchException(ue.arg)}else ue.method==="return"&&ue.abrupt("return",ue.arg);Fe=Ne;var Ut=ye(pe,ne,ue);if(Ut.type==="normal"){if(Fe=ue.done?Ue:_e,Ut.arg===Le)continue;return{value:Ut.arg,done:ue.done}}Ut.type==="throw"&&(Fe=Ue,ue.method="throw",ue.arg=Ut.arg)}}}function Qa(pe,ne){var ue=ne.method,Fe=pe.iterator[ue];if(Fe===s)return ne.delegate=null,ue==="throw"&&pe.iterator.return&&(ne.method="return",ne.arg=s,Qa(pe,ne),ne.method==="throw")||ue!=="return"&&(ne.method="throw",ne.arg=new TypeError("The iterator does not provide a '"+ue+"' method")),Le;var Oe=ye(Fe,pe.iterator,ne.arg);if(Oe.type==="throw")return ne.method="throw",ne.arg=Oe.arg,ne.delegate=null,Le;var Pe=Oe.arg;return Pe?Pe.done?(ne[pe.resultName]=Pe.value,ne.next=pe.nextLoc,ne.method!=="return"&&(ne.method="next",ne.arg=s),ne.delegate=null,Le):Pe:(ne.method="throw",ne.arg=new TypeError("iterator result is not an object"),ne.delegate=null,Le)}function no(pe){var ne={tryLoc:pe[0]};1 in pe&&(ne.catchLoc=pe[1]),2 in pe&&(ne.finallyLoc=pe[2],ne.afterLoc=pe[3]),this.tryEntries.push(ne)}function sa(pe){var ne=pe.completion||{};ne.type="normal",delete ne.arg,pe.completion=ne}function oa(pe){this.tryEntries=[{tryLoc:"root"}],pe.forEach(no,this),this.reset(!0)}function ua(pe){if(pe||pe===""){var ne=pe[j];if(ne)return ne.call(pe);if(typeof pe.next=="function")return pe;if(!isNaN(pe.length)){var ue=-1,Fe=function Oe(){for(;++ue<pe.length;)if(F.call(pe,ue))return Oe.value=pe[ue],Oe.done=!1,Oe;return Oe.value=s,Oe.done=!0,Oe};return Fe.next=Fe}}throw new TypeError(v(pe)+" is not iterable")}return Je.prototype=ft,P(nr,"constructor",{value:ft,configurable:!0}),P(ft,"constructor",{value:Je,configurable:!0}),Je.displayName=X(ft,K,"GeneratorFunction"),l.isGeneratorFunction=function(pe){var ne=typeof pe=="function"&&pe.constructor;return!!ne&&(ne===Je||(ne.displayName||ne.name)==="GeneratorFunction")},l.mark=function(pe){return Object.setPrototypeOf?Object.setPrototypeOf(pe,ft):(pe.__proto__=ft,X(pe,K,"GeneratorFunction")),pe.prototype=Object.create(nr),pe},l.awrap=function(pe){return{__await:pe}},gi(bi.prototype),X(bi.prototype,W,function(){return this}),l.AsyncIterator=bi,l.async=function(pe,ne,ue,Fe,Oe){Oe===void 0&&(Oe=Promise);var Pe=new bi(te(pe,ne,ue,Fe),Oe);return l.isGeneratorFunction(ne)?Pe:Pe.next().then(function(pt){return pt.done?pt.value:Pe.next()})},gi(nr),X(nr,K,"Generator"),X(nr,j,function(){return this}),X(nr,"toString",function(){return"[object Generator]"}),l.keys=function(pe){var ne=Object(pe),ue=[];for(var Fe in ne)ue.push(Fe);return ue.reverse(),function Oe(){for(;ue.length;){var Pe=ue.pop();if(Pe in ne)return Oe.value=Pe,Oe.done=!1,Oe}return Oe.done=!0,Oe}},l.values=ua,oa.prototype={constructor:oa,reset:function(ne){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(sa),!ne)for(var ue in this)ue.charAt(0)==="t"&&F.call(this,ue)&&!isNaN(+ue.slice(1))&&(this[ue]=s)},stop:function(){this.done=!0;var ne=this.tryEntries[0].completion;if(ne.type==="throw")throw ne.arg;return this.rval},dispatchException:function(ne){if(this.done)throw ne;var ue=this;function Fe(Or,Tr){return pt.type="throw",pt.arg=ne,ue.next=Or,Tr&&(ue.method="next",ue.arg=s),!!Tr}for(var Oe=this.tryEntries.length-1;Oe>=0;--Oe){var Pe=this.tryEntries[Oe],pt=Pe.completion;if(Pe.tryLoc==="root")return Fe("end");if(Pe.tryLoc<=this.prev){var Lt=F.call(Pe,"catchLoc"),Ut=F.call(Pe,"finallyLoc");if(Lt&&Ut){if(this.prev<Pe.catchLoc)return Fe(Pe.catchLoc,!0);if(this.prev<Pe.finallyLoc)return Fe(Pe.finallyLoc)}else if(Lt){if(this.prev<Pe.catchLoc)return Fe(Pe.catchLoc,!0)}else{if(!Ut)throw new Error("try statement without catch or finally");if(this.prev<Pe.finallyLoc)return Fe(Pe.finallyLoc)}}}},abrupt:function(ne,ue){for(var Fe=this.tryEntries.length-1;Fe>=0;--Fe){var Oe=this.tryEntries[Fe];if(Oe.tryLoc<=this.prev&&F.call(Oe,"finallyLoc")&&this.prev<Oe.finallyLoc){var Pe=Oe;break}}Pe&&(ne==="break"||ne==="continue")&&Pe.tryLoc<=ue&&ue<=Pe.finallyLoc&&(Pe=null);var pt=Pe?Pe.completion:{};return pt.type=ne,pt.arg=ue,Pe?(this.method="next",this.next=Pe.finallyLoc,Le):this.complete(pt)},complete:function(ne,ue){if(ne.type==="throw")throw ne.arg;return ne.type==="break"||ne.type==="continue"?this.next=ne.arg:ne.type==="return"?(this.rval=this.arg=ne.arg,this.method="return",this.next="end"):ne.type==="normal"&&ue&&(this.next=ue),Le},finish:function(ne){for(var ue=this.tryEntries.length-1;ue>=0;--ue){var Fe=this.tryEntries[ue];if(Fe.finallyLoc===ne)return this.complete(Fe.completion,Fe.afterLoc),sa(Fe),Le}},catch:function(ne){for(var ue=this.tryEntries.length-1;ue>=0;--ue){var Fe=this.tryEntries[ue];if(Fe.tryLoc===ne){var Oe=Fe.completion;if(Oe.type==="throw"){var Pe=Oe.arg;sa(Fe)}return Pe}}throw new Error("illegal catch attempt")},delegateYield:function(ne,ue,Fe){return this.delegate={iterator:ua(ne),resultName:ue,nextLoc:Fe},this.method==="next"&&(this.arg=s),Le}},l}function U(s,l){var f=Object.keys(s);if(Object.getOwnPropertySymbols){var F=Object.getOwnPropertySymbols(s);l&&(F=F.filter(function(P){return Object.getOwnPropertyDescriptor(s,P).enumerable})),f.push.apply(f,F)}return f}function ee(s){for(var l=1;l<arguments.length;l++){var f=arguments[l]!=null?arguments[l]:{};l%2?U(Object(f),!0).forEach(function(F){R(s,F,f[F])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(f)):U(Object(f)).forEach(function(F){Object.defineProperty(s,F,Object.getOwnPropertyDescriptor(f,F))})}return s}function R(s,l,f){return l=$(l),l in s?Object.defineProperty(s,l,{value:f,enumerable:!0,configurable:!0,writable:!0}):s[l]=f,s}function $(s){var l=J(s,"string");return v(l)=="symbol"?l:String(l)}function J(s,l){if(v(s)!="object"||!s)return s;var f=s[Symbol.toPrimitive];if(f!==void 0){var F=f.call(s,l||"default");if(v(F)!="object")return F;throw new TypeError("@@toPrimitive must return a primitive value.")}return(l==="string"?String:Number)(s)}function z(s,l,f,F,P,L,j){try{var W=s[L](j),K=W.value}catch(X){f(X);return}W.done?l(K):Promise.resolve(K).then(F,P)}function q(s){return function(){var l=this,f=arguments;return new Promise(function(F,P){var L=s.apply(l,f);function j(K){z(L,F,P,j,W,"next",K)}function W(K){z(L,F,P,j,W,"throw",K)}j(void 0)})}}function ie(s,l){return Se(s)||De(s,l)||ge(s,l)||se()}function se(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function De(s,l){var f=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(f!=null){var F,P,L,j,W=[],K=!0,X=!1;try{if(L=(f=f.call(s)).next,l===0){if(Object(f)!==f)return;K=!1}else for(;!(K=(F=L.call(f)).done)&&(W.push(F.value),W.length!==l);K=!0);}catch(te){X=!0,P=te}finally{try{if(!K&&f.return!=null&&(j=f.return(),Object(j)!==j))return}finally{if(X)throw P}}return W}}function Se(s){if(Array.isArray(s))return s}function st(s,l){var f=typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(!f){if(Array.isArray(s)||(f=ge(s))||l&&s&&typeof s.length=="number"){f&&(s=f);var F=0,P=function(){};return{s:P,n:function(){return F>=s.length?{done:!0}:{done:!1,value:s[F++]}},e:function(X){throw X},f:P}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var L=!0,j=!1,W;return{s:function(){f=f.call(s)},n:function(){var X=f.next();return L=X.done,X},e:function(X){j=!0,W=X},f:function(){try{!L&&f.return!=null&&f.return()}finally{if(j)throw W}}}}function ot(s){return V(s)||G(s)||ge(s)||He()}function He(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ge(s,l){if(s){if(typeof s=="string")return Z(s,l);var f=Object.prototype.toString.call(s).slice(8,-1);if(f==="Object"&&s.constructor&&(f=s.constructor.name),f==="Map"||f==="Set")return Array.from(s);if(f==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(f))return Z(s,l)}}function G(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function V(s){if(Array.isArray(s))return Z(s)}function Z(s,l){(l==null||l>s.length)&&(l=s.length);for(var f=0,F=new Array(l);f<l;f++)F[f]=s[f];return F}var D=g.error,be=g.warn;function we(s){return typeof document<"u"&&document.getElementById?document.getElementById(s):null}var Me=33984,We=35048,je=34962,rt=34963,Qe=35345,mt=35982,Ft=36386,yt=35713,lt=35714,vt=35632,Ct=35633,de=35981,o=35718,p=35721,x=35971,I=35382,E=35396,y=35398,m=35392,A=35395,w=5126,B=35664,k=35665,H=35666,Y=5124,ae=35667,oe=35668,ce=35669,me=35670,fe=35671,ve=35672,xe=35673,le=35674,Ee=35675,ze=35676,Ze=35678,Ve=35680,qe=35679,Ce=35682,Ie=35685,tt=35686,Ye=35687,et=35688,Ke=35689,nt=35690,Be=36289,Ge=36292,Tt=36293,dt=5125,Rt=36294,It=36295,Yt=36296,Jt=36298,er=36299,vr=36300,Hr=36303,Yr=36306,Kr=36307,xt=36308,qi=36311,$r=3553,Qr=34067,An=32879,Zr=35866,Re={};function ni(s,l){return Re[l].bindPoint}function Hi(s,l){return function(f){s.uniform1f(l,f)}}function Yi(s,l){return function(f){s.uniform1fv(l,f)}}function Ki(s,l){return function(f){s.uniform2fv(l,f)}}function $i(s,l){return function(f){s.uniform3fv(l,f)}}function Qi(s,l){return function(f){s.uniform4fv(l,f)}}function ii(s,l){return function(f){s.uniform1i(l,f)}}function ai(s,l){return function(f){s.uniform1iv(l,f)}}function si(s,l){return function(f){s.uniform2iv(l,f)}}function oi(s,l){return function(f){s.uniform3iv(l,f)}}function ui(s,l){return function(f){s.uniform4iv(l,f)}}function tr(s,l){return function(f){s.uniform1ui(l,f)}}function ut(s,l){return function(f){s.uniform1uiv(l,f)}}function Jr(s,l){return function(f){s.uniform2uiv(l,f)}}function xr(s,l){return function(f){s.uniform3uiv(l,f)}}function en(s,l){return function(f){s.uniform4uiv(l,f)}}function ar(s,l){return function(f){s.uniformMatrix2fv(l,!1,f)}}function Et(s,l){return function(f){s.uniformMatrix3fv(l,!1,f)}}function ci(s,l){return function(f){s.uniformMatrix4fv(l,!1,f)}}function hi(s,l){return function(f){s.uniformMatrix2x3fv(l,!1,f)}}function li(s,l){return function(f){s.uniformMatrix3x2fv(l,!1,f)}}function kt(s,l){return function(f){s.uniformMatrix2x4fv(l,!1,f)}}function Ir(s,l){return function(f){s.uniformMatrix4x2fv(l,!1,f)}}function Sn(s,l){return function(f){s.uniformMatrix3x4fv(l,!1,f)}}function Zi(s,l){return function(f){s.uniformMatrix4x3fv(l,!1,f)}}function St(s,l,f,F){var P=ni(s,l);return d.isWebGL2(s)?function(L){var j,W;!L||g.isTexture(s,L)?(j=L,W=null):(j=L.texture,W=L.sampler),s.uniform1i(F,f),s.activeTexture(Me+f),s.bindTexture(P,j),s.bindSampler(f,W)}:function(L){s.uniform1i(F,f),s.activeTexture(Me+f),s.bindTexture(P,L)}}function Mt(s,l,f,F,P){for(var L=ni(s,l),j=new Int32Array(P),W=0;W<P;++W)j[W]=f+W;return d.isWebGL2(s)?function(K){s.uniform1iv(F,j),K.forEach(function(X,te){s.activeTexture(Me+j[te]);var ye,Te;!X||g.isTexture(s,X)?(ye=X,Te=null):(ye=X.texture,Te=X.sampler),s.bindSampler(f,Te),s.bindTexture(L,ye)})}:function(K){s.uniform1iv(F,j),K.forEach(function(X,te){s.activeTexture(Me+j[te]),s.bindTexture(L,X)})}}Re[w]={Type:Float32Array,size:4,setter:Hi,arraySetter:Yi},Re[B]={Type:Float32Array,size:8,setter:Ki,cols:2},Re[k]={Type:Float32Array,size:12,setter:$i,cols:3},Re[H]={Type:Float32Array,size:16,setter:Qi,cols:4},Re[Y]={Type:Int32Array,size:4,setter:ii,arraySetter:ai},Re[ae]={Type:Int32Array,size:8,setter:si,cols:2},Re[oe]={Type:Int32Array,size:12,setter:oi,cols:3},Re[ce]={Type:Int32Array,size:16,setter:ui,cols:4},Re[dt]={Type:Uint32Array,size:4,setter:tr,arraySetter:ut},Re[Rt]={Type:Uint32Array,size:8,setter:Jr,cols:2},Re[It]={Type:Uint32Array,size:12,setter:xr,cols:3},Re[Yt]={Type:Uint32Array,size:16,setter:en,cols:4},Re[me]={Type:Uint32Array,size:4,setter:ii,arraySetter:ai},Re[fe]={Type:Uint32Array,size:8,setter:si,cols:2},Re[ve]={Type:Uint32Array,size:12,setter:oi,cols:3},Re[xe]={Type:Uint32Array,size:16,setter:ui,cols:4},Re[le]={Type:Float32Array,size:32,setter:ar,rows:2,cols:2},Re[Ee]={Type:Float32Array,size:48,setter:Et,rows:3,cols:3},Re[ze]={Type:Float32Array,size:64,setter:ci,rows:4,cols:4},Re[Ie]={Type:Float32Array,size:32,setter:hi,rows:2,cols:3},Re[tt]={Type:Float32Array,size:32,setter:kt,rows:2,cols:4},Re[Ye]={Type:Float32Array,size:48,setter:li,rows:3,cols:2},Re[et]={Type:Float32Array,size:48,setter:Sn,rows:3,cols:4},Re[Ke]={Type:Float32Array,size:64,setter:Ir,rows:4,cols:2},Re[nt]={Type:Float32Array,size:64,setter:Zi,rows:4,cols:3},Re[Ze]={Type:null,size:0,setter:St,arraySetter:Mt,bindPoint:$r},Re[Ve]={Type:null,size:0,setter:St,arraySetter:Mt,bindPoint:Qr},Re[qe]={Type:null,size:0,setter:St,arraySetter:Mt,bindPoint:An},Re[Ce]={Type:null,size:0,setter:St,arraySetter:Mt,bindPoint:$r},Re[Be]={Type:null,size:0,setter:St,arraySetter:Mt,bindPoint:Zr},Re[Ge]={Type:null,size:0,setter:St,arraySetter:Mt,bindPoint:Zr},Re[Tt]={Type:null,size:0,setter:St,arraySetter:Mt,bindPoint:Qr},Re[Jt]={Type:null,size:0,setter:St,arraySetter:Mt,bindPoint:$r},Re[er]={Type:null,size:0,setter:St,arraySetter:Mt,bindPoint:An},Re[vr]={Type:null,size:0,setter:St,arraySetter:Mt,bindPoint:Qr},Re[Hr]={Type:null,size:0,setter:St,arraySetter:Mt,bindPoint:Zr},Re[Yr]={Type:null,size:0,setter:St,arraySetter:Mt,bindPoint:$r},Re[Kr]={Type:null,size:0,setter:St,arraySetter:Mt,bindPoint:An},Re[xt]={Type:null,size:0,setter:St,arraySetter:Mt,bindPoint:Qr},Re[qi]={Type:null,size:0,setter:St,arraySetter:Mt,bindPoint:Zr};function tn(s,l){return function(f){if(f.value)switch(s.disableVertexAttribArray(l),f.value.length){case 4:s.vertexAttrib4fv(l,f.value);break;case 3:s.vertexAttrib3fv(l,f.value);break;case 2:s.vertexAttrib2fv(l,f.value);break;case 1:s.vertexAttrib1fv(l,f.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else s.bindBuffer(je,f.buffer),s.enableVertexAttribArray(l),s.vertexAttribPointer(l,f.numComponents||f.size,f.type||w,f.normalize||!1,f.stride||0,f.offset||0),s.vertexAttribDivisor&&s.vertexAttribDivisor(l,f.divisor||0)}}function zt(s,l){return function(f){if(f.value)if(s.disableVertexAttribArray(l),f.value.length===4)s.vertexAttrib4iv(l,f.value);else throw new Error("The length of an integer constant value must be 4!");else s.bindBuffer(je,f.buffer),s.enableVertexAttribArray(l),s.vertexAttribIPointer(l,f.numComponents||f.size,f.type||Y,f.stride||0,f.offset||0),s.vertexAttribDivisor&&s.vertexAttribDivisor(l,f.divisor||0)}}function jt(s,l){return function(f){if(f.value)if(s.disableVertexAttribArray(l),f.value.length===4)s.vertexAttrib4uiv(l,f.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else s.bindBuffer(je,f.buffer),s.enableVertexAttribArray(l),s.vertexAttribIPointer(l,f.numComponents||f.size,f.type||dt,f.stride||0,f.offset||0),s.vertexAttribDivisor&&s.vertexAttribDivisor(l,f.divisor||0)}}function sr(s,l,f){var F=f.size,P=f.count;return function(L){s.bindBuffer(je,L.buffer);for(var j=L.size||L.numComponents||F,W=j/P,K=L.type||w,X=Re[K],te=X.size*j,ye=L.normalize||!1,Te=L.offset||0,_e=te/P,Ne=0;Ne<P;++Ne)s.enableVertexAttribArray(l+Ne),s.vertexAttribPointer(l+Ne,W,K,ye,te,Te+_e*Ne),s.vertexAttribDivisor&&s.vertexAttribDivisor(l+Ne,L.divisor||0)}}var at={};at[w]={size:4,setter:tn},at[B]={size:8,setter:tn},at[k]={size:12,setter:tn},at[H]={size:16,setter:tn},at[Y]={size:4,setter:zt},at[ae]={size:8,setter:zt},at[oe]={size:12,setter:zt},at[ce]={size:16,setter:zt},at[dt]={size:4,setter:jt},at[Rt]={size:8,setter:jt},at[It]={size:12,setter:jt},at[Yt]={size:16,setter:jt},at[me]={size:4,setter:zt},at[fe]={size:8,setter:zt},at[ve]={size:12,setter:zt},at[xe]={size:16,setter:zt},at[le]={size:4,setter:sr,count:2},at[Ee]={size:9,setter:sr,count:3},at[ze]={size:16,setter:sr,count:4};var or=/ERROR:\s*\d+:(\d+)/gi;function rr(s){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,F=ot(l.matchAll(or)),P=new Map(F.map(function(L,j){var W=parseInt(L[1]),K=F[j+1],X=K?K.index:l.length,te=l.substring(L.index,X);return[W-1,te]}));return s.split(`
`).map(function(L,j){var W=P.get(j);return"".concat(j+1+f,": ").concat(L).concat(W?`

^^^ `.concat(W):"")}).join(`
`)}var Mn=/^[ \t]*\n/;function _t(s){var l=0;return Mn.test(s)&&(l=1,s=s.replace(Mn,"")),{lineOffset:l,shaderSource:s}}function rn(s,l){return s.errorCallback(l),s.callback&&setTimeout(function(){s.callback("".concat(l,`
`).concat(s.errors.join(`
`)))}),null}function nn(s,l,f,F){F=F||D;var P=s.getShaderParameter(f,yt);if(!P){var L=s.getShaderInfoLog(f),j=_t(s.getShaderSource(f)),W=j.lineOffset,K=j.shaderSource,X="".concat(rr(K,L,W),`
Error compiling `).concat(d.glEnumToString(s,l),": ").concat(L);return F(X),X}return""}function ur(s,l,f){var F,P,L;if(typeof l=="function"&&(f=l,l=void 0),typeof s=="function")f=s,s=void 0;else if(s&&!Array.isArray(s)){var j=s;f=j.errorCallback,s=j.attribLocations,F=j.transformFeedbackVaryings,P=j.transformFeedbackMode,L=j.callback}var W=f||D,K=[],X={errorCallback:function(Te){K.push(Te);for(var _e=arguments.length,Ne=new Array(_e>1?_e-1:0),Ue=1;Ue<_e;Ue++)Ne[Ue-1]=arguments[Ue];W.apply(void 0,[Te].concat(Ne))},transformFeedbackVaryings:F,transformFeedbackMode:P,callback:L,errors:K};{var te={};Array.isArray(s)?s.forEach(function(ye,Te){te[ye]=l?l[Te]:Te}):te=s||{},X.attribLocations=te}return X}var cr=["VERTEX_SHADER","FRAGMENT_SHADER"];function fi(s,l){if(l.indexOf("frag")>=0)return vt;if(l.indexOf("vert")>=0)return Ct}function mi(s,l,f){var F=s.getAttachedShaders(l),P=st(F),L;try{for(P.s();!(L=P.n()).done;){var j=L.value;f.has(j)&&s.deleteShader(j)}}catch(W){P.e(W)}finally{P.f()}s.deleteProgram(l)}var yi=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new Promise(function(f){return setTimeout(f,l)})};function di(s,l,f){for(var F=s.createProgram(),P=ur(f),L=P.attribLocations,j=P.transformFeedbackVaryings,W=P.transformFeedbackMode,K=0;K<l.length;++K){var X=l[K];if(typeof X=="string"){var te=we(X),ye=te?te.text:X,Te=s[cr[K]];te&&te.type&&(Te=fi(s,te.type)||Te),X=s.createShader(Te),s.shaderSource(X,_t(ye).shaderSource),s.compileShader(X),s.attachShader(F,X)}}Object.entries(L).forEach(function(Ne){var Ue=ie(Ne,2),Le=Ue[0],Xe=Ue[1];return s.bindAttribLocation(F,Xe,Le)});{var _e=j;_e&&(_e.attribs&&(_e=_e.attribs),Array.isArray(_e)||(_e=Object.keys(_e)),s.transformFeedbackVaryings(F,_e,W||de))}return s.linkProgram(F),F}function Br(s,l,f,F,P){var L=ur(f,F,P),j=new Set(l),W=di(s,l,L);function K(X,te){var ye=Rn(X,te,L.errorCallback);return ye&&mi(X,te,j),ye}if(L.callback){Fn(s,W).then(function(){var X=K(s,W);L.callback(X,X?void 0:W)});return}return K(s,W)?void 0:W}function hr(s){return function(l,f){for(var F=arguments.length,P=new Array(F>2?F-2:0),L=2;L<F;L++)P[L-2]=arguments[L];return new Promise(function(j,W){var K=ur.apply(void 0,P);K.callback=function(X,te){X?W(X):j(te)},s(l,f,K)})}}i.createProgramAsync=hr(Br),i.createProgramInfoAsync=hr(T);function Fn(s,l){return Cn.apply(this,arguments)}function Cn(){return Cn=q(C().mark(function s(l,f){var F,P,L;return C().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:F=l.getExtension("KHR_parallel_shader_compile"),P=F?function(K,X){return K.getProgramParameter(X,F.COMPLETION_STATUS_KHR)}:function(){return!0},L=0;case 3:return W.next=5,yi(L);case 5:L=16.666666666666668;case 6:if(!P(l,f)){W.next=3;break}case 7:case"end":return W.stop()}},s)})),Cn.apply(this,arguments)}function gr(s,l){return an.apply(this,arguments)}function an(){return an=q(C().mark(function s(l,f){var F,P,L;return C().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:F=0,P=Object.values(f);case 1:if(!(F<P.length)){W.next=8;break}return L=P[F],W.next=5,Fn(l,L);case 5:F++,W.next=1;break;case 8:case"end":return W.stop()}},s)})),an.apply(this,arguments)}function Rn(s,l,f){f=f||D;var F=s.getProgramParameter(l,lt);if(!F){var P=s.getProgramInfoLog(l);f("Error in program linking: ".concat(P));var L=s.getAttachedShaders(l),j=L.map(function(W){return nn(s,s.getShaderParameter(W,s.SHADER_TYPE),W,f)});return"".concat(P,`
`).concat(j.filter(function(W){return W}).join(`
`))}}function Pn(s,l,f,F,P){var L=ur(f,F,P),j=[],W=st(l),K;try{for(W.s();!(K=W.n()).done;){var X=K.value,te=we(X);if(!te)return rn(L,"unknown script element: ".concat(X));j.push(te.text)}}catch(ye){W.e(ye)}finally{W.f()}return Br(s,j,L)}function Nn(s,l,f,F,P){return Br(s,l,f,F,P)}function Dn(s){var l=s.name;return l.startsWith("gl_")||l.startsWith("webgl_")}var Ji=/(\.|\[|]|\w+)/g,ea=function(l){return l>="0"&&l<="9"};function Lr(s,l,f,F){for(var P=s.split(Ji).filter(function(Ne){return Ne!==""}),L=0,j="";;){var W=P[L++];j+=W;var K=ea(W[0]),X=K?parseInt(W):W;K&&(j+=P[L++]);var te=L===P.length;if(te){f[X]=l;break}else{var ye=P[L++],Te=ye==="[",_e=f[X]||(Te?[]:{});f[X]=_e,f=_e,F[j]=F[j]||function(Ne){return function(Ue){xi(Ne,Ue)}}(_e),j+=ye}}}function br(s,l){var f=0;function F(Te,_e,Ne){var Ue=_e.name.endsWith("[0]"),Le=_e.type,Xe=Re[Le];if(!Xe)throw new Error("unknown type: 0x".concat(Le.toString(16)));var Je;if(Xe.bindPoint){var ft=f;f+=_e.size,Ue?Je=Xe.arraySetter(s,Le,ft,Ne,_e.size):Je=Xe.setter(s,Le,ft,Ne,_e.size)}else Xe.arraySetter&&Ue?Je=Xe.arraySetter(s,Ne):Je=Xe.setter(s,Ne);return Je.location=Ne,Je}for(var P={},L={},j=s.getProgramParameter(l,o),W=0;W<j;++W){var K=s.getActiveUniform(l,W);if(!Dn(K)){var X=K.name;X.endsWith("[0]")&&(X=X.substr(0,X.length-3));var te=s.getUniformLocation(l,K.name);if(te){var ye=F(l,K,te);P[X]=ye,Lr(X,ye,L,P)}}}return P}function sn(s,l){for(var f={},F=s.getProgramParameter(l,x),P=0;P<F;++P){var L=s.getTransformFeedbackVarying(l,P);f[L.name]={index:P,type:L.type,size:L.size}}return f}function on(s,l,f){l.transformFeedbackInfo&&(l=l.transformFeedbackInfo),f.attribs&&(f=f.attribs);for(var F in f){var P=l[F];if(P){var L=f[F];L.offset?s.bindBufferRange(mt,P.index,L.buffer,L.offset,L.size):s.bindBufferBase(mt,P.index,L.buffer)}}}function In(s,l,f){var F=s.createTransformFeedback();return s.bindTransformFeedback(Ft,F),s.useProgram(l.program),on(s,l,f),s.bindTransformFeedback(Ft,null),F}function lr(s,l){for(var f=s.getProgramParameter(l,o),F=[],P=[],L=0;L<f;++L){P.push(L),F.push({});var j=s.getActiveUniform(l,L);F[L].name=j.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(Te){var _e=Te[0],Ne=Te[1];s.getActiveUniforms(l,P,s[_e]).forEach(function(Ue,Le){F[Le][Ne]=Ue})});for(var W={},K=s.getProgramParameter(l,I),X=0;X<K;++X){var te=s.getActiveUniformBlockName(l,X),ye={index:s.getUniformBlockIndex(l,te),usedByVertexShader:s.getActiveUniformBlockParameter(l,X,E),usedByFragmentShader:s.getActiveUniformBlockParameter(l,X,y),size:s.getActiveUniformBlockParameter(l,X,m),uniformIndices:s.getActiveUniformBlockParameter(l,X,A)};ye.used=ye.usedByVertexShader||ye.usedByFragmentShader,W[te]=ye}return{blockSpecs:W,uniformData:F}}var pi=/\[\d+\]\.$/,ta=function(l,f){return((l+(f-1))/f|0)*f};function ra(s,l,f,F){if(l||f){F=F||1;var P=s.length,L=P/4;return function(j){for(var W=0,K=0,X=0;X<L;++X){for(var te=0;te<F;++te)s[W++]=j[K++];W+=4-F}}}else return function(j){j.length?s.set(j):s[0]=j}}function Bn(s,l,f,F){var P=f.blockSpecs,L=f.uniformData,j=P[F];if(!j)return be("no uniform block object named:",F),{name:F,uniforms:{}};var W=new ArrayBuffer(j.size),K=s.createBuffer(),X=j.index;s.bindBuffer(Qe,K),s.uniformBlockBinding(l,j.index,X);var te=F+".";pi.test(te)&&(te=te.replace(pi,"."));var ye={},Te={},_e={};return j.uniformIndices.forEach(function(Ne){var Ue=L[Ne],Le=Ue.name;Le.startsWith(te)&&(Le=Le.substr(te.length));var Xe=Le.endsWith("[0]");Xe&&(Le=Le.substr(0,Le.length-3));var Je=Re[Ue.type],ft=Je.Type,bt=Xe?ta(Je.size,16)*Ue.size:Je.size*Ue.size,Bt=new ft(W,Ue.offset,bt/ft.BYTES_PER_ELEMENT);ye[Le]=Bt;var Kt=ra(Bt,Xe,Je.rows,Je.cols);Te[Le]=Kt,Lr(Le,Kt,_e,Te)}),{name:F,array:W,asFloat:new Float32Array(W),buffer:K,uniforms:ye,setters:Te}}function Ln(s,l,f){return Bn(s,l.program,l.uniformBlockSpec,f)}function un(s,l,f){var F=l.uniformBlockSpec||l,P=F.blockSpecs[f.name];if(P){var L=P.index;return s.bindBufferRange(Qe,L,f.buffer,f.offset||0,f.array.byteLength),!0}return!1}function vi(s,l,f){un(s,l,f)&&s.bufferData(Qe,f.array,We)}function na(s,l){var f=s.setters;for(var F in l){var P=f[F];if(P){var L=l[F];P(L)}}}function xi(s,l){for(var f in l){var F=s[f];typeof F=="function"?F(l[f]):xi(s[f],l[f])}}function cn(s){for(var l=s.uniformSetters||s,f=arguments.length<=1?0:arguments.length-1,F=0;F<f;++F){var P=F+1<1||arguments.length<=F+1?void 0:arguments[F+1];if(Array.isArray(P))for(var L=P.length,j=0;j<L;++j)cn(l,P[j]);else for(var W in P){var K=l[W];K&&K(P[W])}}}i.setUniformsAndBindTextures=cn;function On(s,l){for(var f={},F=s.getProgramParameter(l,p),P=0;P<F;++P){var L=s.getActiveAttrib(l,P);if(!Dn(L)){var j=s.getAttribLocation(l,L.name),W=at[L.type],K=W.setter(s,j,W);K.location=j,f[L.name]=K}}return f}function zn(s,l){for(var f in l){var F=s[f];F&&F(l[f])}}function ia(s,l,f){f.vertexArrayObject?s.bindVertexArray(f.vertexArrayObject):(zn(l.attribSetters||l,f.attribs),f.indices&&s.bindBuffer(rt,f.indices))}function hn(s,l){var f=br(s,l),F=On(s,l),P={program:l,uniformSetters:f,attribSetters:F};return d.isWebGL2(s)&&(P.uniformBlockSpec=lr(s,l),P.transformFeedbackInfo=sn(s,l)),P}var aa=/\s|{|}|;/;function T(s,l,f,F,P){var L=ur(f,F,P),j=[];if(l=l.map(function(X){if(!aa.test(X)){var te=we(X);if(te)X=te.text;else{var ye="no element with id: ".concat(X);L.errorCallback(ye),j.push(ye)}}return X}),j.length)return rn(L,"");var W=L.callback;W&&(L.callback=function(X,te){W(X,X?void 0:hn(s,te))});var K=Nn(s,l,L);return K?hn(s,K):null}function S(s,l,f,F,P){for(var L=0,j=Object.entries(l);L<j.length;L++){var W=ie(j[L],2),K=W[0],X=W[1],te=ee({},P),ye=f[K];Array.isArray(ye)||Object.assign(te,ye);var Te=Rn(s,X,te.errorCallback);if(Te){for(var _e=0,Ne=Object.values(l);_e<Ne.length;_e++){var Ue=Ne[_e],Le=s.getAttachedShaders(Ue);s.deleteProgram(Ue);var Xe=st(Le),Je;try{for(Xe.s();!(Je=Xe.n()).done;){var ft=Je.value;F.has(ft)||s.deleteShader(ft)}}catch(bt){Xe.e(bt)}finally{Xe.f()}}return Te}}}function M(s,l){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},F=new Set,P=Object.fromEntries(Object.entries(l).map(function(j){var W=ie(j,2),K=W[0],X=W[1],te=ee({},f),ye=Array.isArray(X)?X:X.shaders;return Array.isArray(X)||Object.assign(te,X),ye.forEach(F.add,F),[K,di(s,ye,te)]}));if(f.callback){gr(s,P).then(function(){var j=S(s,P,l,F,f);f.callback(j,j?void 0:P)});return}var L=S(s,P,l,F,f);return L?void 0:P}function O(s,l,f){f=ur(f);function F(j,W){return Object.fromEntries(Object.entries(W).map(function(K){var X=ie(K,2),te=X[0],ye=X[1];return[te,hn(j,ye)]}))}var P=f.callback;P&&(f.callback=function(j,W){P(j,j?void 0:F(s,W))});var L=M(s,l,f);if(!(P||!L))return F(s,L)}i.createProgramsAsync=hr(M),i.createProgramInfosAsync=hr(O)},"./src/textures.js":(u,i,h)=>{function v(T){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S},v(T)}i.__esModule=!0,i.canFilter=yi,i.canGenerateMipmap=mi,i.createSampler=Dn,i.createSamplers=Ji,i.createTexture=zn,i.createTextures=aa,i.getBytesPerElementForInternalFormat=ur,i.getFormatAndTypeForInternalFormat=cr,i.getNumComponentsForFormat=di,i.loadTextureFromUrl=vi,i.resizeTexture=ia,i.setDefaultTextureColor=Fn,i.setEmptyTexture=On,i.setSamplerParameters=Nn,i.setTextureDefaults_=Cn,i.setTextureFilteringForSize=Lr,i.setTextureFromArray=cn,i.setTextureFromElement=In,i.setTextureParameters=Pn;var d=C(h("./src/utils.js")),g=C(h("./src/typedarrays.js")),_=C(h("./src/helper.js"));function b(T){if(typeof WeakMap!="function")return null;var S=new WeakMap,M=new WeakMap;return(b=function(s){return s?M:S})(T)}function C(T,S){if(!S&&T&&T.__esModule)return T;if(T===null||v(T)!="object"&&typeof T!="function")return{default:T};var M=b(S);if(M&&M.has(T))return M.get(T);var O={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in T)if(l!=="default"&&Object.prototype.hasOwnProperty.call(T,l)){var f=s?Object.getOwnPropertyDescriptor(T,l):null;f&&(f.get||f.set)?Object.defineProperty(O,l,f):O[l]=T[l]}return O.default=T,M&&M.set(T,O),O}var U={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},ee=g.isArrayBuffer,R=function(){var T;return function(){return T=T||(typeof document<"u"&&document.createElement?document.createElement("canvas").getContext("2d"):null),T}}(),$=6406,J=6407,z=6408,q=6409,ie=6410,se=6402,De=34041,Se=33071,st=9728,ot=9729,He=3553,ge=34067,G=32879,V=35866,Z=34069,D=34070,be=34071,we=34072,Me=34073,We=34074,je=10241,rt=10240,Qe=10242,mt=10243,Ft=32882,yt=33082,lt=33083,vt=33084,Ct=33085,de=34892,o=34893,p=3317,x=3314,I=32878,E=3316,y=3315,m=32877,A=37443,w=37441,B=37440,k=33321,H=36756,Y=33325,ae=33326,oe=33330,ce=33329,me=33338,fe=33337,ve=33340,xe=33339,le=33323,Ee=36757,ze=33327,Ze=33328,Ve=33336,qe=33335,Ce=33332,Ie=33331,tt=33334,Ye=33333,et=32849,Ke=35905,nt=36194,Be=36758,Ge=35898,Tt=35901,dt=34843,Rt=34837,It=36221,Yt=36239,Jt=36215,er=36233,vr=36209,Hr=36227,Yr=32856,Kr=35907,xt=36759,qi=32855,$r=32854,Qr=32857,An=34842,Zr=34836,Re=36220,ni=36238,Hi=36975,Yi=36214,Ki=36232,$i=36226,Qi=36208,ii=33189,ai=33190,si=36012,oi=36013,ui=35056,tr=5120,ut=5121,Jr=5122,xr=5123,en=5124,ar=5125,Et=5126,ci=32819,hi=32820,li=33635,kt=5131,Ir=36193,Sn=33640,Zi=35899,St=35902,Mt=36269,tn=34042,zt=33319,jt=33320,sr=6403,at=36244,or=36248,rr=36249,Mn={};{var _t=Mn;_t[$]={numColorComponents:1},_t[q]={numColorComponents:1},_t[ie]={numColorComponents:2},_t[J]={numColorComponents:3},_t[z]={numColorComponents:4},_t[sr]={numColorComponents:1},_t[at]={numColorComponents:1},_t[zt]={numColorComponents:2},_t[jt]={numColorComponents:2},_t[J]={numColorComponents:3},_t[or]={numColorComponents:3},_t[z]={numColorComponents:4},_t[rr]={numColorComponents:4},_t[se]={numColorComponents:1},_t[De]={numColorComponents:2}}var rn;function nn(T){if(!rn){var S={};S[$]={textureFormat:$,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[ut,kt,Ir,Et]},S[q]={textureFormat:q,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[ut,kt,Ir,Et]},S[ie]={textureFormat:ie,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[ut,kt,Ir,Et]},S[J]={textureFormat:J,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[ut,kt,Ir,Et,li]},S[z]={textureFormat:z,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[ut,kt,Ir,Et,ci,hi]},S[se]={textureFormat:se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[ar,xr]},S[k]={textureFormat:sr,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[ut]},S[H]={textureFormat:sr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[tr]},S[Y]={textureFormat:sr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[Et,kt]},S[ae]={textureFormat:sr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[Et]},S[oe]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[ut]},S[ce]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[tr]},S[Ce]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[xr]},S[Ie]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Jr]},S[tt]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ar]},S[Ye]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[en]},S[le]={textureFormat:zt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[ut]},S[Ee]={textureFormat:zt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[tr]},S[ze]={textureFormat:zt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[Et,kt]},S[Ze]={textureFormat:zt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[Et]},S[Ve]={textureFormat:jt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[ut]},S[qe]={textureFormat:jt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[tr]},S[me]={textureFormat:jt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[xr]},S[fe]={textureFormat:jt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Jr]},S[ve]={textureFormat:jt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[ar]},S[xe]={textureFormat:jt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[en]},S[et]={textureFormat:J,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[ut]},S[Ke]={textureFormat:J,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[ut]},S[nt]={textureFormat:J,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[ut,li]},S[Be]={textureFormat:J,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[tr]},S[Ge]={textureFormat:J,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[Et,kt,Zi]},S[Tt]={textureFormat:J,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[Et,kt,St]},S[dt]={textureFormat:J,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[Et,kt]},S[Rt]={textureFormat:J,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[Et]},S[It]={textureFormat:or,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[ut]},S[Yt]={textureFormat:or,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[tr]},S[Jt]={textureFormat:or,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[xr]},S[er]={textureFormat:or,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[Jr]},S[vr]={textureFormat:or,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[ar]},S[Hr]={textureFormat:or,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[en]},S[Yr]={textureFormat:z,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[ut]},S[Kr]={textureFormat:z,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[ut]},S[xt]={textureFormat:z,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[tr]},S[qi]={textureFormat:z,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[ut,hi,Sn]},S[$r]={textureFormat:z,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[ut,ci]},S[Qr]={textureFormat:z,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[Sn]},S[An]={textureFormat:z,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[Et,kt]},S[Zr]={textureFormat:z,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[Et]},S[Re]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ut]},S[ni]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[tr]},S[Hi]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Sn]},S[Yi]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[xr]},S[Ki]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Jr]},S[$i]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[en]},S[Qi]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[ar]},S[ii]={textureFormat:se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[xr,ar]},S[ai]={textureFormat:se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ar]},S[si]={textureFormat:se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Et]},S[ui]={textureFormat:De,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[tn]},S[oi]={textureFormat:De,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Mt]},Object.keys(S).forEach(function(M){var O=S[M];O.bytesPerElementMap={},O.bytesPerElement.forEach(function(s,l){var f=O.type[l];O.bytesPerElementMap[f]=s})}),rn=S}return rn[T]}function ur(T,S){var M=nn(T);if(!M)throw"unknown internal format";var O=M.bytesPerElementMap[S];if(O===void 0)throw"unknown internal format";return O}function cr(T){var S=nn(T);if(!S)throw"unknown internal format";return{format:S.textureFormat,type:S.type[0]}}function fi(T){return(T&T-1)===0}function mi(T,S,M,O){if(!d.isWebGL2(T))return fi(S)&&fi(M);var s=nn(O);if(!s)throw"unknown internal format";return s.colorRenderable&&s.textureFilterable}function yi(T){var S=nn(T);if(!S)throw"unknown internal format";return S.textureFilterable}function di(T){var S=Mn[T];if(!S)throw"unknown format: "+T;return S.numColorComponents}function Br(T,S,M){return ee(S)?g.getGLTypeForTypedArray(S):M||ut}function hr(T,S,M,O,s){if(s%1!==0)throw"can't guess dimensions";if(!M&&!O){var l=Math.sqrt(s/(S===ge?6:1));l%1===0?(M=l,O=l):(M=s,O=1)}else if(O){if(!M&&(M=s/O,M%1))throw"can't guess dimensions"}else if(O=s/M,O%1)throw"can't guess dimensions";return{width:M,height:O}}function Fn(T){U.textureColor=new Uint8Array([T[0]*255,T[1]*255,T[2]*255,T[3]*255])}function Cn(T){_.copyExistingProperties(T,U),T.textureColor&&Fn(T.textureColor)}function gr(T,S){S.colorspaceConversion!==void 0&&T.pixelStorei(A,S.colorspaceConversion),S.premultiplyAlpha!==void 0&&T.pixelStorei(w,S.premultiplyAlpha),S.flipY!==void 0&&T.pixelStorei(B,S.flipY)}function an(T){T.pixelStorei(p,4),d.isWebGL2(T)&&(T.pixelStorei(x,0),T.pixelStorei(I,0),T.pixelStorei(E,0),T.pixelStorei(y,0),T.pixelStorei(m,0))}function Rn(T,S,M,O){O.minMag&&(M.call(T,S,je,O.minMag),M.call(T,S,rt,O.minMag)),O.min&&M.call(T,S,je,O.min),O.mag&&M.call(T,S,rt,O.mag),O.wrap&&(M.call(T,S,Qe,O.wrap),M.call(T,S,mt,O.wrap),(S===G||_.isSampler(T,S))&&M.call(T,S,Ft,O.wrap)),O.wrapR&&M.call(T,S,Ft,O.wrapR),O.wrapS&&M.call(T,S,Qe,O.wrapS),O.wrapT&&M.call(T,S,mt,O.wrapT),O.minLod!==void 0&&M.call(T,S,yt,O.minLod),O.maxLod!==void 0&&M.call(T,S,lt,O.maxLod),O.baseLevel!==void 0&&M.call(T,S,vt,O.baseLevel),O.maxLevel!==void 0&&M.call(T,S,Ct,O.maxLevel),O.compareFunc!==void 0&&M.call(T,S,o,O.compareFunc),O.compareMode!==void 0&&M.call(T,S,de,O.compareMode)}function Pn(T,S,M){var O=M.target||He;T.bindTexture(O,S),Rn(T,O,T.texParameteri,M)}function Nn(T,S,M){Rn(T,S,T.samplerParameteri,M)}function Dn(T,S){var M=T.createSampler();return Nn(T,M,S),M}function Ji(T,S){var M={};return Object.keys(S).forEach(function(O){M[O]=Dn(T,S[O])}),M}function ea(T){return T=T||U.textureColor,ee(T)?T:new Uint8Array([T[0]*255,T[1]*255,T[2]*255,T[3]*255])}function Lr(T,S,M,O,s,l){M=M||U.textureOptions,l=l||z;var f=M.target||He;if(O=O||M.width,s=s||M.height,T.bindTexture(f,S),mi(T,O,s,l))T.generateMipmap(f);else{var F=yi(l)?ot:st;T.texParameteri(f,je,F),T.texParameteri(f,rt,F),T.texParameteri(f,Qe,Se),T.texParameteri(f,mt,Se)}}function br(T){return T.auto===!0||T.auto===void 0&&T.level===void 0}function sn(T,S){return S=S||{},S.cubeFaceOrder||[Z,D,be,we,Me,We]}function on(T,S){var M=sn(T,S),O=M.map(function(s,l){return{face:s,ndx:l}});return O.sort(function(s,l){return s.face-l.face}),O}function In(T,S,M,O){O=O||U.textureOptions;var s=O.target||He,l=O.level||0,f=M.width,F=M.height,P=O.internalFormat||O.format||z,L=cr(P),j=O.format||L.format,W=O.type||L.type;if(gr(T,O),T.bindTexture(s,S),s===ge){var K=M.width,X=M.height,te,ye;if(K/6===X)te=X,ye=[0,0,1,0,2,0,3,0,4,0,5,0];else if(X/6===K)te=K,ye=[0,0,0,1,0,2,0,3,0,4,0,5];else if(K/3===X/2)te=K/3,ye=[0,0,1,0,2,0,0,1,1,1,2,1];else if(K/2===X/3)te=K/2,ye=[0,0,1,0,0,1,1,1,0,2,1,2];else throw"can't figure out cube map from element: "+(M.src?M.src:M.nodeName);var Te=R();Te?(Te.canvas.width=te,Te.canvas.height=te,f=te,F=te,on(T,O).forEach(function(Bt){var Kt=ye[Bt.ndx*2+0]*te,nr=ye[Bt.ndx*2+1]*te;Te.drawImage(M,Kt,nr,te,te,0,0,te,te),T.texImage2D(Bt.face,l,P,j,W,Te.canvas)}),Te.canvas.width=1,Te.canvas.height=1):typeof createImageBitmap<"u"&&(f=te,F=te,on(T,O).forEach(function(Bt){var Kt=ye[Bt.ndx*2+0]*te,nr=ye[Bt.ndx*2+1]*te;T.texImage2D(Bt.face,l,P,te,te,0,j,W,null),createImageBitmap(M,Kt,nr,te,te,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(function(gi){gr(T,O),T.bindTexture(s,S),T.texImage2D(Bt.face,l,P,j,W,gi),br(O)&&Lr(T,S,O,f,F,P)})}))}else if(s===G||s===V){var _e=Math.min(M.width,M.height),Ne=Math.max(M.width,M.height),Ue=Ne/_e;if(Ue%1!==0)throw"can not compute 3D dimensions of element";var Le=M.width===Ne?1:0,Xe=M.height===Ne?1:0;T.pixelStorei(p,1),T.pixelStorei(x,M.width),T.pixelStorei(I,0),T.pixelStorei(m,0),T.texImage3D(s,l,P,_e,_e,_e,0,j,W,null);for(var Je=0;Je<Ue;++Je){var ft=Je*_e*Le,bt=Je*_e*Xe;T.pixelStorei(E,ft),T.pixelStorei(y,bt),T.texSubImage3D(s,l,0,0,Je,_e,_e,1,j,W,M)}an(T)}else T.texImage2D(s,l,P,j,W,M);br(O)&&Lr(T,S,O,f,F,P),Pn(T,S,O)}function lr(){}function pi(T){if(typeof document<"u"){var S=document.createElement("a");return S.href=T,S.hostname===location.hostname&&S.port===location.port&&S.protocol===location.protocol}else{var M=new URL(location.href).origin,O=new URL(T,location.href).origin;return O===M}}function ta(T,S){return S===void 0&&!pi(T)?"anonymous":S}function ra(T,S,M){M=M||lr;var O;if(S=S!==void 0?S:U.crossOrigin,S=ta(T,S),typeof Image<"u"){O=new Image,S!==void 0&&(O.crossOrigin=S);var s=function(){O.removeEventListener("error",l),O.removeEventListener("load",f),O=null},l=function(){var K="couldn't load image: "+T;_.error(K),M(K,O),s()},f=function(){M(null,O),s()};return O.addEventListener("error",l),O.addEventListener("load",f),O.src=T,O}else if(typeof ImageBitmap<"u"){var F,P,L=function(){M(F,P)},j={};S&&(j.mode="cors"),fetch(T,j).then(function(W){if(!W.ok)throw W;return W.blob()}).then(function(W){return createImageBitmap(W,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}).then(function(W){P=W,setTimeout(L)}).catch(function(W){F=W,setTimeout(L)}),O=null}return O}function Bn(T){return typeof ImageBitmap<"u"&&T instanceof ImageBitmap||typeof ImageData<"u"&&T instanceof ImageData||typeof HTMLElement<"u"&&T instanceof HTMLElement}function Ln(T,S,M){return Bn(T)?(setTimeout(function(){M(null,T)}),T):ra(T,S,M)}function un(T,S,M){M=M||U.textureOptions;var O=M.target||He;if(T.bindTexture(O,S),M.color!==!1){var s=ea(M.color);if(O===ge)for(var l=0;l<6;++l)T.texImage2D(Z+l,0,z,1,1,0,z,ut,s);else O===G||O===V?T.texImage3D(O,0,z,1,1,1,0,z,ut,s):T.texImage2D(O,0,z,1,1,0,z,ut,s)}}function vi(T,S,M,O){O=O||lr,M=M||U.textureOptions,un(T,S,M),M=Object.assign({},M);var s=Ln(M.src,M.crossOrigin,function(l,f){l?O(l,S,f):(In(T,S,f,M),O(null,S,f))});return s}function na(T,S,M,O){O=O||lr;var s=M.src;if(s.length!==6)throw"there must be 6 urls for a cubemap";var l=M.level||0,f=M.internalFormat||M.format||z,F=cr(f),P=M.format||F.format,L=M.type||ut,j=M.target||He;if(j!==ge)throw"target must be TEXTURE_CUBE_MAP";un(T,S,M),M=Object.assign({},M);var W=6,K=[],X=sn(T,M),te;function ye(Te){return function(_e,Ne){--W,_e?K.push(_e):Ne.width!==Ne.height?K.push("cubemap face img is not a square: "+Ne.src):(gr(T,M),T.bindTexture(j,S),W===5?sn().forEach(function(Ue){T.texImage2D(Ue,l,f,P,L,Ne)}):T.texImage2D(Te,l,f,P,L,Ne),br(M)&&T.generateMipmap(j)),W===0&&O(K.length?K:void 0,S,te)}}te=s.map(function(Te,_e){return Ln(Te,M.crossOrigin,ye(X[_e]))})}function xi(T,S,M,O){O=O||lr;var s=M.src,l=M.internalFormat||M.format||z,f=cr(l),F=M.format||f.format,P=M.type||ut,L=M.target||V;if(L!==G&&L!==V)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";un(T,S,M),M=Object.assign({},M);var j=s.length,W=[],K,X=M.level||0,te=M.width,ye=M.height,Te=s.length,_e=!0;function Ne(Ue){return function(Le,Xe){if(--j,Le)W.push(Le);else{if(gr(T,M),T.bindTexture(L,S),_e){_e=!1,te=M.width||Xe.width,ye=M.height||Xe.height,T.texImage3D(L,X,l,te,ye,Te,0,F,P,null);for(var Je=0;Je<Te;++Je)T.texSubImage3D(L,X,0,0,Je,te,ye,1,F,P,Xe)}else{var ft=Xe,bt;(Xe.width!==te||Xe.height!==ye)&&(bt=R(),ft=bt.canvas,bt.canvas.width=te,bt.canvas.height=ye,bt.drawImage(Xe,0,0,te,ye)),T.texSubImage3D(L,X,0,0,Ue,te,ye,1,F,P,ft),bt&&ft===bt.canvas&&(bt.canvas.width=0,bt.canvas.height=0)}br(M)&&T.generateMipmap(L)}j===0&&O(W.length?W:void 0,S,K)}}K=s.map(function(Ue,Le){return Ln(Ue,M.crossOrigin,Ne(Le))})}function cn(T,S,M,O){O=O||U.textureOptions;var s=O.target||He;T.bindTexture(s,S);var l=O.width,f=O.height,F=O.depth,P=O.level||0,L=O.internalFormat||O.format||z,j=cr(L),W=O.format||j.format,K=O.type||Br(T,M,j.type);if(ee(M))M instanceof Uint8ClampedArray&&(M=new Uint8Array(M.buffer));else{var X=g.getTypedArrayTypeForGLType(K);M=new X(M)}var te=ur(L,K),ye=M.byteLength/te;if(ye%1)throw"length wrong size for format: "+d.glEnumToString(T,W);var Te;if(s===G||s===V)if(!l&&!f&&!F){var _e=Math.cbrt(ye);if(_e%1!==0)throw"can't guess cube size of array of numElements: "+ye;l=_e,f=_e,F=_e}else l&&(!f||!F)?(Te=hr(T,s,f,F,ye/l),f=Te.width,F=Te.height):f&&(!l||!F)?(Te=hr(T,s,l,F,ye/f),l=Te.width,F=Te.height):(Te=hr(T,s,l,f,ye/F),l=Te.width,f=Te.height);else Te=hr(T,s,l,f,ye),l=Te.width,f=Te.height;if(an(T),T.pixelStorei(p,O.unpackAlignment||1),gr(T,O),s===ge){var Ne=te/M.BYTES_PER_ELEMENT,Ue=ye/6*Ne;on(T,O).forEach(function(Le){var Xe=Ue*Le.ndx,Je=M.subarray(Xe,Xe+Ue);T.texImage2D(Le.face,P,L,l,f,0,W,K,Je)})}else s===G||s===V?T.texImage3D(s,P,L,l,f,F,0,W,K,M):T.texImage2D(s,P,L,l,f,0,W,K,M);return{width:l,height:f,depth:F,type:K}}function On(T,S,M){var O=M.target||He;T.bindTexture(O,S);var s=M.level||0,l=M.internalFormat||M.format||z,f=cr(l),F=M.format||f.format,P=M.type||f.type;if(gr(T,M),O===ge)for(var L=0;L<6;++L)T.texImage2D(Z+L,s,l,M.width,M.height,0,F,P,null);else O===G||O===V?T.texImage3D(O,s,l,M.width,M.height,M.depth,0,F,P,null):T.texImage2D(O,s,l,M.width,M.height,0,F,P,null)}function zn(T,S,M){M=M||lr,S=S||U.textureOptions;var O=T.createTexture(),s=S.target||He,l=S.width||1,f=S.height||1,F=S.internalFormat||z;T.bindTexture(s,O),s===ge&&(T.texParameteri(s,Qe,Se),T.texParameteri(s,mt,Se));var P=S.src;if(P)if(typeof P=="function"&&(P=P(T,S)),typeof P=="string")vi(T,O,S,M);else if(ee(P)||Array.isArray(P)&&(typeof P[0]=="number"||Array.isArray(P[0])||ee(P[0]))){var L=cn(T,O,P,S);l=L.width,f=L.height}else Array.isArray(P)&&(typeof P[0]=="string"||Bn(P[0]))?s===ge?na(T,O,S,M):xi(T,O,S,M):(In(T,O,P,S),l=P.width,f=P.height);else On(T,O,S);return br(S)&&Lr(T,O,S,l,f,F),Pn(T,O,S),O}function ia(T,S,M,O,s,l){O=O||M.width,s=s||M.height,l=l||M.depth;var f=M.target||He;T.bindTexture(f,S);var F=M.level||0,P=M.internalFormat||M.format||z,L=cr(P),j=M.format||L.format,W,K=M.src;if(K&&(ee(K)||Array.isArray(K)&&typeof K[0]=="number")?W=M.type||Br(T,K,L.type):W=M.type||L.type,f===ge)for(var X=0;X<6;++X)T.texImage2D(Z+X,F,P,O,s,0,j,W,null);else f===G||f===V?T.texImage3D(f,F,P,O,s,l,0,j,W,null):T.texImage2D(f,F,P,O,s,0,j,W,null)}function hn(T){return typeof T=="string"||Array.isArray(T)&&typeof T[0]=="string"}function aa(T,S,M){M=M||lr;var O=0,s=[],l={},f={};function F(){O===0&&setTimeout(function(){M(s.length?s:void 0,l,f)},0)}return Object.keys(S).forEach(function(P){var L=S[P],j;hn(L.src)&&(j=function(K,X,te){f[P]=te,--O,K&&s.push(K),F()},++O),l[P]=zn(T,L,j)}),F(),l}},"./src/twgl-full.js":(u,i,h)=>{function v(R){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $},v(R)}i.__esModule=!0;var d={m4:!0,v3:!0,primitives:!0};i.v3=i.primitives=i.m4=void 0;var g=ee(h("./src/m4.js"));i.m4=g;var _=ee(h("./src/v3.js"));i.v3=_;var b=ee(h("./src/primitives.js"));i.primitives=b;var C=h("./src/twgl.js");Object.keys(C).forEach(function(R){R==="default"||R==="__esModule"||Object.prototype.hasOwnProperty.call(d,R)||R in i&&i[R]===C[R]||(i[R]=C[R])});function U(R){if(typeof WeakMap!="function")return null;var $=new WeakMap,J=new WeakMap;return(U=function(q){return q?J:$})(R)}function ee(R,$){if(!$&&R&&R.__esModule)return R;if(R===null||v(R)!="object"&&typeof R!="function")return{default:R};var J=U($);if(J&&J.has(R))return J.get(R);var z={__proto__:null},q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ie in R)if(ie!=="default"&&Object.prototype.hasOwnProperty.call(R,ie)){var se=q?Object.getOwnPropertyDescriptor(R,ie):null;se&&(se.get||se.set)?Object.defineProperty(z,ie,se):z[ie]=R[ie]}return z.default=R,J&&J.set(R,z),z}},"./src/twgl.js":(u,i,h)=>{function v(D){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(be){return typeof be}:function(be){return be&&typeof Symbol=="function"&&be.constructor===Symbol&&be!==Symbol.prototype?"symbol":typeof be},v(D)}i.__esModule=!0;var d={addExtensionsToContext:!0,getContext:!0,getWebGLContext:!0,resizeCanvasToDisplaySize:!0,setDefaults:!0,attributes:!0,textures:!0,utils:!0,draw:!0,framebuffers:!0,programs:!0,typedarrays:!0,vertexArrays:!0};i.addExtensionsToContext=ot,i.framebuffers=i.draw=i.attributes=void 0,i.getContext=V,i.getWebGLContext=ge,i.programs=void 0,i.resizeCanvasToDisplaySize=Z,i.setDefaults=se,i.vertexArrays=i.utils=i.typedarrays=i.textures=void 0;var g=q(h("./src/attributes.js"));i.attributes=g,Object.keys(g).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(d,D)||D in i&&i[D]===g[D]||(i[D]=g[D])});var _=q(h("./src/textures.js"));i.textures=_,Object.keys(_).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(d,D)||D in i&&i[D]===_[D]||(i[D]=_[D])});var b=q(h("./src/helper.js")),C=q(h("./src/utils.js"));i.utils=C,Object.keys(C).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(d,D)||D in i&&i[D]===C[D]||(i[D]=C[D])});var U=q(h("./src/draw.js"));i.draw=U,Object.keys(U).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(d,D)||D in i&&i[D]===U[D]||(i[D]=U[D])});var ee=q(h("./src/framebuffers.js"));i.framebuffers=ee,Object.keys(ee).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(d,D)||D in i&&i[D]===ee[D]||(i[D]=ee[D])});var R=q(h("./src/programs.js"));i.programs=R,Object.keys(R).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(d,D)||D in i&&i[D]===R[D]||(i[D]=R[D])});var $=q(h("./src/typedarrays.js"));i.typedarrays=$,Object.keys($).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(d,D)||D in i&&i[D]===$[D]||(i[D]=$[D])});var J=q(h("./src/vertex-arrays.js"));i.vertexArrays=J,Object.keys(J).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(d,D)||D in i&&i[D]===J[D]||(i[D]=J[D])});function z(D){if(typeof WeakMap!="function")return null;var be=new WeakMap,we=new WeakMap;return(z=function(We){return We?we:be})(D)}function q(D,be){if(!be&&D&&D.__esModule)return D;if(D===null||v(D)!="object"&&typeof D!="function")return{default:D};var we=z(be);if(we&&we.has(D))return we.get(D);var Me={__proto__:null},We=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var je in D)if(je!=="default"&&Object.prototype.hasOwnProperty.call(D,je)){var rt=We?Object.getOwnPropertyDescriptor(D,je):null;rt&&(rt.get||rt.set)?Object.defineProperty(Me,je,rt):Me[je]=D[je]}return Me.default=D,we&&we.set(D,Me),Me}var ie={addExtensionsToContext:!0};function se(D){b.copyExistingProperties(D,ie),g.setAttributeDefaults_(D),_.setTextureDefaults_(D)}var De=/^(.*?)_/;function Se(D,be){C.glEnumToString(D,0);var we=D.getExtension(be);if(we){var Me={},We=De.exec(be)[1],je="_"+We;for(var rt in we){var Qe=we[rt],mt=typeof Qe=="function",Ft=mt?We:je,yt=rt;rt.endsWith(Ft)&&(yt=rt.substring(0,rt.length-Ft.length)),D[yt]!==void 0?!mt&&D[yt]!==Qe&&b.warn(yt,D[yt],Qe,rt):mt?D[yt]=function(lt){return function(){return lt.apply(we,arguments)}}(Qe):(D[yt]=Qe,Me[yt]=Qe)}Me.constructor={name:we.constructor.name},C.glEnumToString(Me,0)}return we}var st=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_depth_texture","WEBGL_draw_buffers"];function ot(D){for(var be=0;be<st.length;++be)Se(D,st[be])}function He(D,be){for(var we=["webgl","experimental-webgl"],Me=null,We=0;We<we.length;++We)if(Me=D.getContext(we[We],be),Me){ie.addExtensionsToContext&&ot(Me);break}return Me}function ge(D,be){var we=He(D,be);return we}function G(D,be){for(var we=["webgl2","webgl","experimental-webgl"],Me=null,We=0;We<we.length;++We)if(Me=D.getContext(we[We],be),Me){ie.addExtensionsToContext&&ot(Me);break}return Me}function V(D,be){var we=G(D,be);return we}function Z(D,be){be=be||1,be=Math.max(0,be);var we=D.clientWidth*be|0,Me=D.clientHeight*be|0;return D.width!==we||D.height!==Me?(D.width=we,D.height=Me,!0):!1}},"./src/typedarrays.js":(u,i)=>{i.__esModule=!0,i.getGLTypeForTypedArray=st,i.getGLTypeForTypedArrayType=ot,i.getTypedArrayTypeForGLType=He,i.isArrayBuffer=void 0;var h=5120,v=5121,d=5122,g=5123,_=5124,b=5125,C=5126,U=32819,ee=32820,R=33635,$=5131,J=33640,z=35899,q=35902,ie=36269,se=34042,De={};{var Se=De;Se[h]=Int8Array,Se[v]=Uint8Array,Se[d]=Int16Array,Se[g]=Uint16Array,Se[_]=Int32Array,Se[b]=Uint32Array,Se[C]=Float32Array,Se[U]=Uint16Array,Se[ee]=Uint16Array,Se[R]=Uint16Array,Se[$]=Uint16Array,Se[J]=Uint32Array,Se[z]=Uint32Array,Se[q]=Uint32Array,Se[ie]=Uint32Array,Se[se]=Uint32Array}function st(ge){if(ge instanceof Int8Array)return h;if(ge instanceof Uint8Array||ge instanceof Uint8ClampedArray)return v;if(ge instanceof Int16Array)return d;if(ge instanceof Uint16Array)return g;if(ge instanceof Int32Array)return _;if(ge instanceof Uint32Array)return b;if(ge instanceof Float32Array)return C;throw new Error("unsupported typed array type")}function ot(ge){if(ge===Int8Array)return h;if(ge===Uint8Array||ge===Uint8ClampedArray)return v;if(ge===Int16Array)return d;if(ge===Uint16Array)return g;if(ge===Int32Array)return _;if(ge===Uint32Array)return b;if(ge===Float32Array)return C;throw new Error("unsupported typed array type")}function He(ge){var G=De[ge];if(!G)throw new Error("unknown gl type");return G}i.isArrayBuffer=typeof SharedArrayBuffer<"u"?function(G){return G&&G.buffer&&(G.buffer instanceof ArrayBuffer||G.buffer instanceof SharedArrayBuffer)}:function(G){return G&&G.buffer&&G.buffer instanceof ArrayBuffer}},"./src/utils.js":(u,i)=>{i.__esModule=!0,i.glEnumToString=void 0,i.isWebGL1=v,i.isWebGL2=h;function h(d){return!!d.texStorage2D}function v(d){return!d.texStorage2D}i.glEnumToString=function(){var d={},g={};function _(b){var C=b.constructor.name;if(!d[C]){for(var U in b)if(typeof b[U]=="number"){var ee=g[b[U]];g[b[U]]=ee?"".concat(ee," | ").concat(U):U}d[C]=!0}}return function(C,U){return _(C),g[U]||(typeof U=="number"?"0x".concat(U.toString(16)):U)}}()},"./src/v3.js":(u,i)=>{i.__esModule=!0,i.add=g,i.copy=ot,i.create=d,i.cross=J,i.distance=se,i.distanceSq=De,i.divScalar=$,i.divide=ge,i.dot=z,i.length=q,i.lengthSq=ie,i.lerp=b,i.lerpV=C,i.max=U,i.min=ee,i.mulScalar=R,i.multiply=He,i.negate=st,i.normalize=Se,i.setDefaultType=v,i.subtract=_;var h=Float32Array;function v(G){var V=h;return h=G,V}function d(G,V,Z){var D=new h(3);return G&&(D[0]=G),V&&(D[1]=V),Z&&(D[2]=Z),D}function g(G,V,Z){return Z=Z||new h(3),Z[0]=G[0]+V[0],Z[1]=G[1]+V[1],Z[2]=G[2]+V[2],Z}function _(G,V,Z){return Z=Z||new h(3),Z[0]=G[0]-V[0],Z[1]=G[1]-V[1],Z[2]=G[2]-V[2],Z}function b(G,V,Z,D){return D=D||new h(3),D[0]=G[0]+Z*(V[0]-G[0]),D[1]=G[1]+Z*(V[1]-G[1]),D[2]=G[2]+Z*(V[2]-G[2]),D}function C(G,V,Z,D){return D=D||new h(3),D[0]=G[0]+Z[0]*(V[0]-G[0]),D[1]=G[1]+Z[1]*(V[1]-G[1]),D[2]=G[2]+Z[2]*(V[2]-G[2]),D}function U(G,V,Z){return Z=Z||new h(3),Z[0]=Math.max(G[0],V[0]),Z[1]=Math.max(G[1],V[1]),Z[2]=Math.max(G[2],V[2]),Z}function ee(G,V,Z){return Z=Z||new h(3),Z[0]=Math.min(G[0],V[0]),Z[1]=Math.min(G[1],V[1]),Z[2]=Math.min(G[2],V[2]),Z}function R(G,V,Z){return Z=Z||new h(3),Z[0]=G[0]*V,Z[1]=G[1]*V,Z[2]=G[2]*V,Z}function $(G,V,Z){return Z=Z||new h(3),Z[0]=G[0]/V,Z[1]=G[1]/V,Z[2]=G[2]/V,Z}function J(G,V,Z){Z=Z||new h(3);var D=G[2]*V[0]-G[0]*V[2],be=G[0]*V[1]-G[1]*V[0];return Z[0]=G[1]*V[2]-G[2]*V[1],Z[1]=D,Z[2]=be,Z}function z(G,V){return G[0]*V[0]+G[1]*V[1]+G[2]*V[2]}function q(G){return Math.sqrt(G[0]*G[0]+G[1]*G[1]+G[2]*G[2])}function ie(G){return G[0]*G[0]+G[1]*G[1]+G[2]*G[2]}function se(G,V){var Z=G[0]-V[0],D=G[1]-V[1],be=G[2]-V[2];return Math.sqrt(Z*Z+D*D+be*be)}function De(G,V){var Z=G[0]-V[0],D=G[1]-V[1],be=G[2]-V[2];return Z*Z+D*D+be*be}function Se(G,V){V=V||new h(3);var Z=G[0]*G[0]+G[1]*G[1]+G[2]*G[2],D=Math.sqrt(Z);return D>1e-5?(V[0]=G[0]/D,V[1]=G[1]/D,V[2]=G[2]/D):(V[0]=0,V[1]=0,V[2]=0),V}function st(G,V){return V=V||new h(3),V[0]=-G[0],V[1]=-G[1],V[2]=-G[2],V}function ot(G,V){return V=V||new h(3),V[0]=G[0],V[1]=G[1],V[2]=G[2],V}function He(G,V,Z){return Z=Z||new h(3),Z[0]=G[0]*V[0],Z[1]=G[1]*V[1],Z[2]=G[2]*V[2],Z}function ge(G,V,Z){return Z=Z||new h(3),Z[0]=G[0]/V[0],Z[1]=G[1]/V[1],Z[2]=G[2]/V[2],Z}},"./src/vertex-arrays.js":(u,i,h)=>{function v(R){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $},v(R)}i.__esModule=!0,i.createVAOAndSetAttributes=U,i.createVAOFromBufferInfo=ee,i.createVertexArrayInfo=C;var d=_(h("./src/programs.js"));function g(R){if(typeof WeakMap!="function")return null;var $=new WeakMap,J=new WeakMap;return(g=function(q){return q?J:$})(R)}function _(R,$){if(!$&&R&&R.__esModule)return R;if(R===null||v(R)!="object"&&typeof R!="function")return{default:R};var J=g($);if(J&&J.has(R))return J.get(R);var z={__proto__:null},q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ie in R)if(ie!=="default"&&Object.prototype.hasOwnProperty.call(R,ie)){var se=q?Object.getOwnPropertyDescriptor(R,ie):null;se&&(se.get||se.set)?Object.defineProperty(z,ie,se):z[ie]=R[ie]}return z.default=R,J&&J.set(R,z),z}var b=34963;function C(R,$,J){var z=R.createVertexArray();return R.bindVertexArray(z),$.length||($=[$]),$.forEach(function(q){d.setBuffersAndAttributes(R,q,J)}),R.bindVertexArray(null),{numElements:J.numElements,elementType:J.elementType,vertexArrayObject:z}}function U(R,$,J,z){var q=R.createVertexArray();return R.bindVertexArray(q),d.setAttributes($,J),z&&R.bindBuffer(b,z),R.bindVertexArray(null),q}function ee(R,$,J){return U(R,$.attribSetters||$,J.attribs,J.indices)}}},r={};function n(u){var i=r[u];if(i!==void 0)return i.exports;var h=r[u]={exports:{}};return t[u](h,h.exports,n),h.exports}var a=n("./src/twgl-full.js");return a})())})(Fs);var Er=Fs.exports;/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Cs="162",Rs=300,Za=1e3,Ti=1001,Ja=1002,es=1003,uo=1006,co=1008,ho=1009,lo=1014,fo=1020,mo=1023,la=1026,ts=1027,Ps="",Ar="srgb",Oa="srgb-linear",yo="display-p3",Ns="display-p3-linear",Aa="linear",rs="srgb",ns="rec709",is="p3",po=515,Ei=2e3,as=2001;class za{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const n=this._listeners[e];if(n!==void 0){const a=n.indexOf(t);a!==-1&&n.splice(a,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const n=r.slice(0);for(let a=0,u=n.length;a<u;a++)n[a].call(this,e);e.target=null}}}const Pt=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let ss=1234567;const Ds=Math.PI/180,Is=180/Math.PI;function Wi(){const c=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Pt[c&255]+Pt[c>>8&255]+Pt[c>>16&255]+Pt[c>>24&255]+"-"+Pt[e&255]+Pt[e>>8&255]+"-"+Pt[e>>16&15|64]+Pt[e>>24&255]+"-"+Pt[t&63|128]+Pt[t>>8&255]+"-"+Pt[t>>16&255]+Pt[t>>24&255]+Pt[r&255]+Pt[r>>8&255]+Pt[r>>16&255]+Pt[r>>24&255]).toLowerCase()}function Ot(c,e,t){return Math.max(e,Math.min(t,c))}function Ua(c,e){return(c%e+e)%e}function vo(c,e,t,r,n){return r+(c-e)*(n-r)/(t-e)}function xo(c,e,t){return c!==e?(t-c)/(e-c):0}function Wn(c,e,t){return(1-t)*c+t*e}function go(c,e,t,r){return Wn(c,e,1-Math.exp(-t*r))}function bo(c,e=1){return e-Math.abs(Ua(c,e*2)-e)}function To(c,e,t){return c<=e?0:c>=t?1:(c=(c-e)/(t-e),c*c*(3-2*c))}function Eo(c,e,t){return c<=e?0:c>=t?1:(c=(c-e)/(t-e),c*c*c*(c*(c*6-15)+10))}function _o(c,e){return c+Math.floor(Math.random()*(e-c+1))}function wo(c,e){return c+Math.random()*(e-c)}function Ao(c){return c*(.5-Math.random())}function So(c){c!==void 0&&(ss=c);let e=ss+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Mo(c){return c*Ds}function Fo(c){return c*Is}function Co(c){return(c&c-1)===0&&c!==0}function Ro(c){return Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))}function Po(c){return Math.pow(2,Math.floor(Math.log(c)/Math.LN2))}function No(c,e,t,r,n){const a=Math.cos,u=Math.sin,i=a(t/2),h=u(t/2),v=a((e+r)/2),d=u((e+r)/2),g=a((e-r)/2),_=u((e-r)/2),b=a((r-e)/2),C=u((r-e)/2);switch(n){case"XYX":c.set(i*d,h*g,h*_,i*v);break;case"YZY":c.set(h*_,i*d,h*g,i*v);break;case"ZXZ":c.set(h*g,h*_,i*d,i*v);break;case"XZX":c.set(i*d,h*C,h*b,i*v);break;case"YXY":c.set(h*b,i*d,h*C,i*v);break;case"ZYZ":c.set(h*C,h*b,i*d,i*v);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function Do(c,e){switch(e.constructor){case Float32Array:return c;case Uint32Array:return c/4294967295;case Uint16Array:return c/65535;case Uint8Array:return c/255;case Int32Array:return Math.max(c/2147483647,-1);case Int16Array:return Math.max(c/32767,-1);case Int8Array:return Math.max(c/127,-1);default:throw new Error("Invalid component type.")}}function Io(c,e){switch(e.constructor){case Float32Array:return c;case Uint32Array:return Math.round(c*4294967295);case Uint16Array:return Math.round(c*65535);case Uint8Array:return Math.round(c*255);case Int32Array:return Math.round(c*2147483647);case Int16Array:return Math.round(c*32767);case Int8Array:return Math.round(c*127);default:throw new Error("Invalid component type.")}}const Bo={DEG2RAD:Ds,RAD2DEG:Is,generateUUID:Wi,clamp:Ot,euclideanModulo:Ua,mapLinear:vo,inverseLerp:xo,lerp:Wn,damp:go,pingpong:bo,smoothstep:To,smootherstep:Eo,randInt:_o,randFloat:wo,randFloatSpread:Ao,seededRandom:So,degToRad:Mo,radToDeg:Fo,isPowerOfTwo:Co,ceilPowerOfTwo:Ro,floorPowerOfTwo:Po,setQuaternionFromProperEuler:No,normalize:Io,denormalize:Do};class dn{constructor(e=0,t=0){dn.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Ot(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),n=Math.sin(t),a=this.x-e.x,u=this.y-e.y;return this.x=a*r-u*n+e.x,this.y=a*n+u*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Dr{constructor(e,t,r,n,a,u,i,h,v){Dr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,n,a,u,i,h,v)}set(e,t,r,n,a,u,i,h,v){const d=this.elements;return d[0]=e,d[1]=n,d[2]=i,d[3]=t,d[4]=a,d[5]=h,d[6]=r,d[7]=u,d[8]=v,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,n=t.elements,a=this.elements,u=r[0],i=r[3],h=r[6],v=r[1],d=r[4],g=r[7],_=r[2],b=r[5],C=r[8],U=n[0],ee=n[3],R=n[6],$=n[1],J=n[4],z=n[7],q=n[2],ie=n[5],se=n[8];return a[0]=u*U+i*$+h*q,a[3]=u*ee+i*J+h*ie,a[6]=u*R+i*z+h*se,a[1]=v*U+d*$+g*q,a[4]=v*ee+d*J+g*ie,a[7]=v*R+d*z+g*se,a[2]=_*U+b*$+C*q,a[5]=_*ee+b*J+C*ie,a[8]=_*R+b*z+C*se,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],n=e[2],a=e[3],u=e[4],i=e[5],h=e[6],v=e[7],d=e[8];return t*u*d-t*i*v-r*a*d+r*i*h+n*a*v-n*u*h}invert(){const e=this.elements,t=e[0],r=e[1],n=e[2],a=e[3],u=e[4],i=e[5],h=e[6],v=e[7],d=e[8],g=d*u-i*v,_=i*h-d*a,b=v*a-u*h,C=t*g+r*_+n*b;if(C===0)return this.set(0,0,0,0,0,0,0,0,0);const U=1/C;return e[0]=g*U,e[1]=(n*v-d*r)*U,e[2]=(i*r-n*u)*U,e[3]=_*U,e[4]=(d*t-n*h)*U,e[5]=(n*a-i*t)*U,e[6]=b*U,e[7]=(r*h-v*t)*U,e[8]=(u*t-r*a)*U,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,n,a,u,i){const h=Math.cos(a),v=Math.sin(a);return this.set(r*h,r*v,-r*(h*u+v*i)+u+e,-n*v,n*h,-n*(-v*u+h*i)+i+t,0,0,1),this}scale(e,t){return this.premultiply(fa.makeScale(e,t)),this}rotate(e){return this.premultiply(fa.makeRotation(-e)),this}translate(e,t){return this.premultiply(fa.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let n=0;n<9;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const fa=new Dr;function os(c){return document.createElementNS("http://www.w3.org/1999/xhtml",c)}const us=new Dr().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),cs=new Dr().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),_i={[Oa]:{transfer:Aa,primaries:ns,toReference:c=>c,fromReference:c=>c},[Ar]:{transfer:rs,primaries:ns,toReference:c=>c.convertSRGBToLinear(),fromReference:c=>c.convertLinearToSRGB()},[Ns]:{transfer:Aa,primaries:is,toReference:c=>c.applyMatrix3(cs),fromReference:c=>c.applyMatrix3(us)},[yo]:{transfer:rs,primaries:is,toReference:c=>c.convertSRGBToLinear().applyMatrix3(cs),fromReference:c=>c.applyMatrix3(us).convertLinearToSRGB()}},Lo=new Set([Oa,Ns]),$t={enabled:!0,_workingColorSpace:Oa,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(c){if(!Lo.has(c))throw new Error(`Unsupported working color space, "${c}".`);this._workingColorSpace=c},convert:function(c,e,t){if(this.enabled===!1||e===t||!e||!t)return c;const r=_i[e].toReference,n=_i[t].fromReference;return n(r(c))},fromWorkingColorSpace:function(c,e){return this.convert(c,this._workingColorSpace,e)},toWorkingColorSpace:function(c,e){return this.convert(c,e,this._workingColorSpace)},getPrimaries:function(c){return _i[c].primaries},getTransfer:function(c){return c===Ps?Aa:_i[c].transfer}};function pn(c){return c<.04045?c*.0773993808:Math.pow(c*.9478672986+.0521327014,2.4)}function ma(c){return c<.0031308?c*12.92:1.055*Math.pow(c,.41666)-.055}let ln;class Oo{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{ln===void 0&&(ln=os("canvas")),ln.width=e.width,ln.height=e.height;const r=ln.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=ln}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=os("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const n=r.getImageData(0,0,e.width,e.height),a=n.data;for(let u=0;u<a.length;u++)a[u]=pn(a[u]/255)*255;return r.putImageData(n,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(pn(t[r]/255)*255):t[r]=pn(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let zo=0;class Uo{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:zo++}),this.uuid=Wi(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},n=this.data;if(n!==null){let a;if(Array.isArray(n)){a=[];for(let u=0,i=n.length;u<i;u++)n[u].isDataTexture?a.push(ya(n[u].image)):a.push(ya(n[u]))}else a=ya(n);r.url=a}return t||(e.images[this.uuid]=r),r}}function ya(c){return typeof HTMLImageElement<"u"&&c instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&c instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&c instanceof ImageBitmap?Oo.getDataURL(c):c.data?{data:Array.from(c.data),width:c.width,height:c.height,type:c.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let ko=0;class Nr extends za{constructor(e=Nr.DEFAULT_IMAGE,t=Nr.DEFAULT_MAPPING,r=Ti,n=Ti,a=uo,u=co,i=mo,h=ho,v=Nr.DEFAULT_ANISOTROPY,d=Ps){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:ko++}),this.uuid=Wi(),this.name="",this.source=new Uo(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=n,this.magFilter=a,this.minFilter=u,this.anisotropy=v,this.format=i,this.internalFormat=null,this.type=h,this.offset=new dn(0,0),this.repeat=new dn(1,1),this.center=new dn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Dr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=d,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Rs)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Za:e.x=e.x-Math.floor(e.x);break;case Ti:e.x=e.x<0?0:1;break;case Ja:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Za:e.y=e.y-Math.floor(e.y);break;case Ti:e.y=e.y<0?0:1;break;case Ja:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}Nr.DEFAULT_IMAGE=null;Nr.DEFAULT_MAPPING=Rs;Nr.DEFAULT_ANISOTROPY=1;class ka{constructor(e=0,t=0,r=0,n=1){ka.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,n=this.z,a=this.w,u=e.elements;return this.x=u[0]*t+u[4]*r+u[8]*n+u[12]*a,this.y=u[1]*t+u[5]*r+u[9]*n+u[13]*a,this.z=u[2]*t+u[6]*r+u[10]*n+u[14]*a,this.w=u[3]*t+u[7]*r+u[11]*n+u[15]*a,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,n,a;const h=e.elements,v=h[0],d=h[4],g=h[8],_=h[1],b=h[5],C=h[9],U=h[2],ee=h[6],R=h[10];if(Math.abs(d-_)<.01&&Math.abs(g-U)<.01&&Math.abs(C-ee)<.01){if(Math.abs(d+_)<.1&&Math.abs(g+U)<.1&&Math.abs(C+ee)<.1&&Math.abs(v+b+R-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const J=(v+1)/2,z=(b+1)/2,q=(R+1)/2,ie=(d+_)/4,se=(g+U)/4,De=(C+ee)/4;return J>z&&J>q?J<.01?(r=0,n=.707106781,a=.707106781):(r=Math.sqrt(J),n=ie/r,a=se/r):z>q?z<.01?(r=.707106781,n=0,a=.707106781):(n=Math.sqrt(z),r=ie/n,a=De/n):q<.01?(r=.707106781,n=.707106781,a=0):(a=Math.sqrt(q),r=se/a,n=De/a),this.set(r,n,a,t),this}let $=Math.sqrt((ee-C)*(ee-C)+(g-U)*(g-U)+(_-d)*(_-d));return Math.abs($)<.001&&($=1),this.x=(ee-C)/$,this.y=(g-U)/$,this.z=(_-d)/$,this.w=Math.acos((v+b+R-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class ei{constructor(e=0,t=0,r=0,n=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=n}static slerpFlat(e,t,r,n,a,u,i){let h=r[n+0],v=r[n+1],d=r[n+2],g=r[n+3];const _=a[u+0],b=a[u+1],C=a[u+2],U=a[u+3];if(i===0){e[t+0]=h,e[t+1]=v,e[t+2]=d,e[t+3]=g;return}if(i===1){e[t+0]=_,e[t+1]=b,e[t+2]=C,e[t+3]=U;return}if(g!==U||h!==_||v!==b||d!==C){let ee=1-i;const R=h*_+v*b+d*C+g*U,$=R>=0?1:-1,J=1-R*R;if(J>Number.EPSILON){const q=Math.sqrt(J),ie=Math.atan2(q,R*$);ee=Math.sin(ee*ie)/q,i=Math.sin(i*ie)/q}const z=i*$;if(h=h*ee+_*z,v=v*ee+b*z,d=d*ee+C*z,g=g*ee+U*z,ee===1-i){const q=1/Math.sqrt(h*h+v*v+d*d+g*g);h*=q,v*=q,d*=q,g*=q}}e[t]=h,e[t+1]=v,e[t+2]=d,e[t+3]=g}static multiplyQuaternionsFlat(e,t,r,n,a,u){const i=r[n],h=r[n+1],v=r[n+2],d=r[n+3],g=a[u],_=a[u+1],b=a[u+2],C=a[u+3];return e[t]=i*C+d*g+h*b-v*_,e[t+1]=h*C+d*_+v*g-i*b,e[t+2]=v*C+d*b+i*_-h*g,e[t+3]=d*C-i*g-h*_-v*b,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const r=e._x,n=e._y,a=e._z,u=e._order,i=Math.cos,h=Math.sin,v=i(r/2),d=i(n/2),g=i(a/2),_=h(r/2),b=h(n/2),C=h(a/2);switch(u){case"XYZ":this._x=_*d*g+v*b*C,this._y=v*b*g-_*d*C,this._z=v*d*C+_*b*g,this._w=v*d*g-_*b*C;break;case"YXZ":this._x=_*d*g+v*b*C,this._y=v*b*g-_*d*C,this._z=v*d*C-_*b*g,this._w=v*d*g+_*b*C;break;case"ZXY":this._x=_*d*g-v*b*C,this._y=v*b*g+_*d*C,this._z=v*d*C+_*b*g,this._w=v*d*g-_*b*C;break;case"ZYX":this._x=_*d*g-v*b*C,this._y=v*b*g+_*d*C,this._z=v*d*C-_*b*g,this._w=v*d*g+_*b*C;break;case"YZX":this._x=_*d*g+v*b*C,this._y=v*b*g+_*d*C,this._z=v*d*C-_*b*g,this._w=v*d*g-_*b*C;break;case"XZY":this._x=_*d*g-v*b*C,this._y=v*b*g-_*d*C,this._z=v*d*C+_*b*g,this._w=v*d*g+_*b*C;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+u)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],n=t[4],a=t[8],u=t[1],i=t[5],h=t[9],v=t[2],d=t[6],g=t[10],_=r+i+g;if(_>0){const b=.5/Math.sqrt(_+1);this._w=.25/b,this._x=(d-h)*b,this._y=(a-v)*b,this._z=(u-n)*b}else if(r>i&&r>g){const b=2*Math.sqrt(1+r-i-g);this._w=(d-h)/b,this._x=.25*b,this._y=(n+u)/b,this._z=(a+v)/b}else if(i>g){const b=2*Math.sqrt(1+i-r-g);this._w=(a-v)/b,this._x=(n+u)/b,this._y=.25*b,this._z=(h+d)/b}else{const b=2*Math.sqrt(1+g-r-i);this._w=(u-n)/b,this._x=(a+v)/b,this._y=(h+d)/b,this._z=.25*b}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ot(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const n=Math.min(1,t/r);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,n=e._y,a=e._z,u=e._w,i=t._x,h=t._y,v=t._z,d=t._w;return this._x=r*d+u*i+n*v-a*h,this._y=n*d+u*h+a*i-r*v,this._z=a*d+u*v+r*h-n*i,this._w=u*d-r*i-n*h-a*v,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,n=this._y,a=this._z,u=this._w;let i=u*e._w+r*e._x+n*e._y+a*e._z;if(i<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,i=-i):this.copy(e),i>=1)return this._w=u,this._x=r,this._y=n,this._z=a,this;const h=1-i*i;if(h<=Number.EPSILON){const b=1-t;return this._w=b*u+t*this._w,this._x=b*r+t*this._x,this._y=b*n+t*this._y,this._z=b*a+t*this._z,this.normalize(),this}const v=Math.sqrt(h),d=Math.atan2(v,i),g=Math.sin((1-t)*d)/v,_=Math.sin(t*d)/v;return this._w=u*g+this._w*_,this._x=r*g+this._x*_,this._y=n*g+this._y*_,this._z=a*g+this._z*_,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),r=Math.random(),n=Math.sqrt(1-r),a=Math.sqrt(r);return this.set(n*Math.sin(e),n*Math.cos(e),a*Math.sin(t),a*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class gt{constructor(e=0,t=0,r=0){gt.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(hs.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(hs.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,n=this.z,a=e.elements;return this.x=a[0]*t+a[3]*r+a[6]*n,this.y=a[1]*t+a[4]*r+a[7]*n,this.z=a[2]*t+a[5]*r+a[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,n=this.z,a=e.elements,u=1/(a[3]*t+a[7]*r+a[11]*n+a[15]);return this.x=(a[0]*t+a[4]*r+a[8]*n+a[12])*u,this.y=(a[1]*t+a[5]*r+a[9]*n+a[13])*u,this.z=(a[2]*t+a[6]*r+a[10]*n+a[14])*u,this}applyQuaternion(e){const t=this.x,r=this.y,n=this.z,a=e.x,u=e.y,i=e.z,h=e.w,v=2*(u*n-i*r),d=2*(i*t-a*n),g=2*(a*r-u*t);return this.x=t+h*v+u*g-i*d,this.y=r+h*d+i*v-a*g,this.z=n+h*g+a*d-u*v,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,n=this.z,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*n,this.y=a[1]*t+a[5]*r+a[9]*n,this.z=a[2]*t+a[6]*r+a[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,n=e.y,a=e.z,u=t.x,i=t.y,h=t.z;return this.x=n*h-a*i,this.y=a*u-r*h,this.z=r*i-n*u,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return da.copy(this).projectOnVector(e),this.sub(da)}reflect(e){return this.sub(da.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Ot(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,r=Math.sqrt(1-t*t);return this.x=r*Math.cos(e),this.y=t,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const da=new gt,hs=new ei;class ir{constructor(e,t,r,n,a,u,i,h,v,d,g,_,b,C,U,ee){ir.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,n,a,u,i,h,v,d,g,_,b,C,U,ee)}set(e,t,r,n,a,u,i,h,v,d,g,_,b,C,U,ee){const R=this.elements;return R[0]=e,R[4]=t,R[8]=r,R[12]=n,R[1]=a,R[5]=u,R[9]=i,R[13]=h,R[2]=v,R[6]=d,R[10]=g,R[14]=_,R[3]=b,R[7]=C,R[11]=U,R[15]=ee,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ir().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,n=1/fn.setFromMatrixColumn(e,0).length(),a=1/fn.setFromMatrixColumn(e,1).length(),u=1/fn.setFromMatrixColumn(e,2).length();return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=0,t[4]=r[4]*a,t[5]=r[5]*a,t[6]=r[6]*a,t[7]=0,t[8]=r[8]*u,t[9]=r[9]*u,t[10]=r[10]*u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,n=e.y,a=e.z,u=Math.cos(r),i=Math.sin(r),h=Math.cos(n),v=Math.sin(n),d=Math.cos(a),g=Math.sin(a);if(e.order==="XYZ"){const _=u*d,b=u*g,C=i*d,U=i*g;t[0]=h*d,t[4]=-h*g,t[8]=v,t[1]=b+C*v,t[5]=_-U*v,t[9]=-i*h,t[2]=U-_*v,t[6]=C+b*v,t[10]=u*h}else if(e.order==="YXZ"){const _=h*d,b=h*g,C=v*d,U=v*g;t[0]=_+U*i,t[4]=C*i-b,t[8]=u*v,t[1]=u*g,t[5]=u*d,t[9]=-i,t[2]=b*i-C,t[6]=U+_*i,t[10]=u*h}else if(e.order==="ZXY"){const _=h*d,b=h*g,C=v*d,U=v*g;t[0]=_-U*i,t[4]=-u*g,t[8]=C+b*i,t[1]=b+C*i,t[5]=u*d,t[9]=U-_*i,t[2]=-u*v,t[6]=i,t[10]=u*h}else if(e.order==="ZYX"){const _=u*d,b=u*g,C=i*d,U=i*g;t[0]=h*d,t[4]=C*v-b,t[8]=_*v+U,t[1]=h*g,t[5]=U*v+_,t[9]=b*v-C,t[2]=-v,t[6]=i*h,t[10]=u*h}else if(e.order==="YZX"){const _=u*h,b=u*v,C=i*h,U=i*v;t[0]=h*d,t[4]=U-_*g,t[8]=C*g+b,t[1]=g,t[5]=u*d,t[9]=-i*d,t[2]=-v*d,t[6]=b*g+C,t[10]=_-U*g}else if(e.order==="XZY"){const _=u*h,b=u*v,C=i*h,U=i*v;t[0]=h*d,t[4]=-g,t[8]=v*d,t[1]=_*g+U,t[5]=u*d,t[9]=b*g-C,t[2]=C*g-b,t[6]=i*d,t[10]=U*g+_}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Go,e,Wo)}lookAt(e,t,r){const n=this.elements;return Gt.subVectors(e,t),Gt.lengthSq()===0&&(Gt.z=1),Gt.normalize(),_r.crossVectors(r,Gt),_r.lengthSq()===0&&(Math.abs(r.z)===1?Gt.x+=1e-4:Gt.z+=1e-4,Gt.normalize(),_r.crossVectors(r,Gt)),_r.normalize(),wi.crossVectors(Gt,_r),n[0]=_r.x,n[4]=wi.x,n[8]=Gt.x,n[1]=_r.y,n[5]=wi.y,n[9]=Gt.y,n[2]=_r.z,n[6]=wi.z,n[10]=Gt.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,n=t.elements,a=this.elements,u=r[0],i=r[4],h=r[8],v=r[12],d=r[1],g=r[5],_=r[9],b=r[13],C=r[2],U=r[6],ee=r[10],R=r[14],$=r[3],J=r[7],z=r[11],q=r[15],ie=n[0],se=n[4],De=n[8],Se=n[12],st=n[1],ot=n[5],He=n[9],ge=n[13],G=n[2],V=n[6],Z=n[10],D=n[14],be=n[3],we=n[7],Me=n[11],We=n[15];return a[0]=u*ie+i*st+h*G+v*be,a[4]=u*se+i*ot+h*V+v*we,a[8]=u*De+i*He+h*Z+v*Me,a[12]=u*Se+i*ge+h*D+v*We,a[1]=d*ie+g*st+_*G+b*be,a[5]=d*se+g*ot+_*V+b*we,a[9]=d*De+g*He+_*Z+b*Me,a[13]=d*Se+g*ge+_*D+b*We,a[2]=C*ie+U*st+ee*G+R*be,a[6]=C*se+U*ot+ee*V+R*we,a[10]=C*De+U*He+ee*Z+R*Me,a[14]=C*Se+U*ge+ee*D+R*We,a[3]=$*ie+J*st+z*G+q*be,a[7]=$*se+J*ot+z*V+q*we,a[11]=$*De+J*He+z*Z+q*Me,a[15]=$*Se+J*ge+z*D+q*We,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],n=e[8],a=e[12],u=e[1],i=e[5],h=e[9],v=e[13],d=e[2],g=e[6],_=e[10],b=e[14],C=e[3],U=e[7],ee=e[11],R=e[15];return C*(+a*h*g-n*v*g-a*i*_+r*v*_+n*i*b-r*h*b)+U*(+t*h*b-t*v*_+a*u*_-n*u*b+n*v*d-a*h*d)+ee*(+t*v*g-t*i*b-a*u*g+r*u*b+a*i*d-r*v*d)+R*(-n*i*d-t*h*g+t*i*_+n*u*g-r*u*_+r*h*d)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],n=e[2],a=e[3],u=e[4],i=e[5],h=e[6],v=e[7],d=e[8],g=e[9],_=e[10],b=e[11],C=e[12],U=e[13],ee=e[14],R=e[15],$=g*ee*v-U*_*v+U*h*b-i*ee*b-g*h*R+i*_*R,J=C*_*v-d*ee*v-C*h*b+u*ee*b+d*h*R-u*_*R,z=d*U*v-C*g*v+C*i*b-u*U*b-d*i*R+u*g*R,q=C*g*h-d*U*h-C*i*_+u*U*_+d*i*ee-u*g*ee,ie=t*$+r*J+n*z+a*q;if(ie===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const se=1/ie;return e[0]=$*se,e[1]=(U*_*a-g*ee*a-U*n*b+r*ee*b+g*n*R-r*_*R)*se,e[2]=(i*ee*a-U*h*a+U*n*v-r*ee*v-i*n*R+r*h*R)*se,e[3]=(g*h*a-i*_*a-g*n*v+r*_*v+i*n*b-r*h*b)*se,e[4]=J*se,e[5]=(d*ee*a-C*_*a+C*n*b-t*ee*b-d*n*R+t*_*R)*se,e[6]=(C*h*a-u*ee*a-C*n*v+t*ee*v+u*n*R-t*h*R)*se,e[7]=(u*_*a-d*h*a+d*n*v-t*_*v-u*n*b+t*h*b)*se,e[8]=z*se,e[9]=(C*g*a-d*U*a-C*r*b+t*U*b+d*r*R-t*g*R)*se,e[10]=(u*U*a-C*i*a+C*r*v-t*U*v-u*r*R+t*i*R)*se,e[11]=(d*i*a-u*g*a-d*r*v+t*g*v+u*r*b-t*i*b)*se,e[12]=q*se,e[13]=(d*U*n-C*g*n+C*r*_-t*U*_-d*r*ee+t*g*ee)*se,e[14]=(C*i*n-u*U*n-C*r*h+t*U*h+u*r*ee-t*i*ee)*se,e[15]=(u*g*n-d*i*n+d*r*h-t*g*h-u*r*_+t*i*_)*se,this}scale(e){const t=this.elements,r=e.x,n=e.y,a=e.z;return t[0]*=r,t[4]*=n,t[8]*=a,t[1]*=r,t[5]*=n,t[9]*=a,t[2]*=r,t[6]*=n,t[10]*=a,t[3]*=r,t[7]*=n,t[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),n=Math.sin(t),a=1-r,u=e.x,i=e.y,h=e.z,v=a*u,d=a*i;return this.set(v*u+r,v*i-n*h,v*h+n*i,0,v*i+n*h,d*i+r,d*h-n*u,0,v*h-n*i,d*h+n*u,a*h*h+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,n,a,u){return this.set(1,r,a,0,e,1,u,0,t,n,1,0,0,0,0,1),this}compose(e,t,r){const n=this.elements,a=t._x,u=t._y,i=t._z,h=t._w,v=a+a,d=u+u,g=i+i,_=a*v,b=a*d,C=a*g,U=u*d,ee=u*g,R=i*g,$=h*v,J=h*d,z=h*g,q=r.x,ie=r.y,se=r.z;return n[0]=(1-(U+R))*q,n[1]=(b+z)*q,n[2]=(C-J)*q,n[3]=0,n[4]=(b-z)*ie,n[5]=(1-(_+R))*ie,n[6]=(ee+$)*ie,n[7]=0,n[8]=(C+J)*se,n[9]=(ee-$)*se,n[10]=(1-(_+U))*se,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,r){const n=this.elements;let a=fn.set(n[0],n[1],n[2]).length();const u=fn.set(n[4],n[5],n[6]).length(),i=fn.set(n[8],n[9],n[10]).length();this.determinant()<0&&(a=-a),e.x=n[12],e.y=n[13],e.z=n[14],Qt.copy(this);const v=1/a,d=1/u,g=1/i;return Qt.elements[0]*=v,Qt.elements[1]*=v,Qt.elements[2]*=v,Qt.elements[4]*=d,Qt.elements[5]*=d,Qt.elements[6]*=d,Qt.elements[8]*=g,Qt.elements[9]*=g,Qt.elements[10]*=g,t.setFromRotationMatrix(Qt),r.x=a,r.y=u,r.z=i,this}makePerspective(e,t,r,n,a,u,i=Ei){const h=this.elements,v=2*a/(t-e),d=2*a/(r-n),g=(t+e)/(t-e),_=(r+n)/(r-n);let b,C;if(i===Ei)b=-(u+a)/(u-a),C=-2*u*a/(u-a);else if(i===as)b=-u/(u-a),C=-u*a/(u-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+i);return h[0]=v,h[4]=0,h[8]=g,h[12]=0,h[1]=0,h[5]=d,h[9]=_,h[13]=0,h[2]=0,h[6]=0,h[10]=b,h[14]=C,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,t,r,n,a,u,i=Ei){const h=this.elements,v=1/(t-e),d=1/(r-n),g=1/(u-a),_=(t+e)*v,b=(r+n)*d;let C,U;if(i===Ei)C=(u+a)*g,U=-2*g;else if(i===as)C=a*g,U=-1*g;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+i);return h[0]=2*v,h[4]=0,h[8]=0,h[12]=-_,h[1]=0,h[5]=2*d,h[9]=0,h[13]=-b,h[2]=0,h[6]=0,h[10]=U,h[14]=-C,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let n=0;n<16;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const fn=new gt,Qt=new ir,Go=new gt(0,0,0),Wo=new gt(1,1,1),_r=new gt,wi=new gt,Gt=new gt,ls=new ir,fs=new ei;class ji{constructor(e=0,t=0,r=0,n=ji.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,n=this._order){return this._x=e,this._y=t,this._z=r,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const n=e.elements,a=n[0],u=n[4],i=n[8],h=n[1],v=n[5],d=n[9],g=n[2],_=n[6],b=n[10];switch(t){case"XYZ":this._y=Math.asin(Ot(i,-1,1)),Math.abs(i)<.9999999?(this._x=Math.atan2(-d,b),this._z=Math.atan2(-u,a)):(this._x=Math.atan2(_,v),this._z=0);break;case"YXZ":this._x=Math.asin(-Ot(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(i,b),this._z=Math.atan2(h,v)):(this._y=Math.atan2(-g,a),this._z=0);break;case"ZXY":this._x=Math.asin(Ot(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(-g,b),this._z=Math.atan2(-u,v)):(this._y=0,this._z=Math.atan2(h,a));break;case"ZYX":this._y=Math.asin(-Ot(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(_,b),this._z=Math.atan2(h,a)):(this._x=0,this._z=Math.atan2(-u,v));break;case"YZX":this._z=Math.asin(Ot(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-d,v),this._y=Math.atan2(-g,a)):(this._x=0,this._y=Math.atan2(i,b));break;case"XZY":this._z=Math.asin(-Ot(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(_,v),this._y=Math.atan2(i,a)):(this._x=Math.atan2(-d,b),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return ls.makeRotationFromQuaternion(e),this.setFromRotationMatrix(ls,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return fs.setFromEuler(this),this.setFromQuaternion(fs,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ji.DEFAULT_ORDER="XYZ";class jo{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Vo=0;const ms=new gt,mn=new ei,fr=new ir,Ai=new gt,Un=new gt,Xo=new gt,qo=new ei,ys=new gt(1,0,0),ds=new gt(0,1,0),ps=new gt(0,0,1),Ho={type:"added"},Yo={type:"removed"},pa={type:"childadded",child:null},va={type:"childremoved",child:null};class Vr extends za{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Vo++}),this.uuid=Wi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Vr.DEFAULT_UP.clone();const e=new gt,t=new ji,r=new ei,n=new gt(1,1,1);function a(){r.setFromEuler(t,!1)}function u(){t.setFromQuaternion(r,void 0,!1)}t._onChange(a),r._onChange(u),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new ir},normalMatrix:{value:new Dr}}),this.matrix=new ir,this.matrixWorld=new ir,this.matrixAutoUpdate=Vr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Vr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new jo,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return mn.setFromAxisAngle(e,t),this.quaternion.multiply(mn),this}rotateOnWorldAxis(e,t){return mn.setFromAxisAngle(e,t),this.quaternion.premultiply(mn),this}rotateX(e){return this.rotateOnAxis(ys,e)}rotateY(e){return this.rotateOnAxis(ds,e)}rotateZ(e){return this.rotateOnAxis(ps,e)}translateOnAxis(e,t){return ms.copy(e).applyQuaternion(this.quaternion),this.position.add(ms.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(ys,e)}translateY(e){return this.translateOnAxis(ds,e)}translateZ(e){return this.translateOnAxis(ps,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(fr.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?Ai.copy(e):Ai.set(e,t,r);const n=this.parent;this.updateWorldMatrix(!0,!1),Un.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?fr.lookAt(Un,Ai,this.up):fr.lookAt(Ai,Un,this.up),this.quaternion.setFromRotationMatrix(fr),n&&(fr.extractRotation(n.matrixWorld),mn.setFromRotationMatrix(fr),this.quaternion.premultiply(mn.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Ho),pa.child=e,this.dispatchEvent(pa),pa.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Yo),va.child=e,this.dispatchEvent(va),va.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),fr.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),fr.multiply(e.parent.matrixWorld)),e.applyMatrix4(fr),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,n=this.children.length;r<n;r++){const u=this.children[r].getObjectByProperty(e,t);if(u!==void 0)return u}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);const n=this.children;for(let a=0,u=n.length;a<u;a++)n[a].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Un,e,Xo),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Un,qo,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,n=t.length;r<n;r++){const a=t[r];(a.matrixWorldAutoUpdate===!0||e===!0)&&a.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const n=this.children;for(let a=0,u=n.length;a<u;a++){const i=n[a];i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),n.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(n.type="BatchedMesh",n.perObjectFrustumCulled=this.perObjectFrustumCulled,n.sortObjects=this.sortObjects,n.drawRanges=this._drawRanges,n.reservedRanges=this._reservedRanges,n.visibility=this._visibility,n.active=this._active,n.bounds=this._bounds.map(i=>({boxInitialized:i.boxInitialized,boxMin:i.box.min.toArray(),boxMax:i.box.max.toArray(),sphereInitialized:i.sphereInitialized,sphereRadius:i.sphere.radius,sphereCenter:i.sphere.center.toArray()})),n.maxGeometryCount=this._maxGeometryCount,n.maxVertexCount=this._maxVertexCount,n.maxIndexCount=this._maxIndexCount,n.geometryInitialized=this._geometryInitialized,n.geometryCount=this._geometryCount,n.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(n.boundingSphere={center:n.boundingSphere.center.toArray(),radius:n.boundingSphere.radius}),this.boundingBox!==null&&(n.boundingBox={min:n.boundingBox.min.toArray(),max:n.boundingBox.max.toArray()}));function a(i,h){return i[h.uuid]===void 0&&(i[h.uuid]=h.toJSON(e)),h.uuid}if(this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=a(e.geometries,this.geometry);const i=this.geometry.parameters;if(i!==void 0&&i.shapes!==void 0){const h=i.shapes;if(Array.isArray(h))for(let v=0,d=h.length;v<d;v++){const g=h[v];a(e.shapes,g)}else a(e.shapes,h)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const i=[];for(let h=0,v=this.material.length;h<v;h++)i.push(a(e.materials,this.material[h]));n.material=i}else n.material=a(e.materials,this.material);if(this.children.length>0){n.children=[];for(let i=0;i<this.children.length;i++)n.children.push(this.children[i].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let i=0;i<this.animations.length;i++){const h=this.animations[i];n.animations.push(a(e.animations,h))}}if(t){const i=u(e.geometries),h=u(e.materials),v=u(e.textures),d=u(e.images),g=u(e.shapes),_=u(e.skeletons),b=u(e.animations),C=u(e.nodes);i.length>0&&(r.geometries=i),h.length>0&&(r.materials=h),v.length>0&&(r.textures=v),d.length>0&&(r.images=d),g.length>0&&(r.shapes=g),_.length>0&&(r.skeletons=_),b.length>0&&(r.animations=b),C.length>0&&(r.nodes=C)}return r.object=n,r;function u(i){const h=[];for(const v in i){const d=i[v];delete d.metadata,h.push(d)}return h}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const n=e.children[r];this.add(n.clone())}return this}}Vr.DEFAULT_UP=new gt(0,1,0);Vr.DEFAULT_MATRIX_AUTO_UPDATE=!0;Vr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Bs={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},wr={h:0,s:0,l:0},Si={h:0,s:0,l:0};function xa(c,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?c+(e-c)*6*t:t<1/2?e:t<2/3?c+(e-c)*6*(2/3-t):c}class Ga{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(t===void 0&&r===void 0){const n=e;n&&n.isColor?this.copy(n):typeof n=="number"?this.setHex(n):typeof n=="string"&&this.setStyle(n)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Ar){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,$t.toWorkingColorSpace(this,t),this}setRGB(e,t,r,n=$t.workingColorSpace){return this.r=e,this.g=t,this.b=r,$t.toWorkingColorSpace(this,n),this}setHSL(e,t,r,n=$t.workingColorSpace){if(e=Ua(e,1),t=Ot(t,0,1),r=Ot(r,0,1),t===0)this.r=this.g=this.b=r;else{const a=r<=.5?r*(1+t):r+t-r*t,u=2*r-a;this.r=xa(u,a,e+1/3),this.g=xa(u,a,e),this.b=xa(u,a,e-1/3)}return $t.toWorkingColorSpace(this,n),this}setStyle(e,t=Ar){function r(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const u=n[1],i=n[2];switch(u){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return r(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,t);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return r(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,t);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return r(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=n[1],u=a.length;if(u===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,t);if(u===6)return this.setHex(parseInt(a,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Ar){const r=Bs[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=pn(e.r),this.g=pn(e.g),this.b=pn(e.b),this}copyLinearToSRGB(e){return this.r=ma(e.r),this.g=ma(e.g),this.b=ma(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ar){return $t.fromWorkingColorSpace(Nt.copy(this),e),Math.round(Ot(Nt.r*255,0,255))*65536+Math.round(Ot(Nt.g*255,0,255))*256+Math.round(Ot(Nt.b*255,0,255))}getHexString(e=Ar){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=$t.workingColorSpace){$t.fromWorkingColorSpace(Nt.copy(this),t);const r=Nt.r,n=Nt.g,a=Nt.b,u=Math.max(r,n,a),i=Math.min(r,n,a);let h,v;const d=(i+u)/2;if(i===u)h=0,v=0;else{const g=u-i;switch(v=d<=.5?g/(u+i):g/(2-u-i),u){case r:h=(n-a)/g+(n<a?6:0);break;case n:h=(a-r)/g+2;break;case a:h=(r-n)/g+4;break}h/=6}return e.h=h,e.s=v,e.l=d,e}getRGB(e,t=$t.workingColorSpace){return $t.fromWorkingColorSpace(Nt.copy(this),t),e.r=Nt.r,e.g=Nt.g,e.b=Nt.b,e}getStyle(e=Ar){$t.fromWorkingColorSpace(Nt.copy(this),e);const t=Nt.r,r=Nt.g,n=Nt.b;return e!==Ar?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${n.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(r*255)},${Math.round(n*255)})`}offsetHSL(e,t,r){return this.getHSL(wr),this.setHSL(wr.h+e,wr.s+t,wr.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(wr),e.getHSL(Si);const r=Wn(wr.h,Si.h,t),n=Wn(wr.s,Si.s,t),a=Wn(wr.l,Si.l,t);return this.setHSL(r,n,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,n=this.b,a=e.elements;return this.r=a[0]*t+a[3]*r+a[6]*n,this.g=a[1]*t+a[4]*r+a[7]*n,this.b=a[2]*t+a[5]*r+a[8]*n,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Nt=new Ga;Ga.NAMES=Bs;class Ko extends Nr{constructor(e,t,r,n,a,u,i,h,v,d){if(d=d!==void 0?d:la,d!==la&&d!==ts)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&d===la&&(r=lo),r===void 0&&d===ts&&(r=fo),super(null,n,a,u,i,h,d,r,v),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=i!==void 0?i:es,this.minFilter=h!==void 0?h:es,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const $o=new Ko(1,1);$o.compareFunction=po;typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Cs}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Cs);const vs={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},Wa=["x","y","z","w"];function Qo(c){let e="{";c.isNode===!0&&(e+=c.id);for(const{property:t,childNode:r}of Sa(c))e+=","+t.slice(0,-4)+":"+r.getCacheKey();return e+="}",e}function*Sa(c,e=!1){for(const t in c){if(t.startsWith("_")===!0)continue;const r=c[t];if(Array.isArray(r)===!0)for(let n=0;n<r.length;n++){const a=r[n];a&&(a.isNode===!0||e&&typeof a.toJSON=="function")&&(yield{property:t,index:n,childNode:a})}else if(r&&r.isNode===!0)yield{property:t,childNode:r};else if(typeof r=="object")for(const n in r){const a=r[n];a&&(a.isNode===!0||e&&typeof a.toJSON=="function")&&(yield{property:t,index:n,childNode:a})}}}function Ma(c){if(c==null)return null;const e=typeof c;return c.isNode===!0?"node":e==="number"?"float":e==="boolean"?"bool":e==="string"?"string":e==="function"?"shader":c.isVector2===!0?"vec2":c.isVector3===!0?"vec3":c.isVector4===!0?"vec4":c.isMatrix3===!0?"mat3":c.isMatrix4===!0?"mat4":c.isColor===!0?"color":c instanceof ArrayBuffer?"ArrayBuffer":null}function Ls(c,...e){const t=c?c.slice(-4):void 0;return e.length===1&&(t==="vec2"?e=[e[0],e[0]]:t==="vec3"?e=[e[0],e[0],e[0]]:t==="vec4"&&(e=[e[0],e[0],e[0],e[0]])),c==="color"?new Ga(...e):t==="vec2"?new dn(...e):t==="vec3"?new gt(...e):t==="vec4"?new ka(...e):t==="mat3"?new Dr(...e):t==="mat4"?new ir(...e):c==="bool"?e[0]||!1:c==="float"||c==="int"||c==="uint"?e[0]||0:c==="string"?e[0]||"":c==="ArrayBuffer"?Jo(e[0]):null}function Zo(c){let e="";const t=new Uint8Array(c);for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return btoa(e)}function Jo(c){return Uint8Array.from(atob(c),e=>e.charCodeAt(0)).buffer}const xs=new Map;let eu=0;class qr extends za{constructor(e=null){super(),this.nodeType=e,this.updateType=vs.NONE,this.updateBeforeType=vs.NONE,this.uuid=Bo.generateUUID(),this.isNode=!0,Object.defineProperty(this,"id",{value:eu++})}get type(){return this.constructor.type}getSelf(){return this.self||this}setReference(){return this}isGlobal(){return!1}*getChildren(){for(const{childNode:e}of Sa(this))yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const t of this.getChildren())t.traverse(e)}getCacheKey(){return Qo(this)}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getNodeType(e){const t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}getShared(e){const t=this.getHash(e);return e.getNodeFromHash(t)||this}setup(e){const t=e.getNodeProperties(this);for(const r of this.getChildren())t["_node"+r.id]=r;return null}construct(e){return console.warn("THREE.Node: construct() is deprecated. Use setup() instead."),this.setup(e)}increaseUsage(e){const t=e.getDataFromNode(this);return t.usageCount=t.usageCount===void 0?1:t.usageCount+1,t.usageCount}analyze(e){if(this.increaseUsage(e)===1){const r=e.getNodeProperties(this);for(const n of Object.values(r))n&&n.isNode===!0&&n.build(e)}}generate(e,t){const{outputNode:r}=e.getNodeProperties(this);if(r&&r.isNode===!0)return r.build(e,t)}updateBefore(){console.warn("Abstract function.")}update(){console.warn("Abstract function.")}build(e,t=null){const r=this.getShared(e);if(this!==r)return r.build(e,t);e.addNode(this),e.addChain(this);let n=null;const a=e.getBuildStage();if(a==="setup"){this.setReference(e);const u=e.getNodeProperties(this);if(u.initialized!==!0||e.context.tempRead===!1){const i=e.stack.nodes.length;u.initialized=!0,u.outputNode=this.setup(e),u.outputNode!==null&&e.stack.nodes.length!==i&&(u.outputNode=e.stack);for(const h of Object.values(u))h&&h.isNode===!0&&h.build(e)}}else if(a==="analyze")this.analyze(e);else if(a==="generate")if(this.generate.length===1){const i=this.getNodeType(e),h=e.getDataFromNode(this);n=h.snippet,n===void 0&&(n=this.generate(e)||"",h.snippet=n),n=e.format(n,i,t)}else n=this.generate(e,t)||"";return e.removeChain(this),n}getSerializeChildren(){return Sa(this)}serialize(e){const t=this.getSerializeChildren(),r={};for(const{property:n,index:a,childNode:u}of t)a!==void 0?(r[n]===void 0&&(r[n]=Number.isInteger(a)?[]:{}),r[n][a]=u.toJSON(e.meta).uuid):r[n]=u.toJSON(e.meta).uuid;Object.keys(r).length>0&&(e.inputNodes=r)}deserialize(e){if(e.inputNodes!==void 0){const t=e.meta.nodes;for(const r in e.inputNodes)if(Array.isArray(e.inputNodes[r])){const n=[];for(const a of e.inputNodes[r])n.push(t[a]);this[r]=n}else if(typeof e.inputNodes[r]=="object"){const n={};for(const a in e.inputNodes[r]){const u=e.inputNodes[r][a];n[a]=t[u]}this[r]=n}else{const n=e.inputNodes[r];this[r]=t[n]}}}toJSON(e){const{uuid:t,type:r}=this,n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{},nodes:{}});let a=e.nodes[t];a===void 0&&(a={uuid:t,type:r,meta:e,metadata:{version:4.6,type:"Node",generator:"Node.toJSON"}},n!==!0&&(e.nodes[a.uuid]=a),this.serialize(a),delete a.meta);function u(i){const h=[];for(const v in i){const d=i[v];delete d.metadata,h.push(d)}return h}if(n){const i=u(e.textures),h=u(e.images),v=u(e.nodes);i.length>0&&(a.textures=i),h.length>0&&(a.images=h),v.length>0&&(a.nodes=v)}return a}}function qt(c,e){if(typeof e!="function"||!c)throw new Error(`Node class ${c} is not a class`);if(xs.has(c)){console.warn(`Redefinition of node class ${c}`);return}xs.set(c,e),e.type=c}class wn extends qr{constructor(e){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,t){if(e.getBuildStage()==="generate"){const n=e.getVectorType(this.getNodeType(e,t)),a=e.getDataFromNode(this);if(e.context.tempRead!==!1&&a.propertyName!==void 0)return e.format(a.propertyName,n,t);if(e.context.tempWrite!==!1&&n!=="void"&&t!=="void"&&this.hasDependencies(e)){const u=super.build(e,n),i=e.getVarFromNode(this,null,n),h=e.getPropertyName(i);return e.addLineFlowCode(`${h} = ${u}`),a.snippet=u,a.propertyName=h,e.format(a.propertyName,n,t)}}return super.build(e,t)}}qt("TempNode",wn);class ja extends qr{constructor(e,t){super(),this.node=e,this.indexNode=t,this.isArrayElementNode=!0}getNodeType(e){return this.node.getNodeType(e)}generate(e){const t=this.node.build(e),r=this.indexNode.build(e,"uint");return`${t}[ ${r} ]`}}qt("ArrayElementNode",ja);class Va extends qr{constructor(e,t){super(),this.node=e,this.convertTo=t}getNodeType(e){const t=this.node.getNodeType(e);let r=null;for(const n of this.convertTo.split("|"))(r===null||e.getTypeLength(t)===e.getTypeLength(n))&&(r=n);return r}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,t){const r=this.node,n=this.getNodeType(e),a=r.build(e,n);return e.format(a,n,t)}}qt("ConvertNode",Va);class Os extends wn{constructor(e=[],t=null){super(t),this.nodes=e}getNodeType(e){return this.nodeType!==null?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((t,r)=>t+e.getTypeLength(r.getNodeType(e)),0))}generate(e,t){const r=this.getNodeType(e),n=this.nodes,a=e.getComponentType(r),u=[];for(const h of n){let v=h.build(e);const d=e.getComponentType(h.getNodeType(e));d!==a&&(v=e.format(v,d,a)),u.push(v)}const i=`${e.getType(r)}( ${u.join(", ")} )`;return e.format(i,r,t)}}qt("JoinNode",Os);const tu=Wa.join("");class Fa extends qr{constructor(e,t="x"){super(),this.node=e,this.components=t,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const t of this.components)e=Math.max(Wa.indexOf(t)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}generate(e,t){const r=this.node,n=e.getTypeLength(r.getNodeType(e));let a=null;if(n>1){let u=null;this.getVectorLength()>=n&&(u=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const h=r.build(e,u);this.components.length===n&&this.components===tu.slice(0,this.components.length)?a=e.format(h,u,t):a=e.format(`${h}.${this.components}`,this.getNodeType(e),t)}else a=r.build(e,t);return a}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}qt("SplitNode",Fa);class zs extends wn{constructor(e,t,r){super(),this.sourceNode=e,this.components=t,this.targetNode=r}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:t,components:r,targetNode:n}=this,a=this.getNodeType(e),u=e.getTypeFromLength(r.length),i=n.build(e,u),h=t.build(e,a),v=e.getTypeLength(a),d=[];for(let g=0;g<v;g++){const _=Wa[g];_===r[0]?(d.push(i),g+=r.length-1):d.push(h+"."+_)}return`${e.getType(a)}( ${d.join(", ")} )`}}qt("SetNode",zs);class Us extends qr{constructor(e,t=null){super(t),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return this.nodeType===null?Ma(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=Ma(this.value),e.nodeType=this.nodeType,e.valueType==="ArrayBuffer"&&(e.value=Zo(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?Ls(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){console.warn("Abstract function.")}}qt("InputNode",Us);class Ht extends Us{constructor(e,t=null){super(e,t),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,t){const r=this.getNodeType(e);return e.format(this.generateConst(e),r,t)}}qt("ConstNode",Ht);let ru=null;const yn=new Map;function Q(c,e){if(yn.has(c)){console.warn(`Redefinition of node element ${c}`);return}if(typeof e!="function")throw new Error(`Node element ${c} is not a function`);yn.set(c,e)}const gs=c=>c.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),ks={setup(c,e){const t=e.shift();return c(Ya(t),...e)},get(c,e,t){if(typeof e=="string"&&c[e]===void 0){if(c.isStackNode!==!0&&e==="assign")return(...r)=>(ru.assign(t,...r),t);if(yn.has(e)){const r=yn.get(e);return c.isStackNode?(...n)=>t.add(r(...n)):(...n)=>r(t,...n)}else{if(e==="self")return c;if(e.endsWith("Assign")&&yn.has(e.slice(0,e.length-6))){const r=yn.get(e.slice(0,e.length-6));return c.isStackNode?(...n)=>t.assign(n[0],r(...n)):(...n)=>t.assign(r(t,...n))}else{if(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0)return e=gs(e),ct(new Fa(t,e));if(/^set[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=gs(e.slice(3).toLowerCase()),e=e.split("").sort().join(""),r=>ct(new zs(c,e,r));if(e==="width"||e==="height"||e==="depth")return e==="width"?e="x":e==="height"?e="y":e==="depth"&&(e="z"),ct(new Fa(c,e));if(/^\d+$/.test(e)===!0)return ct(new ja(t,new Ht(Number(e),"uint")))}}}return Reflect.get(c,e,t)},set(c,e,t,r){return typeof e=="string"&&c[e]===void 0&&(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0||e==="width"||e==="height"||e==="depth"||/^\d+$/.test(e)===!0)?(r[e].assign(t),!0):Reflect.set(c,e,t,r)}},ga=new WeakMap,bs=new WeakMap,nu=function(c,e=null){const t=Ma(c);if(t==="node"){let r=ga.get(c);return r===void 0&&(r=new Proxy(c,ks),ga.set(c,r),ga.set(r,r)),r}else{if(e===null&&(t==="float"||t==="boolean")||t&&t!=="shader"&&t!=="string")return ct(Ca(c,e));if(t==="shader")return ti(c)}return c},iu=function(c,e=null){for(const t in c)c[t]=ct(c[t],e);return c},au=function(c,e=null){const t=c.length;for(let r=0;r<t;r++)c[r]=ct(c[r],e);return c},su=function(c,e=null,t=null,r=null){const n=a=>ct(r!==null?Object.assign(a,r):a);return e===null?(...a)=>n(new c(...ba(a))):t!==null?(t=ct(t),(...a)=>n(new c(e,...ba(a),t))):(...a)=>n(new c(e,...ba(a)))};class ou extends qr{constructor(e,t){super(),this.shaderNode=e,this.inputNodes=t}getNodeType(e){const{outputNode:t}=e.getNodeProperties(this);return t?t.getNodeType(e):super.getNodeType(e)}call(e){const{shaderNode:t,inputNodes:r}=this;if(t.layout){let u=bs.get(e.constructor);u===void 0&&(u=new WeakMap,bs.set(e.constructor,u));let i=u.get(t);return i===void 0&&(i=ct(e.buildFunctionNode(t)),u.set(t,i)),e.currentFunctionNode!==null&&e.currentFunctionNode.includes.push(i),ct(i.call(r))}const n=t.jsFunc,a=r!==null?n(r,e.stack,e):n(e.stack,e);return ct(a)}setup(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}generate(e,t){const{outputNode:r}=e.getNodeProperties(this);return r===null?this.call(e).build(e,t):super.generate(e,t)}}class uu extends qr{constructor(e){super(),this.jsFunc=e,this.layout=null}get isArrayInput(){return/^\((\s+)?\[/.test(this.jsFunc.toString())}setLayout(e){return this.layout=e,this}call(e=null){return Ya(e),ct(new ou(this,e))}setup(){return this.call()}}const cu=[!1,!0],hu=[0,1,2,3],lu=[-1,-2],Gs=[.5,1.5,1/3,1e-6,1e6,Math.PI,Math.PI*2,1/Math.PI,2/Math.PI,1/(Math.PI*2),Math.PI/2],Xa=new Map;for(const c of cu)Xa.set(c,new Ht(c));const qa=new Map;for(const c of hu)qa.set(c,new Ht(c,"uint"));const Ha=new Map([...qa].map(c=>new Ht(c.value,"int")));for(const c of lu)Ha.set(c,new Ht(c,"int"));const Vi=new Map([...Ha].map(c=>new Ht(c.value)));for(const c of Gs)Vi.set(c,new Ht(c));for(const c of Gs)Vi.set(-c,new Ht(-c));const Xi={bool:Xa,uint:qa,ints:Ha,float:Vi},Ts=new Map([...Xa,...Vi]),Ca=(c,e)=>Ts.has(c)?Ts.get(c):c.isNode===!0?c:new Ht(c,e),fu=c=>{try{return c.getNodeType()}catch{return}},it=function(c,e=null){return(...t)=>{if((t.length===0||!["bool","float","int","uint"].includes(c)&&t.every(n=>typeof n!="object"))&&(t=[Ls(c,...t)]),t.length===1&&e!==null&&e.has(t[0]))return ct(e.get(t[0]));if(t.length===1){const n=Ca(t[0],c);return fu(n)===c?ct(n):ct(new Va(n,c))}const r=t.map(n=>Ca(n));return ct(new Os(r,c))}};function Ws(c){return new Proxy(new uu(c),ks)}const ct=(c,e=null)=>nu(c,e),Ya=(c,e=null)=>new iu(c,e),ba=(c,e=null)=>new au(c,e),he=(...c)=>new su(...c),ti=c=>{const e=new Ws(c),t=(...r)=>{let n;return Ya(r),r[0]&&r[0].isNode?n=[...r]:n=r[0],e.call(n)};return t.shaderNode=e,t.setLayout=r=>(e.setLayout(r),t),t};qt("ShaderNode",Ws);function mu(c){return c}Q("append",mu);const yu=new it("color"),ri=new it("float",Xi.float),du=new it("int",Xi.int),pu=new it("uint",Xi.uint),vu=new it("bool",Xi.bool),xu=new it("vec2"),gu=new it("ivec2"),bu=new it("uvec2"),Tu=new it("bvec2"),Xr=new it("vec3"),Eu=new it("ivec3"),_u=new it("uvec3"),wu=new it("bvec3"),Ra=new it("vec4"),Au=new it("ivec4"),Su=new it("uvec4"),Mu=new it("bvec4"),Fu=new it("mat2"),Cu=new it("imat2"),Ru=new it("umat2"),Pu=new it("bmat2"),Nu=new it("mat3"),Du=new it("imat3"),Iu=new it("umat3"),Bu=new it("bmat3"),Lu=new it("mat4"),Ou=new it("imat4"),zu=new it("umat4"),Uu=new it("bmat4"),ku=(c="")=>ct(new Ht(c,"string")),Gu=c=>ct(new Ht(c,"ArrayBuffer"));Q("color",yu);Q("float",ri);Q("int",du);Q("uint",pu);Q("bool",vu);Q("vec2",xu);Q("ivec2",gu);Q("uvec2",bu);Q("bvec2",Tu);Q("vec3",Xr);Q("ivec3",Eu);Q("uvec3",_u);Q("bvec3",wu);Q("vec4",Ra);Q("ivec4",Au);Q("uvec4",Su);Q("bvec4",Mu);Q("mat2",Fu);Q("imat2",Cu);Q("umat2",Ru);Q("bmat2",Pu);Q("mat3",Nu);Q("imat3",Du);Q("umat3",Iu);Q("bmat3",Bu);Q("mat4",Lu);Q("imat4",Ou);Q("umat4",zu);Q("bmat4",Uu);Q("string",ku);Q("arrayBuffer",Gu);const Wu=he(ja),ju=(c,e)=>ct(new Va(ct(c),e));Q("element",Wu);Q("convert",ju);class ht extends wn{constructor(e,t,r,...n){if(super(),this.op=e,n.length>0){let a=r;for(let u=0;u<n.length;u++)a=new ht(e,a,n[u]);r=a}this.aNode=t,this.bNode=r}getNodeType(e,t){const r=this.op,n=this.aNode,a=this.bNode,u=n.getNodeType(e),i=typeof a<"u"?a.getNodeType(e):null;if(u==="void"||i==="void")return"void";if(r==="%")return u;if(r==="~"||r==="&"||r==="|"||r==="^"||r===">>"||r==="<<")return e.getIntegerType(u);if(r==="!"||r==="=="||r==="&&"||r==="||"||r==="^^")return"bool";if(r==="<"||r===">"||r==="<="||r===">="){const h=t?e.getTypeLength(t):Math.max(e.getTypeLength(u),e.getTypeLength(i));return h>1?`bvec${h}`:"bool"}else return u==="float"&&e.isMatrix(i)?i:e.isMatrix(u)&&e.isVector(i)?e.getVectorFromMatrix(u):e.isVector(u)&&e.isMatrix(i)?e.getVectorFromMatrix(i):e.getTypeLength(i)>e.getTypeLength(u)?i:u}generate(e,t){const r=this.op,n=this.aNode,a=this.bNode,u=this.getNodeType(e,t);let i=null,h=null;u!=="void"?(i=n.getNodeType(e),h=typeof a<"u"?a.getNodeType(e):null,r==="<"||r===">"||r==="<="||r===">="||r==="=="?e.isVector(i)?h=i:i=h="float":r===">>"||r==="<<"?(i=u,h=e.changeComponentType(h,"uint")):e.isMatrix(i)&&e.isVector(h)?h=e.getVectorFromMatrix(i):e.isVector(i)&&e.isMatrix(h)?i=e.getVectorFromMatrix(h):i=h=u):i=h=u;const v=n.build(e,i),d=typeof a<"u"?a.build(e,h):null,g=e.getTypeLength(t),_=e.getFunctionOperator(r);if(t!=="void")return r==="<"&&g>1?e.format(`${e.getMethod("lessThan")}( ${v}, ${d} )`,u,t):r==="<="&&g>1?e.format(`${e.getMethod("lessThanEqual")}( ${v}, ${d} )`,u,t):r===">"&&g>1?e.format(`${e.getMethod("greaterThan")}( ${v}, ${d} )`,u,t):r===">="&&g>1?e.format(`${e.getMethod("greaterThanEqual")}( ${v}, ${d} )`,u,t):r==="!"||r==="~"?e.format(`(${r}${v})`,i,t):_?e.format(`${_}( ${v}, ${d} )`,u,t):e.format(`( ${v} ${r} ${d} )`,u,t);if(i!=="void")return _?e.format(`${_}( ${v}, ${d} )`,u,t):e.format(`${v} ${r} ${d}`,u,t)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const Vu=he(ht,"+"),Pa=he(ht,"-"),Ka=he(ht,"*"),js=he(ht,"/"),Xu=he(ht,"%"),qu=he(ht,"=="),Hu=he(ht,"!="),Yu=he(ht,"<"),Ku=he(ht,">"),$u=he(ht,"<="),Qu=he(ht,">="),Zu=he(ht,"&&"),Ju=he(ht,"||"),ec=he(ht,"!"),tc=he(ht,"^^"),rc=he(ht,"&"),nc=he(ht,"~"),ic=he(ht,"|"),ac=he(ht,"^"),sc=he(ht,"<<"),oc=he(ht,">>");Q("add",Vu);Q("sub",Pa);Q("mul",Ka);Q("div",js);Q("remainder",Xu);Q("equal",qu);Q("notEqual",Hu);Q("lessThan",Yu);Q("greaterThan",Ku);Q("lessThanEqual",$u);Q("greaterThanEqual",Qu);Q("and",Zu);Q("or",Ju);Q("not",ec);Q("xor",tc);Q("bitAnd",rc);Q("bitNot",nc);Q("bitOr",ic);Q("bitXor",ac);Q("shiftLeft",sc);Q("shiftRight",oc);qt("OperatorNode",ht);class N extends wn{constructor(e,t,r=null,n=null){super(),this.method=e,this.aNode=t,this.bNode=r,this.cNode=n}getInputType(e){const t=this.aNode.getNodeType(e),r=this.bNode?this.bNode.getNodeType(e):null,n=this.cNode?this.cNode.getNodeType(e):null,a=e.isMatrix(t)?0:e.getTypeLength(t),u=e.isMatrix(r)?0:e.getTypeLength(r),i=e.isMatrix(n)?0:e.getTypeLength(n);return a>u&&a>i?t:u>i?r:i>a?n:t}getNodeType(e){const t=this.method;return t===N.LENGTH||t===N.DISTANCE||t===N.DOT?"float":t===N.CROSS?"vec3":t===N.ALL?"bool":t===N.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):t===N.MOD?this.aNode.getNodeType(e):this.getInputType(e)}generate(e,t){const r=this.method,n=this.getNodeType(e),a=this.getInputType(e),u=this.aNode,i=this.bNode,h=this.cNode,v=e.renderer.isWebGLRenderer===!0;if(r===N.TRANSFORM_DIRECTION){let d=u,g=i;e.isMatrix(d.getNodeType(e))?g=Ra(Xr(g),0):d=Ra(Xr(d),0);const _=Ka(d,g).xyz;return Vs(_).build(e,t)}else{if(r===N.NEGATE)return e.format("( - "+u.build(e,a)+" )",n,t);if(r===N.ONE_MINUS)return Pa(1,u).build(e,t);if(r===N.RECIPROCAL)return js(1,u).build(e,t);if(r===N.DIFFERENCE)return $a(Pa(u,i)).build(e,t);{const d=[];return r===N.CROSS||r===N.MOD?d.push(u.build(e,n),i.build(e,n)):r===N.STEP?d.push(u.build(e,e.getTypeLength(u.getNodeType(e))===1?"float":a),i.build(e,a)):v&&(r===N.MIN||r===N.MAX)||r===N.MOD?d.push(u.build(e,a),i.build(e,e.getTypeLength(i.getNodeType(e))===1?"float":a)):r===N.REFRACT?d.push(u.build(e,a),i.build(e,a),h.build(e,"float")):r===N.MIX?d.push(u.build(e,a),i.build(e,a),h.build(e,e.getTypeLength(h.getNodeType(e))===1?"float":a)):(d.push(u.build(e,a)),i!==null&&d.push(i.build(e,a)),h!==null&&d.push(h.build(e,a))),e.format(`${e.getMethod(r,n)}( ${d.join(", ")} )`,n,t)}}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}N.ALL="all";N.ANY="any";N.EQUALS="equals";N.RADIANS="radians";N.DEGREES="degrees";N.EXP="exp";N.EXP2="exp2";N.LOG="log";N.LOG2="log2";N.SQRT="sqrt";N.INVERSE_SQRT="inversesqrt";N.FLOOR="floor";N.CEIL="ceil";N.NORMALIZE="normalize";N.FRACT="fract";N.SIN="sin";N.COS="cos";N.TAN="tan";N.ASIN="asin";N.ACOS="acos";N.ATAN="atan";N.ABS="abs";N.SIGN="sign";N.LENGTH="length";N.NEGATE="negate";N.ONE_MINUS="oneMinus";N.DFDX="dFdx";N.DFDY="dFdy";N.ROUND="round";N.RECIPROCAL="reciprocal";N.TRUNC="trunc";N.FWIDTH="fwidth";N.BITCAST="bitcast";N.ATAN2="atan2";N.MIN="min";N.MAX="max";N.MOD="mod";N.STEP="step";N.REFLECT="reflect";N.DISTANCE="distance";N.DIFFERENCE="difference";N.DOT="dot";N.CROSS="cross";N.POW="pow";N.TRANSFORM_DIRECTION="transformDirection";N.MIX="mix";N.CLAMP="clamp";N.REFRACT="refract";N.SMOOTHSTEP="smoothstep";N.FACEFORWARD="faceforward";const uc=ri(1e-6);ri(1e6);ri(Math.PI);ri(Math.PI*2);const cc=he(N,N.ALL),hc=he(N,N.ANY),lc=he(N,N.EQUALS),fc=he(N,N.RADIANS),mc=he(N,N.DEGREES),yc=he(N,N.EXP),dc=he(N,N.EXP2),pc=he(N,N.LOG),vc=he(N,N.LOG2),xc=he(N,N.SQRT),gc=he(N,N.INVERSE_SQRT),bc=he(N,N.FLOOR),Tc=he(N,N.CEIL),Vs=he(N,N.NORMALIZE),Ec=he(N,N.FRACT),_c=he(N,N.SIN),wc=he(N,N.COS),Ac=he(N,N.TAN),Sc=he(N,N.ASIN),Mc=he(N,N.ACOS),Fc=he(N,N.ATAN),$a=he(N,N.ABS),Xs=he(N,N.SIGN),Cc=he(N,N.LENGTH),Rc=he(N,N.NEGATE),Pc=he(N,N.ONE_MINUS),Nc=he(N,N.DFDX),Dc=he(N,N.DFDY),Ic=he(N,N.ROUND),Bc=he(N,N.RECIPROCAL),Lc=he(N,N.TRUNC),Oc=he(N,N.FWIDTH);he(N,N.BITCAST);const zc=he(N,N.ATAN2),Uc=he(N,N.MIN),kc=he(N,N.MAX),Gc=he(N,N.MOD),Wc=he(N,N.STEP),jc=he(N,N.REFLECT),Vc=he(N,N.DISTANCE),Xc=he(N,N.DIFFERENCE),qs=he(N,N.DOT),qc=he(N,N.CROSS),Hs=he(N,N.POW),Hc=he(N,N.POW,2),Yc=he(N,N.POW,3),Kc=he(N,N.POW,4),$c=he(N,N.TRANSFORM_DIRECTION),Qc=c=>Ka(Xs(c),Hs($a(c),1/3)),Zc=c=>qs(c,c),Jc=he(N,N.MIX),Ys=(c,e=0,t=1)=>ct(new N(N.CLAMP,ct(c),ct(e),ct(t))),eh=c=>Ys(c),th=he(N,N.REFRACT),rh=he(N,N.SMOOTHSTEP),nh=he(N,N.FACEFORWARD),ih=(c,e,t)=>Jc(e,t,c),ah=(c,e,t)=>rh(e,t,c);Q("all",cc);Q("any",hc);Q("equals",lc);Q("radians",fc);Q("degrees",mc);Q("exp",yc);Q("exp2",dc);Q("log",pc);Q("log2",vc);Q("sqrt",xc);Q("inverseSqrt",gc);Q("floor",bc);Q("ceil",Tc);Q("normalize",Vs);Q("fract",Ec);Q("sin",_c);Q("cos",wc);Q("tan",Ac);Q("asin",Sc);Q("acos",Mc);Q("atan",Fc);Q("abs",$a);Q("sign",Xs);Q("length",Cc);Q("lengthSq",Zc);Q("negate",Rc);Q("oneMinus",Pc);Q("dFdx",Nc);Q("dFdy",Dc);Q("round",Ic);Q("reciprocal",Bc);Q("trunc",Lc);Q("fwidth",Oc);Q("atan2",zc);Q("min",Uc);Q("max",kc);Q("mod",Gc);Q("step",Wc);Q("reflect",jc);Q("distance",Vc);Q("dot",qs);Q("cross",qc);Q("pow",Hs);Q("pow2",Hc);Q("pow3",Yc);Q("pow4",Kc);Q("transformDirection",$c);Q("mix",ih);Q("clamp",Ys);Q("refract",th);Q("smoothstep",ah);Q("faceForward",nh);Q("difference",Xc);Q("saturate",eh);Q("cbrt",Qc);qt("MathNode",N);const sh=ti(({base:c,blend:e})=>{const t=r=>e[r].lessThan(uc).cond(e[r],c[r].oneMinus().div(e[r]).oneMinus().max(0));return Xr(t("x"),t("y"),t("z"))}).setLayout({name:"burnColor",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),oh=ti(({base:c,blend:e})=>{const t=r=>e[r].equal(1).cond(e[r],c[r].div(e[r].oneMinus()).max(0));return Xr(t("x"),t("y"),t("z"))}).setLayout({name:"dodgeColor",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),uh=ti(({base:c,blend:e})=>{const t=r=>c[r].oneMinus().mul(e[r].oneMinus()).oneMinus();return Xr(t("x"),t("y"),t("z"))}).setLayout({name:"screenColor",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),ch=ti(({base:c,blend:e})=>{const t=r=>c[r].lessThan(.5).cond(c[r].mul(e[r],2),c[r].oneMinus().mul(e[r].oneMinus()).oneMinus());return Xr(t("x"),t("y"),t("z"))}).setLayout({name:"overlayColor",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]});class At extends wn{constructor(e,t,r){super(),this.blendMode=e,this.baseNode=t,this.blendNode=r}setup(){const{blendMode:e,baseNode:t,blendNode:r}=this,n={base:t,blend:r};let a=null;return e===At.BURN?a=sh(n):e===At.DODGE?a=oh(n):e===At.SCREEN?a=uh(n):e===At.OVERLAY&&(a=ch(n)),a}}At.BURN="burn";At.DODGE="dodge";At.SCREEN="screen";At.OVERLAY="overlay";const hh=he(At,At.BURN),lh=he(At,At.DODGE),fh=he(At,At.OVERLAY),mh=he(At,At.SCREEN);Q("burn",hh);Q("dodge",lh);Q("overlay",fh);Q("screen",mh);qt("BlendModeNode",At);var Wt,Xt,Mr,Tn,Fr,Dt,Cr,dr,En,Hn,Yn,Kn,Ba,La,$n,Wr,pr,Qn,Li,Ks,Oi,$s,zi,Qs,Zn,Na,Ui,Zs,ki,Js,Jn,Da,Gi,eo;class yh{constructor(){Ae(this,Li);Ae(this,Oi);Ae(this,zi);Ae(this,Zn);Ae(this,Ui);Ae(this,ki);Ae(this,Jn);Ae(this,Gi);wt(this,"canvas",document.querySelector("#canvas"));wt(this,"gl");Ae(this,Wt,new Map);Ae(this,Xt,new Map);Ae(this,Mr,void 0);Ae(this,Tn,void 0);Ae(this,Fr,void 0);Ae(this,Dt,new Uint8Array(600));Ae(this,Cr,void 0);Ae(this,dr,new Uint8Array(3*40));Ae(this,En,void 0);Ae(this,Hn,document.createTextNode("0"));Ae(this,Yn,document.createTextNode("1"));Ae(this,Kn,document.createTextNode("0"));Ae(this,Ba,0);Ae(this,La,0);Ae(this,$n,new Map);Ae(this,Wr,void 0);Ae(this,pr,void 0);Ae(this,Qn,document.querySelectorAll("button"));document.querySelector("#linesCleared").appendChild(re(this,Hn)),document.querySelector("#speedLevel").appendChild(re(this,Yn)),document.querySelector("#score").appendChild(re(this,Kn));const e=document.styleSheets;let t=!1;for(let g=0;g<e.length&&!t;g++)e[g].href.includes("WebTetris")&&(ke(this,Wr,e[g].cssRules),t=!0);re(this,Wt).set(1,[255,0,0]),re(this,Wt).set(2,[0,255,0]),re(this,Wt).set(3,[255,255,0]),re(this,Wt).set(4,[0,0,255]),re(this,Wt).set(5,[180,90,246]),re(this,Wt).set(6,[0,255,255]),re(this,Wt).set(7,[255,140,40]),re(this,Xt).set("Z",1),re(this,Xt).set("S",2),re(this,Xt).set("O",3),re(this,Xt).set("J",4),re(this,Xt).set("T",5),re(this,Xt).set("I",6),re(this,Xt).set("L",7);let r=this.canvas.getContext("webgl");this.gl=r,r||document.body.appendChild(document.createTextNode("WebGL is not supported."));function n(g,_,b,C){return[g,_+C,g+b,_+C,g+b,_,g,_]}function a(g,_,b,C){let U=[g/2,g],ee=[],R=(300-U[1])/2,$=(400-U[0])/2;ee.push(...n($,R,U[0],U[1])),ee.push(...n($-_-C,R,C,C));for(let J=0;J<3;J++)ee.push(...n($+_+U[0],R+J*(C+b),C,C));return ee}const u={a_Position:{numComponents:2,data:a(250,3,0,30)},a_GridPos:{numComponents:2,data:[0,0,10,0,10,20,0,20,0,0,4,0,4,4,0,4,0,0,4,0,4,4,0,4,0,0,4,0,4,4,0,4,0,0,4,0,4,4,0,4]},a_QueueID:{numComponents:1,data:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3]},a_ShaderID:{numComponents:1,data:[0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},indices:{numComponents:3,data:[0,1,2,2,3,0,4,5,6,6,7,4,8,9,10,10,11,8,12,13,14,14,15,12,16,17,18,18,19,16]}};ke(this,Tn,Er.createBufferInfoFromArrays(r,u));let i=document.querySelector("#vertex-shader-2d").text,h=document.querySelector("#fragment-shader-2d").text;ke(this,Mr,Er.createProgramInfo(r,[i,h]));let v={src:"textures/block.png",mag:r.LINEAR};ke(this,En,Er.createTexture(this.gl,v)),ke(this,Fr,r.createTexture()),r.bindTexture(r.TEXTURE_2D,re(this,Fr)),r.pixelStorei(r.UNPACK_ALIGNMENT,1),r.texImage2D(r.TEXTURE_2D,0,r.RGB,10,20,0,r.RGB,r.UNSIGNED_BYTE,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),ke(this,Cr,r.createTexture()),r.bindTexture(r.TEXTURE_2D,re(this,Cr)),r.pixelStorei(r.UNPACK_ALIGNMENT,1),r.texImage2D(r.TEXTURE_2D,0,r.RGB,4,2*5,0,r.RGB,r.UNSIGNED_BYTE,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.useProgram(re(this,Mr).program),Er.setBuffersAndAttributes(r,re(this,Mr),re(this,Tn));let d={u_Resolution:[this.gl.canvas.width,this.gl.canvas.height],u_GridData:re(this,Fr),u_QueueData:re(this,Cr),u_BlockTexture:re(this,En)};Er.setUniforms(re(this,Mr),d),$e(this,ki,Js).call(this,"#gameSpace"),ke(this,pr,$e(this,Jn,Da).call(this,"button").fontSize),ke(this,pr,Number(re(this,pr).substring(0,re(this,pr).length-2)))}updateData(e){$e(this,Li,Ks).call(this,e),$e(this,zi,Qs).call(this,e),$e(this,Ui,Zs).call(this,e)}renderGame(){Er.resizeCanvasToDisplaySize(this.gl.canvas),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),$e(this,Gi,eo).call(this);let e={u_Resolution:[this.gl.canvas.width,this.gl.canvas.height],u_GridData:re(this,Fr),u_QueueData:re(this,Cr),u_BlockTexture:re(this,En)};Er.setUniforms(re(this,Mr),e),Er.drawBufferInfo(this.gl,re(this,Tn))}}Wt=new WeakMap,Xt=new WeakMap,Mr=new WeakMap,Tn=new WeakMap,Fr=new WeakMap,Dt=new WeakMap,Cr=new WeakMap,dr=new WeakMap,En=new WeakMap,Hn=new WeakMap,Yn=new WeakMap,Kn=new WeakMap,Ba=new WeakMap,La=new WeakMap,$n=new WeakMap,Wr=new WeakMap,pr=new WeakMap,Qn=new WeakMap,Li=new WeakSet,Ks=function(e){for(let t=0;t<20;t++){let r=e.gridData[t];for(let n=0;n<10;n++){let a=$e(this,Oi,$s).call(this,r,n),u=3*(10*t+n);if(a!=0){let i=re(this,Wt).get(a);re(this,Dt)[u]=i[0],re(this,Dt)[u+1]=i[1],re(this,Dt)[u+2]=i[2]}else re(this,Dt)[u]=0,re(this,Dt)[u+1]=0,re(this,Dt)[u+2]=0}}if(e.playerPiece.active){let t=170;for(let n=0;n<4;n++){let a=3*(10*e.ghostBlocks[n][1]+e.ghostBlocks[n][0]);re(this,Dt)[a]=t,re(this,Dt)[a+1]=t,re(this,Dt)[a+2]=t}let r=e.playerPiece.shape;for(let n=0;n<4;n++){let a=re(this,Wt).get(re(this,Xt).get(r)),u=3*(10*e.playerPiece.blocks[n][1]+e.playerPiece.blocks[n][0]);re(this,Dt)[u]=a[0],re(this,Dt)[u+1]=a[1],re(this,Dt)[u+2]=a[2]}}this.gl.bindTexture(this.gl.TEXTURE_2D,re(this,Fr)),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,10,20,this.gl.RGB,this.gl.UNSIGNED_BYTE,re(this,Dt))},Oi=new WeakSet,$s=function(e,t){const r=32-(3+3*t),n=7<<r;return(e&n)>>>r},zi=new WeakSet,Qs=function(e){for(let t=0;t<re(this,dr).length;t++)re(this,dr)[t]=0;e.heldPiece!=null&&$e(this,Zn,Na).call(this,e.heldPiece,0);for(let t=0;t<4;t++)$e(this,Zn,Na).call(this,e.pieceQueue[t],24*(1+t));this.gl.bindTexture(this.gl.TEXTURE_2D,re(this,Cr)),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,4,10,this.gl.RGB,this.gl.UNSIGNED_BYTE,re(this,dr))},Zn=new WeakSet,Na=function(e,t){let r=Sr.getBaseShape(e),n=re(this,Wt).get(re(this,Xt).get(e));for(let a=0;a<4;a++){let u=r[a],i=t+3*(u[1]*4+u[0]);re(this,dr)[i]=n[0],re(this,dr)[i+1]=n[1],re(this,dr)[i+2]=n[2]}},Ui=new WeakSet,Zs=function(e){re(this,Hn).nodeValue=e.linesCleared,re(this,Yn).nodeValue=e.speedLevel==11?"MAX":e.speedLevel,re(this,Kn).nodeValue=e.score},ki=new WeakSet,Js=function(e){const t=document.querySelector(e),r=$e(this,Jn,Da).call(this,e);r!=null&&re(this,$n).set(t,r)},Jn=new WeakSet,Da=function(e){let t=null;for(let r=0;r<re(this,Wr).length&&t==null;r++)re(this,Wr)[r].selectorText==e&&(t=re(this,Wr)[r].style);return t},Gi=new WeakSet,eo=function(){const e=this.gl.canvas.width,t=this.gl.canvas.height,r=3*e>4*t;re(this,$n).forEach(function(a,u,i){const h=a.left!="",v=a.top!="";let d=h?a.left:a.right,g=v?a.top:a.bottom,_=a.fontSize,b=a.width,C=a.height;d=Number(d.substring(0,d.length-2)),g=Number(g.substring(0,g.length-2)),b=Number(b.substring(0,b.length-2)),C=Number(C.substring(0,C.length-2)),_!=""&&(_=Number(_.substring(0,_.length-2))),r?(d=(4*t*(d-50)+150*e)/(3*e)+"vw",b=b*4*t/(3*e)+"vw",g=g+"vh",C=C+"vh"):(g=g*3*e/(4*t)+(100*t-75*e)/(2*t)+"vh",C=C*3*e/(4*t)+"vh",d=d+"vw",b=b+"vw",_!=""&&(_=_*3*e/(4*t))),_!=""&&(u.style.fontSize=_+"vh"),h?u.style.left=d:u.style.right=d,v?u.style.top=g:u.style.bottom=g,u.style.width=b,u.style.height=C});const n=r?re(this,pr):re(this,pr)*3*e/(4*t);for(let a=0;a<re(this,Qn).length;a++){let u=re(this,Qn)[a];u.style.fontSize=n+"vh"}};var _n,jr,Rr,Pr;class dh{constructor(e){Ae(this,_n,void 0);Ae(this,jr,void 0);Ae(this,Rr,!1);Ae(this,Pr,null);wt(this,"leftQueue",0);wt(this,"rightQueue",0);e.addEventListener("touchmove",t=>{this.dragEvent(t)}),e.addEventListener("touchstart",t=>{this.touchStart(t)}),e.addEventListener("touchend",t=>{this.touchEnd(t)}),e.addEventListener("touchcancel",t=>{this.touchEnd(t)})}touchStart(e){if(re(this,Pr)===null){let t=e.touches.item(0);ke(this,Pr,t.identifier),ke(this,jr,t.pageX),ke(this,_n,t.pageX)}}touchEnd(e){let t=!0;for(let r=0;r<e.touches.length&&t;r++)e.touches.item(r).identifier===re(this,Pr)&&(t=!1);t&&(ke(this,Pr,null),this.leftQueue=0,this.rightQueue=0)}dragEvent(e){let t=null;for(let n=0;n<e.changedTouches.length;n++)if(e.changedTouches.item(n).identifier===re(this,Pr)){t=e.changedTouches.item(n);break}if(t===null)return;let r=!1;(t.pageX-re(this,_n))*(re(this,Rr)?1:-1)>0&&(ke(this,Rr,!re(this,Rr)),ke(this,jr,t.pageX+20*(re(this,Rr)?1:-1))),Math.abs(t.pageX-re(this,jr))>40&&(r=!0),r&&(ke(this,jr,t.pageX),re(this,Rr)?(this.leftQueue++,this.rightQueue=0):(this.rightQueue++,this.leftQueue=0)),ke(this,_n,t.pageX)}}_n=new WeakMap,jr=new WeakMap,Rr=new WeakMap,Pr=new WeakMap;let Gn=null,Ia=new Map,to;function ph(c){c.inputKeys.forEach(function(t,r,n){localStorage.setItem(t,r)})}function vh(c){let e=[];c.inputKeys.forEach(function(t,r,n){const a=localStorage.getItem(t);a!=null&&e.push({action:t,oldKey:r,newKey:a})});for(let t=0;t<e.length;t++)c.inputKeys.delete(e[t].oldKey);for(let t=0;t<e.length;t++)c.inputKeys.set(e[t].newKey,e[t].action)}function xh(c,e){const t=document.querySelectorAll(c);for(let a=0;a<t.length;a++){let u=t[a];u.classList.add("ready"),u.addEventListener("click",function(){e.selectedSpan!=null&&(e.selectedKey="Escape",n()),e.originalKeybind=u.innerText,e.selectedSpan=u,e.selectedAction=u.id.substring(2),Gn.textContent="Rebinding "+e.selectedAction+" action (press key to rebind)...",document.addEventListener("keydown",r),u.classList.remove("ready"),u.classList.add("waiting"),u.innerText="..."}),u.innerText=e.actionToKey(u.id.substring(2)),u.innerText==" "&&(u.innerText="Space")}function r(a){e.selectedKey=a.key.length>1?a.key:a.key.toUpperCase(),n()}function n(){e.selectedKey=="Escape"||to.classList.contains("hide")?(e.selectedKey=e.originalKeybind,a(),Gn.textContent="Rebind canceled.",e.updateCounters()):e.rebindControl(e.selectedAction,e.selectedKey)?(Gn.textContent="Rebind successful!",a(),ph(e)):Gn.textContent="'"+e.selectedKey+"' is already in use (press another key)...";function a(){document.removeEventListener("keydown",r);const u=e.selectedKey==" "?"Space":e.selectedKey;e.selectedSpan.innerText=u,Ia.get(e.selectedAction).forEach(function(i,h,v){i.innerText=u}),e.selectedAction="",e.selectedKey="",e.selectedSpan.classList.remove("waiting"),e.selectedSpan.classList.add("ready"),e.selectedSpan=null}}}function gh(c,e,t,r){to=r,Gn=t,xh(c,e),e.actionStates.forEach(function(n,a,u){Ia.set(a,document.querySelectorAll("span.cd_"+a)),Ia.get(a).forEach(function(i,h,v){const d=e.actionToKey(a);i.innerText=d==" "?"Space":d})})}function bh(){let c=document.createTextNode("");document.querySelector("#debug").appendChild(c);const e=document.querySelector("#startButton");let t=new so;vh(t),document.addEventListener("keydown",function($){t.setInputState($.key,!0)}),document.addEventListener("keyup",function($){t.setInputState($.key,!1)});let r=new dh(document.querySelector("#gameGUI")),n=new Ta,a=new yh;const u=document.querySelector("#titleScreen"),i=document.querySelector("#pauseScreen"),h=document.querySelector("#gameOverScreen"),v=document.querySelector("#settingsScreen");let d=!0;const g=document.createTextNode("0"),_=document.createTextNode("0");document.querySelector("#finalScore").appendChild(g),document.querySelector("#finalLines").append(_);let b=0,C=0;function U($){let J=($-C)*.001;C=$,b+=J,v.classList.contains("hide")?n.gameState.gameOver?d||h.classList.contains("hide")&&(h.classList.remove("hide"),g.textContent=n.gameState.score,_.textContent=n.gameState.linesCleared):(b>=n.gameTickTime&&(b=Math.min(b-n.gameTickTime,n.gameTickTime),t.updateCounters(),Th(n,t,r),n.runTick(),t.getCounter("Pause")==1&&(n.gameState.isPaused?(n.pauseGame(!1),i.classList.add("hide")):(n.pauseGame(!0),i.classList.remove("hide")))),n.isStateChanged&&a.updateData(n.gameState)):(t.updateCounters(),t.getCounter("Pause")==1&&v.classList.add("hide")),a.renderGame(),requestAnimationFrame(U)}function ee(){n.startNewGame(),a.updateData(n.gameState),a.renderGame(),document.querySelector("#titleScreen").classList.add("hide"),document.querySelector("#gameGUI").classList.remove("hide"),requestAnimationFrame(U),d=!1}e.addEventListener("click",ee),document.querySelector("#heldPieceOverlay").addEventListener("click",function(){n.holdPiece()}),document.querySelector("#unpauseButton").addEventListener("click",function(){n.gameState.isPaused=!1,i.classList.add("hide")}),document.querySelector("#replayButton").addEventListener("click",function(){n.startNewGame(),a.updateData(n.gameState),a.renderGame(),h.classList.add("hide")}),document.querySelector("#returnToTitleButton").addEventListener("click",function(){u.classList.remove("hide"),h.classList.add("hide"),d=!0}),requestAnimationFrame(U);let R=document.createTextNode("");document.querySelector("#settingsConsoleText").appendChild(R),gh(".controlRebind",t,R,v),document.querySelector("#exitSettingsButton").addEventListener("click",function(){v.classList.add("hide")}),document.querySelectorAll(".settingsButton").forEach(function($,J,z){$.addEventListener("click",function(){v.classList.remove("hide")})})}function Th(c,e,t){e.getCounter("HardDrop")==1&&(c.input.hardDrop=!0),e.getCounter("Hold")==1&&(c.input.hold=!0),e.getCounter("RotateClockwise")==1&&(c.input.rotClockwise=!0),e.getCounter("RotateAntiClockwise")==1&&(c.input.rotAntiClockwise=!0),e.getInputState("SoftDrop")&&(c.input.softDrop=!0),(e.getCounter("MoveLeft")==1||e.getCounter("MoveLeft")>5)&&(c.input.moveLeft=!0),(e.getCounter("MoveRight")==1||e.getCounter("MoveRight")>5)&&(c.input.moveRight=!0),t.leftQueue>0&&(c.input.moveLeft=!0,t.leftQueue--),t.rightQueue>0&&(c.input.moveRight=!0,t.rightQueue--)}bh();
