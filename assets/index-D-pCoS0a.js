var co=Object.defineProperty;var ho=(u,e,t)=>e in u?co(u,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):u[e]=t;var ct=(u,e,t)=>(ho(u,typeof e!="symbol"?e+"":e,t),t),ya=(u,e,t)=>{if(!e.has(u))throw TypeError("Cannot "+t)};var ee=(u,e,t)=>(ya(u,e,"read from private field"),t?t.call(u):e.get(u)),_e=(u,e,t)=>{if(e.has(u))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(u):e.set(u,t)},Ce=(u,e,t,r)=>(ya(u,e,"write to private field"),r?r.call(u,t):e.set(u,t),t);var da=(u,e,t,r)=>({set _(n){Ce(u,e,n,t)},get _(){return ee(u,e,r)}}),$e=(u,e,t)=>(ya(u,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();var gn,yr,dr,Li,Gr,bn,Zt,Wr,Ii,Ms,Bi,Fs,Oi,Cs,zi,Rs,Tn,Ni,jr,Vn,Yn,Ma,Ui,Ps,Kn,Fa,ki,Ns,En,Di,$n,Ca;const Hn=class Hn{constructor(){_e(this,Ii);_e(this,Bi);_e(this,Oi);_e(this,zi);_e(this,Tn);_e(this,jr);_e(this,Yn);_e(this,Ui);_e(this,Kn);_e(this,ki);_e(this,En);_e(this,$n);ct(this,"input",{moveLeft:!1,moveRight:!1,hardDrop:!1,softDrop:!1,hold:!1,rotClockwise:!1,rotAntiClockwise:!1});ct(this,"numRows",21);ct(this,"graceTimerDuration",.5);ct(this,"gameTickTime",1/30);ct(this,"pieceMap",new Map);ct(this,"gameState",{isPaused:!1,gameOver:!0,gridData:new Uint32Array(this.numRows),playerPiece:null,pieceQueue:[],heldPiece:null,ghostBlocks:[[0,0],[0,0],[0,0],[0,0]],linesCleared:0,speedLevel:1,score:0});_e(this,gn,15);_e(this,yr,!0);_e(this,dr,0);_e(this,Li,!1);_e(this,Gr,-1);_e(this,bn,0);_e(this,Zt,!1);_e(this,Wr,!1);$e(this,Tn,Ni).call(this),$e(this,jr,Vn).call(this),$e(this,En,Di).call(this),Ce(this,gn,15),this.pieceMap.set("Z",1),this.pieceMap.set("S",2),this.pieceMap.set("O",3),this.pieceMap.set("J",4),this.pieceMap.set("T",5),this.pieceMap.set("I",6),this.pieceMap.set("L",7),this.gameState.isPaused=!0}get isStateChanged(){const e=ee(this,yr);return Ce(this,yr,!1),e}runTick(){if(this.gameState.isPaused)return;let e=!1;if(ee(this,Wr)){this.animationCount==null||this.rowCount==null?(this.animationCount=0,this.rowCount=0):(this.animationCount++,this.rowCount<this.numRows&&this.animationCount%4==0?(this.clearRow(0),this.rowCount++,Ce(this,yr,!0)):this.rowCount==this.numRows&&(this.rowCount++,this.gameState.gameOver=!0));return}if(this.input.hardDrop)this.hardDropPlayerPiece(),this.finishWithPiece(),e=!0;else if(this.input.hold)this.holdPiece(),e=!0;else{ee(this,Zt)&&$e(this,Ui,Ps).call(this,this.gameTickTime),this.input.softDrop&&(e=this.tryMovePiece(0,-1)||e);let t=0;this.input.rotClockwise&&(t+=1),this.input.rotAntiClockwise&&(t-=1),t!=0&&(e=this.tryRotatePiece(t==1)||e);let r=0;if(this.input.moveLeft&&(r-=1),this.input.moveRight&&(r+=1),r!=0&&(e=this.tryMovePiece(r,0)||e),da(this,dr)._++,ee(this,dr)>=ee(this,gn)){let n=!this.tryMovePiece(0,-1);e||(e=!n),Ce(this,dr,0),n&&!ee(this,Zt)&&$e(this,Yn,Ma).call(this)}if(ee(this,Zt)&&ee(this,Gr)<=0){let n=!this.tryMovePiece(0,-1);e=!0,n&&this.finishWithPiece()}else if(!ee(this,Zt)){let n=!1;for(const a of this.gameState.playerPiece.blocks)n=n||this.isBlockHere(a[0],a[1]-1);n&&$e(this,Yn,Ma).call(this)}}e&&($e(this,En,Di).call(this),Ce(this,yr,!0)),this.input={moveLeft:!1,moveRight:!1,hardDrop:!1,softDrop:!1,hold:!1,rotClockwise:!1,rotAntiClockwise:!1}}pauseGame(e){this.gameState.isPaused=e}startNewGame(){this.gameState.gameOver=!1,this.gameState.isPaused=!1,Ce(this,Wr,!1),this.animationCount=null,this.rowCount=null;for(let e=0;e<this.gameState.gridData.length;e++)this.gameState.gridData[e]=0;this.gameState.linesCleared=0,this.gameState.speedLevel=0,this.gameState.score=0,this.gameState.pieceQueue=[],this.gameState.heldPiece=null,$e(this,Tn,Ni).call(this),$e(this,jr,Vn).call(this),$e(this,En,Di).call(this),$e(this,$n,Ca).call(this)}tryMovePiece(e,t){let r=!0;for(let n=0;n<4&&r;n++){let a=this.gameState.playerPiece.blocks[n][0]+e,o=this.gameState.playerPiece.blocks[n][1]+t;this.isBlockHere(a,o)&&(r=!1)}return r&&($e(this,Bi,Fs).call(this,e,t),e!=0&&$e(this,Kn,Fa).call(this),t!=0&&Ce(this,Zt,!1)),r}hardDropPlayerPiece(){for(;this.tryMovePiece(0,-1););}tryRotatePiece(e){let t=$e(this,Oi,Cs).call(this,e);return t&&$e(this,Kn,Fa).call(this),t}holdPiece(){if(this.gameState.heldPiece==null)this.gameState.heldPiece=this.gameState.playerPiece.shape,$e(this,jr,Vn).call(this),Ce(this,yr,!0),Ce(this,dr,0);else if(!this.gameState.playerPiece.wasHeld){let e=this.gameState.heldPiece;this.gameState.heldPiece=this.gameState.playerPiece.shape,this.gameState.playerPiece=new Mr(e),this.gameState.playerPiece.wasHeld=!0,Ce(this,yr,!0),Ce(this,dr,0),this.isPlayerPieceValid()||(this.gameState.playerPiece.active=!1,Ce(this,Wr,!0))}}finishWithPiece(){const e=this.gameState.linesCleared;this.gameState.playerPiece.shape=="T"&&Ce(this,Li,!0),$e(this,zi,Rs).call(this),$e(this,jr,Vn).call(this),Ce(this,Zt,!1),$e(this,ki,Ns).call(this),this.gameState.linesCleared!=e&&($e(this,$n,Ca).call(this),this.gameState.score+=Math.pow(this.gameState.linesCleared-e,2)*100)}clearRow(e){for(let t=e;t<this.numRows-1;t++)this.gameState.gridData[t]=this.gameState.gridData[t+1];this.gameState.gridData[this.numRows-1]=0}isBlockHere(e,t){if(e<0||t<0||e>=10||t>=this.numRows)return!0;const r=this.gameState.gridData[t],n=7<<32-(3+3*e);return(r&n)!=0}getBlockData(e,t){const r=this.gameState.gridData[t],n=32-(3+3*e),a=7<<n;return(r&a)>>>n}isPlayerPieceValid(){let e=!0;for(let t=0;t<4&&e;t++)this.isBlockHere(this.gameState.playerPiece.blocks[t][0],this.gameState.playerPiece.blocks[t][1])&&(e=!1);return e}};gn=new WeakMap,yr=new WeakMap,dr=new WeakMap,Li=new WeakMap,Gr=new WeakMap,bn=new WeakMap,Zt=new WeakMap,Wr=new WeakMap,Ii=new WeakSet,Ms=function(e,t,r){const a=~(7<<32-(3+3*e));this.gameState.gridData[t]&=a;const o=r<<32-(3+3*e);this.gameState.gridData[t]|=o},Bi=new WeakSet,Fs=function(e,t){for(let r=0;r<4;r++)this.gameState.playerPiece.blocks[r][0]+=e,this.gameState.playerPiece.blocks[r][1]+=t},Oi=new WeakSet,Cs=function(e){let t=(this.gameState.playerPiece.rotationIndex+4+(e?1:-1))%4,r=[...this.gameState.playerPiece.blocks[0]],n=[];for(let w=0;w<4;w++)n.push([...this.gameState.playerPiece.blocks[w]]);let a=1,o=1;e?o=-1:a=-1;let i;for(let w=0;w<4;w++)n[w][0]-=r[0],n[w][1]-=r[1],i=n[w][0],n[w][0]=a*n[w][1],n[w][1]=o*i,n[w][0]+=r[0],n[w][1]+=r[1];let h;switch(this.gameState.playerPiece.shape){case"O":h=Mr.offsets.O;break;case"I":h=Mr.offsets.I;break;default:h=Mr.offsets.OTHER;break}let v,y,g=!1;for(let w=0;w<5&&!g;w++){v=h[w],y=[v[this.gameState.playerPiece.rotationIndex][0]-v[t][0],v[this.gameState.playerPiece.rotationIndex][1]-v[t][1]],g=!0;for(let b=0;b<4;b++)n[b][0]+=y[0],n[b][1]+=y[1],this.isBlockHere(n[b][0],n[b][1])&&(g=!1);if(!g)for(let b=0;b<4;b++)n[b][0]-=y[0],n[b][1]-=y[1]}if(g){for(let w=0;w<4;w++)this.gameState.playerPiece.blocks[w]=[...n[w]];this.gameState.playerPiece.rotationIndex=t}return g},zi=new WeakSet,Rs=function(){let e,t,r=this.pieceMap.get(this.gameState.playerPiece.shape);for(let n=0;n<4;n++)e=this.gameState.playerPiece.blocks[n][0],t=this.gameState.playerPiece.blocks[n][1],$e(this,Ii,Ms).call(this,e,t,r)},Tn=new WeakSet,Ni=function(){let e=["O","I","T","J","L","S","Z"],t;for(let r=0;r<7;r++)t=Math.floor(Math.random()*e.length),this.gameState.pieceQueue.push(e[t]),e.splice(t,1)},jr=new WeakSet,Vn=function(){let e=this.gameState.pieceQueue[0];this.gameState.pieceQueue.splice(0,1),this.gameState.pieceQueue.length<7&&$e(this,Tn,Ni).call(this),delete this.gameState.playerPiece,this.gameState.playerPiece=new Mr(e),this.isPlayerPieceValid()||(this.gameState.playerPiece.active=!1,Ce(this,Wr,!0)),Ce(this,dr,0)},Yn=new WeakSet,Ma=function(){Ce(this,Gr,this.graceTimerDuration),Ce(this,Zt,!0),Ce(this,bn,0)},Ui=new WeakSet,Ps=function(e){Ce(this,Gr,ee(this,Gr)-e)},Kn=new WeakSet,Fa=function(){ee(this,Zt)&&ee(this,bn)<30&&(Ce(this,Gr,this.graceTimerDuration),da(this,bn)._++)},ki=new WeakSet,Ns=function(){for(let e=0;e<this.numRows;e++){let t=!0;for(let r=0;r<10&&t;r++)this.isBlockHere(r,e)||(t=!1);t&&(this.clearRow(e),this.gameState.linesCleared++,e--)}},En=new WeakSet,Di=function(){for(let t=0;t<4;t++)this.gameState.ghostBlocks[t]=[...this.gameState.playerPiece.blocks[t]];let e=!1;for(;!e;){for(let t=0;t<4;t++)this.isBlockHere(this.gameState.ghostBlocks[t][0],this.gameState.ghostBlocks[t][1]-1)&&(e=!0);if(!e)for(let t=0;t<4;t++)this.gameState.ghostBlocks[t][1]-=1}},$n=new WeakSet,Ca=function(){this.gameState.speedLevel=Math.min(Math.floor(this.gameState.linesCleared/10)+1,Hn.levels.max),Ce(this,gn,Hn.levels[this.gameState.speedLevel])},ct(Hn,"levels",{1:25,2:20,3:16,4:12,5:10,6:8,7:6,8:5,9:4,10:2,11:1,max:11});let Aa=Hn;const Vt=class Vt{constructor(e){this.blocks=[],this.shape=e,this.rotationIndex=0,this.active=!0,this.wasHeld=!1;let t=Vt.getBaseShape(e);for(let r=0;r<4;r++)this.blocks.push([...t[r]]),this.blocks[r][0]+=3,this.blocks[r][1]+=19}static getBaseShape(e){let t;switch(e){case"O":t=Vt.pieces.O;break;case"I":t=Vt.pieces.I;break;case"L":t=Vt.pieces.L;break;case"J":t=Vt.pieces.J;break;case"T":t=Vt.pieces.T;break;case"S":t=Vt.pieces.S;break;case"Z":t=Vt.pieces.Z;break;default:t=[[0,0],[0,0],[0,0],[0,0]]}return t}};ct(Vt,"offsets",{O:[[[0,0],[0,-1],[-1,-1],[-1,0]]],I:[[[0,0],[-1,0],[-1,1],[0,1]],[[-1,0],[0,0],[1,1],[0,1]],[[2,0],[0,0],[-2,1],[0,1]],[[-1,0],[0,1],[1,0],[0,-1]],[[2,0],[0,-2],[-2,0],[0,2]]],OTHER:[[[0,0],[0,0],[0,0],[0,0]],[[0,0],[1,0],[0,0],[-1,0]],[[0,0],[1,-1],[0,0],[-1,-1]],[[0,0],[0,2],[0,0],[0,2]],[[0,0],[1,2],[0,0],[-1,2]]]}),ct(Vt,"pieces",{O:[[1,0],[1,1],[2,1],[2,0]],I:[[1,0],[0,0],[2,0],[3,0]],L:[[1,0],[0,0],[2,0],[2,1]],J:[[1,0],[0,0],[0,1],[2,0]],T:[[1,0],[0,0],[2,0],[1,1]],S:[[1,0],[0,0],[1,1],[2,1]],Z:[[1,0],[2,0],[1,1],[0,1]]});let Mr=Vt;class lo{constructor(){ct(this,"selectedKey","");ct(this,"originalKeybind","");ct(this,"selectedAction","");ct(this,"selectedSpan",null);this.actionStates=new Map,this.actionStates.set("HardDrop",!1),this.actionStates.set("SoftDrop",!1),this.actionStates.set("MoveLeft",!1),this.actionStates.set("MoveRight",!1),this.actionStates.set("Hold",!1),this.actionStates.set("RotateClockwise",!1),this.actionStates.set("RotateAntiClockwise",!1),this.actionStates.set("Pause",!1),this.inputKeys=new Map,this.inputKeys.set("A","MoveLeft"),this.inputKeys.set("D","MoveRight"),this.inputKeys.set("W","HardDrop"),this.inputKeys.set("S","SoftDrop"),this.inputKeys.set("E","Hold"),this.inputKeys.set("ArrowLeft","RotateAntiClockwise"),this.inputKeys.set("ArrowRight","RotateClockwise"),this.inputKeys.set("Escape","Pause"),this.counters=new Map,this.counters.set("MoveLeft",0),this.counters.set("MoveRight",0),this.counters.set("RotateClockwise",0),this.counters.set("RotateAntiClockwise",0),this.counters.set("HardDrop",0),this.counters.set("Hold",0),this.counters.set("Pause",0)}keyToState(e){return e.length==1&&(e=e.toUpperCase()),this.inputKeys.get(e)}actionToKey(e){let t="";return this.inputKeys.forEach(function(r,n,a){r==e&&(t=n)}),t}rebindControl(e,t){let r=!1,n="";return this.inputKeys.forEach(function(a,o,i){a==e&&(n=o)}),n!=""&&(this.inputKeys.has(t)&&t!=n||(this.inputKeys.delete(n),this.inputKeys.set(t,e),r=!0)),r}setInputState(e,t){let r=this.keyToState(e);r!=null&&this.actionStates.set(r,t)}getInputState(e){return this.actionStates.has(e)?this.actionStates.get(e):(console.log("ERROR: trying to access an input action that doesn't exist ("+e+"). The allowed options are:"),this.actionStates.forEach(function(t,r,n){console.log("    - "+r)}),null)}updateCounters(){for(const[e,t]of this.counters)this.getInputState(e)?this.counters.set(e,t+1):this.counters.set(e,0)}getCounter(e){return this.counters.has(e)?this.counters.get(e):(console.log("ERROR: trying to access input action that doesn't have a counter ("+e+"). The counters are:"),this.counters.forEach(function(t,r,n){console.log("    - "+r+": "+t)}),null)}}var fo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ds={exports:{}};/*!
 * @license twgl.js 5.5.4 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
 * Available via the MIT license.
 * see: http://github.com/greggman/twgl.js for details
 */(function(u,e){(function(r,n){u.exports=n()})(typeof self<"u"?self:fo,()=>(()=>{var t={"./src/attributes.js":(o,i,h)=>{function v(E){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},v(E)}i.__esModule=!0,i.createAttribsFromArrays=dt,i.createBufferFromArray=x,i.createBufferFromTypedArray=ge,i.createBufferInfoFromArrays=p,i.createBuffersFromArrays=L,i.getArray_=Z,i.getNumComponents_=Me,i.setAttribInfoBufferFromArray=ft,i.setAttributeDefaults_=ot,i.setAttributePrefix=st;var y=b(h("./src/typedarrays.js")),g=b(h("./src/helper.js"));function w(E){if(typeof WeakMap!="function")return null;var d=new WeakMap,m=new WeakMap;return(w=function(_){return _?m:d})(E)}function b(E,d){if(!d&&E&&E.__esModule)return E;if(E===null||v(E)!="object"&&typeof E!="function")return{default:E};var m=w(d);if(m&&m.has(E))return m.get(E);var S={__proto__:null},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var I in E)if(I!=="default"&&Object.prototype.hasOwnProperty.call(E,I)){var k=_?Object.getOwnPropertyDescriptor(E,I):null;k&&(k.get||k.set)?Object.defineProperty(S,I,k):S[I]=E[I]}return S.default=E,m&&m.set(E,S),S}var F=35044,U=34962,te=34963,R=34660,J=5120,$=5121,B=5122,X=5123,ie=5124,se=5125,Le=5126,Ae={attribPrefix:""};function st(E){Ae.attribPrefix=E}function ot(E){g.copyExistingProperties(E,Ae)}function He(E,d,m,S,_){E.bindBuffer(d,m),E.bufferData(d,S,_||F)}function ge(E,d,m,S){if(g.isBuffer(E,d))return d;m=m||U;var _=E.createBuffer();return He(E,m,_,d,S),_}function G(E){return E==="indices"}function V(E){return E===Int8Array||E===Uint8Array}function Z(E){return E.length?E:E.data}var D=/coord|texture/i,be=/color|colour/i;function Se(E,d){var m;if(D.test(E)?m=2:be.test(E)?m=4:m=3,d%m>0)throw new Error("Can not guess numComponents for attribute '".concat(E,"'. Tried ").concat(m," but ").concat(d," values is not evenly divisible by ").concat(m,". You should specify it."));return m}function Me(E,d,m){return E.numComponents||E.size||Se(d,m||Z(E).length)}function We(E,d){if(y.isArrayBuffer(E))return E;if(y.isArrayBuffer(E.data))return E.data;Array.isArray(E)&&(E={data:E});var m=E.type?rt(E.type):void 0;return m||(G(d)?m=Uint16Array:m=Float32Array),new m(E.data)}function je(E){return typeof E=="number"?E:E?y.getGLTypeForTypedArrayType(E):Le}function rt(E){return typeof E=="number"?y.getTypedArrayTypeForGLType(E):E||Float32Array}function Qe(E,d){return{buffer:d.buffer,numValues:24,type:je(d.type),arrayType:rt(d.type)}}function yt(E,d){var m=d.data||d,S=rt(d.type),_=m*S.BYTES_PER_ELEMENT,I=E.createBuffer();return E.bindBuffer(U,I),E.bufferData(U,_,d.drawType||F),{buffer:I,numValues:m,type:y.getGLTypeForTypedArrayType(S),arrayType:S}}function Ft(E,d,m){var S=We(d,m);return{arrayType:S.constructor,buffer:ge(E,S,void 0,d.drawType),type:y.getGLTypeForTypedArray(S),numValues:0}}function dt(E,d){var m={};return Object.keys(d).forEach(function(S){if(!G(S)){var _=d[S],I=_.attrib||_.name||_.attribName||Ae.attribPrefix+S;if(_.value){if(!Array.isArray(_.value)&&!y.isArrayBuffer(_.value))throw new Error("array.value is not array or typedarray");m[I]={value:_.value}}else{var k;_.buffer&&_.buffer instanceof WebGLBuffer?k=Qe:typeof _=="number"||typeof _.data=="number"?k=yt:k=Ft;var H=k(E,_,S),Y=H.buffer,ae=H.type,oe=H.numValues,ce=H.arrayType,me=_.normalize!==void 0?_.normalize:V(ce),fe=Me(_,S,oe);m[I]={buffer:Y,numComponents:fe,type:ae,normalize:me,stride:_.stride||0,offset:_.offset||0,divisor:_.divisor===void 0?void 0:_.divisor,drawType:_.drawType}}}}),E.bindBuffer(U,null),m}function ft(E,d,m,S){m=We(m),S!==void 0?(E.bindBuffer(U,d.buffer),E.bufferSubData(U,S,m)):He(E,U,d.buffer,m,d.drawType)}function xt(E,d){return d===J||d===$?1:d===B||d===X?2:d===ie||d===se||d===Le?4:0}var Ct=["position","positions","a_position"];function de(E){var d,m;for(m=0;m<Ct.length&&(d=Ct[m],!(d in E));++m);m===Ct.length&&(d=Object.keys(E)[0]);var S=E[d],_=Z(S).length;if(_===void 0)return 1;var I=Me(S,d),k=_/I;if(_%I>0)throw new Error("numComponents ".concat(I," not correct for length ").concat(_));return k}function c(E,d){var m,S;for(S=0;S<Ct.length&&(m=Ct[S],!(m in d||(m=Ae.attribPrefix+m,m in d)));++S);S===Ct.length&&(m=Object.keys(d)[0]);var _=d[m];if(!_.buffer)return 1;E.bindBuffer(U,_.buffer);var I=E.getBufferParameter(U,R);E.bindBuffer(U,null);var k=xt(E,_.type),H=I/k,Y=_.numComponents||_.size,ae=H/Y;if(ae%1!==0)throw new Error("numComponents ".concat(Y," not correct for length ").concat(length));return ae}function p(E,d,m){var S=dt(E,d),_=Object.assign({},m||{});_.attribs=Object.assign({},m?m.attribs:{},S);var I=d.indices;if(I){var k=We(I,"indices");_.indices=ge(E,k,te),_.numElements=k.length,_.elementType=y.getGLTypeForTypedArray(k)}else _.numElements||(_.numElements=c(E,_.attribs));return _}function x(E,d,m){var S=m==="indices"?te:U,_=We(d,m);return ge(E,_,S)}function L(E,d){var m={};return Object.keys(d).forEach(function(S){m[S]=x(E,d[S],S)}),d.indices?(m.numElements=d.indices.length,m.elementType=y.getGLTypeForTypedArray(We(d.indices),"indices")):m.numElements=de(d),m}},"./src/draw.js":(o,i,h)=>{function v(R){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(J){return typeof J}:function(J){return J&&typeof Symbol=="function"&&J.constructor===Symbol&&J!==Symbol.prototype?"symbol":typeof J},v(R)}i.__esModule=!0,i.drawBufferInfo=U,i.drawObjectList=te;var y=w(h("./src/programs.js"));function g(R){if(typeof WeakMap!="function")return null;var J=new WeakMap,$=new WeakMap;return(g=function(X){return X?$:J})(R)}function w(R,J){if(!J&&R&&R.__esModule)return R;if(R===null||v(R)!="object"&&typeof R!="function")return{default:R};var $=g(J);if($&&$.has(R))return $.get(R);var B={__proto__:null},X=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ie in R)if(ie!=="default"&&Object.prototype.hasOwnProperty.call(R,ie)){var se=X?Object.getOwnPropertyDescriptor(R,ie):null;se&&(se.get||se.set)?Object.defineProperty(B,ie,se):B[ie]=R[ie]}return B.default=R,$&&$.set(R,B),B}var b=4,F=5123;function U(R,J,$,B,X,ie){$=$===void 0?b:$;var se=J.indices,Le=J.elementType,Ae=B===void 0?J.numElements:B;X=X===void 0?0:X,Le||se?ie!==void 0?R.drawElementsInstanced($,Ae,Le===void 0?F:J.elementType,X,ie):R.drawElements($,Ae,Le===void 0?F:J.elementType,X):ie!==void 0?R.drawArraysInstanced($,X,Ae,ie):R.drawArrays($,X,Ae)}function te(R,J){var $=null,B=null;J.forEach(function(X){if(X.active!==!1){var ie=X.programInfo,se=X.vertexArrayInfo||X.bufferInfo,Le=!1,Ae=X.type===void 0?b:X.type;ie!==$&&($=ie,R.useProgram(ie.program),Le=!0),(Le||se!==B)&&(B&&B.vertexArrayObject&&!se.vertexArrayObject&&R.bindVertexArray(null),B=se,y.setBuffersAndAttributes(R,ie,se)),y.setUniforms(ie,X.uniforms),U(R,se,Ae,X.count,X.offset,X.instanceCount)}}),B&&B.vertexArrayObject&&R.bindVertexArray(null)}},"./src/framebuffers.js":(o,i,h)=>{function v(de){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},v(de)}i.__esModule=!0,i.bindFramebufferInfo=Ct,i.createFramebufferInfo=ft,i.resizeFramebufferInfo=xt;var y=b(h("./src/textures.js")),g=b(h("./src/helper.js"));function w(de){if(typeof WeakMap!="function")return null;var c=new WeakMap,p=new WeakMap;return(w=function(L){return L?p:c})(de)}function b(de,c){if(!c&&de&&de.__esModule)return de;if(de===null||v(de)!="object"&&typeof de!="function")return{default:de};var p=w(c);if(p&&p.has(de))return p.get(de);var x={__proto__:null},L=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var E in de)if(E!=="default"&&Object.prototype.hasOwnProperty.call(de,E)){var d=L?Object.getOwnPropertyDescriptor(de,E):null;d&&(d.get||d.set)?Object.defineProperty(x,E,d):x[E]=de[E]}return x.default=de,p&&p.set(de,x),x}var F=36160,U=36161,te=3553,R=5121,J=6402,$=6408,B=33190,X=36012,ie=35056,se=36013,Le=32854,Ae=32855,st=36194,ot=33189,He=6401,ge=36168,G=34041,V=36064,Z=36096,D=36128,be=33306,Se=33071,Me=9729,We=[{format:$,type:R,min:Me,wrap:Se},{format:G}],je={};je[G]=be,je[He]=D,je[ge]=D,je[J]=Z,je[ot]=Z,je[B]=Z,je[X]=Z,je[ie]=be,je[se]=be;function rt(de,c){return je[de]||je[c]}var Qe={};Qe[Le]=!0,Qe[Ae]=!0,Qe[st]=!0,Qe[G]=!0,Qe[ot]=!0,Qe[He]=!0,Qe[ge]=!0;function yt(de){return Qe[de]}var Ft=32;function dt(de){return de>=V&&de<V+Ft}function ft(de,c,p,x){var L=F,E=de.createFramebuffer();de.bindFramebuffer(L,E),p=p||de.drawingBufferWidth,x=x||de.drawingBufferHeight,c=c||We;var d=[],m={framebuffer:E,attachments:[],width:p,height:x};return c.forEach(function(S,_){var I=S.attachment,k=S.samples,H=S.format,Y=S.attachmentPoint||rt(H,S.internalFormat);if(Y||(Y=V+_),dt(Y)&&d.push(Y),!I)if(k!==void 0||yt(H))I=de.createRenderbuffer(),de.bindRenderbuffer(U,I),k>1?de.renderbufferStorageMultisample(U,k,H,p,x):de.renderbufferStorage(U,H,p,x);else{var ae=Object.assign({},S);ae.width=p,ae.height=x,ae.auto===void 0&&(ae.auto=!1,ae.min=ae.min||ae.minMag||Me,ae.mag=ae.mag||ae.minMag||Me,ae.wrapS=ae.wrapS||ae.wrap||Se,ae.wrapT=ae.wrapT||ae.wrap||Se),I=y.createTexture(de,ae)}if(g.isRenderbuffer(de,I))de.framebufferRenderbuffer(L,Y,U,I);else if(g.isTexture(de,I))S.layer!==void 0?de.framebufferTextureLayer(L,Y,I,S.level||0,S.layer):de.framebufferTexture2D(L,Y,S.target||te,I,S.level||0);else throw new Error("unknown attachment type");m.attachments.push(I)}),de.drawBuffers&&de.drawBuffers(d),m}function xt(de,c,p,x,L){x=x||de.drawingBufferWidth,L=L||de.drawingBufferHeight,c.width=x,c.height=L,p=p||We,p.forEach(function(E,d){var m=c.attachments[d],S=E.format,_=E.samples;if(_!==void 0||g.isRenderbuffer(de,m))de.bindRenderbuffer(U,m),_>1?de.renderbufferStorageMultisample(U,_,S,x,L):de.renderbufferStorage(U,S,x,L);else if(g.isTexture(de,m))y.resizeTexture(de,m,E,x,L);else throw new Error("unknown attachment type")})}function Ct(de,c,p){p=p||F,c?(de.bindFramebuffer(p,c.framebuffer),de.viewport(0,0,c.width,c.height)):(de.bindFramebuffer(p,null),de.viewport(0,0,de.drawingBufferWidth,de.drawingBufferHeight))}},"./src/helper.js":(o,i)=>{i.__esModule=!0,i.copyExistingProperties=y,i.copyNamedProperties=v,i.error=g,i.isBuffer=U,i.isRenderbuffer=te,i.isSampler=$,i.isShader=R,i.isTexture=J,i.warn=w;function h(B){"@babel/helpers - typeof";return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(X){return typeof X}:function(X){return X&&typeof Symbol=="function"&&X.constructor===Symbol&&X!==Symbol.prototype?"symbol":typeof X},h(B)}function v(B,X,ie){B.forEach(function(se){var Le=X[se];Le!==void 0&&(ie[se]=Le)})}function y(B,X){Object.keys(X).forEach(function(ie){X.hasOwnProperty(ie)&&B.hasOwnProperty(ie)&&(X[ie]=B[ie])})}function g(){var B;(B=console).error.apply(B,arguments)}function w(){var B;(B=console).warn.apply(B,arguments)}var b=new Map;function F(B,X){if(!B||h(B)!=="object")return!1;var ie=b.get(X);ie||(ie=new WeakMap,b.set(X,ie));var se=ie.get(B);if(se===void 0){var Le=Object.prototype.toString.call(B);se=Le.substring(8,Le.length-1)===X,ie.set(B,se)}return se}function U(B,X){return typeof WebGLBuffer<"u"&&F(X,"WebGLBuffer")}function te(B,X){return typeof WebGLRenderbuffer<"u"&&F(X,"WebGLRenderbuffer")}function R(B,X){return typeof WebGLShader<"u"&&F(X,"WebGLShader")}function J(B,X){return typeof WebGLTexture<"u"&&F(X,"WebGLTexture")}function $(B,X){return typeof WebGLSampler<"u"&&F(X,"WebGLSampler")}},"./src/m4.js":(o,i,h)=>{function v(c){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},v(c)}i.__esModule=!0,i.axisRotate=Ft,i.axisRotation=yt,i.copy=R,i.create=te,i.frustum=He,i.getAxis=Le,i.getTranslation=se,i.identity=J,i.inverse=B,i.lookAt=Z,i.multiply=X,i.negate=U,i.ortho=ot,i.perspective=st,i.rotateX=Me,i.rotateY=je,i.rotateZ=Qe,i.rotationX=Se,i.rotationY=We,i.rotationZ=rt,i.scale=ft,i.scaling=dt,i.setAxis=Ae,i.setDefaultType=F,i.setTranslation=ie,i.transformDirection=Ct,i.transformNormal=de,i.transformPoint=xt,i.translate=be,i.translation=D,i.transpose=$;var y=w(h("./src/v3.js"));function g(c){if(typeof WeakMap!="function")return null;var p=new WeakMap,x=new WeakMap;return(g=function(E){return E?x:p})(c)}function w(c,p){if(!p&&c&&c.__esModule)return c;if(c===null||v(c)!="object"&&typeof c!="function")return{default:c};var x=g(p);if(x&&x.has(c))return x.get(c);var L={__proto__:null},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in c)if(d!=="default"&&Object.prototype.hasOwnProperty.call(c,d)){var m=E?Object.getOwnPropertyDescriptor(c,d):null;m&&(m.get||m.set)?Object.defineProperty(L,d,m):L[d]=c[d]}return L.default=c,x&&x.set(c,L),L}var b=Float32Array;function F(c){var p=b;return b=c,p}function U(c,p){return p=p||new b(16),p[0]=-c[0],p[1]=-c[1],p[2]=-c[2],p[3]=-c[3],p[4]=-c[4],p[5]=-c[5],p[6]=-c[6],p[7]=-c[7],p[8]=-c[8],p[9]=-c[9],p[10]=-c[10],p[11]=-c[11],p[12]=-c[12],p[13]=-c[13],p[14]=-c[14],p[15]=-c[15],p}function te(){return new b(16).fill(0)}function R(c,p){return p=p||new b(16),p[0]=c[0],p[1]=c[1],p[2]=c[2],p[3]=c[3],p[4]=c[4],p[5]=c[5],p[6]=c[6],p[7]=c[7],p[8]=c[8],p[9]=c[9],p[10]=c[10],p[11]=c[11],p[12]=c[12],p[13]=c[13],p[14]=c[14],p[15]=c[15],p}function J(c){return c=c||new b(16),c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function $(c,p){if(p=p||new b(16),p===c){var x;return x=c[1],c[1]=c[4],c[4]=x,x=c[2],c[2]=c[8],c[8]=x,x=c[3],c[3]=c[12],c[12]=x,x=c[6],c[6]=c[9],c[9]=x,x=c[7],c[7]=c[13],c[13]=x,x=c[11],c[11]=c[14],c[14]=x,p}var L=c[0*4+0],E=c[0*4+1],d=c[0*4+2],m=c[0*4+3],S=c[1*4+0],_=c[1*4+1],I=c[1*4+2],k=c[1*4+3],H=c[2*4+0],Y=c[2*4+1],ae=c[2*4+2],oe=c[2*4+3],ce=c[3*4+0],me=c[3*4+1],fe=c[3*4+2],ve=c[3*4+3];return p[0]=L,p[1]=S,p[2]=H,p[3]=ce,p[4]=E,p[5]=_,p[6]=Y,p[7]=me,p[8]=d,p[9]=I,p[10]=ae,p[11]=fe,p[12]=m,p[13]=k,p[14]=oe,p[15]=ve,p}function B(c,p){p=p||new b(16);var x=c[0*4+0],L=c[0*4+1],E=c[0*4+2],d=c[0*4+3],m=c[1*4+0],S=c[1*4+1],_=c[1*4+2],I=c[1*4+3],k=c[2*4+0],H=c[2*4+1],Y=c[2*4+2],ae=c[2*4+3],oe=c[3*4+0],ce=c[3*4+1],me=c[3*4+2],fe=c[3*4+3],ve=Y*fe,xe=me*ae,le=_*fe,Ee=me*I,Ue=_*ae,Ze=Y*I,Ve=E*fe,Xe=me*d,Re=E*ae,Ie=Y*d,tt=E*I,Ye=_*d,et=k*ce,Ke=oe*H,nt=m*ce,Be=oe*S,Ge=m*H,Et=k*S,pt=x*ce,Rt=oe*L,Lt=x*H,Yt=k*L,er=x*S,tr=m*L,xr=ve*S+Ee*H+Ue*ce-(xe*S+le*H+Ze*ce),Kr=xe*L+Ve*H+Ie*ce-(ve*L+Xe*H+Re*ce),$r=le*L+Xe*S+tt*ce-(Ee*L+Ve*S+Ye*ce),Qr=Ze*L+Re*S+Ye*H-(Ue*L+Ie*S+tt*H),gt=1/(x*xr+m*Kr+k*$r+oe*Qr);return p[0]=gt*xr,p[1]=gt*Kr,p[2]=gt*$r,p[3]=gt*Qr,p[4]=gt*(xe*m+le*k+Ze*oe-(ve*m+Ee*k+Ue*oe)),p[5]=gt*(ve*x+Xe*k+Re*oe-(xe*x+Ve*k+Ie*oe)),p[6]=gt*(Ee*x+Ve*m+Ye*oe-(le*x+Xe*m+tt*oe)),p[7]=gt*(Ue*x+Ie*m+tt*k-(Ze*x+Re*m+Ye*k)),p[8]=gt*(et*I+Be*ae+Ge*fe-(Ke*I+nt*ae+Et*fe)),p[9]=gt*(Ke*d+pt*ae+Yt*fe-(et*d+Rt*ae+Lt*fe)),p[10]=gt*(nt*d+Rt*I+er*fe-(Be*d+pt*I+tr*fe)),p[11]=gt*(Et*d+Lt*I+tr*ae-(Ge*d+Yt*I+er*ae)),p[12]=gt*(nt*Y+Et*me+Ke*_-(Ge*me+et*_+Be*Y)),p[13]=gt*(Lt*me+et*E+Rt*Y-(pt*Y+Yt*me+Ke*E)),p[14]=gt*(pt*_+tr*me+Be*E-(er*me+nt*E+Rt*_)),p[15]=gt*(er*Y+Ge*E+Yt*_-(Lt*_+tr*Y+Et*E)),p}function X(c,p,x){x=x||new b(16);var L=c[0],E=c[1],d=c[2],m=c[3],S=c[4],_=c[5],I=c[6],k=c[7],H=c[8],Y=c[9],ae=c[10],oe=c[11],ce=c[12],me=c[13],fe=c[14],ve=c[15],xe=p[0],le=p[1],Ee=p[2],Ue=p[3],Ze=p[4],Ve=p[5],Xe=p[6],Re=p[7],Ie=p[8],tt=p[9],Ye=p[10],et=p[11],Ke=p[12],nt=p[13],Be=p[14],Ge=p[15];return x[0]=L*xe+S*le+H*Ee+ce*Ue,x[1]=E*xe+_*le+Y*Ee+me*Ue,x[2]=d*xe+I*le+ae*Ee+fe*Ue,x[3]=m*xe+k*le+oe*Ee+ve*Ue,x[4]=L*Ze+S*Ve+H*Xe+ce*Re,x[5]=E*Ze+_*Ve+Y*Xe+me*Re,x[6]=d*Ze+I*Ve+ae*Xe+fe*Re,x[7]=m*Ze+k*Ve+oe*Xe+ve*Re,x[8]=L*Ie+S*tt+H*Ye+ce*et,x[9]=E*Ie+_*tt+Y*Ye+me*et,x[10]=d*Ie+I*tt+ae*Ye+fe*et,x[11]=m*Ie+k*tt+oe*Ye+ve*et,x[12]=L*Ke+S*nt+H*Be+ce*Ge,x[13]=E*Ke+_*nt+Y*Be+me*Ge,x[14]=d*Ke+I*nt+ae*Be+fe*Ge,x[15]=m*Ke+k*nt+oe*Be+ve*Ge,x}function ie(c,p,x){return x=x||J(),c!==x&&(x[0]=c[0],x[1]=c[1],x[2]=c[2],x[3]=c[3],x[4]=c[4],x[5]=c[5],x[6]=c[6],x[7]=c[7],x[8]=c[8],x[9]=c[9],x[10]=c[10],x[11]=c[11]),x[12]=p[0],x[13]=p[1],x[14]=p[2],x[15]=1,x}function se(c,p){return p=p||y.create(),p[0]=c[12],p[1]=c[13],p[2]=c[14],p}function Le(c,p,x){x=x||y.create();var L=p*4;return x[0]=c[L+0],x[1]=c[L+1],x[2]=c[L+2],x}function Ae(c,p,x,L){L!==c&&(L=R(c,L));var E=x*4;return L[E+0]=p[0],L[E+1]=p[1],L[E+2]=p[2],L}function st(c,p,x,L,E){E=E||new b(16);var d=Math.tan(Math.PI*.5-.5*c),m=1/(x-L);return E[0]=d/p,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=d,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=(x+L)*m,E[11]=-1,E[12]=0,E[13]=0,E[14]=x*L*m*2,E[15]=0,E}function ot(c,p,x,L,E,d,m){return m=m||new b(16),m[0]=2/(p-c),m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=2/(L-x),m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=2/(E-d),m[11]=0,m[12]=(p+c)/(c-p),m[13]=(L+x)/(x-L),m[14]=(d+E)/(E-d),m[15]=1,m}function He(c,p,x,L,E,d,m){m=m||new b(16);var S=p-c,_=L-x,I=E-d;return m[0]=2*E/S,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=2*E/_,m[6]=0,m[7]=0,m[8]=(c+p)/S,m[9]=(L+x)/_,m[10]=d/I,m[11]=-1,m[12]=0,m[13]=0,m[14]=E*d/I,m[15]=0,m}var ge,G,V;function Z(c,p,x,L){return L=L||new b(16),ge=ge||y.create(),G=G||y.create(),V=V||y.create(),y.normalize(y.subtract(c,p,V),V),y.normalize(y.cross(x,V,ge),ge),y.normalize(y.cross(V,ge,G),G),L[0]=ge[0],L[1]=ge[1],L[2]=ge[2],L[3]=0,L[4]=G[0],L[5]=G[1],L[6]=G[2],L[7]=0,L[8]=V[0],L[9]=V[1],L[10]=V[2],L[11]=0,L[12]=c[0],L[13]=c[1],L[14]=c[2],L[15]=1,L}function D(c,p){return p=p||new b(16),p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=c[0],p[13]=c[1],p[14]=c[2],p[15]=1,p}function be(c,p,x){x=x||new b(16);var L=p[0],E=p[1],d=p[2],m=c[0],S=c[1],_=c[2],I=c[3],k=c[1*4+0],H=c[1*4+1],Y=c[1*4+2],ae=c[1*4+3],oe=c[2*4+0],ce=c[2*4+1],me=c[2*4+2],fe=c[2*4+3],ve=c[3*4+0],xe=c[3*4+1],le=c[3*4+2],Ee=c[3*4+3];return c!==x&&(x[0]=m,x[1]=S,x[2]=_,x[3]=I,x[4]=k,x[5]=H,x[6]=Y,x[7]=ae,x[8]=oe,x[9]=ce,x[10]=me,x[11]=fe),x[12]=m*L+k*E+oe*d+ve,x[13]=S*L+H*E+ce*d+xe,x[14]=_*L+Y*E+me*d+le,x[15]=I*L+ae*E+fe*d+Ee,x}function Se(c,p){p=p||new b(16);var x=Math.cos(c),L=Math.sin(c);return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=x,p[6]=L,p[7]=0,p[8]=0,p[9]=-L,p[10]=x,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}function Me(c,p,x){x=x||new b(16);var L=c[4],E=c[5],d=c[6],m=c[7],S=c[8],_=c[9],I=c[10],k=c[11],H=Math.cos(p),Y=Math.sin(p);return x[4]=H*L+Y*S,x[5]=H*E+Y*_,x[6]=H*d+Y*I,x[7]=H*m+Y*k,x[8]=H*S-Y*L,x[9]=H*_-Y*E,x[10]=H*I-Y*d,x[11]=H*k-Y*m,c!==x&&(x[0]=c[0],x[1]=c[1],x[2]=c[2],x[3]=c[3],x[12]=c[12],x[13]=c[13],x[14]=c[14],x[15]=c[15]),x}function We(c,p){p=p||new b(16);var x=Math.cos(c),L=Math.sin(c);return p[0]=x,p[1]=0,p[2]=-L,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=L,p[9]=0,p[10]=x,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}function je(c,p,x){x=x||new b(16);var L=c[0*4+0],E=c[0*4+1],d=c[0*4+2],m=c[0*4+3],S=c[2*4+0],_=c[2*4+1],I=c[2*4+2],k=c[2*4+3],H=Math.cos(p),Y=Math.sin(p);return x[0]=H*L-Y*S,x[1]=H*E-Y*_,x[2]=H*d-Y*I,x[3]=H*m-Y*k,x[8]=H*S+Y*L,x[9]=H*_+Y*E,x[10]=H*I+Y*d,x[11]=H*k+Y*m,c!==x&&(x[4]=c[4],x[5]=c[5],x[6]=c[6],x[7]=c[7],x[12]=c[12],x[13]=c[13],x[14]=c[14],x[15]=c[15]),x}function rt(c,p){p=p||new b(16);var x=Math.cos(c),L=Math.sin(c);return p[0]=x,p[1]=L,p[2]=0,p[3]=0,p[4]=-L,p[5]=x,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}function Qe(c,p,x){x=x||new b(16);var L=c[0*4+0],E=c[0*4+1],d=c[0*4+2],m=c[0*4+3],S=c[1*4+0],_=c[1*4+1],I=c[1*4+2],k=c[1*4+3],H=Math.cos(p),Y=Math.sin(p);return x[0]=H*L+Y*S,x[1]=H*E+Y*_,x[2]=H*d+Y*I,x[3]=H*m+Y*k,x[4]=H*S-Y*L,x[5]=H*_-Y*E,x[6]=H*I-Y*d,x[7]=H*k-Y*m,c!==x&&(x[8]=c[8],x[9]=c[9],x[10]=c[10],x[11]=c[11],x[12]=c[12],x[13]=c[13],x[14]=c[14],x[15]=c[15]),x}function yt(c,p,x){x=x||new b(16);var L=c[0],E=c[1],d=c[2],m=Math.sqrt(L*L+E*E+d*d);L/=m,E/=m,d/=m;var S=L*L,_=E*E,I=d*d,k=Math.cos(p),H=Math.sin(p),Y=1-k;return x[0]=S+(1-S)*k,x[1]=L*E*Y+d*H,x[2]=L*d*Y-E*H,x[3]=0,x[4]=L*E*Y-d*H,x[5]=_+(1-_)*k,x[6]=E*d*Y+L*H,x[7]=0,x[8]=L*d*Y+E*H,x[9]=E*d*Y-L*H,x[10]=I+(1-I)*k,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x}function Ft(c,p,x,L){L=L||new b(16);var E=p[0],d=p[1],m=p[2],S=Math.sqrt(E*E+d*d+m*m);E/=S,d/=S,m/=S;var _=E*E,I=d*d,k=m*m,H=Math.cos(x),Y=Math.sin(x),ae=1-H,oe=_+(1-_)*H,ce=E*d*ae+m*Y,me=E*m*ae-d*Y,fe=E*d*ae-m*Y,ve=I+(1-I)*H,xe=d*m*ae+E*Y,le=E*m*ae+d*Y,Ee=d*m*ae-E*Y,Ue=k+(1-k)*H,Ze=c[0],Ve=c[1],Xe=c[2],Re=c[3],Ie=c[4],tt=c[5],Ye=c[6],et=c[7],Ke=c[8],nt=c[9],Be=c[10],Ge=c[11];return L[0]=oe*Ze+ce*Ie+me*Ke,L[1]=oe*Ve+ce*tt+me*nt,L[2]=oe*Xe+ce*Ye+me*Be,L[3]=oe*Re+ce*et+me*Ge,L[4]=fe*Ze+ve*Ie+xe*Ke,L[5]=fe*Ve+ve*tt+xe*nt,L[6]=fe*Xe+ve*Ye+xe*Be,L[7]=fe*Re+ve*et+xe*Ge,L[8]=le*Ze+Ee*Ie+Ue*Ke,L[9]=le*Ve+Ee*tt+Ue*nt,L[10]=le*Xe+Ee*Ye+Ue*Be,L[11]=le*Re+Ee*et+Ue*Ge,c!==L&&(L[12]=c[12],L[13]=c[13],L[14]=c[14],L[15]=c[15]),L}function dt(c,p){return p=p||new b(16),p[0]=c[0],p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=c[1],p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=c[2],p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}function ft(c,p,x){x=x||new b(16);var L=p[0],E=p[1],d=p[2];return x[0]=L*c[0],x[1]=L*c[1],x[2]=L*c[2],x[3]=L*c[3],x[4]=E*c[4],x[5]=E*c[5],x[6]=E*c[6],x[7]=E*c[7],x[8]=d*c[8],x[9]=d*c[9],x[10]=d*c[10],x[11]=d*c[11],c!==x&&(x[12]=c[12],x[13]=c[13],x[14]=c[14],x[15]=c[15]),x}function xt(c,p,x){x=x||y.create();var L=p[0],E=p[1],d=p[2],m=L*c[0*4+3]+E*c[1*4+3]+d*c[2*4+3]+c[3*4+3];return x[0]=(L*c[0]+E*c[4]+d*c[8]+c[12])/m,x[1]=(L*c[1]+E*c[5]+d*c[9]+c[13])/m,x[2]=(L*c[2]+E*c[6]+d*c[10]+c[14])/m,x}function Ct(c,p,x){x=x||y.create();var L=p[0],E=p[1],d=p[2];return x[0]=L*c[0]+E*c[4]+d*c[8],x[1]=L*c[1]+E*c[5]+d*c[9],x[2]=L*c[2]+E*c[6]+d*c[10],x}function de(c,p,x){x=x||y.create();var L=B(c),E=p[0],d=p[1],m=p[2];return x[0]=E*L[0]+d*L[1]+m*L[2],x[1]=E*L[4]+d*L[5]+m*L[6],x[2]=E*L[8]+d*L[9]+m*L[10],x}},"./src/primitives.js":(o,i,h)=>{function v(d){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},v(d)}i.__esModule=!0,i.concatVertices=p,i.create3DFBuffers=i.create3DFBufferInfo=void 0,i.create3DFVertices=We,i.createAugmentedTypedArray=B,i.createCrescentBuffers=i.createCrescentBufferInfo=void 0,i.createCrescentVertices=je,i.createCubeBuffers=i.createCubeBufferInfo=i.createCresentVertices=i.createCresentBuffers=i.createCresentBufferInfo=void 0,i.createCubeVertices=be,i.createCylinderBuffers=i.createCylinderBufferInfo=void 0,i.createCylinderVertices=rt,i.createDiscBuffers=i.createDiscBufferInfo=void 0,i.createDiscVertices=yt,i.createPlaneBuffers=i.createPlaneBufferInfo=void 0,i.createPlaneVertices=V,i.createSphereBuffers=i.createSphereBufferInfo=void 0,i.createSphereVertices=Z,i.createTorusBuffers=i.createTorusBufferInfo=void 0,i.createTorusVertices=Qe,i.createTruncatedConeBuffers=i.createTruncatedConeBufferInfo=void 0,i.createTruncatedConeVertices=Se,i.createXYQuadBuffers=i.createXYQuadBufferInfo=void 0,i.createXYQuadVertices=G,i.deindexVertices=ie,i.duplicateVertices=x,i.flattenNormals=se,i.makeRandomVertexColors=dt,i.reorientDirections=st,i.reorientNormals=ot,i.reorientPositions=He,i.reorientVertices=ge;var y=te(h("./src/attributes.js")),g=te(h("./src/helper.js")),w=te(h("./src/typedarrays.js")),b=te(h("./src/m4.js")),F=te(h("./src/v3.js"));function U(d){if(typeof WeakMap!="function")return null;var m=new WeakMap,S=new WeakMap;return(U=function(I){return I?S:m})(d)}function te(d,m){if(!m&&d&&d.__esModule)return d;if(d===null||v(d)!="object"&&typeof d!="function")return{default:d};var S=U(m);if(S&&S.has(d))return S.get(d);var _={__proto__:null},I=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var k in d)if(k!=="default"&&Object.prototype.hasOwnProperty.call(d,k)){var H=I?Object.getOwnPropertyDescriptor(d,k):null;H&&(H.get||H.set)?Object.defineProperty(_,k,H):_[k]=d[k]}return _.default=d,S&&S.set(d,_),_}var R=y.getArray_,J=y.getNumComponents_;function $(d,m){var S=0;return d.push=function(){for(var _=0;_<arguments.length;++_){var I=arguments[_];if(I instanceof Array||w.isArrayBuffer(I))for(var k=0;k<I.length;++k)d[S++]=I[k];else d[S++]=I}},d.reset=function(_){S=_||0},d.numComponents=m,Object.defineProperty(d,"numElements",{get:function(){return this.length/this.numComponents|0}}),d}function B(d,m,S){var _=S||Float32Array;return $(new _(d*m),d)}function X(d){return d!=="indices"}function ie(d){var m=d.indices,S={},_=m.length;function I(k){for(var H=d[k],Y=H.numComponents,ae=B(Y,_,H.constructor),oe=0;oe<_;++oe)for(var ce=m[oe],me=ce*Y,fe=0;fe<Y;++fe)ae.push(H[me+fe]);S[k]=ae}return Object.keys(d).filter(X).forEach(I),S}function se(d){if(d.indices)throw new Error("can not flatten normals of indexed vertices. deindex them first");for(var m=d.normal,S=m.length,_=0;_<S;_+=9){var I=m[_+0],k=m[_+1],H=m[_+2],Y=m[_+3],ae=m[_+4],oe=m[_+5],ce=m[_+6],me=m[_+7],fe=m[_+8],ve=I+Y+ce,xe=k+ae+me,le=H+oe+fe,Ee=Math.sqrt(ve*ve+xe*xe+le*le);ve/=Ee,xe/=Ee,le/=Ee,m[_+0]=ve,m[_+1]=xe,m[_+2]=le,m[_+3]=ve,m[_+4]=xe,m[_+5]=le,m[_+6]=ve,m[_+7]=xe,m[_+8]=le}return d}function Le(d,m,S){for(var _=d.length,I=new Float32Array(3),k=0;k<_;k+=3)S(m,[d[k],d[k+1],d[k+2]],I),d[k]=I[0],d[k+1]=I[1],d[k+2]=I[2]}function Ae(d,m,S){S=S||F.create();var _=m[0],I=m[1],k=m[2];return S[0]=_*d[0]+I*d[1]+k*d[2],S[1]=_*d[4]+I*d[5]+k*d[6],S[2]=_*d[8]+I*d[9]+k*d[10],S}function st(d,m){return Le(d,m,b.transformDirection),d}function ot(d,m){return Le(d,b.inverse(m),Ae),d}function He(d,m){return Le(d,m,b.transformPoint),d}function ge(d,m){return Object.keys(d).forEach(function(S){var _=d[S];S.indexOf("pos")>=0?He(_,m):S.indexOf("tan")>=0||S.indexOf("binorm")>=0?st(_,m):S.indexOf("norm")>=0&&ot(_,m)}),d}function G(d,m,S){return d=d||2,m=m||0,S=S||0,d*=.5,{position:{numComponents:2,data:[m+-1*d,S+-1*d,m+1*d,S+-1*d,m+-1*d,S+1*d,m+1*d,S+1*d]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function V(d,m,S,_,I){d=d||1,m=m||1,S=S||1,_=_||1,I=I||b.identity();for(var k=(S+1)*(_+1),H=B(3,k),Y=B(3,k),ae=B(2,k),oe=0;oe<=_;oe++)for(var ce=0;ce<=S;ce++){var me=ce/S,fe=oe/_;H.push(d*me-d*.5,0,m*fe-m*.5),Y.push(0,1,0),ae.push(me,fe)}for(var ve=S+1,xe=B(3,S*_*2,Uint16Array),le=0;le<_;le++)for(var Ee=0;Ee<S;Ee++)xe.push((le+0)*ve+Ee,(le+1)*ve+Ee,(le+0)*ve+Ee+1),xe.push((le+1)*ve+Ee,(le+1)*ve+Ee+1,(le+0)*ve+Ee+1);var Ue=ge({position:H,normal:Y,texcoord:ae,indices:xe},I);return Ue}function Z(d,m,S,_,I,k,H){if(m<=0||S<=0)throw new Error("subdivisionAxis and subdivisionHeight must be > 0");_=_||0,I=I||Math.PI,k=k||0,H=H||Math.PI*2;for(var Y=I-_,ae=H-k,oe=(m+1)*(S+1),ce=B(3,oe),me=B(3,oe),fe=B(2,oe),ve=0;ve<=S;ve++)for(var xe=0;xe<=m;xe++){var le=xe/m,Ee=ve/S,Ue=ae*le+k,Ze=Y*Ee+_,Ve=Math.sin(Ue),Xe=Math.cos(Ue),Re=Math.sin(Ze),Ie=Math.cos(Ze),tt=Xe*Re,Ye=Ie,et=Ve*Re;ce.push(d*tt,d*Ye,d*et),me.push(tt,Ye,et),fe.push(1-le,Ee)}for(var Ke=m+1,nt=B(3,m*S*2,Uint16Array),Be=0;Be<m;Be++)for(var Ge=0;Ge<S;Ge++)nt.push((Ge+0)*Ke+Be,(Ge+0)*Ke+Be+1,(Ge+1)*Ke+Be),nt.push((Ge+1)*Ke+Be,(Ge+0)*Ke+Be+1,(Ge+1)*Ke+Be+1);return{position:ce,normal:me,texcoord:fe,indices:nt}}var D=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function be(d){d=d||1;for(var m=d/2,S=[[-m,-m,-m],[+m,-m,-m],[-m,+m,-m],[+m,+m,-m],[-m,-m,+m],[+m,-m,+m],[-m,+m,+m],[+m,+m,+m]],_=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],I=[[1,0],[0,0],[0,1],[1,1]],k=6*4,H=B(3,k),Y=B(3,k),ae=B(2,k),oe=B(3,6*2,Uint16Array),ce=0;ce<6;++ce){for(var me=D[ce],fe=0;fe<4;++fe){var ve=S[me[fe]],xe=_[ce],le=I[fe];H.push(ve),Y.push(xe),ae.push(le)}var Ee=4*ce;oe.push(Ee+0,Ee+1,Ee+2),oe.push(Ee+0,Ee+2,Ee+3)}return{position:H,normal:Y,texcoord:ae,indices:oe}}function Se(d,m,S,_,I,k,H){if(_<3)throw new Error("radialSubdivisions must be 3 or greater");if(I<1)throw new Error("verticalSubdivisions must be 1 or greater");for(var Y=k===void 0?!0:k,ae=H===void 0?!0:H,oe=(Y?2:0)+(ae?2:0),ce=(_+1)*(I+1+oe),me=B(3,ce),fe=B(3,ce),ve=B(2,ce),xe=B(3,_*(I+oe/2)*2,Uint16Array),le=_+1,Ee=Math.atan2(d-m,S),Ue=Math.cos(Ee),Ze=Math.sin(Ee),Ve=Y?-2:0,Xe=I+(ae?2:0),Re=Ve;Re<=Xe;++Re){var Ie=Re/I,tt=S*Ie,Ye=void 0;Re<0?(tt=0,Ie=1,Ye=d):Re>I?(tt=S,Ie=1,Ye=m):Ye=d+(m-d)*(Re/I),(Re===-2||Re===I+2)&&(Ye=0,Ie=0),tt-=S/2;for(var et=0;et<le;++et){var Ke=Math.sin(et*Math.PI*2/_),nt=Math.cos(et*Math.PI*2/_);me.push(Ke*Ye,tt,nt*Ye),Re<0?fe.push(0,-1,0):Re>I?fe.push(0,1,0):Ye===0?fe.push(0,0,0):fe.push(Ke*Ue,Ze,nt*Ue),ve.push(et/_,1-Ie)}}for(var Be=0;Be<I+oe;++Be)if(!(Be===1&&Y||Be===I+oe-2&&ae))for(var Ge=0;Ge<_;++Ge)xe.push(le*(Be+0)+0+Ge,le*(Be+0)+1+Ge,le*(Be+1)+1+Ge),xe.push(le*(Be+0)+0+Ge,le*(Be+1)+1+Ge,le*(Be+1)+0+Ge);return{position:me,normal:fe,texcoord:ve,indices:xe}}function Me(d,m){m=m||[];for(var S=[],_=0;_<d.length;_+=4){var I=d[_],k=d.slice(_+1,_+4);k.push.apply(k,m);for(var H=0;H<I;++H)S.push.apply(S,k)}return S}function We(){var d=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],m=[.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0],S=Me([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),_=Me([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),I=d.length/3,k={position:B(3,I),texcoord:B(2,I),normal:B(3,I),color:B(4,I,Uint8Array),indices:B(3,I/3,Uint16Array)};k.position.push(d),k.texcoord.push(m),k.normal.push(S),k.color.push(_);for(var H=0;H<I;++H)k.indices.push(H);return k}function je(d,m,S,_,I,k,H){if(I<=0)throw new Error("subdivisionDown must be > 0");k=k||0,H=H||1;var Y=2,ae=H-k,oe=(I+1)*2*(2+Y),ce=B(3,oe),me=B(3,oe),fe=B(2,oe);function ve(Xe,Re,Ie){return Xe+(Re-Xe)*Ie}function xe(Xe,Re,Ie,tt,Ye,et){for(var Ke=0;Ke<=I;Ke++){var nt=Re/(Y-1),Be=Ke/I,Ge=(nt-.5)*2,Et=(k+Be*ae)*Math.PI,pt=Math.sin(Et),Rt=Math.cos(Et),Lt=ve(d,Xe,pt),Yt=Ge*_,er=Rt*d,tr=pt*Lt;ce.push(Yt,er,tr);var xr=F.add(F.multiply([0,pt,Rt],Ie),tt);me.push(xr),fe.push(nt*Ye+et,Be)}}for(var le=0;le<Y;le++){var Ee=(le/(Y-1)-.5)*2;xe(m,le,[1,1,1],[0,0,0],1,0),xe(m,le,[0,0,0],[Ee,0,0],0,0),xe(S,le,[1,1,1],[0,0,0],1,0),xe(S,le,[0,0,0],[Ee,0,0],0,1)}var Ue=B(3,I*2*(2+Y),Uint16Array);function Ze(Xe,Re){for(var Ie=0;Ie<I;++Ie)Ue.push(Xe+Ie+0,Xe+Ie+1,Re+Ie+0),Ue.push(Xe+Ie+1,Re+Ie+1,Re+Ie+0)}var Ve=I+1;return Ze(Ve*0,Ve*4),Ze(Ve*5,Ve*7),Ze(Ve*6,Ve*2),Ze(Ve*3,Ve*1),{position:ce,normal:me,texcoord:fe,indices:Ue}}function rt(d,m,S,_,I,k){return Se(d,d,m,S,_,I,k)}function Qe(d,m,S,_,I,k){if(S<3)throw new Error("radialSubdivisions must be 3 or greater");if(_<3)throw new Error("verticalSubdivisions must be 3 or greater");I=I||0,k=k||Math.PI*2;for(var H=k-I,Y=S+1,ae=_+1,oe=Y*ae,ce=B(3,oe),me=B(3,oe),fe=B(2,oe),ve=B(3,S*_*2,Uint16Array),xe=0;xe<ae;++xe)for(var le=xe/_,Ee=le*Math.PI*2,Ue=Math.sin(Ee),Ze=d+Ue*m,Ve=Math.cos(Ee),Xe=Ve*m,Re=0;Re<Y;++Re){var Ie=Re/S,tt=I+Ie*H,Ye=Math.sin(tt),et=Math.cos(tt),Ke=Ye*Ze,nt=et*Ze,Be=Ye*Ue,Ge=et*Ue;ce.push(Ke,Xe,nt),me.push(Be,Ve,Ge),fe.push(Ie,1-le)}for(var Et=0;Et<_;++Et)for(var pt=0;pt<S;++pt){var Rt=1+pt,Lt=1+Et;ve.push(Y*Et+pt,Y*Lt+pt,Y*Et+Rt),ve.push(Y*Lt+pt,Y*Lt+Rt,Y*Et+Rt)}return{position:ce,normal:me,texcoord:fe,indices:ve}}function yt(d,m,S,_,I){if(m<3)throw new Error("divisions must be at least 3");S=S||1,I=I||1,_=_||0;for(var k=(m+1)*(S+1),H=B(3,k),Y=B(3,k),ae=B(2,k),oe=B(3,S*m*2,Uint16Array),ce=0,me=d-_,fe=m+1,ve=0;ve<=S;++ve){for(var xe=_+me*Math.pow(ve/S,I),le=0;le<=m;++le){var Ee=2*Math.PI*le/m,Ue=xe*Math.cos(Ee),Ze=xe*Math.sin(Ee);if(H.push(Ue,0,Ze),Y.push(0,1,0),ae.push(1-le/m,ve/S),ve>0&&le!==m){var Ve=ce+(le+1),Xe=ce+le,Re=ce+le-fe,Ie=ce+(le+1)-fe;oe.push(Ve,Xe,Re),oe.push(Ve,Re,Ie)}}ce+=m+1}return{position:H,normal:Y,texcoord:ae,indices:oe}}function Ft(d){return Math.random()*d|0}function dt(d,m){m=m||{};var S=d.position.numElements,_=B(4,S,Uint8Array),I=m.rand||function(me,fe){return fe<3?Ft(256):255};if(d.color=_,d.indices)for(var k=0;k<S;++k)_.push(I(k,0),I(k,1),I(k,2),I(k,3));else for(var H=m.vertsPerColor||3,Y=S/H,ae=0;ae<Y;++ae)for(var oe=[I(ae,0),I(ae,1),I(ae,2),I(ae,3)],ce=0;ce<H;++ce)_.push(oe);return d}function ft(d){return function(m){var S=d.apply(this,Array.prototype.slice.call(arguments,1));return y.createBuffersFromArrays(m,S)}}function xt(d){return function(m){var S=d.apply(null,Array.prototype.slice.call(arguments,1));return y.createBufferInfoFromArrays(m,S)}}var Ct=["numComponents","size","type","normalize","stride","offset","attrib","name","attribName"];function de(d,m,S,_){_=_||0;for(var I=d.length,k=0;k<I;++k)m[S+k]=d[k]+_}function c(d,m){var S=R(d),_=new S.constructor(m),I=_;return S.numComponents&&S.numElements&&$(_,S.numComponents),d.data&&(I={data:_},g.copyNamedProperties(Ct,d,I)),I}function p(d){for(var m={},S,_=function(){var ce=d[I];Object.keys(ce).forEach(function(me){m[me]||(m[me]=[]),!S&&me!=="indices"&&(S=me);var fe=ce[me],ve=J(fe,me),xe=R(fe),le=xe.length/ve;m[me].push(le)})},I=0;I<d.length;++I)_();function k(oe){for(var ce=0,me,fe=0;fe<d.length;++fe){var ve=d[fe],xe=ve[oe],le=R(xe);ce+=le.length,(!me||xe.data)&&(me=xe)}return{length:ce,spec:me}}function H(oe,ce,me){for(var fe=0,ve=0,xe=0;xe<d.length;++xe){var le=d[xe],Ee=le[oe],Ue=R(Ee);oe==="indices"?(de(Ue,me,ve,fe),fe+=ce[xe]):de(Ue,me,ve),ve+=Ue.length}}var Y=m[S],ae={};return Object.keys(m).forEach(function(oe){var ce=k(oe),me=c(ce.spec,ce.length);H(oe,Y,R(me)),ae[oe]=me}),ae}function x(d){var m={};return Object.keys(d).forEach(function(S){var _=d[S],I=R(_),k=c(_,I.length);de(I,R(k),0),m[S]=k}),m}i.create3DFBufferInfo=xt(We),i.create3DFBuffers=ft(We),i.createCubeBufferInfo=xt(be),i.createCubeBuffers=ft(be),i.createPlaneBufferInfo=xt(V),i.createPlaneBuffers=ft(V),i.createSphereBufferInfo=xt(Z),i.createSphereBuffers=ft(Z),i.createTruncatedConeBufferInfo=xt(Se),i.createTruncatedConeBuffers=ft(Se),i.createXYQuadBufferInfo=xt(G),i.createXYQuadBuffers=ft(G);var L=i.createCrescentBufferInfo=xt(je),E=i.createCrescentBuffers=ft(je);i.createCylinderBufferInfo=xt(rt),i.createCylinderBuffers=ft(rt),i.createTorusBufferInfo=xt(Qe),i.createTorusBuffers=ft(Qe),i.createDiscBufferInfo=xt(yt),i.createDiscBuffers=ft(yt),i.createCresentBufferInfo=L,i.createCresentBuffers=E,i.createCresentVertices=je},"./src/programs.js":(o,i,h)=>{function v(s){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(l){return typeof l}:function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},v(s)}i.__esModule=!0,i.bindTransformFeedbackInfo=cn,i.bindUniformBlock=hn,i.createAttributeSetters=Gn,i.createProgram=Or,i.createProgramAsync=void 0,i.createProgramFromScripts=In,i.createProgramFromSources=Bn,i.createProgramInfo=T,i.createProgramInfoAsync=void 0,i.createProgramInfoFromProgram=fn,i.createProgramInfos=z,i.createProgramInfosAsync=void 0,i.createPrograms=M,i.createProgramsAsync=void 0,i.createTransformFeedback=zn,i.createTransformFeedbackInfo=un,i.createUniformBlockInfo=kn,i.createUniformBlockInfoFromProgram=Un,i.createUniformBlockSpecFromProgram=fr,i.createUniformSetters=Tr,i.setAttributes=Wn,i.setBlockUniforms=ua,i.setBuffersAndAttributes=ca,i.setUniformBlock=Ei,i.setUniforms=ln,i.setUniformsAndBindTextures=void 0;var y=b(h("./src/utils.js")),g=b(h("./src/helper.js"));function w(s){if(typeof WeakMap!="function")return null;var l=new WeakMap,f=new WeakMap;return(w=function(P){return P?f:l})(s)}function b(s,l){if(!l&&s&&s.__esModule)return s;if(s===null||v(s)!="object"&&typeof s!="function")return{default:s};var f=w(l);if(f&&f.has(s))return f.get(s);var C={__proto__:null},P=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var O in s)if(O!=="default"&&Object.prototype.hasOwnProperty.call(s,O)){var j=P?Object.getOwnPropertyDescriptor(s,O):null;j&&(j.get||j.set)?Object.defineProperty(C,O,j):C[O]=s[O]}return C.default=s,f&&f.set(s,C),C}function F(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */F=function(){return l};var s,l={},f=Object.prototype,C=f.hasOwnProperty,P=Object.defineProperty||function(pe,ne,ue){pe[ne]=ue.value},O=typeof Symbol=="function"?Symbol:{},j=O.iterator||"@@iterator",W=O.asyncIterator||"@@asyncIterator",K=O.toStringTag||"@@toStringTag";function q(pe,ne,ue){return Object.defineProperty(pe,ne,{value:ue,enumerable:!0,configurable:!0,writable:!0}),pe[ne]}try{q({},"")}catch{q=function(ue,Fe,ze){return ue[Fe]=ze}}function re(pe,ne,ue,Fe){var ze=ne&&ne.prototype instanceof qe?ne:qe,Ne=Object.create(ze.prototype),vt=new fa(Fe||[]);return P(Ne,"_invoke",{value:oo(pe,ue,vt)}),Ne}function ye(pe,ne,ue){try{return{type:"normal",arg:pe.call(ne,ue)}}catch(Fe){return{type:"throw",arg:Fe}}}l.wrap=re;var Te="suspendedStart",we="suspendedYield",De="executing",ke="completed",Oe={};function qe(){}function Je(){}function mt(){}var Tt={};q(Tt,j,function(){return this});var It=Object.getPrototypeOf,Kt=It&&It(It(ma([])));Kt&&Kt!==f&&C.call(Kt,j)&&(Tt=Kt);var ir=mt.prototype=qe.prototype=Object.create(Tt);function _i(pe){["next","throw","return"].forEach(function(ne){q(pe,ne,function(ue){return this._invoke(ne,ue)})})}function Si(pe,ne){function ue(ze,Ne,vt,Bt){var Ut=ye(pe[ze],pe,Ne);if(Ut.type!=="throw"){var Ur=Ut.arg,Er=Ur.value;return Er&&v(Er)=="object"&&C.call(Er,"__await")?ne.resolve(Er.__await).then(function(kr){ue("next",kr,vt,Bt)},function(kr){ue("throw",kr,vt,Bt)}):ne.resolve(Er).then(function(kr){Ur.value=kr,vt(Ur)},function(kr){return ue("throw",kr,vt,Bt)})}Bt(Ut.arg)}var Fe;P(this,"_invoke",{value:function(Ne,vt){function Bt(){return new ne(function(Ut,Ur){ue(Ne,vt,Ut,Ur)})}return Fe=Fe?Fe.then(Bt,Bt):Bt()}})}function oo(pe,ne,ue){var Fe=Te;return function(ze,Ne){if(Fe===De)throw new Error("Generator is already running");if(Fe===ke){if(ze==="throw")throw Ne;return{value:s,done:!0}}for(ue.method=ze,ue.arg=Ne;;){var vt=ue.delegate;if(vt){var Bt=rs(vt,ue);if(Bt){if(Bt===Oe)continue;return Bt}}if(ue.method==="next")ue.sent=ue._sent=ue.arg;else if(ue.method==="throw"){if(Fe===Te)throw Fe=ke,ue.arg;ue.dispatchException(ue.arg)}else ue.method==="return"&&ue.abrupt("return",ue.arg);Fe=De;var Ut=ye(pe,ne,ue);if(Ut.type==="normal"){if(Fe=ue.done?ke:we,Ut.arg===Oe)continue;return{value:Ut.arg,done:ue.done}}Ut.type==="throw"&&(Fe=ke,ue.method="throw",ue.arg=Ut.arg)}}}function rs(pe,ne){var ue=ne.method,Fe=pe.iterator[ue];if(Fe===s)return ne.delegate=null,ue==="throw"&&pe.iterator.return&&(ne.method="return",ne.arg=s,rs(pe,ne),ne.method==="throw")||ue!=="return"&&(ne.method="throw",ne.arg=new TypeError("The iterator does not provide a '"+ue+"' method")),Oe;var ze=ye(Fe,pe.iterator,ne.arg);if(ze.type==="throw")return ne.method="throw",ne.arg=ze.arg,ne.delegate=null,Oe;var Ne=ze.arg;return Ne?Ne.done?(ne[pe.resultName]=Ne.value,ne.next=pe.nextLoc,ne.method!=="return"&&(ne.method="next",ne.arg=s),ne.delegate=null,Oe):Ne:(ne.method="throw",ne.arg=new TypeError("iterator result is not an object"),ne.delegate=null,Oe)}function uo(pe){var ne={tryLoc:pe[0]};1 in pe&&(ne.catchLoc=pe[1]),2 in pe&&(ne.finallyLoc=pe[2],ne.afterLoc=pe[3]),this.tryEntries.push(ne)}function la(pe){var ne=pe.completion||{};ne.type="normal",delete ne.arg,pe.completion=ne}function fa(pe){this.tryEntries=[{tryLoc:"root"}],pe.forEach(uo,this),this.reset(!0)}function ma(pe){if(pe||pe===""){var ne=pe[j];if(ne)return ne.call(pe);if(typeof pe.next=="function")return pe;if(!isNaN(pe.length)){var ue=-1,Fe=function ze(){for(;++ue<pe.length;)if(C.call(pe,ue))return ze.value=pe[ue],ze.done=!1,ze;return ze.value=s,ze.done=!0,ze};return Fe.next=Fe}}throw new TypeError(v(pe)+" is not iterable")}return Je.prototype=mt,P(ir,"constructor",{value:mt,configurable:!0}),P(mt,"constructor",{value:Je,configurable:!0}),Je.displayName=q(mt,K,"GeneratorFunction"),l.isGeneratorFunction=function(pe){var ne=typeof pe=="function"&&pe.constructor;return!!ne&&(ne===Je||(ne.displayName||ne.name)==="GeneratorFunction")},l.mark=function(pe){return Object.setPrototypeOf?Object.setPrototypeOf(pe,mt):(pe.__proto__=mt,q(pe,K,"GeneratorFunction")),pe.prototype=Object.create(ir),pe},l.awrap=function(pe){return{__await:pe}},_i(Si.prototype),q(Si.prototype,W,function(){return this}),l.AsyncIterator=Si,l.async=function(pe,ne,ue,Fe,ze){ze===void 0&&(ze=Promise);var Ne=new Si(re(pe,ne,ue,Fe),ze);return l.isGeneratorFunction(ne)?Ne:Ne.next().then(function(vt){return vt.done?vt.value:Ne.next()})},_i(ir),q(ir,K,"Generator"),q(ir,j,function(){return this}),q(ir,"toString",function(){return"[object Generator]"}),l.keys=function(pe){var ne=Object(pe),ue=[];for(var Fe in ne)ue.push(Fe);return ue.reverse(),function ze(){for(;ue.length;){var Ne=ue.pop();if(Ne in ne)return ze.value=Ne,ze.done=!1,ze}return ze.done=!0,ze}},l.values=ma,fa.prototype={constructor:fa,reset:function(ne){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(la),!ne)for(var ue in this)ue.charAt(0)==="t"&&C.call(this,ue)&&!isNaN(+ue.slice(1))&&(this[ue]=s)},stop:function(){this.done=!0;var ne=this.tryEntries[0].completion;if(ne.type==="throw")throw ne.arg;return this.rval},dispatchException:function(ne){if(this.done)throw ne;var ue=this;function Fe(Ur,Er){return vt.type="throw",vt.arg=ne,ue.next=Ur,Er&&(ue.method="next",ue.arg=s),!!Er}for(var ze=this.tryEntries.length-1;ze>=0;--ze){var Ne=this.tryEntries[ze],vt=Ne.completion;if(Ne.tryLoc==="root")return Fe("end");if(Ne.tryLoc<=this.prev){var Bt=C.call(Ne,"catchLoc"),Ut=C.call(Ne,"finallyLoc");if(Bt&&Ut){if(this.prev<Ne.catchLoc)return Fe(Ne.catchLoc,!0);if(this.prev<Ne.finallyLoc)return Fe(Ne.finallyLoc)}else if(Bt){if(this.prev<Ne.catchLoc)return Fe(Ne.catchLoc,!0)}else{if(!Ut)throw new Error("try statement without catch or finally");if(this.prev<Ne.finallyLoc)return Fe(Ne.finallyLoc)}}}},abrupt:function(ne,ue){for(var Fe=this.tryEntries.length-1;Fe>=0;--Fe){var ze=this.tryEntries[Fe];if(ze.tryLoc<=this.prev&&C.call(ze,"finallyLoc")&&this.prev<ze.finallyLoc){var Ne=ze;break}}Ne&&(ne==="break"||ne==="continue")&&Ne.tryLoc<=ue&&ue<=Ne.finallyLoc&&(Ne=null);var vt=Ne?Ne.completion:{};return vt.type=ne,vt.arg=ue,Ne?(this.method="next",this.next=Ne.finallyLoc,Oe):this.complete(vt)},complete:function(ne,ue){if(ne.type==="throw")throw ne.arg;return ne.type==="break"||ne.type==="continue"?this.next=ne.arg:ne.type==="return"?(this.rval=this.arg=ne.arg,this.method="return",this.next="end"):ne.type==="normal"&&ue&&(this.next=ue),Oe},finish:function(ne){for(var ue=this.tryEntries.length-1;ue>=0;--ue){var Fe=this.tryEntries[ue];if(Fe.finallyLoc===ne)return this.complete(Fe.completion,Fe.afterLoc),la(Fe),Oe}},catch:function(ne){for(var ue=this.tryEntries.length-1;ue>=0;--ue){var Fe=this.tryEntries[ue];if(Fe.tryLoc===ne){var ze=Fe.completion;if(ze.type==="throw"){var Ne=ze.arg;la(Fe)}return Ne}}throw new Error("illegal catch attempt")},delegateYield:function(ne,ue,Fe){return this.delegate={iterator:ma(ne),resultName:ue,nextLoc:Fe},this.method==="next"&&(this.arg=s),Oe}},l}function U(s,l){var f=Object.keys(s);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(s);l&&(C=C.filter(function(P){return Object.getOwnPropertyDescriptor(s,P).enumerable})),f.push.apply(f,C)}return f}function te(s){for(var l=1;l<arguments.length;l++){var f=arguments[l]!=null?arguments[l]:{};l%2?U(Object(f),!0).forEach(function(C){R(s,C,f[C])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(f)):U(Object(f)).forEach(function(C){Object.defineProperty(s,C,Object.getOwnPropertyDescriptor(f,C))})}return s}function R(s,l,f){return l=J(l),l in s?Object.defineProperty(s,l,{value:f,enumerable:!0,configurable:!0,writable:!0}):s[l]=f,s}function J(s){var l=$(s,"string");return v(l)=="symbol"?l:String(l)}function $(s,l){if(v(s)!="object"||!s)return s;var f=s[Symbol.toPrimitive];if(f!==void 0){var C=f.call(s,l||"default");if(v(C)!="object")return C;throw new TypeError("@@toPrimitive must return a primitive value.")}return(l==="string"?String:Number)(s)}function B(s,l,f,C,P,O,j){try{var W=s[O](j),K=W.value}catch(q){f(q);return}W.done?l(K):Promise.resolve(K).then(C,P)}function X(s){return function(){var l=this,f=arguments;return new Promise(function(C,P){var O=s.apply(l,f);function j(K){B(O,C,P,j,W,"next",K)}function W(K){B(O,C,P,j,W,"throw",K)}j(void 0)})}}function ie(s,l){return Ae(s)||Le(s,l)||ge(s,l)||se()}function se(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Le(s,l){var f=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(f!=null){var C,P,O,j,W=[],K=!0,q=!1;try{if(O=(f=f.call(s)).next,l===0){if(Object(f)!==f)return;K=!1}else for(;!(K=(C=O.call(f)).done)&&(W.push(C.value),W.length!==l);K=!0);}catch(re){q=!0,P=re}finally{try{if(!K&&f.return!=null&&(j=f.return(),Object(j)!==j))return}finally{if(q)throw P}}return W}}function Ae(s){if(Array.isArray(s))return s}function st(s,l){var f=typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(!f){if(Array.isArray(s)||(f=ge(s))||l&&s&&typeof s.length=="number"){f&&(s=f);var C=0,P=function(){};return{s:P,n:function(){return C>=s.length?{done:!0}:{done:!1,value:s[C++]}},e:function(q){throw q},f:P}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var O=!0,j=!1,W;return{s:function(){f=f.call(s)},n:function(){var q=f.next();return O=q.done,q},e:function(q){j=!0,W=q},f:function(){try{!O&&f.return!=null&&f.return()}finally{if(j)throw W}}}}function ot(s){return V(s)||G(s)||ge(s)||He()}function He(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ge(s,l){if(s){if(typeof s=="string")return Z(s,l);var f=Object.prototype.toString.call(s).slice(8,-1);if(f==="Object"&&s.constructor&&(f=s.constructor.name),f==="Map"||f==="Set")return Array.from(s);if(f==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(f))return Z(s,l)}}function G(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function V(s){if(Array.isArray(s))return Z(s)}function Z(s,l){(l==null||l>s.length)&&(l=s.length);for(var f=0,C=new Array(l);f<l;f++)C[f]=s[f];return C}var D=g.error,be=g.warn;function Se(s){return typeof document<"u"&&document.getElementById?document.getElementById(s):null}var Me=33984,We=35048,je=34962,rt=34963,Qe=35345,yt=35982,Ft=36386,dt=35713,ft=35714,xt=35632,Ct=35633,de=35981,c=35718,p=35721,x=35971,L=35382,E=35396,d=35398,m=35392,S=35395,_=5126,I=35664,k=35665,H=35666,Y=5124,ae=35667,oe=35668,ce=35669,me=35670,fe=35671,ve=35672,xe=35673,le=35674,Ee=35675,Ue=35676,Ze=35678,Ve=35680,Xe=35679,Re=35682,Ie=35685,tt=35686,Ye=35687,et=35688,Ke=35689,nt=35690,Be=36289,Ge=36292,Et=36293,pt=5125,Rt=36294,Lt=36295,Yt=36296,er=36298,tr=36299,xr=36300,Kr=36303,$r=36306,Qr=36307,gt=36308,Qi=36311,Zr=3553,Jr=34067,Cn=32879,en=35866,Pe={};function ui(s,l){return Pe[l].bindPoint}function Zi(s,l){return function(f){s.uniform1f(l,f)}}function Ji(s,l){return function(f){s.uniform1fv(l,f)}}function ea(s,l){return function(f){s.uniform2fv(l,f)}}function ta(s,l){return function(f){s.uniform3fv(l,f)}}function ra(s,l){return function(f){s.uniform4fv(l,f)}}function ci(s,l){return function(f){s.uniform1i(l,f)}}function hi(s,l){return function(f){s.uniform1iv(l,f)}}function li(s,l){return function(f){s.uniform2iv(l,f)}}function fi(s,l){return function(f){s.uniform3iv(l,f)}}function mi(s,l){return function(f){s.uniform4iv(l,f)}}function rr(s,l){return function(f){s.uniform1ui(l,f)}}function ut(s,l){return function(f){s.uniform1uiv(l,f)}}function tn(s,l){return function(f){s.uniform2uiv(l,f)}}function gr(s,l){return function(f){s.uniform3uiv(l,f)}}function rn(s,l){return function(f){s.uniform4uiv(l,f)}}function sr(s,l){return function(f){s.uniformMatrix2fv(l,!1,f)}}function wt(s,l){return function(f){s.uniformMatrix3fv(l,!1,f)}}function yi(s,l){return function(f){s.uniformMatrix4fv(l,!1,f)}}function di(s,l){return function(f){s.uniformMatrix2x3fv(l,!1,f)}}function pi(s,l){return function(f){s.uniformMatrix3x2fv(l,!1,f)}}function kt(s,l){return function(f){s.uniformMatrix2x4fv(l,!1,f)}}function Br(s,l){return function(f){s.uniformMatrix4x2fv(l,!1,f)}}function Rn(s,l){return function(f){s.uniformMatrix3x4fv(l,!1,f)}}function na(s,l){return function(f){s.uniformMatrix4x3fv(l,!1,f)}}function At(s,l,f,C){var P=ui(s,l);return y.isWebGL2(s)?function(O){var j,W;!O||g.isTexture(s,O)?(j=O,W=null):(j=O.texture,W=O.sampler),s.uniform1i(C,f),s.activeTexture(Me+f),s.bindTexture(P,j),s.bindSampler(f,W)}:function(O){s.uniform1i(C,f),s.activeTexture(Me+f),s.bindTexture(P,O)}}function Mt(s,l,f,C,P){for(var O=ui(s,l),j=new Int32Array(P),W=0;W<P;++W)j[W]=f+W;return y.isWebGL2(s)?function(K){s.uniform1iv(C,j),K.forEach(function(q,re){s.activeTexture(Me+j[re]);var ye,Te;!q||g.isTexture(s,q)?(ye=q,Te=null):(ye=q.texture,Te=q.sampler),s.bindSampler(f,Te),s.bindTexture(O,ye)})}:function(K){s.uniform1iv(C,j),K.forEach(function(q,re){s.activeTexture(Me+j[re]),s.bindTexture(O,q)})}}Pe[_]={Type:Float32Array,size:4,setter:Zi,arraySetter:Ji},Pe[I]={Type:Float32Array,size:8,setter:ea,cols:2},Pe[k]={Type:Float32Array,size:12,setter:ta,cols:3},Pe[H]={Type:Float32Array,size:16,setter:ra,cols:4},Pe[Y]={Type:Int32Array,size:4,setter:ci,arraySetter:hi},Pe[ae]={Type:Int32Array,size:8,setter:li,cols:2},Pe[oe]={Type:Int32Array,size:12,setter:fi,cols:3},Pe[ce]={Type:Int32Array,size:16,setter:mi,cols:4},Pe[pt]={Type:Uint32Array,size:4,setter:rr,arraySetter:ut},Pe[Rt]={Type:Uint32Array,size:8,setter:tn,cols:2},Pe[Lt]={Type:Uint32Array,size:12,setter:gr,cols:3},Pe[Yt]={Type:Uint32Array,size:16,setter:rn,cols:4},Pe[me]={Type:Uint32Array,size:4,setter:ci,arraySetter:hi},Pe[fe]={Type:Uint32Array,size:8,setter:li,cols:2},Pe[ve]={Type:Uint32Array,size:12,setter:fi,cols:3},Pe[xe]={Type:Uint32Array,size:16,setter:mi,cols:4},Pe[le]={Type:Float32Array,size:32,setter:sr,rows:2,cols:2},Pe[Ee]={Type:Float32Array,size:48,setter:wt,rows:3,cols:3},Pe[Ue]={Type:Float32Array,size:64,setter:yi,rows:4,cols:4},Pe[Ie]={Type:Float32Array,size:32,setter:di,rows:2,cols:3},Pe[tt]={Type:Float32Array,size:32,setter:kt,rows:2,cols:4},Pe[Ye]={Type:Float32Array,size:48,setter:pi,rows:3,cols:2},Pe[et]={Type:Float32Array,size:48,setter:Rn,rows:3,cols:4},Pe[Ke]={Type:Float32Array,size:64,setter:Br,rows:4,cols:2},Pe[nt]={Type:Float32Array,size:64,setter:na,rows:4,cols:3},Pe[Ze]={Type:null,size:0,setter:At,arraySetter:Mt,bindPoint:Zr},Pe[Ve]={Type:null,size:0,setter:At,arraySetter:Mt,bindPoint:Jr},Pe[Xe]={Type:null,size:0,setter:At,arraySetter:Mt,bindPoint:Cn},Pe[Re]={Type:null,size:0,setter:At,arraySetter:Mt,bindPoint:Zr},Pe[Be]={Type:null,size:0,setter:At,arraySetter:Mt,bindPoint:en},Pe[Ge]={Type:null,size:0,setter:At,arraySetter:Mt,bindPoint:en},Pe[Et]={Type:null,size:0,setter:At,arraySetter:Mt,bindPoint:Jr},Pe[er]={Type:null,size:0,setter:At,arraySetter:Mt,bindPoint:Zr},Pe[tr]={Type:null,size:0,setter:At,arraySetter:Mt,bindPoint:Cn},Pe[xr]={Type:null,size:0,setter:At,arraySetter:Mt,bindPoint:Jr},Pe[Kr]={Type:null,size:0,setter:At,arraySetter:Mt,bindPoint:en},Pe[$r]={Type:null,size:0,setter:At,arraySetter:Mt,bindPoint:Zr},Pe[Qr]={Type:null,size:0,setter:At,arraySetter:Mt,bindPoint:Cn},Pe[gt]={Type:null,size:0,setter:At,arraySetter:Mt,bindPoint:Jr},Pe[Qi]={Type:null,size:0,setter:At,arraySetter:Mt,bindPoint:en};function nn(s,l){return function(f){if(f.value)switch(s.disableVertexAttribArray(l),f.value.length){case 4:s.vertexAttrib4fv(l,f.value);break;case 3:s.vertexAttrib3fv(l,f.value);break;case 2:s.vertexAttrib2fv(l,f.value);break;case 1:s.vertexAttrib1fv(l,f.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else s.bindBuffer(je,f.buffer),s.enableVertexAttribArray(l),s.vertexAttribPointer(l,f.numComponents||f.size,f.type||_,f.normalize||!1,f.stride||0,f.offset||0),s.vertexAttribDivisor&&s.vertexAttribDivisor(l,f.divisor||0)}}function zt(s,l){return function(f){if(f.value)if(s.disableVertexAttribArray(l),f.value.length===4)s.vertexAttrib4iv(l,f.value);else throw new Error("The length of an integer constant value must be 4!");else s.bindBuffer(je,f.buffer),s.enableVertexAttribArray(l),s.vertexAttribIPointer(l,f.numComponents||f.size,f.type||Y,f.stride||0,f.offset||0),s.vertexAttribDivisor&&s.vertexAttribDivisor(l,f.divisor||0)}}function jt(s,l){return function(f){if(f.value)if(s.disableVertexAttribArray(l),f.value.length===4)s.vertexAttrib4uiv(l,f.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else s.bindBuffer(je,f.buffer),s.enableVertexAttribArray(l),s.vertexAttribIPointer(l,f.numComponents||f.size,f.type||pt,f.stride||0,f.offset||0),s.vertexAttribDivisor&&s.vertexAttribDivisor(l,f.divisor||0)}}function or(s,l,f){var C=f.size,P=f.count;return function(O){s.bindBuffer(je,O.buffer);for(var j=O.size||O.numComponents||C,W=j/P,K=O.type||_,q=Pe[K],re=q.size*j,ye=O.normalize||!1,Te=O.offset||0,we=re/P,De=0;De<P;++De)s.enableVertexAttribArray(l+De),s.vertexAttribPointer(l+De,W,K,ye,re,Te+we*De),s.vertexAttribDivisor&&s.vertexAttribDivisor(l+De,O.divisor||0)}}var at={};at[_]={size:4,setter:nn},at[I]={size:8,setter:nn},at[k]={size:12,setter:nn},at[H]={size:16,setter:nn},at[Y]={size:4,setter:zt},at[ae]={size:8,setter:zt},at[oe]={size:12,setter:zt},at[ce]={size:16,setter:zt},at[pt]={size:4,setter:jt},at[Rt]={size:8,setter:jt},at[Lt]={size:12,setter:jt},at[Yt]={size:16,setter:jt},at[me]={size:4,setter:zt},at[fe]={size:8,setter:zt},at[ve]={size:12,setter:zt},at[xe]={size:16,setter:zt},at[le]={size:4,setter:or,count:2},at[Ee]={size:9,setter:or,count:3},at[Ue]={size:16,setter:or,count:4};var ur=/ERROR:\s*\d+:(\d+)/gi;function nr(s){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,C=ot(l.matchAll(ur)),P=new Map(C.map(function(O,j){var W=parseInt(O[1]),K=C[j+1],q=K?K.index:l.length,re=l.substring(O.index,q);return[W-1,re]}));return s.split(`
`).map(function(O,j){var W=P.get(j);return"".concat(j+1+f,": ").concat(O).concat(W?`

^^^ `.concat(W):"")}).join(`
`)}var Pn=/^[ \t]*\n/;function _t(s){var l=0;return Pn.test(s)&&(l=1,s=s.replace(Pn,"")),{lineOffset:l,shaderSource:s}}function an(s,l){return s.errorCallback(l),s.callback&&setTimeout(function(){s.callback("".concat(l,`
`).concat(s.errors.join(`
`)))}),null}function sn(s,l,f,C){C=C||D;var P=s.getShaderParameter(f,dt);if(!P){var O=s.getShaderInfoLog(f),j=_t(s.getShaderSource(f)),W=j.lineOffset,K=j.shaderSource,q="".concat(nr(K,O,W),`
Error compiling `).concat(y.glEnumToString(s,l),": ").concat(O);return C(q),q}return""}function cr(s,l,f){var C,P,O;if(typeof l=="function"&&(f=l,l=void 0),typeof s=="function")f=s,s=void 0;else if(s&&!Array.isArray(s)){var j=s;f=j.errorCallback,s=j.attribLocations,C=j.transformFeedbackVaryings,P=j.transformFeedbackMode,O=j.callback}var W=f||D,K=[],q={errorCallback:function(Te){K.push(Te);for(var we=arguments.length,De=new Array(we>1?we-1:0),ke=1;ke<we;ke++)De[ke-1]=arguments[ke];W.apply(void 0,[Te].concat(De))},transformFeedbackVaryings:C,transformFeedbackMode:P,callback:O,errors:K};{var re={};Array.isArray(s)?s.forEach(function(ye,Te){re[ye]=l?l[Te]:Te}):re=s||{},q.attribLocations=re}return q}var hr=["VERTEX_SHADER","FRAGMENT_SHADER"];function vi(s,l){if(l.indexOf("frag")>=0)return xt;if(l.indexOf("vert")>=0)return Ct}function xi(s,l,f){var C=s.getAttachedShaders(l),P=st(C),O;try{for(P.s();!(O=P.n()).done;){var j=O.value;f.has(j)&&s.deleteShader(j)}}catch(W){P.e(W)}finally{P.f()}s.deleteProgram(l)}var gi=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new Promise(function(f){return setTimeout(f,l)})};function bi(s,l,f){for(var C=s.createProgram(),P=cr(f),O=P.attribLocations,j=P.transformFeedbackVaryings,W=P.transformFeedbackMode,K=0;K<l.length;++K){var q=l[K];if(typeof q=="string"){var re=Se(q),ye=re?re.text:q,Te=s[hr[K]];re&&re.type&&(Te=vi(s,re.type)||Te),q=s.createShader(Te),s.shaderSource(q,_t(ye).shaderSource),s.compileShader(q),s.attachShader(C,q)}}Object.entries(O).forEach(function(De){var ke=ie(De,2),Oe=ke[0],qe=ke[1];return s.bindAttribLocation(C,qe,Oe)});{var we=j;we&&(we.attribs&&(we=we.attribs),Array.isArray(we)||(we=Object.keys(we)),s.transformFeedbackVaryings(C,we,W||de))}return s.linkProgram(C),C}function Or(s,l,f,C,P){var O=cr(f,C,P),j=new Set(l),W=bi(s,l,O);function K(q,re){var ye=Ln(q,re,O.errorCallback);return ye&&xi(q,re,j),ye}if(O.callback){Nn(s,W).then(function(){var q=K(s,W);O.callback(q,q?void 0:W)});return}return K(s,W)?void 0:W}function lr(s){return function(l,f){for(var C=arguments.length,P=new Array(C>2?C-2:0),O=2;O<C;O++)P[O-2]=arguments[O];return new Promise(function(j,W){var K=cr.apply(void 0,P);K.callback=function(q,re){q?W(q):j(re)},s(l,f,K)})}}i.createProgramAsync=lr(Or),i.createProgramInfoAsync=lr(T);function Nn(s,l){return Dn.apply(this,arguments)}function Dn(){return Dn=X(F().mark(function s(l,f){var C,P,O;return F().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:C=l.getExtension("KHR_parallel_shader_compile"),P=C?function(K,q){return K.getProgramParameter(q,C.COMPLETION_STATUS_KHR)}:function(){return!0},O=0;case 3:return W.next=5,gi(O);case 5:O=16.666666666666668;case 6:if(!P(l,f)){W.next=3;break}case 7:case"end":return W.stop()}},s)})),Dn.apply(this,arguments)}function br(s,l){return on.apply(this,arguments)}function on(){return on=X(F().mark(function s(l,f){var C,P,O;return F().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:C=0,P=Object.values(f);case 1:if(!(C<P.length)){W.next=8;break}return O=P[C],W.next=5,Nn(l,O);case 5:C++,W.next=1;break;case 8:case"end":return W.stop()}},s)})),on.apply(this,arguments)}function Ln(s,l,f){f=f||D;var C=s.getProgramParameter(l,ft);if(!C){var P=s.getProgramInfoLog(l);f("Error in program linking: ".concat(P));var O=s.getAttachedShaders(l),j=O.map(function(W){return sn(s,s.getShaderParameter(W,s.SHADER_TYPE),W,f)});return"".concat(P,`
`).concat(j.filter(function(W){return W}).join(`
`))}}function In(s,l,f,C,P){var O=cr(f,C,P),j=[],W=st(l),K;try{for(W.s();!(K=W.n()).done;){var q=K.value,re=Se(q);if(!re)return an(O,"unknown script element: ".concat(q));j.push(re.text)}}catch(ye){W.e(ye)}finally{W.f()}return Or(s,j,O)}function Bn(s,l,f,C,P){return Or(s,l,f,C,P)}function On(s){var l=s.name;return l.startsWith("gl_")||l.startsWith("webgl_")}var ia=/(\.|\[|]|\w+)/g,aa=function(l){return l>="0"&&l<="9"};function zr(s,l,f,C){for(var P=s.split(ia).filter(function(De){return De!==""}),O=0,j="";;){var W=P[O++];j+=W;var K=aa(W[0]),q=K?parseInt(W):W;K&&(j+=P[O++]);var re=O===P.length;if(re){f[q]=l;break}else{var ye=P[O++],Te=ye==="[",we=f[q]||(Te?[]:{});f[q]=we,f=we,C[j]=C[j]||function(De){return function(ke){wi(De,ke)}}(we),j+=ye}}}function Tr(s,l){var f=0;function C(Te,we,De){var ke=we.name.endsWith("[0]"),Oe=we.type,qe=Pe[Oe];if(!qe)throw new Error("unknown type: 0x".concat(Oe.toString(16)));var Je;if(qe.bindPoint){var mt=f;f+=we.size,ke?Je=qe.arraySetter(s,Oe,mt,De,we.size):Je=qe.setter(s,Oe,mt,De,we.size)}else qe.arraySetter&&ke?Je=qe.arraySetter(s,De):Je=qe.setter(s,De);return Je.location=De,Je}for(var P={},O={},j=s.getProgramParameter(l,c),W=0;W<j;++W){var K=s.getActiveUniform(l,W);if(!On(K)){var q=K.name;q.endsWith("[0]")&&(q=q.substr(0,q.length-3));var re=s.getUniformLocation(l,K.name);if(re){var ye=C(l,K,re);P[q]=ye,zr(q,ye,O,P)}}}return P}function un(s,l){for(var f={},C=s.getProgramParameter(l,x),P=0;P<C;++P){var O=s.getTransformFeedbackVarying(l,P);f[O.name]={index:P,type:O.type,size:O.size}}return f}function cn(s,l,f){l.transformFeedbackInfo&&(l=l.transformFeedbackInfo),f.attribs&&(f=f.attribs);for(var C in f){var P=l[C];if(P){var O=f[C];O.offset?s.bindBufferRange(yt,P.index,O.buffer,O.offset,O.size):s.bindBufferBase(yt,P.index,O.buffer)}}}function zn(s,l,f){var C=s.createTransformFeedback();return s.bindTransformFeedback(Ft,C),s.useProgram(l.program),cn(s,l,f),s.bindTransformFeedback(Ft,null),C}function fr(s,l){for(var f=s.getProgramParameter(l,c),C=[],P=[],O=0;O<f;++O){P.push(O),C.push({});var j=s.getActiveUniform(l,O);C[O].name=j.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(Te){var we=Te[0],De=Te[1];s.getActiveUniforms(l,P,s[we]).forEach(function(ke,Oe){C[Oe][De]=ke})});for(var W={},K=s.getProgramParameter(l,L),q=0;q<K;++q){var re=s.getActiveUniformBlockName(l,q),ye={index:s.getUniformBlockIndex(l,re),usedByVertexShader:s.getActiveUniformBlockParameter(l,q,E),usedByFragmentShader:s.getActiveUniformBlockParameter(l,q,d),size:s.getActiveUniformBlockParameter(l,q,m),uniformIndices:s.getActiveUniformBlockParameter(l,q,S)};ye.used=ye.usedByVertexShader||ye.usedByFragmentShader,W[re]=ye}return{blockSpecs:W,uniformData:C}}var Ti=/\[\d+\]\.$/,sa=function(l,f){return((l+(f-1))/f|0)*f};function oa(s,l,f,C){if(l||f){C=C||1;var P=s.length,O=P/4;return function(j){for(var W=0,K=0,q=0;q<O;++q){for(var re=0;re<C;++re)s[W++]=j[K++];W+=4-C}}}else return function(j){j.length?s.set(j):s[0]=j}}function Un(s,l,f,C){var P=f.blockSpecs,O=f.uniformData,j=P[C];if(!j)return be("no uniform block object named:",C),{name:C,uniforms:{}};var W=new ArrayBuffer(j.size),K=s.createBuffer(),q=j.index;s.bindBuffer(Qe,K),s.uniformBlockBinding(l,j.index,q);var re=C+".";Ti.test(re)&&(re=re.replace(Ti,"."));var ye={},Te={},we={};return j.uniformIndices.forEach(function(De){var ke=O[De],Oe=ke.name;Oe.startsWith(re)&&(Oe=Oe.substr(re.length));var qe=Oe.endsWith("[0]");qe&&(Oe=Oe.substr(0,Oe.length-3));var Je=Pe[ke.type],mt=Je.Type,Tt=qe?sa(Je.size,16)*ke.size:Je.size*ke.size,It=new mt(W,ke.offset,Tt/mt.BYTES_PER_ELEMENT);ye[Oe]=It;var Kt=oa(It,qe,Je.rows,Je.cols);Te[Oe]=Kt,zr(Oe,Kt,we,Te)}),{name:C,array:W,asFloat:new Float32Array(W),buffer:K,uniforms:ye,setters:Te}}function kn(s,l,f){return Un(s,l.program,l.uniformBlockSpec,f)}function hn(s,l,f){var C=l.uniformBlockSpec||l,P=C.blockSpecs[f.name];if(P){var O=P.index;return s.bindBufferRange(Qe,O,f.buffer,f.offset||0,f.array.byteLength),!0}return!1}function Ei(s,l,f){hn(s,l,f)&&s.bufferData(Qe,f.array,We)}function ua(s,l){var f=s.setters;for(var C in l){var P=f[C];if(P){var O=l[C];P(O)}}}function wi(s,l){for(var f in l){var C=s[f];typeof C=="function"?C(l[f]):wi(s[f],l[f])}}function ln(s){for(var l=s.uniformSetters||s,f=arguments.length<=1?0:arguments.length-1,C=0;C<f;++C){var P=C+1<1||arguments.length<=C+1?void 0:arguments[C+1];if(Array.isArray(P))for(var O=P.length,j=0;j<O;++j)ln(l,P[j]);else for(var W in P){var K=l[W];K&&K(P[W])}}}i.setUniformsAndBindTextures=ln;function Gn(s,l){for(var f={},C=s.getProgramParameter(l,p),P=0;P<C;++P){var O=s.getActiveAttrib(l,P);if(!On(O)){var j=s.getAttribLocation(l,O.name),W=at[O.type],K=W.setter(s,j,W);K.location=j,f[O.name]=K}}return f}function Wn(s,l){for(var f in l){var C=s[f];C&&C(l[f])}}function ca(s,l,f){f.vertexArrayObject?s.bindVertexArray(f.vertexArrayObject):(Wn(l.attribSetters||l,f.attribs),f.indices&&s.bindBuffer(rt,f.indices))}function fn(s,l){var f=Tr(s,l),C=Gn(s,l),P={program:l,uniformSetters:f,attribSetters:C};return y.isWebGL2(s)&&(P.uniformBlockSpec=fr(s,l),P.transformFeedbackInfo=un(s,l)),P}var ha=/\s|{|}|;/;function T(s,l,f,C,P){var O=cr(f,C,P),j=[];if(l=l.map(function(q){if(!ha.test(q)){var re=Se(q);if(re)q=re.text;else{var ye="no element with id: ".concat(q);O.errorCallback(ye),j.push(ye)}}return q}),j.length)return an(O,"");var W=O.callback;W&&(O.callback=function(q,re){W(q,q?void 0:fn(s,re))});var K=Bn(s,l,O);return K?fn(s,K):null}function A(s,l,f,C,P){for(var O=0,j=Object.entries(l);O<j.length;O++){var W=ie(j[O],2),K=W[0],q=W[1],re=te({},P),ye=f[K];Array.isArray(ye)||Object.assign(re,ye);var Te=Ln(s,q,re.errorCallback);if(Te){for(var we=0,De=Object.values(l);we<De.length;we++){var ke=De[we],Oe=s.getAttachedShaders(ke);s.deleteProgram(ke);var qe=st(Oe),Je;try{for(qe.s();!(Je=qe.n()).done;){var mt=Je.value;C.has(mt)||s.deleteShader(mt)}}catch(Tt){qe.e(Tt)}finally{qe.f()}}return Te}}}function M(s,l){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},C=new Set,P=Object.fromEntries(Object.entries(l).map(function(j){var W=ie(j,2),K=W[0],q=W[1],re=te({},f),ye=Array.isArray(q)?q:q.shaders;return Array.isArray(q)||Object.assign(re,q),ye.forEach(C.add,C),[K,bi(s,ye,re)]}));if(f.callback){br(s,P).then(function(){var j=A(s,P,l,C,f);f.callback(j,j?void 0:P)});return}var O=A(s,P,l,C,f);return O?void 0:P}function z(s,l,f){f=cr(f);function C(j,W){return Object.fromEntries(Object.entries(W).map(function(K){var q=ie(K,2),re=q[0],ye=q[1];return[re,fn(j,ye)]}))}var P=f.callback;P&&(f.callback=function(j,W){P(j,j?void 0:C(s,W))});var O=M(s,l,f);if(!(P||!O))return C(s,O)}i.createProgramsAsync=lr(M),i.createProgramInfosAsync=lr(z)},"./src/textures.js":(o,i,h)=>{function v(T){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(A){return typeof A}:function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},v(T)}i.__esModule=!0,i.canFilter=gi,i.canGenerateMipmap=xi,i.createSampler=On,i.createSamplers=ia,i.createTexture=Wn,i.createTextures=ha,i.getBytesPerElementForInternalFormat=cr,i.getFormatAndTypeForInternalFormat=hr,i.getNumComponentsForFormat=bi,i.loadTextureFromUrl=Ei,i.resizeTexture=ca,i.setDefaultTextureColor=Nn,i.setEmptyTexture=Gn,i.setSamplerParameters=Bn,i.setTextureDefaults_=Dn,i.setTextureFilteringForSize=zr,i.setTextureFromArray=ln,i.setTextureFromElement=zn,i.setTextureParameters=In;var y=F(h("./src/utils.js")),g=F(h("./src/typedarrays.js")),w=F(h("./src/helper.js"));function b(T){if(typeof WeakMap!="function")return null;var A=new WeakMap,M=new WeakMap;return(b=function(s){return s?M:A})(T)}function F(T,A){if(!A&&T&&T.__esModule)return T;if(T===null||v(T)!="object"&&typeof T!="function")return{default:T};var M=b(A);if(M&&M.has(T))return M.get(T);var z={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in T)if(l!=="default"&&Object.prototype.hasOwnProperty.call(T,l)){var f=s?Object.getOwnPropertyDescriptor(T,l):null;f&&(f.get||f.set)?Object.defineProperty(z,l,f):z[l]=T[l]}return z.default=T,M&&M.set(T,z),z}var U={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},te=g.isArrayBuffer,R=function(){var T;return function(){return T=T||(typeof document<"u"&&document.createElement?document.createElement("canvas").getContext("2d"):null),T}}(),J=6406,$=6407,B=6408,X=6409,ie=6410,se=6402,Le=34041,Ae=33071,st=9728,ot=9729,He=3553,ge=34067,G=32879,V=35866,Z=34069,D=34070,be=34071,Se=34072,Me=34073,We=34074,je=10241,rt=10240,Qe=10242,yt=10243,Ft=32882,dt=33082,ft=33083,xt=33084,Ct=33085,de=34892,c=34893,p=3317,x=3314,L=32878,E=3316,d=3315,m=32877,S=37443,_=37441,I=37440,k=33321,H=36756,Y=33325,ae=33326,oe=33330,ce=33329,me=33338,fe=33337,ve=33340,xe=33339,le=33323,Ee=36757,Ue=33327,Ze=33328,Ve=33336,Xe=33335,Re=33332,Ie=33331,tt=33334,Ye=33333,et=32849,Ke=35905,nt=36194,Be=36758,Ge=35898,Et=35901,pt=34843,Rt=34837,Lt=36221,Yt=36239,er=36215,tr=36233,xr=36209,Kr=36227,$r=32856,Qr=35907,gt=36759,Qi=32855,Zr=32854,Jr=32857,Cn=34842,en=34836,Pe=36220,ui=36238,Zi=36975,Ji=36214,ea=36232,ta=36226,ra=36208,ci=33189,hi=33190,li=36012,fi=36013,mi=35056,rr=5120,ut=5121,tn=5122,gr=5123,rn=5124,sr=5125,wt=5126,yi=32819,di=32820,pi=33635,kt=5131,Br=36193,Rn=33640,na=35899,At=35902,Mt=36269,nn=34042,zt=33319,jt=33320,or=6403,at=36244,ur=36248,nr=36249,Pn={};{var _t=Pn;_t[J]={numColorComponents:1},_t[X]={numColorComponents:1},_t[ie]={numColorComponents:2},_t[$]={numColorComponents:3},_t[B]={numColorComponents:4},_t[or]={numColorComponents:1},_t[at]={numColorComponents:1},_t[zt]={numColorComponents:2},_t[jt]={numColorComponents:2},_t[$]={numColorComponents:3},_t[ur]={numColorComponents:3},_t[B]={numColorComponents:4},_t[nr]={numColorComponents:4},_t[se]={numColorComponents:1},_t[Le]={numColorComponents:2}}var an;function sn(T){if(!an){var A={};A[J]={textureFormat:J,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[ut,kt,Br,wt]},A[X]={textureFormat:X,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[ut,kt,Br,wt]},A[ie]={textureFormat:ie,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[ut,kt,Br,wt]},A[$]={textureFormat:$,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[ut,kt,Br,wt,pi]},A[B]={textureFormat:B,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[ut,kt,Br,wt,yi,di]},A[se]={textureFormat:se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[sr,gr]},A[k]={textureFormat:or,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[ut]},A[H]={textureFormat:or,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[rr]},A[Y]={textureFormat:or,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[wt,kt]},A[ae]={textureFormat:or,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[wt]},A[oe]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[ut]},A[ce]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[rr]},A[Re]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[gr]},A[Ie]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[tn]},A[tt]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[sr]},A[Ye]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[rn]},A[le]={textureFormat:zt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[ut]},A[Ee]={textureFormat:zt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[rr]},A[Ue]={textureFormat:zt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[wt,kt]},A[Ze]={textureFormat:zt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[wt]},A[Ve]={textureFormat:jt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[ut]},A[Xe]={textureFormat:jt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[rr]},A[me]={textureFormat:jt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[gr]},A[fe]={textureFormat:jt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[tn]},A[ve]={textureFormat:jt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[sr]},A[xe]={textureFormat:jt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[rn]},A[et]={textureFormat:$,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[ut]},A[Ke]={textureFormat:$,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[ut]},A[nt]={textureFormat:$,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[ut,pi]},A[Be]={textureFormat:$,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[rr]},A[Ge]={textureFormat:$,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[wt,kt,na]},A[Et]={textureFormat:$,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[wt,kt,At]},A[pt]={textureFormat:$,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[wt,kt]},A[Rt]={textureFormat:$,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[wt]},A[Lt]={textureFormat:ur,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[ut]},A[Yt]={textureFormat:ur,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[rr]},A[er]={textureFormat:ur,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[gr]},A[tr]={textureFormat:ur,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[tn]},A[xr]={textureFormat:ur,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[sr]},A[Kr]={textureFormat:ur,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[rn]},A[$r]={textureFormat:B,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[ut]},A[Qr]={textureFormat:B,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[ut]},A[gt]={textureFormat:B,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[rr]},A[Qi]={textureFormat:B,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[ut,di,Rn]},A[Zr]={textureFormat:B,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[ut,yi]},A[Jr]={textureFormat:B,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[Rn]},A[Cn]={textureFormat:B,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[wt,kt]},A[en]={textureFormat:B,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[wt]},A[Pe]={textureFormat:nr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ut]},A[ui]={textureFormat:nr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[rr]},A[Zi]={textureFormat:nr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Rn]},A[Ji]={textureFormat:nr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[gr]},A[ea]={textureFormat:nr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[tn]},A[ta]={textureFormat:nr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[rn]},A[ra]={textureFormat:nr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[sr]},A[ci]={textureFormat:se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[gr,sr]},A[hi]={textureFormat:se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[sr]},A[li]={textureFormat:se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[wt]},A[mi]={textureFormat:Le,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[nn]},A[fi]={textureFormat:Le,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Mt]},Object.keys(A).forEach(function(M){var z=A[M];z.bytesPerElementMap={},z.bytesPerElement.forEach(function(s,l){var f=z.type[l];z.bytesPerElementMap[f]=s})}),an=A}return an[T]}function cr(T,A){var M=sn(T);if(!M)throw"unknown internal format";var z=M.bytesPerElementMap[A];if(z===void 0)throw"unknown internal format";return z}function hr(T){var A=sn(T);if(!A)throw"unknown internal format";return{format:A.textureFormat,type:A.type[0]}}function vi(T){return(T&T-1)===0}function xi(T,A,M,z){if(!y.isWebGL2(T))return vi(A)&&vi(M);var s=sn(z);if(!s)throw"unknown internal format";return s.colorRenderable&&s.textureFilterable}function gi(T){var A=sn(T);if(!A)throw"unknown internal format";return A.textureFilterable}function bi(T){var A=Pn[T];if(!A)throw"unknown format: "+T;return A.numColorComponents}function Or(T,A,M){return te(A)?g.getGLTypeForTypedArray(A):M||ut}function lr(T,A,M,z,s){if(s%1!==0)throw"can't guess dimensions";if(!M&&!z){var l=Math.sqrt(s/(A===ge?6:1));l%1===0?(M=l,z=l):(M=s,z=1)}else if(z){if(!M&&(M=s/z,M%1))throw"can't guess dimensions"}else if(z=s/M,z%1)throw"can't guess dimensions";return{width:M,height:z}}function Nn(T){U.textureColor=new Uint8Array([T[0]*255,T[1]*255,T[2]*255,T[3]*255])}function Dn(T){w.copyExistingProperties(T,U),T.textureColor&&Nn(T.textureColor)}function br(T,A){A.colorspaceConversion!==void 0&&T.pixelStorei(S,A.colorspaceConversion),A.premultiplyAlpha!==void 0&&T.pixelStorei(_,A.premultiplyAlpha),A.flipY!==void 0&&T.pixelStorei(I,A.flipY)}function on(T){T.pixelStorei(p,4),y.isWebGL2(T)&&(T.pixelStorei(x,0),T.pixelStorei(L,0),T.pixelStorei(E,0),T.pixelStorei(d,0),T.pixelStorei(m,0))}function Ln(T,A,M,z){z.minMag&&(M.call(T,A,je,z.minMag),M.call(T,A,rt,z.minMag)),z.min&&M.call(T,A,je,z.min),z.mag&&M.call(T,A,rt,z.mag),z.wrap&&(M.call(T,A,Qe,z.wrap),M.call(T,A,yt,z.wrap),(A===G||w.isSampler(T,A))&&M.call(T,A,Ft,z.wrap)),z.wrapR&&M.call(T,A,Ft,z.wrapR),z.wrapS&&M.call(T,A,Qe,z.wrapS),z.wrapT&&M.call(T,A,yt,z.wrapT),z.minLod!==void 0&&M.call(T,A,dt,z.minLod),z.maxLod!==void 0&&M.call(T,A,ft,z.maxLod),z.baseLevel!==void 0&&M.call(T,A,xt,z.baseLevel),z.maxLevel!==void 0&&M.call(T,A,Ct,z.maxLevel),z.compareFunc!==void 0&&M.call(T,A,c,z.compareFunc),z.compareMode!==void 0&&M.call(T,A,de,z.compareMode)}function In(T,A,M){var z=M.target||He;T.bindTexture(z,A),Ln(T,z,T.texParameteri,M)}function Bn(T,A,M){Ln(T,A,T.samplerParameteri,M)}function On(T,A){var M=T.createSampler();return Bn(T,M,A),M}function ia(T,A){var M={};return Object.keys(A).forEach(function(z){M[z]=On(T,A[z])}),M}function aa(T){return T=T||U.textureColor,te(T)?T:new Uint8Array([T[0]*255,T[1]*255,T[2]*255,T[3]*255])}function zr(T,A,M,z,s,l){M=M||U.textureOptions,l=l||B;var f=M.target||He;if(z=z||M.width,s=s||M.height,T.bindTexture(f,A),xi(T,z,s,l))T.generateMipmap(f);else{var C=gi(l)?ot:st;T.texParameteri(f,je,C),T.texParameteri(f,rt,C),T.texParameteri(f,Qe,Ae),T.texParameteri(f,yt,Ae)}}function Tr(T){return T.auto===!0||T.auto===void 0&&T.level===void 0}function un(T,A){return A=A||{},A.cubeFaceOrder||[Z,D,be,Se,Me,We]}function cn(T,A){var M=un(T,A),z=M.map(function(s,l){return{face:s,ndx:l}});return z.sort(function(s,l){return s.face-l.face}),z}function zn(T,A,M,z){z=z||U.textureOptions;var s=z.target||He,l=z.level||0,f=M.width,C=M.height,P=z.internalFormat||z.format||B,O=hr(P),j=z.format||O.format,W=z.type||O.type;if(br(T,z),T.bindTexture(s,A),s===ge){var K=M.width,q=M.height,re,ye;if(K/6===q)re=q,ye=[0,0,1,0,2,0,3,0,4,0,5,0];else if(q/6===K)re=K,ye=[0,0,0,1,0,2,0,3,0,4,0,5];else if(K/3===q/2)re=K/3,ye=[0,0,1,0,2,0,0,1,1,1,2,1];else if(K/2===q/3)re=K/2,ye=[0,0,1,0,0,1,1,1,0,2,1,2];else throw"can't figure out cube map from element: "+(M.src?M.src:M.nodeName);var Te=R();Te?(Te.canvas.width=re,Te.canvas.height=re,f=re,C=re,cn(T,z).forEach(function(It){var Kt=ye[It.ndx*2+0]*re,ir=ye[It.ndx*2+1]*re;Te.drawImage(M,Kt,ir,re,re,0,0,re,re),T.texImage2D(It.face,l,P,j,W,Te.canvas)}),Te.canvas.width=1,Te.canvas.height=1):typeof createImageBitmap<"u"&&(f=re,C=re,cn(T,z).forEach(function(It){var Kt=ye[It.ndx*2+0]*re,ir=ye[It.ndx*2+1]*re;T.texImage2D(It.face,l,P,re,re,0,j,W,null),createImageBitmap(M,Kt,ir,re,re,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(function(_i){br(T,z),T.bindTexture(s,A),T.texImage2D(It.face,l,P,j,W,_i),Tr(z)&&zr(T,A,z,f,C,P)})}))}else if(s===G||s===V){var we=Math.min(M.width,M.height),De=Math.max(M.width,M.height),ke=De/we;if(ke%1!==0)throw"can not compute 3D dimensions of element";var Oe=M.width===De?1:0,qe=M.height===De?1:0;T.pixelStorei(p,1),T.pixelStorei(x,M.width),T.pixelStorei(L,0),T.pixelStorei(m,0),T.texImage3D(s,l,P,we,we,we,0,j,W,null);for(var Je=0;Je<ke;++Je){var mt=Je*we*Oe,Tt=Je*we*qe;T.pixelStorei(E,mt),T.pixelStorei(d,Tt),T.texSubImage3D(s,l,0,0,Je,we,we,1,j,W,M)}on(T)}else T.texImage2D(s,l,P,j,W,M);Tr(z)&&zr(T,A,z,f,C,P),In(T,A,z)}function fr(){}function Ti(T){if(typeof document<"u"){var A=document.createElement("a");return A.href=T,A.hostname===location.hostname&&A.port===location.port&&A.protocol===location.protocol}else{var M=new URL(location.href).origin,z=new URL(T,location.href).origin;return z===M}}function sa(T,A){return A===void 0&&!Ti(T)?"anonymous":A}function oa(T,A,M){M=M||fr;var z;if(A=A!==void 0?A:U.crossOrigin,A=sa(T,A),typeof Image<"u"){z=new Image,A!==void 0&&(z.crossOrigin=A);var s=function(){z.removeEventListener("error",l),z.removeEventListener("load",f),z=null},l=function(){var K="couldn't load image: "+T;w.error(K),M(K,z),s()},f=function(){M(null,z),s()};return z.addEventListener("error",l),z.addEventListener("load",f),z.src=T,z}else if(typeof ImageBitmap<"u"){var C,P,O=function(){M(C,P)},j={};A&&(j.mode="cors"),fetch(T,j).then(function(W){if(!W.ok)throw W;return W.blob()}).then(function(W){return createImageBitmap(W,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}).then(function(W){P=W,setTimeout(O)}).catch(function(W){C=W,setTimeout(O)}),z=null}return z}function Un(T){return typeof ImageBitmap<"u"&&T instanceof ImageBitmap||typeof ImageData<"u"&&T instanceof ImageData||typeof HTMLElement<"u"&&T instanceof HTMLElement}function kn(T,A,M){return Un(T)?(setTimeout(function(){M(null,T)}),T):oa(T,A,M)}function hn(T,A,M){M=M||U.textureOptions;var z=M.target||He;if(T.bindTexture(z,A),M.color!==!1){var s=aa(M.color);if(z===ge)for(var l=0;l<6;++l)T.texImage2D(Z+l,0,B,1,1,0,B,ut,s);else z===G||z===V?T.texImage3D(z,0,B,1,1,1,0,B,ut,s):T.texImage2D(z,0,B,1,1,0,B,ut,s)}}function Ei(T,A,M,z){z=z||fr,M=M||U.textureOptions,hn(T,A,M),M=Object.assign({},M);var s=kn(M.src,M.crossOrigin,function(l,f){l?z(l,A,f):(zn(T,A,f,M),z(null,A,f))});return s}function ua(T,A,M,z){z=z||fr;var s=M.src;if(s.length!==6)throw"there must be 6 urls for a cubemap";var l=M.level||0,f=M.internalFormat||M.format||B,C=hr(f),P=M.format||C.format,O=M.type||ut,j=M.target||He;if(j!==ge)throw"target must be TEXTURE_CUBE_MAP";hn(T,A,M),M=Object.assign({},M);var W=6,K=[],q=un(T,M),re;function ye(Te){return function(we,De){--W,we?K.push(we):De.width!==De.height?K.push("cubemap face img is not a square: "+De.src):(br(T,M),T.bindTexture(j,A),W===5?un().forEach(function(ke){T.texImage2D(ke,l,f,P,O,De)}):T.texImage2D(Te,l,f,P,O,De),Tr(M)&&T.generateMipmap(j)),W===0&&z(K.length?K:void 0,A,re)}}re=s.map(function(Te,we){return kn(Te,M.crossOrigin,ye(q[we]))})}function wi(T,A,M,z){z=z||fr;var s=M.src,l=M.internalFormat||M.format||B,f=hr(l),C=M.format||f.format,P=M.type||ut,O=M.target||V;if(O!==G&&O!==V)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";hn(T,A,M),M=Object.assign({},M);var j=s.length,W=[],K,q=M.level||0,re=M.width,ye=M.height,Te=s.length,we=!0;function De(ke){return function(Oe,qe){if(--j,Oe)W.push(Oe);else{if(br(T,M),T.bindTexture(O,A),we){we=!1,re=M.width||qe.width,ye=M.height||qe.height,T.texImage3D(O,q,l,re,ye,Te,0,C,P,null);for(var Je=0;Je<Te;++Je)T.texSubImage3D(O,q,0,0,Je,re,ye,1,C,P,qe)}else{var mt=qe,Tt;(qe.width!==re||qe.height!==ye)&&(Tt=R(),mt=Tt.canvas,Tt.canvas.width=re,Tt.canvas.height=ye,Tt.drawImage(qe,0,0,re,ye)),T.texSubImage3D(O,q,0,0,ke,re,ye,1,C,P,mt),Tt&&mt===Tt.canvas&&(Tt.canvas.width=0,Tt.canvas.height=0)}Tr(M)&&T.generateMipmap(O)}j===0&&z(W.length?W:void 0,A,K)}}K=s.map(function(ke,Oe){return kn(ke,M.crossOrigin,De(Oe))})}function ln(T,A,M,z){z=z||U.textureOptions;var s=z.target||He;T.bindTexture(s,A);var l=z.width,f=z.height,C=z.depth,P=z.level||0,O=z.internalFormat||z.format||B,j=hr(O),W=z.format||j.format,K=z.type||Or(T,M,j.type);if(te(M))M instanceof Uint8ClampedArray&&(M=new Uint8Array(M.buffer));else{var q=g.getTypedArrayTypeForGLType(K);M=new q(M)}var re=cr(O,K),ye=M.byteLength/re;if(ye%1)throw"length wrong size for format: "+y.glEnumToString(T,W);var Te;if(s===G||s===V)if(!l&&!f&&!C){var we=Math.cbrt(ye);if(we%1!==0)throw"can't guess cube size of array of numElements: "+ye;l=we,f=we,C=we}else l&&(!f||!C)?(Te=lr(T,s,f,C,ye/l),f=Te.width,C=Te.height):f&&(!l||!C)?(Te=lr(T,s,l,C,ye/f),l=Te.width,C=Te.height):(Te=lr(T,s,l,f,ye/C),l=Te.width,f=Te.height);else Te=lr(T,s,l,f,ye),l=Te.width,f=Te.height;if(on(T),T.pixelStorei(p,z.unpackAlignment||1),br(T,z),s===ge){var De=re/M.BYTES_PER_ELEMENT,ke=ye/6*De;cn(T,z).forEach(function(Oe){var qe=ke*Oe.ndx,Je=M.subarray(qe,qe+ke);T.texImage2D(Oe.face,P,O,l,f,0,W,K,Je)})}else s===G||s===V?T.texImage3D(s,P,O,l,f,C,0,W,K,M):T.texImage2D(s,P,O,l,f,0,W,K,M);return{width:l,height:f,depth:C,type:K}}function Gn(T,A,M){var z=M.target||He;T.bindTexture(z,A);var s=M.level||0,l=M.internalFormat||M.format||B,f=hr(l),C=M.format||f.format,P=M.type||f.type;if(br(T,M),z===ge)for(var O=0;O<6;++O)T.texImage2D(Z+O,s,l,M.width,M.height,0,C,P,null);else z===G||z===V?T.texImage3D(z,s,l,M.width,M.height,M.depth,0,C,P,null):T.texImage2D(z,s,l,M.width,M.height,0,C,P,null)}function Wn(T,A,M){M=M||fr,A=A||U.textureOptions;var z=T.createTexture(),s=A.target||He,l=A.width||1,f=A.height||1,C=A.internalFormat||B;T.bindTexture(s,z),s===ge&&(T.texParameteri(s,Qe,Ae),T.texParameteri(s,yt,Ae));var P=A.src;if(P)if(typeof P=="function"&&(P=P(T,A)),typeof P=="string")Ei(T,z,A,M);else if(te(P)||Array.isArray(P)&&(typeof P[0]=="number"||Array.isArray(P[0])||te(P[0]))){var O=ln(T,z,P,A);l=O.width,f=O.height}else Array.isArray(P)&&(typeof P[0]=="string"||Un(P[0]))?s===ge?ua(T,z,A,M):wi(T,z,A,M):(zn(T,z,P,A),l=P.width,f=P.height);else Gn(T,z,A);return Tr(A)&&zr(T,z,A,l,f,C),In(T,z,A),z}function ca(T,A,M,z,s,l){z=z||M.width,s=s||M.height,l=l||M.depth;var f=M.target||He;T.bindTexture(f,A);var C=M.level||0,P=M.internalFormat||M.format||B,O=hr(P),j=M.format||O.format,W,K=M.src;if(K&&(te(K)||Array.isArray(K)&&typeof K[0]=="number")?W=M.type||Or(T,K,O.type):W=M.type||O.type,f===ge)for(var q=0;q<6;++q)T.texImage2D(Z+q,C,P,z,s,0,j,W,null);else f===G||f===V?T.texImage3D(f,C,P,z,s,l,0,j,W,null):T.texImage2D(f,C,P,z,s,0,j,W,null)}function fn(T){return typeof T=="string"||Array.isArray(T)&&typeof T[0]=="string"}function ha(T,A,M){M=M||fr;var z=0,s=[],l={},f={};function C(){z===0&&setTimeout(function(){M(s.length?s:void 0,l,f)},0)}return Object.keys(A).forEach(function(P){var O=A[P],j;fn(O.src)&&(j=function(K,q,re){f[P]=re,--z,K&&s.push(K),C()},++z),l[P]=Wn(T,O,j)}),C(),l}},"./src/twgl-full.js":(o,i,h)=>{function v(R){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(J){return typeof J}:function(J){return J&&typeof Symbol=="function"&&J.constructor===Symbol&&J!==Symbol.prototype?"symbol":typeof J},v(R)}i.__esModule=!0;var y={m4:!0,v3:!0,primitives:!0};i.v3=i.primitives=i.m4=void 0;var g=te(h("./src/m4.js"));i.m4=g;var w=te(h("./src/v3.js"));i.v3=w;var b=te(h("./src/primitives.js"));i.primitives=b;var F=h("./src/twgl.js");Object.keys(F).forEach(function(R){R==="default"||R==="__esModule"||Object.prototype.hasOwnProperty.call(y,R)||R in i&&i[R]===F[R]||(i[R]=F[R])});function U(R){if(typeof WeakMap!="function")return null;var J=new WeakMap,$=new WeakMap;return(U=function(X){return X?$:J})(R)}function te(R,J){if(!J&&R&&R.__esModule)return R;if(R===null||v(R)!="object"&&typeof R!="function")return{default:R};var $=U(J);if($&&$.has(R))return $.get(R);var B={__proto__:null},X=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ie in R)if(ie!=="default"&&Object.prototype.hasOwnProperty.call(R,ie)){var se=X?Object.getOwnPropertyDescriptor(R,ie):null;se&&(se.get||se.set)?Object.defineProperty(B,ie,se):B[ie]=R[ie]}return B.default=R,$&&$.set(R,B),B}},"./src/twgl.js":(o,i,h)=>{function v(D){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(be){return typeof be}:function(be){return be&&typeof Symbol=="function"&&be.constructor===Symbol&&be!==Symbol.prototype?"symbol":typeof be},v(D)}i.__esModule=!0;var y={addExtensionsToContext:!0,getContext:!0,getWebGLContext:!0,resizeCanvasToDisplaySize:!0,setDefaults:!0,attributes:!0,textures:!0,utils:!0,draw:!0,framebuffers:!0,programs:!0,typedarrays:!0,vertexArrays:!0};i.addExtensionsToContext=ot,i.framebuffers=i.draw=i.attributes=void 0,i.getContext=V,i.getWebGLContext=ge,i.programs=void 0,i.resizeCanvasToDisplaySize=Z,i.setDefaults=se,i.vertexArrays=i.utils=i.typedarrays=i.textures=void 0;var g=X(h("./src/attributes.js"));i.attributes=g,Object.keys(g).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(y,D)||D in i&&i[D]===g[D]||(i[D]=g[D])});var w=X(h("./src/textures.js"));i.textures=w,Object.keys(w).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(y,D)||D in i&&i[D]===w[D]||(i[D]=w[D])});var b=X(h("./src/helper.js")),F=X(h("./src/utils.js"));i.utils=F,Object.keys(F).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(y,D)||D in i&&i[D]===F[D]||(i[D]=F[D])});var U=X(h("./src/draw.js"));i.draw=U,Object.keys(U).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(y,D)||D in i&&i[D]===U[D]||(i[D]=U[D])});var te=X(h("./src/framebuffers.js"));i.framebuffers=te,Object.keys(te).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(y,D)||D in i&&i[D]===te[D]||(i[D]=te[D])});var R=X(h("./src/programs.js"));i.programs=R,Object.keys(R).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(y,D)||D in i&&i[D]===R[D]||(i[D]=R[D])});var J=X(h("./src/typedarrays.js"));i.typedarrays=J,Object.keys(J).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(y,D)||D in i&&i[D]===J[D]||(i[D]=J[D])});var $=X(h("./src/vertex-arrays.js"));i.vertexArrays=$,Object.keys($).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(y,D)||D in i&&i[D]===$[D]||(i[D]=$[D])});function B(D){if(typeof WeakMap!="function")return null;var be=new WeakMap,Se=new WeakMap;return(B=function(We){return We?Se:be})(D)}function X(D,be){if(!be&&D&&D.__esModule)return D;if(D===null||v(D)!="object"&&typeof D!="function")return{default:D};var Se=B(be);if(Se&&Se.has(D))return Se.get(D);var Me={__proto__:null},We=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var je in D)if(je!=="default"&&Object.prototype.hasOwnProperty.call(D,je)){var rt=We?Object.getOwnPropertyDescriptor(D,je):null;rt&&(rt.get||rt.set)?Object.defineProperty(Me,je,rt):Me[je]=D[je]}return Me.default=D,Se&&Se.set(D,Me),Me}var ie={addExtensionsToContext:!0};function se(D){b.copyExistingProperties(D,ie),g.setAttributeDefaults_(D),w.setTextureDefaults_(D)}var Le=/^(.*?)_/;function Ae(D,be){F.glEnumToString(D,0);var Se=D.getExtension(be);if(Se){var Me={},We=Le.exec(be)[1],je="_"+We;for(var rt in Se){var Qe=Se[rt],yt=typeof Qe=="function",Ft=yt?We:je,dt=rt;rt.endsWith(Ft)&&(dt=rt.substring(0,rt.length-Ft.length)),D[dt]!==void 0?!yt&&D[dt]!==Qe&&b.warn(dt,D[dt],Qe,rt):yt?D[dt]=function(ft){return function(){return ft.apply(Se,arguments)}}(Qe):(D[dt]=Qe,Me[dt]=Qe)}Me.constructor={name:Se.constructor.name},F.glEnumToString(Me,0)}return Se}var st=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_depth_texture","WEBGL_draw_buffers"];function ot(D){for(var be=0;be<st.length;++be)Ae(D,st[be])}function He(D,be){for(var Se=["webgl","experimental-webgl"],Me=null,We=0;We<Se.length;++We)if(Me=D.getContext(Se[We],be),Me){ie.addExtensionsToContext&&ot(Me);break}return Me}function ge(D,be){var Se=He(D,be);return Se}function G(D,be){for(var Se=["webgl2","webgl","experimental-webgl"],Me=null,We=0;We<Se.length;++We)if(Me=D.getContext(Se[We],be),Me){ie.addExtensionsToContext&&ot(Me);break}return Me}function V(D,be){var Se=G(D,be);return Se}function Z(D,be){be=be||1,be=Math.max(0,be);var Se=D.clientWidth*be|0,Me=D.clientHeight*be|0;return D.width!==Se||D.height!==Me?(D.width=Se,D.height=Me,!0):!1}},"./src/typedarrays.js":(o,i)=>{i.__esModule=!0,i.getGLTypeForTypedArray=st,i.getGLTypeForTypedArrayType=ot,i.getTypedArrayTypeForGLType=He,i.isArrayBuffer=void 0;var h=5120,v=5121,y=5122,g=5123,w=5124,b=5125,F=5126,U=32819,te=32820,R=33635,J=5131,$=33640,B=35899,X=35902,ie=36269,se=34042,Le={};{var Ae=Le;Ae[h]=Int8Array,Ae[v]=Uint8Array,Ae[y]=Int16Array,Ae[g]=Uint16Array,Ae[w]=Int32Array,Ae[b]=Uint32Array,Ae[F]=Float32Array,Ae[U]=Uint16Array,Ae[te]=Uint16Array,Ae[R]=Uint16Array,Ae[J]=Uint16Array,Ae[$]=Uint32Array,Ae[B]=Uint32Array,Ae[X]=Uint32Array,Ae[ie]=Uint32Array,Ae[se]=Uint32Array}function st(ge){if(ge instanceof Int8Array)return h;if(ge instanceof Uint8Array||ge instanceof Uint8ClampedArray)return v;if(ge instanceof Int16Array)return y;if(ge instanceof Uint16Array)return g;if(ge instanceof Int32Array)return w;if(ge instanceof Uint32Array)return b;if(ge instanceof Float32Array)return F;throw new Error("unsupported typed array type")}function ot(ge){if(ge===Int8Array)return h;if(ge===Uint8Array||ge===Uint8ClampedArray)return v;if(ge===Int16Array)return y;if(ge===Uint16Array)return g;if(ge===Int32Array)return w;if(ge===Uint32Array)return b;if(ge===Float32Array)return F;throw new Error("unsupported typed array type")}function He(ge){var G=Le[ge];if(!G)throw new Error("unknown gl type");return G}i.isArrayBuffer=typeof SharedArrayBuffer<"u"?function(G){return G&&G.buffer&&(G.buffer instanceof ArrayBuffer||G.buffer instanceof SharedArrayBuffer)}:function(G){return G&&G.buffer&&G.buffer instanceof ArrayBuffer}},"./src/utils.js":(o,i)=>{i.__esModule=!0,i.glEnumToString=void 0,i.isWebGL1=v,i.isWebGL2=h;function h(y){return!!y.texStorage2D}function v(y){return!y.texStorage2D}i.glEnumToString=function(){var y={},g={};function w(b){var F=b.constructor.name;if(!y[F]){for(var U in b)if(typeof b[U]=="number"){var te=g[b[U]];g[b[U]]=te?"".concat(te," | ").concat(U):U}y[F]=!0}}return function(F,U){return w(F),g[U]||(typeof U=="number"?"0x".concat(U.toString(16)):U)}}()},"./src/v3.js":(o,i)=>{i.__esModule=!0,i.add=g,i.copy=ot,i.create=y,i.cross=$,i.distance=se,i.distanceSq=Le,i.divScalar=J,i.divide=ge,i.dot=B,i.length=X,i.lengthSq=ie,i.lerp=b,i.lerpV=F,i.max=U,i.min=te,i.mulScalar=R,i.multiply=He,i.negate=st,i.normalize=Ae,i.setDefaultType=v,i.subtract=w;var h=Float32Array;function v(G){var V=h;return h=G,V}function y(G,V,Z){var D=new h(3);return G&&(D[0]=G),V&&(D[1]=V),Z&&(D[2]=Z),D}function g(G,V,Z){return Z=Z||new h(3),Z[0]=G[0]+V[0],Z[1]=G[1]+V[1],Z[2]=G[2]+V[2],Z}function w(G,V,Z){return Z=Z||new h(3),Z[0]=G[0]-V[0],Z[1]=G[1]-V[1],Z[2]=G[2]-V[2],Z}function b(G,V,Z,D){return D=D||new h(3),D[0]=G[0]+Z*(V[0]-G[0]),D[1]=G[1]+Z*(V[1]-G[1]),D[2]=G[2]+Z*(V[2]-G[2]),D}function F(G,V,Z,D){return D=D||new h(3),D[0]=G[0]+Z[0]*(V[0]-G[0]),D[1]=G[1]+Z[1]*(V[1]-G[1]),D[2]=G[2]+Z[2]*(V[2]-G[2]),D}function U(G,V,Z){return Z=Z||new h(3),Z[0]=Math.max(G[0],V[0]),Z[1]=Math.max(G[1],V[1]),Z[2]=Math.max(G[2],V[2]),Z}function te(G,V,Z){return Z=Z||new h(3),Z[0]=Math.min(G[0],V[0]),Z[1]=Math.min(G[1],V[1]),Z[2]=Math.min(G[2],V[2]),Z}function R(G,V,Z){return Z=Z||new h(3),Z[0]=G[0]*V,Z[1]=G[1]*V,Z[2]=G[2]*V,Z}function J(G,V,Z){return Z=Z||new h(3),Z[0]=G[0]/V,Z[1]=G[1]/V,Z[2]=G[2]/V,Z}function $(G,V,Z){Z=Z||new h(3);var D=G[2]*V[0]-G[0]*V[2],be=G[0]*V[1]-G[1]*V[0];return Z[0]=G[1]*V[2]-G[2]*V[1],Z[1]=D,Z[2]=be,Z}function B(G,V){return G[0]*V[0]+G[1]*V[1]+G[2]*V[2]}function X(G){return Math.sqrt(G[0]*G[0]+G[1]*G[1]+G[2]*G[2])}function ie(G){return G[0]*G[0]+G[1]*G[1]+G[2]*G[2]}function se(G,V){var Z=G[0]-V[0],D=G[1]-V[1],be=G[2]-V[2];return Math.sqrt(Z*Z+D*D+be*be)}function Le(G,V){var Z=G[0]-V[0],D=G[1]-V[1],be=G[2]-V[2];return Z*Z+D*D+be*be}function Ae(G,V){V=V||new h(3);var Z=G[0]*G[0]+G[1]*G[1]+G[2]*G[2],D=Math.sqrt(Z);return D>1e-5?(V[0]=G[0]/D,V[1]=G[1]/D,V[2]=G[2]/D):(V[0]=0,V[1]=0,V[2]=0),V}function st(G,V){return V=V||new h(3),V[0]=-G[0],V[1]=-G[1],V[2]=-G[2],V}function ot(G,V){return V=V||new h(3),V[0]=G[0],V[1]=G[1],V[2]=G[2],V}function He(G,V,Z){return Z=Z||new h(3),Z[0]=G[0]*V[0],Z[1]=G[1]*V[1],Z[2]=G[2]*V[2],Z}function ge(G,V,Z){return Z=Z||new h(3),Z[0]=G[0]/V[0],Z[1]=G[1]/V[1],Z[2]=G[2]/V[2],Z}},"./src/vertex-arrays.js":(o,i,h)=>{function v(R){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(J){return typeof J}:function(J){return J&&typeof Symbol=="function"&&J.constructor===Symbol&&J!==Symbol.prototype?"symbol":typeof J},v(R)}i.__esModule=!0,i.createVAOAndSetAttributes=U,i.createVAOFromBufferInfo=te,i.createVertexArrayInfo=F;var y=w(h("./src/programs.js"));function g(R){if(typeof WeakMap!="function")return null;var J=new WeakMap,$=new WeakMap;return(g=function(X){return X?$:J})(R)}function w(R,J){if(!J&&R&&R.__esModule)return R;if(R===null||v(R)!="object"&&typeof R!="function")return{default:R};var $=g(J);if($&&$.has(R))return $.get(R);var B={__proto__:null},X=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ie in R)if(ie!=="default"&&Object.prototype.hasOwnProperty.call(R,ie)){var se=X?Object.getOwnPropertyDescriptor(R,ie):null;se&&(se.get||se.set)?Object.defineProperty(B,ie,se):B[ie]=R[ie]}return B.default=R,$&&$.set(R,B),B}var b=34963;function F(R,J,$){var B=R.createVertexArray();return R.bindVertexArray(B),J.length||(J=[J]),J.forEach(function(X){y.setBuffersAndAttributes(R,X,$)}),R.bindVertexArray(null),{numElements:$.numElements,elementType:$.elementType,vertexArrayObject:B}}function U(R,J,$,B){var X=R.createVertexArray();return R.bindVertexArray(X),y.setAttributes(J,$),B&&R.bindBuffer(b,B),R.bindVertexArray(null),X}function te(R,J,$){return U(R,J.attribSetters||J,$.attribs,$.indices)}}},r={};function n(o){var i=r[o];if(i!==void 0)return i.exports;var h=r[o]={exports:{}};return t[o](h,h.exports,n),h.exports}var a=n("./src/twgl-full.js");return a})())})(Ds);var wr=Ds.exports;/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Ls="162",Is=300,ns=1e3,Ai=1001,is=1002,as=1003,mo=1006,yo=1008,po=1009,vo=1014,xo=1020,go=1023,pa=1026,ss=1027,Bs="",Ar="srgb",Wa="srgb-linear",bo="display-p3",Os="display-p3-linear",Ra="linear",os="srgb",us="rec709",cs="p3",To=515,Mi=2e3,hs=2001;class ja{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const n=this._listeners[e];if(n!==void 0){const a=n.indexOf(t);a!==-1&&n.splice(a,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const n=r.slice(0);for(let a=0,o=n.length;a<o;a++)n[a].call(this,e);e.target=null}}}const Pt=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let ls=1234567;const zs=Math.PI/180,Us=180/Math.PI;function Hi(){const u=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Pt[u&255]+Pt[u>>8&255]+Pt[u>>16&255]+Pt[u>>24&255]+"-"+Pt[e&255]+Pt[e>>8&255]+"-"+Pt[e>>16&15|64]+Pt[e>>24&255]+"-"+Pt[t&63|128]+Pt[t>>8&255]+"-"+Pt[t>>16&255]+Pt[t>>24&255]+Pt[r&255]+Pt[r>>8&255]+Pt[r>>16&255]+Pt[r>>24&255]).toLowerCase()}function Ot(u,e,t){return Math.max(e,Math.min(t,u))}function Va(u,e){return(u%e+e)%e}function Eo(u,e,t,r,n){return r+(u-e)*(n-r)/(t-e)}function wo(u,e,t){return u!==e?(t-u)/(e-u):0}function Xn(u,e,t){return(1-t)*u+t*e}function _o(u,e,t,r){return Xn(u,e,1-Math.exp(-t*r))}function So(u,e=1){return e-Math.abs(Va(u,e*2)-e)}function Ao(u,e,t){return u<=e?0:u>=t?1:(u=(u-e)/(t-e),u*u*(3-2*u))}function Mo(u,e,t){return u<=e?0:u>=t?1:(u=(u-e)/(t-e),u*u*u*(u*(u*6-15)+10))}function Fo(u,e){return u+Math.floor(Math.random()*(e-u+1))}function Co(u,e){return u+Math.random()*(e-u)}function Ro(u){return u*(.5-Math.random())}function Po(u){u!==void 0&&(ls=u);let e=ls+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function No(u){return u*zs}function Do(u){return u*Us}function Lo(u){return(u&u-1)===0&&u!==0}function Io(u){return Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))}function Bo(u){return Math.pow(2,Math.floor(Math.log(u)/Math.LN2))}function Oo(u,e,t,r,n){const a=Math.cos,o=Math.sin,i=a(t/2),h=o(t/2),v=a((e+r)/2),y=o((e+r)/2),g=a((e-r)/2),w=o((e-r)/2),b=a((r-e)/2),F=o((r-e)/2);switch(n){case"XYX":u.set(i*y,h*g,h*w,i*v);break;case"YZY":u.set(h*w,i*y,h*g,i*v);break;case"ZXZ":u.set(h*g,h*w,i*y,i*v);break;case"XZX":u.set(i*y,h*F,h*b,i*v);break;case"YXY":u.set(h*b,i*y,h*F,i*v);break;case"ZYZ":u.set(h*F,h*b,i*y,i*v);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function zo(u,e){switch(e.constructor){case Float32Array:return u;case Uint32Array:return u/4294967295;case Uint16Array:return u/65535;case Uint8Array:return u/255;case Int32Array:return Math.max(u/2147483647,-1);case Int16Array:return Math.max(u/32767,-1);case Int8Array:return Math.max(u/127,-1);default:throw new Error("Invalid component type.")}}function Uo(u,e){switch(e.constructor){case Float32Array:return u;case Uint32Array:return Math.round(u*4294967295);case Uint16Array:return Math.round(u*65535);case Uint8Array:return Math.round(u*255);case Int32Array:return Math.round(u*2147483647);case Int16Array:return Math.round(u*32767);case Int8Array:return Math.round(u*127);default:throw new Error("Invalid component type.")}}const ko={DEG2RAD:zs,RAD2DEG:Us,generateUUID:Hi,clamp:Ot,euclideanModulo:Va,mapLinear:Eo,inverseLerp:wo,lerp:Xn,damp:_o,pingpong:So,smoothstep:Ao,smootherstep:Mo,randInt:Fo,randFloat:Co,randFloatSpread:Ro,seededRandom:Po,degToRad:No,radToDeg:Do,isPowerOfTwo:Lo,ceilPowerOfTwo:Io,floorPowerOfTwo:Bo,setQuaternionFromProperEuler:Oo,normalize:Uo,denormalize:zo};class vn{constructor(e=0,t=0){vn.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Ot(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),n=Math.sin(t),a=this.x-e.x,o=this.y-e.y;return this.x=a*r-o*n+e.x,this.y=a*n+o*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ir{constructor(e,t,r,n,a,o,i,h,v){Ir.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,n,a,o,i,h,v)}set(e,t,r,n,a,o,i,h,v){const y=this.elements;return y[0]=e,y[1]=n,y[2]=i,y[3]=t,y[4]=a,y[5]=h,y[6]=r,y[7]=o,y[8]=v,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,n=t.elements,a=this.elements,o=r[0],i=r[3],h=r[6],v=r[1],y=r[4],g=r[7],w=r[2],b=r[5],F=r[8],U=n[0],te=n[3],R=n[6],J=n[1],$=n[4],B=n[7],X=n[2],ie=n[5],se=n[8];return a[0]=o*U+i*J+h*X,a[3]=o*te+i*$+h*ie,a[6]=o*R+i*B+h*se,a[1]=v*U+y*J+g*X,a[4]=v*te+y*$+g*ie,a[7]=v*R+y*B+g*se,a[2]=w*U+b*J+F*X,a[5]=w*te+b*$+F*ie,a[8]=w*R+b*B+F*se,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],i=e[5],h=e[6],v=e[7],y=e[8];return t*o*y-t*i*v-r*a*y+r*i*h+n*a*v-n*o*h}invert(){const e=this.elements,t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],i=e[5],h=e[6],v=e[7],y=e[8],g=y*o-i*v,w=i*h-y*a,b=v*a-o*h,F=t*g+r*w+n*b;if(F===0)return this.set(0,0,0,0,0,0,0,0,0);const U=1/F;return e[0]=g*U,e[1]=(n*v-y*r)*U,e[2]=(i*r-n*o)*U,e[3]=w*U,e[4]=(y*t-n*h)*U,e[5]=(n*a-i*t)*U,e[6]=b*U,e[7]=(r*h-v*t)*U,e[8]=(o*t-r*a)*U,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,n,a,o,i){const h=Math.cos(a),v=Math.sin(a);return this.set(r*h,r*v,-r*(h*o+v*i)+o+e,-n*v,n*h,-n*(-v*o+h*i)+i+t,0,0,1),this}scale(e,t){return this.premultiply(va.makeScale(e,t)),this}rotate(e){return this.premultiply(va.makeRotation(-e)),this}translate(e,t){return this.premultiply(va.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let n=0;n<9;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const va=new Ir;function fs(u){return document.createElementNS("http://www.w3.org/1999/xhtml",u)}const ms=new Ir().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),ys=new Ir().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Fi={[Wa]:{transfer:Ra,primaries:us,toReference:u=>u,fromReference:u=>u},[Ar]:{transfer:os,primaries:us,toReference:u=>u.convertSRGBToLinear(),fromReference:u=>u.convertLinearToSRGB()},[Os]:{transfer:Ra,primaries:cs,toReference:u=>u.applyMatrix3(ys),fromReference:u=>u.applyMatrix3(ms)},[bo]:{transfer:os,primaries:cs,toReference:u=>u.convertSRGBToLinear().applyMatrix3(ys),fromReference:u=>u.applyMatrix3(ms).convertLinearToSRGB()}},Go=new Set([Wa,Os]),$t={enabled:!0,_workingColorSpace:Wa,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(u){if(!Go.has(u))throw new Error(`Unsupported working color space, "${u}".`);this._workingColorSpace=u},convert:function(u,e,t){if(this.enabled===!1||e===t||!e||!t)return u;const r=Fi[e].toReference,n=Fi[t].fromReference;return n(r(u))},fromWorkingColorSpace:function(u,e){return this.convert(u,this._workingColorSpace,e)},toWorkingColorSpace:function(u,e){return this.convert(u,e,this._workingColorSpace)},getPrimaries:function(u){return Fi[u].primaries},getTransfer:function(u){return u===Bs?Ra:Fi[u].transfer}};function xn(u){return u<.04045?u*.0773993808:Math.pow(u*.9478672986+.0521327014,2.4)}function xa(u){return u<.0031308?u*12.92:1.055*Math.pow(u,.41666)-.055}let mn;class Wo{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{mn===void 0&&(mn=fs("canvas")),mn.width=e.width,mn.height=e.height;const r=mn.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=mn}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=fs("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const n=r.getImageData(0,0,e.width,e.height),a=n.data;for(let o=0;o<a.length;o++)a[o]=xn(a[o]/255)*255;return r.putImageData(n,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(xn(t[r]/255)*255):t[r]=xn(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let jo=0;class Vo{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:jo++}),this.uuid=Hi(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},n=this.data;if(n!==null){let a;if(Array.isArray(n)){a=[];for(let o=0,i=n.length;o<i;o++)n[o].isDataTexture?a.push(ga(n[o].image)):a.push(ga(n[o]))}else a=ga(n);r.url=a}return t||(e.images[this.uuid]=r),r}}function ga(u){return typeof HTMLImageElement<"u"&&u instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&u instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&u instanceof ImageBitmap?Wo.getDataURL(u):u.data?{data:Array.from(u.data),width:u.width,height:u.height,type:u.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let qo=0;class Lr extends ja{constructor(e=Lr.DEFAULT_IMAGE,t=Lr.DEFAULT_MAPPING,r=Ai,n=Ai,a=mo,o=yo,i=go,h=po,v=Lr.DEFAULT_ANISOTROPY,y=Bs){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:qo++}),this.uuid=Hi(),this.name="",this.source=new Vo(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=n,this.magFilter=a,this.minFilter=o,this.anisotropy=v,this.format=i,this.internalFormat=null,this.type=h,this.offset=new vn(0,0),this.repeat=new vn(1,1),this.center=new vn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ir,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=y,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Is)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case ns:e.x=e.x-Math.floor(e.x);break;case Ai:e.x=e.x<0?0:1;break;case is:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case ns:e.y=e.y-Math.floor(e.y);break;case Ai:e.y=e.y<0?0:1;break;case is:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}Lr.DEFAULT_IMAGE=null;Lr.DEFAULT_MAPPING=Is;Lr.DEFAULT_ANISOTROPY=1;class qa{constructor(e=0,t=0,r=0,n=1){qa.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,n=this.z,a=this.w,o=e.elements;return this.x=o[0]*t+o[4]*r+o[8]*n+o[12]*a,this.y=o[1]*t+o[5]*r+o[9]*n+o[13]*a,this.z=o[2]*t+o[6]*r+o[10]*n+o[14]*a,this.w=o[3]*t+o[7]*r+o[11]*n+o[15]*a,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,n,a;const h=e.elements,v=h[0],y=h[4],g=h[8],w=h[1],b=h[5],F=h[9],U=h[2],te=h[6],R=h[10];if(Math.abs(y-w)<.01&&Math.abs(g-U)<.01&&Math.abs(F-te)<.01){if(Math.abs(y+w)<.1&&Math.abs(g+U)<.1&&Math.abs(F+te)<.1&&Math.abs(v+b+R-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const $=(v+1)/2,B=(b+1)/2,X=(R+1)/2,ie=(y+w)/4,se=(g+U)/4,Le=(F+te)/4;return $>B&&$>X?$<.01?(r=0,n=.707106781,a=.707106781):(r=Math.sqrt($),n=ie/r,a=se/r):B>X?B<.01?(r=.707106781,n=0,a=.707106781):(n=Math.sqrt(B),r=ie/n,a=Le/n):X<.01?(r=.707106781,n=.707106781,a=0):(a=Math.sqrt(X),r=se/a,n=Le/a),this.set(r,n,a,t),this}let J=Math.sqrt((te-F)*(te-F)+(g-U)*(g-U)+(w-y)*(w-y));return Math.abs(J)<.001&&(J=1),this.x=(te-F)/J,this.y=(g-U)/J,this.z=(w-y)/J,this.w=Math.acos((v+b+R-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class ai{constructor(e=0,t=0,r=0,n=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=n}static slerpFlat(e,t,r,n,a,o,i){let h=r[n+0],v=r[n+1],y=r[n+2],g=r[n+3];const w=a[o+0],b=a[o+1],F=a[o+2],U=a[o+3];if(i===0){e[t+0]=h,e[t+1]=v,e[t+2]=y,e[t+3]=g;return}if(i===1){e[t+0]=w,e[t+1]=b,e[t+2]=F,e[t+3]=U;return}if(g!==U||h!==w||v!==b||y!==F){let te=1-i;const R=h*w+v*b+y*F+g*U,J=R>=0?1:-1,$=1-R*R;if($>Number.EPSILON){const X=Math.sqrt($),ie=Math.atan2(X,R*J);te=Math.sin(te*ie)/X,i=Math.sin(i*ie)/X}const B=i*J;if(h=h*te+w*B,v=v*te+b*B,y=y*te+F*B,g=g*te+U*B,te===1-i){const X=1/Math.sqrt(h*h+v*v+y*y+g*g);h*=X,v*=X,y*=X,g*=X}}e[t]=h,e[t+1]=v,e[t+2]=y,e[t+3]=g}static multiplyQuaternionsFlat(e,t,r,n,a,o){const i=r[n],h=r[n+1],v=r[n+2],y=r[n+3],g=a[o],w=a[o+1],b=a[o+2],F=a[o+3];return e[t]=i*F+y*g+h*b-v*w,e[t+1]=h*F+y*w+v*g-i*b,e[t+2]=v*F+y*b+i*w-h*g,e[t+3]=y*F-i*g-h*w-v*b,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const r=e._x,n=e._y,a=e._z,o=e._order,i=Math.cos,h=Math.sin,v=i(r/2),y=i(n/2),g=i(a/2),w=h(r/2),b=h(n/2),F=h(a/2);switch(o){case"XYZ":this._x=w*y*g+v*b*F,this._y=v*b*g-w*y*F,this._z=v*y*F+w*b*g,this._w=v*y*g-w*b*F;break;case"YXZ":this._x=w*y*g+v*b*F,this._y=v*b*g-w*y*F,this._z=v*y*F-w*b*g,this._w=v*y*g+w*b*F;break;case"ZXY":this._x=w*y*g-v*b*F,this._y=v*b*g+w*y*F,this._z=v*y*F+w*b*g,this._w=v*y*g-w*b*F;break;case"ZYX":this._x=w*y*g-v*b*F,this._y=v*b*g+w*y*F,this._z=v*y*F-w*b*g,this._w=v*y*g+w*b*F;break;case"YZX":this._x=w*y*g+v*b*F,this._y=v*b*g+w*y*F,this._z=v*y*F-w*b*g,this._w=v*y*g-w*b*F;break;case"XZY":this._x=w*y*g-v*b*F,this._y=v*b*g-w*y*F,this._z=v*y*F+w*b*g,this._w=v*y*g+w*b*F;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],n=t[4],a=t[8],o=t[1],i=t[5],h=t[9],v=t[2],y=t[6],g=t[10],w=r+i+g;if(w>0){const b=.5/Math.sqrt(w+1);this._w=.25/b,this._x=(y-h)*b,this._y=(a-v)*b,this._z=(o-n)*b}else if(r>i&&r>g){const b=2*Math.sqrt(1+r-i-g);this._w=(y-h)/b,this._x=.25*b,this._y=(n+o)/b,this._z=(a+v)/b}else if(i>g){const b=2*Math.sqrt(1+i-r-g);this._w=(a-v)/b,this._x=(n+o)/b,this._y=.25*b,this._z=(h+y)/b}else{const b=2*Math.sqrt(1+g-r-i);this._w=(o-n)/b,this._x=(a+v)/b,this._y=(h+y)/b,this._z=.25*b}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Ot(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const n=Math.min(1,t/r);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,n=e._y,a=e._z,o=e._w,i=t._x,h=t._y,v=t._z,y=t._w;return this._x=r*y+o*i+n*v-a*h,this._y=n*y+o*h+a*i-r*v,this._z=a*y+o*v+r*h-n*i,this._w=o*y-r*i-n*h-a*v,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,n=this._y,a=this._z,o=this._w;let i=o*e._w+r*e._x+n*e._y+a*e._z;if(i<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,i=-i):this.copy(e),i>=1)return this._w=o,this._x=r,this._y=n,this._z=a,this;const h=1-i*i;if(h<=Number.EPSILON){const b=1-t;return this._w=b*o+t*this._w,this._x=b*r+t*this._x,this._y=b*n+t*this._y,this._z=b*a+t*this._z,this.normalize(),this}const v=Math.sqrt(h),y=Math.atan2(v,i),g=Math.sin((1-t)*y)/v,w=Math.sin(t*y)/v;return this._w=o*g+this._w*w,this._x=r*g+this._x*w,this._y=n*g+this._y*w,this._z=a*g+this._z*w,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),r=Math.random(),n=Math.sqrt(1-r),a=Math.sqrt(r);return this.set(n*Math.sin(e),n*Math.cos(e),a*Math.sin(t),a*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class bt{constructor(e=0,t=0,r=0){bt.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(ds.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(ds.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,n=this.z,a=e.elements;return this.x=a[0]*t+a[3]*r+a[6]*n,this.y=a[1]*t+a[4]*r+a[7]*n,this.z=a[2]*t+a[5]*r+a[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,n=this.z,a=e.elements,o=1/(a[3]*t+a[7]*r+a[11]*n+a[15]);return this.x=(a[0]*t+a[4]*r+a[8]*n+a[12])*o,this.y=(a[1]*t+a[5]*r+a[9]*n+a[13])*o,this.z=(a[2]*t+a[6]*r+a[10]*n+a[14])*o,this}applyQuaternion(e){const t=this.x,r=this.y,n=this.z,a=e.x,o=e.y,i=e.z,h=e.w,v=2*(o*n-i*r),y=2*(i*t-a*n),g=2*(a*r-o*t);return this.x=t+h*v+o*g-i*y,this.y=r+h*y+i*v-a*g,this.z=n+h*g+a*y-o*v,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,n=this.z,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*n,this.y=a[1]*t+a[5]*r+a[9]*n,this.z=a[2]*t+a[6]*r+a[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,n=e.y,a=e.z,o=t.x,i=t.y,h=t.z;return this.x=n*h-a*i,this.y=a*o-r*h,this.z=r*i-n*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return ba.copy(this).projectOnVector(e),this.sub(ba)}reflect(e){return this.sub(ba.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Ot(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,r=Math.sqrt(1-t*t);return this.x=r*Math.cos(e),this.y=t,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const ba=new bt,ds=new ai;class ar{constructor(e,t,r,n,a,o,i,h,v,y,g,w,b,F,U,te){ar.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,n,a,o,i,h,v,y,g,w,b,F,U,te)}set(e,t,r,n,a,o,i,h,v,y,g,w,b,F,U,te){const R=this.elements;return R[0]=e,R[4]=t,R[8]=r,R[12]=n,R[1]=a,R[5]=o,R[9]=i,R[13]=h,R[2]=v,R[6]=y,R[10]=g,R[14]=w,R[3]=b,R[7]=F,R[11]=U,R[15]=te,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ar().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,n=1/yn.setFromMatrixColumn(e,0).length(),a=1/yn.setFromMatrixColumn(e,1).length(),o=1/yn.setFromMatrixColumn(e,2).length();return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=0,t[4]=r[4]*a,t[5]=r[5]*a,t[6]=r[6]*a,t[7]=0,t[8]=r[8]*o,t[9]=r[9]*o,t[10]=r[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,n=e.y,a=e.z,o=Math.cos(r),i=Math.sin(r),h=Math.cos(n),v=Math.sin(n),y=Math.cos(a),g=Math.sin(a);if(e.order==="XYZ"){const w=o*y,b=o*g,F=i*y,U=i*g;t[0]=h*y,t[4]=-h*g,t[8]=v,t[1]=b+F*v,t[5]=w-U*v,t[9]=-i*h,t[2]=U-w*v,t[6]=F+b*v,t[10]=o*h}else if(e.order==="YXZ"){const w=h*y,b=h*g,F=v*y,U=v*g;t[0]=w+U*i,t[4]=F*i-b,t[8]=o*v,t[1]=o*g,t[5]=o*y,t[9]=-i,t[2]=b*i-F,t[6]=U+w*i,t[10]=o*h}else if(e.order==="ZXY"){const w=h*y,b=h*g,F=v*y,U=v*g;t[0]=w-U*i,t[4]=-o*g,t[8]=F+b*i,t[1]=b+F*i,t[5]=o*y,t[9]=U-w*i,t[2]=-o*v,t[6]=i,t[10]=o*h}else if(e.order==="ZYX"){const w=o*y,b=o*g,F=i*y,U=i*g;t[0]=h*y,t[4]=F*v-b,t[8]=w*v+U,t[1]=h*g,t[5]=U*v+w,t[9]=b*v-F,t[2]=-v,t[6]=i*h,t[10]=o*h}else if(e.order==="YZX"){const w=o*h,b=o*v,F=i*h,U=i*v;t[0]=h*y,t[4]=U-w*g,t[8]=F*g+b,t[1]=g,t[5]=o*y,t[9]=-i*y,t[2]=-v*y,t[6]=b*g+F,t[10]=w-U*g}else if(e.order==="XZY"){const w=o*h,b=o*v,F=i*h,U=i*v;t[0]=h*y,t[4]=-g,t[8]=v*y,t[1]=w*g+U,t[5]=o*y,t[9]=b*g-F,t[2]=F*g-b,t[6]=i*y,t[10]=U*g+w}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Xo,e,Ho)}lookAt(e,t,r){const n=this.elements;return Gt.subVectors(e,t),Gt.lengthSq()===0&&(Gt.z=1),Gt.normalize(),_r.crossVectors(r,Gt),_r.lengthSq()===0&&(Math.abs(r.z)===1?Gt.x+=1e-4:Gt.z+=1e-4,Gt.normalize(),_r.crossVectors(r,Gt)),_r.normalize(),Ci.crossVectors(Gt,_r),n[0]=_r.x,n[4]=Ci.x,n[8]=Gt.x,n[1]=_r.y,n[5]=Ci.y,n[9]=Gt.y,n[2]=_r.z,n[6]=Ci.z,n[10]=Gt.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,n=t.elements,a=this.elements,o=r[0],i=r[4],h=r[8],v=r[12],y=r[1],g=r[5],w=r[9],b=r[13],F=r[2],U=r[6],te=r[10],R=r[14],J=r[3],$=r[7],B=r[11],X=r[15],ie=n[0],se=n[4],Le=n[8],Ae=n[12],st=n[1],ot=n[5],He=n[9],ge=n[13],G=n[2],V=n[6],Z=n[10],D=n[14],be=n[3],Se=n[7],Me=n[11],We=n[15];return a[0]=o*ie+i*st+h*G+v*be,a[4]=o*se+i*ot+h*V+v*Se,a[8]=o*Le+i*He+h*Z+v*Me,a[12]=o*Ae+i*ge+h*D+v*We,a[1]=y*ie+g*st+w*G+b*be,a[5]=y*se+g*ot+w*V+b*Se,a[9]=y*Le+g*He+w*Z+b*Me,a[13]=y*Ae+g*ge+w*D+b*We,a[2]=F*ie+U*st+te*G+R*be,a[6]=F*se+U*ot+te*V+R*Se,a[10]=F*Le+U*He+te*Z+R*Me,a[14]=F*Ae+U*ge+te*D+R*We,a[3]=J*ie+$*st+B*G+X*be,a[7]=J*se+$*ot+B*V+X*Se,a[11]=J*Le+$*He+B*Z+X*Me,a[15]=J*Ae+$*ge+B*D+X*We,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],n=e[8],a=e[12],o=e[1],i=e[5],h=e[9],v=e[13],y=e[2],g=e[6],w=e[10],b=e[14],F=e[3],U=e[7],te=e[11],R=e[15];return F*(+a*h*g-n*v*g-a*i*w+r*v*w+n*i*b-r*h*b)+U*(+t*h*b-t*v*w+a*o*w-n*o*b+n*v*y-a*h*y)+te*(+t*v*g-t*i*b-a*o*g+r*o*b+a*i*y-r*v*y)+R*(-n*i*y-t*h*g+t*i*w+n*o*g-r*o*w+r*h*y)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],n=e[2],a=e[3],o=e[4],i=e[5],h=e[6],v=e[7],y=e[8],g=e[9],w=e[10],b=e[11],F=e[12],U=e[13],te=e[14],R=e[15],J=g*te*v-U*w*v+U*h*b-i*te*b-g*h*R+i*w*R,$=F*w*v-y*te*v-F*h*b+o*te*b+y*h*R-o*w*R,B=y*U*v-F*g*v+F*i*b-o*U*b-y*i*R+o*g*R,X=F*g*h-y*U*h-F*i*w+o*U*w+y*i*te-o*g*te,ie=t*J+r*$+n*B+a*X;if(ie===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const se=1/ie;return e[0]=J*se,e[1]=(U*w*a-g*te*a-U*n*b+r*te*b+g*n*R-r*w*R)*se,e[2]=(i*te*a-U*h*a+U*n*v-r*te*v-i*n*R+r*h*R)*se,e[3]=(g*h*a-i*w*a-g*n*v+r*w*v+i*n*b-r*h*b)*se,e[4]=$*se,e[5]=(y*te*a-F*w*a+F*n*b-t*te*b-y*n*R+t*w*R)*se,e[6]=(F*h*a-o*te*a-F*n*v+t*te*v+o*n*R-t*h*R)*se,e[7]=(o*w*a-y*h*a+y*n*v-t*w*v-o*n*b+t*h*b)*se,e[8]=B*se,e[9]=(F*g*a-y*U*a-F*r*b+t*U*b+y*r*R-t*g*R)*se,e[10]=(o*U*a-F*i*a+F*r*v-t*U*v-o*r*R+t*i*R)*se,e[11]=(y*i*a-o*g*a-y*r*v+t*g*v+o*r*b-t*i*b)*se,e[12]=X*se,e[13]=(y*U*n-F*g*n+F*r*w-t*U*w-y*r*te+t*g*te)*se,e[14]=(F*i*n-o*U*n-F*r*h+t*U*h+o*r*te-t*i*te)*se,e[15]=(o*g*n-y*i*n+y*r*h-t*g*h-o*r*w+t*i*w)*se,this}scale(e){const t=this.elements,r=e.x,n=e.y,a=e.z;return t[0]*=r,t[4]*=n,t[8]*=a,t[1]*=r,t[5]*=n,t[9]*=a,t[2]*=r,t[6]*=n,t[10]*=a,t[3]*=r,t[7]*=n,t[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),n=Math.sin(t),a=1-r,o=e.x,i=e.y,h=e.z,v=a*o,y=a*i;return this.set(v*o+r,v*i-n*h,v*h+n*i,0,v*i+n*h,y*i+r,y*h-n*o,0,v*h-n*i,y*h+n*o,a*h*h+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,n,a,o){return this.set(1,r,a,0,e,1,o,0,t,n,1,0,0,0,0,1),this}compose(e,t,r){const n=this.elements,a=t._x,o=t._y,i=t._z,h=t._w,v=a+a,y=o+o,g=i+i,w=a*v,b=a*y,F=a*g,U=o*y,te=o*g,R=i*g,J=h*v,$=h*y,B=h*g,X=r.x,ie=r.y,se=r.z;return n[0]=(1-(U+R))*X,n[1]=(b+B)*X,n[2]=(F-$)*X,n[3]=0,n[4]=(b-B)*ie,n[5]=(1-(w+R))*ie,n[6]=(te+J)*ie,n[7]=0,n[8]=(F+$)*se,n[9]=(te-J)*se,n[10]=(1-(w+U))*se,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,r){const n=this.elements;let a=yn.set(n[0],n[1],n[2]).length();const o=yn.set(n[4],n[5],n[6]).length(),i=yn.set(n[8],n[9],n[10]).length();this.determinant()<0&&(a=-a),e.x=n[12],e.y=n[13],e.z=n[14],Qt.copy(this);const v=1/a,y=1/o,g=1/i;return Qt.elements[0]*=v,Qt.elements[1]*=v,Qt.elements[2]*=v,Qt.elements[4]*=y,Qt.elements[5]*=y,Qt.elements[6]*=y,Qt.elements[8]*=g,Qt.elements[9]*=g,Qt.elements[10]*=g,t.setFromRotationMatrix(Qt),r.x=a,r.y=o,r.z=i,this}makePerspective(e,t,r,n,a,o,i=Mi){const h=this.elements,v=2*a/(t-e),y=2*a/(r-n),g=(t+e)/(t-e),w=(r+n)/(r-n);let b,F;if(i===Mi)b=-(o+a)/(o-a),F=-2*o*a/(o-a);else if(i===hs)b=-o/(o-a),F=-o*a/(o-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+i);return h[0]=v,h[4]=0,h[8]=g,h[12]=0,h[1]=0,h[5]=y,h[9]=w,h[13]=0,h[2]=0,h[6]=0,h[10]=b,h[14]=F,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,t,r,n,a,o,i=Mi){const h=this.elements,v=1/(t-e),y=1/(r-n),g=1/(o-a),w=(t+e)*v,b=(r+n)*y;let F,U;if(i===Mi)F=(o+a)*g,U=-2*g;else if(i===hs)F=a*g,U=-1*g;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+i);return h[0]=2*v,h[4]=0,h[8]=0,h[12]=-w,h[1]=0,h[5]=2*y,h[9]=0,h[13]=-b,h[2]=0,h[6]=0,h[10]=U,h[14]=-F,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let n=0;n<16;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const yn=new bt,Qt=new ar,Xo=new bt(0,0,0),Ho=new bt(1,1,1),_r=new bt,Ci=new bt,Gt=new bt,ps=new ar,vs=new ai;class Yi{constructor(e=0,t=0,r=0,n=Yi.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,n=this._order){return this._x=e,this._y=t,this._z=r,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const n=e.elements,a=n[0],o=n[4],i=n[8],h=n[1],v=n[5],y=n[9],g=n[2],w=n[6],b=n[10];switch(t){case"XYZ":this._y=Math.asin(Ot(i,-1,1)),Math.abs(i)<.9999999?(this._x=Math.atan2(-y,b),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(w,v),this._z=0);break;case"YXZ":this._x=Math.asin(-Ot(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(i,b),this._z=Math.atan2(h,v)):(this._y=Math.atan2(-g,a),this._z=0);break;case"ZXY":this._x=Math.asin(Ot(w,-1,1)),Math.abs(w)<.9999999?(this._y=Math.atan2(-g,b),this._z=Math.atan2(-o,v)):(this._y=0,this._z=Math.atan2(h,a));break;case"ZYX":this._y=Math.asin(-Ot(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(w,b),this._z=Math.atan2(h,a)):(this._x=0,this._z=Math.atan2(-o,v));break;case"YZX":this._z=Math.asin(Ot(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-y,v),this._y=Math.atan2(-g,a)):(this._x=0,this._y=Math.atan2(i,b));break;case"XZY":this._z=Math.asin(-Ot(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(w,v),this._y=Math.atan2(i,a)):(this._x=Math.atan2(-y,b),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return ps.makeRotationFromQuaternion(e),this.setFromRotationMatrix(ps,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return vs.setFromEuler(this),this.setFromQuaternion(vs,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Yi.DEFAULT_ORDER="XYZ";class Yo{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Ko=0;const xs=new bt,dn=new ai,mr=new ar,Ri=new bt,jn=new bt,$o=new bt,Qo=new ai,gs=new bt(1,0,0),bs=new bt(0,1,0),Ts=new bt(0,0,1),Zo={type:"added"},Jo={type:"removed"},Ta={type:"childadded",child:null},Ea={type:"childremoved",child:null};class Xr extends ja{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Ko++}),this.uuid=Hi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Xr.DEFAULT_UP.clone();const e=new bt,t=new Yi,r=new ai,n=new bt(1,1,1);function a(){r.setFromEuler(t,!1)}function o(){t.setFromQuaternion(r,void 0,!1)}t._onChange(a),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new ar},normalMatrix:{value:new Ir}}),this.matrix=new ar,this.matrixWorld=new ar,this.matrixAutoUpdate=Xr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Xr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Yo,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return dn.setFromAxisAngle(e,t),this.quaternion.multiply(dn),this}rotateOnWorldAxis(e,t){return dn.setFromAxisAngle(e,t),this.quaternion.premultiply(dn),this}rotateX(e){return this.rotateOnAxis(gs,e)}rotateY(e){return this.rotateOnAxis(bs,e)}rotateZ(e){return this.rotateOnAxis(Ts,e)}translateOnAxis(e,t){return xs.copy(e).applyQuaternion(this.quaternion),this.position.add(xs.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(gs,e)}translateY(e){return this.translateOnAxis(bs,e)}translateZ(e){return this.translateOnAxis(Ts,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(mr.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?Ri.copy(e):Ri.set(e,t,r);const n=this.parent;this.updateWorldMatrix(!0,!1),jn.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?mr.lookAt(jn,Ri,this.up):mr.lookAt(Ri,jn,this.up),this.quaternion.setFromRotationMatrix(mr),n&&(mr.extractRotation(n.matrixWorld),dn.setFromRotationMatrix(mr),this.quaternion.premultiply(dn.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Zo),Ta.child=e,this.dispatchEvent(Ta),Ta.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Jo),Ea.child=e,this.dispatchEvent(Ea),Ea.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),mr.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),mr.multiply(e.parent.matrixWorld)),e.applyMatrix4(mr),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,n=this.children.length;r<n;r++){const o=this.children[r].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);const n=this.children;for(let a=0,o=n.length;a<o;a++)n[a].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(jn,e,$o),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(jn,Qo,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,n=t.length;r<n;r++){const a=t[r];(a.matrixWorldAutoUpdate===!0||e===!0)&&a.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const n=this.children;for(let a=0,o=n.length;a<o;a++){const i=n[a];i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),n.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(n.type="BatchedMesh",n.perObjectFrustumCulled=this.perObjectFrustumCulled,n.sortObjects=this.sortObjects,n.drawRanges=this._drawRanges,n.reservedRanges=this._reservedRanges,n.visibility=this._visibility,n.active=this._active,n.bounds=this._bounds.map(i=>({boxInitialized:i.boxInitialized,boxMin:i.box.min.toArray(),boxMax:i.box.max.toArray(),sphereInitialized:i.sphereInitialized,sphereRadius:i.sphere.radius,sphereCenter:i.sphere.center.toArray()})),n.maxGeometryCount=this._maxGeometryCount,n.maxVertexCount=this._maxVertexCount,n.maxIndexCount=this._maxIndexCount,n.geometryInitialized=this._geometryInitialized,n.geometryCount=this._geometryCount,n.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(n.boundingSphere={center:n.boundingSphere.center.toArray(),radius:n.boundingSphere.radius}),this.boundingBox!==null&&(n.boundingBox={min:n.boundingBox.min.toArray(),max:n.boundingBox.max.toArray()}));function a(i,h){return i[h.uuid]===void 0&&(i[h.uuid]=h.toJSON(e)),h.uuid}if(this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=a(e.geometries,this.geometry);const i=this.geometry.parameters;if(i!==void 0&&i.shapes!==void 0){const h=i.shapes;if(Array.isArray(h))for(let v=0,y=h.length;v<y;v++){const g=h[v];a(e.shapes,g)}else a(e.shapes,h)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const i=[];for(let h=0,v=this.material.length;h<v;h++)i.push(a(e.materials,this.material[h]));n.material=i}else n.material=a(e.materials,this.material);if(this.children.length>0){n.children=[];for(let i=0;i<this.children.length;i++)n.children.push(this.children[i].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let i=0;i<this.animations.length;i++){const h=this.animations[i];n.animations.push(a(e.animations,h))}}if(t){const i=o(e.geometries),h=o(e.materials),v=o(e.textures),y=o(e.images),g=o(e.shapes),w=o(e.skeletons),b=o(e.animations),F=o(e.nodes);i.length>0&&(r.geometries=i),h.length>0&&(r.materials=h),v.length>0&&(r.textures=v),y.length>0&&(r.images=y),g.length>0&&(r.shapes=g),w.length>0&&(r.skeletons=w),b.length>0&&(r.animations=b),F.length>0&&(r.nodes=F)}return r.object=n,r;function o(i){const h=[];for(const v in i){const y=i[v];delete y.metadata,h.push(y)}return h}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const n=e.children[r];this.add(n.clone())}return this}}Xr.DEFAULT_UP=new bt(0,1,0);Xr.DEFAULT_MATRIX_AUTO_UPDATE=!0;Xr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const ks={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Sr={h:0,s:0,l:0},Pi={h:0,s:0,l:0};function wa(u,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?u+(e-u)*6*t:t<1/2?e:t<2/3?u+(e-u)*6*(2/3-t):u}class Xa{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(t===void 0&&r===void 0){const n=e;n&&n.isColor?this.copy(n):typeof n=="number"?this.setHex(n):typeof n=="string"&&this.setStyle(n)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Ar){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,$t.toWorkingColorSpace(this,t),this}setRGB(e,t,r,n=$t.workingColorSpace){return this.r=e,this.g=t,this.b=r,$t.toWorkingColorSpace(this,n),this}setHSL(e,t,r,n=$t.workingColorSpace){if(e=Va(e,1),t=Ot(t,0,1),r=Ot(r,0,1),t===0)this.r=this.g=this.b=r;else{const a=r<=.5?r*(1+t):r+t-r*t,o=2*r-a;this.r=wa(o,a,e+1/3),this.g=wa(o,a,e),this.b=wa(o,a,e-1/3)}return $t.toWorkingColorSpace(this,n),this}setStyle(e,t=Ar){function r(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const o=n[1],i=n[2];switch(o){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return r(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,t);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return r(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,t);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return r(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=n[1],o=a.length;if(o===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(a,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Ar){const r=ks[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=xn(e.r),this.g=xn(e.g),this.b=xn(e.b),this}copyLinearToSRGB(e){return this.r=xa(e.r),this.g=xa(e.g),this.b=xa(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ar){return $t.fromWorkingColorSpace(Nt.copy(this),e),Math.round(Ot(Nt.r*255,0,255))*65536+Math.round(Ot(Nt.g*255,0,255))*256+Math.round(Ot(Nt.b*255,0,255))}getHexString(e=Ar){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=$t.workingColorSpace){$t.fromWorkingColorSpace(Nt.copy(this),t);const r=Nt.r,n=Nt.g,a=Nt.b,o=Math.max(r,n,a),i=Math.min(r,n,a);let h,v;const y=(i+o)/2;if(i===o)h=0,v=0;else{const g=o-i;switch(v=y<=.5?g/(o+i):g/(2-o-i),o){case r:h=(n-a)/g+(n<a?6:0);break;case n:h=(a-r)/g+2;break;case a:h=(r-n)/g+4;break}h/=6}return e.h=h,e.s=v,e.l=y,e}getRGB(e,t=$t.workingColorSpace){return $t.fromWorkingColorSpace(Nt.copy(this),t),e.r=Nt.r,e.g=Nt.g,e.b=Nt.b,e}getStyle(e=Ar){$t.fromWorkingColorSpace(Nt.copy(this),e);const t=Nt.r,r=Nt.g,n=Nt.b;return e!==Ar?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${n.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(r*255)},${Math.round(n*255)})`}offsetHSL(e,t,r){return this.getHSL(Sr),this.setHSL(Sr.h+e,Sr.s+t,Sr.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(Sr),e.getHSL(Pi);const r=Xn(Sr.h,Pi.h,t),n=Xn(Sr.s,Pi.s,t),a=Xn(Sr.l,Pi.l,t);return this.setHSL(r,n,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,n=this.b,a=e.elements;return this.r=a[0]*t+a[3]*r+a[6]*n,this.g=a[1]*t+a[4]*r+a[7]*n,this.b=a[2]*t+a[5]*r+a[8]*n,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Nt=new Xa;Xa.NAMES=ks;class eu extends Lr{constructor(e,t,r,n,a,o,i,h,v,y){if(y=y!==void 0?y:pa,y!==pa&&y!==ss)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&y===pa&&(r=vo),r===void 0&&y===ss&&(r=xo),super(null,n,a,o,i,h,y,r,v),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=i!==void 0?i:as,this.minFilter=h!==void 0?h:as,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const tu=new eu(1,1);tu.compareFunction=To;typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Ls}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Ls);const Es={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},Ha=["x","y","z","w"];function ru(u){let e="{";u.isNode===!0&&(e+=u.id);for(const{property:t,childNode:r}of Pa(u))e+=","+t.slice(0,-4)+":"+r.getCacheKey();return e+="}",e}function*Pa(u,e=!1){for(const t in u){if(t.startsWith("_")===!0)continue;const r=u[t];if(Array.isArray(r)===!0)for(let n=0;n<r.length;n++){const a=r[n];a&&(a.isNode===!0||e&&typeof a.toJSON=="function")&&(yield{property:t,index:n,childNode:a})}else if(r&&r.isNode===!0)yield{property:t,childNode:r};else if(typeof r=="object")for(const n in r){const a=r[n];a&&(a.isNode===!0||e&&typeof a.toJSON=="function")&&(yield{property:t,index:n,childNode:a})}}}function Na(u){if(u==null)return null;const e=typeof u;return u.isNode===!0?"node":e==="number"?"float":e==="boolean"?"bool":e==="string"?"string":e==="function"?"shader":u.isVector2===!0?"vec2":u.isVector3===!0?"vec3":u.isVector4===!0?"vec4":u.isMatrix3===!0?"mat3":u.isMatrix4===!0?"mat4":u.isColor===!0?"color":u instanceof ArrayBuffer?"ArrayBuffer":null}function Gs(u,...e){const t=u?u.slice(-4):void 0;return e.length===1&&(t==="vec2"?e=[e[0],e[0]]:t==="vec3"?e=[e[0],e[0],e[0]]:t==="vec4"&&(e=[e[0],e[0],e[0],e[0]])),u==="color"?new Xa(...e):t==="vec2"?new vn(...e):t==="vec3"?new bt(...e):t==="vec4"?new qa(...e):t==="mat3"?new Ir(...e):t==="mat4"?new ar(...e):u==="bool"?e[0]||!1:u==="float"||u==="int"||u==="uint"?e[0]||0:u==="string"?e[0]||"":u==="ArrayBuffer"?iu(e[0]):null}function nu(u){let e="";const t=new Uint8Array(u);for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return btoa(e)}function iu(u){return Uint8Array.from(atob(u),e=>e.charCodeAt(0)).buffer}const ws=new Map;let au=0;class Yr extends ja{constructor(e=null){super(),this.nodeType=e,this.updateType=Es.NONE,this.updateBeforeType=Es.NONE,this.uuid=ko.generateUUID(),this.isNode=!0,Object.defineProperty(this,"id",{value:au++})}get type(){return this.constructor.type}getSelf(){return this.self||this}setReference(){return this}isGlobal(){return!1}*getChildren(){for(const{childNode:e}of Pa(this))yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const t of this.getChildren())t.traverse(e)}getCacheKey(){return ru(this)}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getNodeType(e){const t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}getShared(e){const t=this.getHash(e);return e.getNodeFromHash(t)||this}setup(e){const t=e.getNodeProperties(this);for(const r of this.getChildren())t["_node"+r.id]=r;return null}construct(e){return console.warn("THREE.Node: construct() is deprecated. Use setup() instead."),this.setup(e)}increaseUsage(e){const t=e.getDataFromNode(this);return t.usageCount=t.usageCount===void 0?1:t.usageCount+1,t.usageCount}analyze(e){if(this.increaseUsage(e)===1){const r=e.getNodeProperties(this);for(const n of Object.values(r))n&&n.isNode===!0&&n.build(e)}}generate(e,t){const{outputNode:r}=e.getNodeProperties(this);if(r&&r.isNode===!0)return r.build(e,t)}updateBefore(){console.warn("Abstract function.")}update(){console.warn("Abstract function.")}build(e,t=null){const r=this.getShared(e);if(this!==r)return r.build(e,t);e.addNode(this),e.addChain(this);let n=null;const a=e.getBuildStage();if(a==="setup"){this.setReference(e);const o=e.getNodeProperties(this);if(o.initialized!==!0||e.context.tempRead===!1){const i=e.stack.nodes.length;o.initialized=!0,o.outputNode=this.setup(e),o.outputNode!==null&&e.stack.nodes.length!==i&&(o.outputNode=e.stack);for(const h of Object.values(o))h&&h.isNode===!0&&h.build(e)}}else if(a==="analyze")this.analyze(e);else if(a==="generate")if(this.generate.length===1){const i=this.getNodeType(e),h=e.getDataFromNode(this);n=h.snippet,n===void 0&&(n=this.generate(e)||"",h.snippet=n),n=e.format(n,i,t)}else n=this.generate(e,t)||"";return e.removeChain(this),n}getSerializeChildren(){return Pa(this)}serialize(e){const t=this.getSerializeChildren(),r={};for(const{property:n,index:a,childNode:o}of t)a!==void 0?(r[n]===void 0&&(r[n]=Number.isInteger(a)?[]:{}),r[n][a]=o.toJSON(e.meta).uuid):r[n]=o.toJSON(e.meta).uuid;Object.keys(r).length>0&&(e.inputNodes=r)}deserialize(e){if(e.inputNodes!==void 0){const t=e.meta.nodes;for(const r in e.inputNodes)if(Array.isArray(e.inputNodes[r])){const n=[];for(const a of e.inputNodes[r])n.push(t[a]);this[r]=n}else if(typeof e.inputNodes[r]=="object"){const n={};for(const a in e.inputNodes[r]){const o=e.inputNodes[r][a];n[a]=t[o]}this[r]=n}else{const n=e.inputNodes[r];this[r]=t[n]}}}toJSON(e){const{uuid:t,type:r}=this,n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{},nodes:{}});let a=e.nodes[t];a===void 0&&(a={uuid:t,type:r,meta:e,metadata:{version:4.6,type:"Node",generator:"Node.toJSON"}},n!==!0&&(e.nodes[a.uuid]=a),this.serialize(a),delete a.meta);function o(i){const h=[];for(const v in i){const y=i[v];delete y.metadata,h.push(y)}return h}if(n){const i=o(e.textures),h=o(e.images),v=o(e.nodes);i.length>0&&(a.textures=i),h.length>0&&(a.images=h),v.length>0&&(a.nodes=v)}return a}}function Xt(u,e){if(typeof e!="function"||!u)throw new Error(`Node class ${u} is not a class`);if(ws.has(u)){console.warn(`Redefinition of node class ${u}`);return}ws.set(u,e),e.type=u}class Fn extends Yr{constructor(e){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,t){if(e.getBuildStage()==="generate"){const n=e.getVectorType(this.getNodeType(e,t)),a=e.getDataFromNode(this);if(e.context.tempRead!==!1&&a.propertyName!==void 0)return e.format(a.propertyName,n,t);if(e.context.tempWrite!==!1&&n!=="void"&&t!=="void"&&this.hasDependencies(e)){const o=super.build(e,n),i=e.getVarFromNode(this,null,n),h=e.getPropertyName(i);return e.addLineFlowCode(`${h} = ${o}`),a.snippet=o,a.propertyName=h,e.format(a.propertyName,n,t)}}return super.build(e,t)}}Xt("TempNode",Fn);class Ya extends Yr{constructor(e,t){super(),this.node=e,this.indexNode=t,this.isArrayElementNode=!0}getNodeType(e){return this.node.getNodeType(e)}generate(e){const t=this.node.build(e),r=this.indexNode.build(e,"uint");return`${t}[ ${r} ]`}}Xt("ArrayElementNode",Ya);class Ka extends Yr{constructor(e,t){super(),this.node=e,this.convertTo=t}getNodeType(e){const t=this.node.getNodeType(e);let r=null;for(const n of this.convertTo.split("|"))(r===null||e.getTypeLength(t)===e.getTypeLength(n))&&(r=n);return r}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,t){const r=this.node,n=this.getNodeType(e),a=r.build(e,n);return e.format(a,n,t)}}Xt("ConvertNode",Ka);class Ws extends Fn{constructor(e=[],t=null){super(t),this.nodes=e}getNodeType(e){return this.nodeType!==null?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((t,r)=>t+e.getTypeLength(r.getNodeType(e)),0))}generate(e,t){const r=this.getNodeType(e),n=this.nodes,a=e.getComponentType(r),o=[];for(const h of n){let v=h.build(e);const y=e.getComponentType(h.getNodeType(e));y!==a&&(v=e.format(v,y,a)),o.push(v)}const i=`${e.getType(r)}( ${o.join(", ")} )`;return e.format(i,r,t)}}Xt("JoinNode",Ws);const su=Ha.join("");class Da extends Yr{constructor(e,t="x"){super(),this.node=e,this.components=t,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const t of this.components)e=Math.max(Ha.indexOf(t)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}generate(e,t){const r=this.node,n=e.getTypeLength(r.getNodeType(e));let a=null;if(n>1){let o=null;this.getVectorLength()>=n&&(o=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const h=r.build(e,o);this.components.length===n&&this.components===su.slice(0,this.components.length)?a=e.format(h,o,t):a=e.format(`${h}.${this.components}`,this.getNodeType(e),t)}else a=r.build(e,t);return a}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}Xt("SplitNode",Da);class js extends Fn{constructor(e,t,r){super(),this.sourceNode=e,this.components=t,this.targetNode=r}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:t,components:r,targetNode:n}=this,a=this.getNodeType(e),o=e.getTypeFromLength(r.length),i=n.build(e,o),h=t.build(e,a),v=e.getTypeLength(a),y=[];for(let g=0;g<v;g++){const w=Ha[g];w===r[0]?(y.push(i),g+=r.length-1):y.push(h+"."+w)}return`${e.getType(a)}( ${y.join(", ")} )`}}Xt("SetNode",js);class Vs extends Yr{constructor(e,t=null){super(t),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return this.nodeType===null?Na(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=Na(this.value),e.nodeType=this.nodeType,e.valueType==="ArrayBuffer"&&(e.value=nu(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?Gs(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){console.warn("Abstract function.")}}Xt("InputNode",Vs);class Ht extends Vs{constructor(e,t=null){super(e,t),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,t){const r=this.getNodeType(e);return e.format(this.generateConst(e),r,t)}}Xt("ConstNode",Ht);let ou=null;const pn=new Map;function Q(u,e){if(pn.has(u)){console.warn(`Redefinition of node element ${u}`);return}if(typeof e!="function")throw new Error(`Node element ${u} is not a function`);pn.set(u,e)}const _s=u=>u.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),qs={setup(u,e){const t=e.shift();return u(Ja(t),...e)},get(u,e,t){if(typeof e=="string"&&u[e]===void 0){if(u.isStackNode!==!0&&e==="assign")return(...r)=>(ou.assign(t,...r),t);if(pn.has(e)){const r=pn.get(e);return u.isStackNode?(...n)=>t.add(r(...n)):(...n)=>r(t,...n)}else{if(e==="self")return u;if(e.endsWith("Assign")&&pn.has(e.slice(0,e.length-6))){const r=pn.get(e.slice(0,e.length-6));return u.isStackNode?(...n)=>t.assign(n[0],r(...n)):(...n)=>t.assign(r(t,...n))}else{if(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0)return e=_s(e),ht(new Da(t,e));if(/^set[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=_s(e.slice(3).toLowerCase()),e=e.split("").sort().join(""),r=>ht(new js(u,e,r));if(e==="width"||e==="height"||e==="depth")return e==="width"?e="x":e==="height"?e="y":e==="depth"&&(e="z"),ht(new Da(u,e));if(/^\d+$/.test(e)===!0)return ht(new Ya(t,new Ht(Number(e),"uint")))}}}return Reflect.get(u,e,t)},set(u,e,t,r){return typeof e=="string"&&u[e]===void 0&&(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0||e==="width"||e==="height"||e==="depth"||/^\d+$/.test(e)===!0)?(r[e].assign(t),!0):Reflect.set(u,e,t,r)}},_a=new WeakMap,Ss=new WeakMap,uu=function(u,e=null){const t=Na(u);if(t==="node"){let r=_a.get(u);return r===void 0&&(r=new Proxy(u,qs),_a.set(u,r),_a.set(r,r)),r}else{if(e===null&&(t==="float"||t==="boolean")||t&&t!=="shader"&&t!=="string")return ht(La(u,e));if(t==="shader")return si(u)}return u},cu=function(u,e=null){for(const t in u)u[t]=ht(u[t],e);return u},hu=function(u,e=null){const t=u.length;for(let r=0;r<t;r++)u[r]=ht(u[r],e);return u},lu=function(u,e=null,t=null,r=null){const n=a=>ht(r!==null?Object.assign(a,r):a);return e===null?(...a)=>n(new u(...Sa(a))):t!==null?(t=ht(t),(...a)=>n(new u(e,...Sa(a),t))):(...a)=>n(new u(e,...Sa(a)))};class fu extends Yr{constructor(e,t){super(),this.shaderNode=e,this.inputNodes=t}getNodeType(e){const{outputNode:t}=e.getNodeProperties(this);return t?t.getNodeType(e):super.getNodeType(e)}call(e){const{shaderNode:t,inputNodes:r}=this;if(t.layout){let o=Ss.get(e.constructor);o===void 0&&(o=new WeakMap,Ss.set(e.constructor,o));let i=o.get(t);return i===void 0&&(i=ht(e.buildFunctionNode(t)),o.set(t,i)),e.currentFunctionNode!==null&&e.currentFunctionNode.includes.push(i),ht(i.call(r))}const n=t.jsFunc,a=r!==null?n(r,e.stack,e):n(e.stack,e);return ht(a)}setup(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}generate(e,t){const{outputNode:r}=e.getNodeProperties(this);return r===null?this.call(e).build(e,t):super.generate(e,t)}}class mu extends Yr{constructor(e){super(),this.jsFunc=e,this.layout=null}get isArrayInput(){return/^\((\s+)?\[/.test(this.jsFunc.toString())}setLayout(e){return this.layout=e,this}call(e=null){return Ja(e),ht(new fu(this,e))}setup(){return this.call()}}const yu=[!1,!0],du=[0,1,2,3],pu=[-1,-2],Xs=[.5,1.5,1/3,1e-6,1e6,Math.PI,Math.PI*2,1/Math.PI,2/Math.PI,1/(Math.PI*2),Math.PI/2],$a=new Map;for(const u of yu)$a.set(u,new Ht(u));const Qa=new Map;for(const u of du)Qa.set(u,new Ht(u,"uint"));const Za=new Map([...Qa].map(u=>new Ht(u.value,"int")));for(const u of pu)Za.set(u,new Ht(u,"int"));const Ki=new Map([...Za].map(u=>new Ht(u.value)));for(const u of Xs)Ki.set(u,new Ht(u));for(const u of Xs)Ki.set(-u,new Ht(-u));const $i={bool:$a,uint:Qa,ints:Za,float:Ki},As=new Map([...$a,...Ki]),La=(u,e)=>As.has(u)?As.get(u):u.isNode===!0?u:new Ht(u,e),vu=u=>{try{return u.getNodeType()}catch{return}},it=function(u,e=null){return(...t)=>{if((t.length===0||!["bool","float","int","uint"].includes(u)&&t.every(n=>typeof n!="object"))&&(t=[Gs(u,...t)]),t.length===1&&e!==null&&e.has(t[0]))return ht(e.get(t[0]));if(t.length===1){const n=La(t[0],u);return vu(n)===u?ht(n):ht(new Ka(n,u))}const r=t.map(n=>La(n));return ht(new Ws(r,u))}};function Hs(u){return new Proxy(new mu(u),qs)}const ht=(u,e=null)=>uu(u,e),Ja=(u,e=null)=>new cu(u,e),Sa=(u,e=null)=>new hu(u,e),he=(...u)=>new lu(...u),si=u=>{const e=new Hs(u),t=(...r)=>{let n;return Ja(r),r[0]&&r[0].isNode?n=[...r]:n=r[0],e.call(n)};return t.shaderNode=e,t.setLayout=r=>(e.setLayout(r),t),t};Xt("ShaderNode",Hs);function xu(u){return u}Q("append",xu);const gu=new it("color"),oi=new it("float",$i.float),bu=new it("int",$i.int),Tu=new it("uint",$i.uint),Eu=new it("bool",$i.bool),wu=new it("vec2"),_u=new it("ivec2"),Su=new it("uvec2"),Au=new it("bvec2"),Hr=new it("vec3"),Mu=new it("ivec3"),Fu=new it("uvec3"),Cu=new it("bvec3"),Ia=new it("vec4"),Ru=new it("ivec4"),Pu=new it("uvec4"),Nu=new it("bvec4"),Du=new it("mat2"),Lu=new it("imat2"),Iu=new it("umat2"),Bu=new it("bmat2"),Ou=new it("mat3"),zu=new it("imat3"),Uu=new it("umat3"),ku=new it("bmat3"),Gu=new it("mat4"),Wu=new it("imat4"),ju=new it("umat4"),Vu=new it("bmat4"),qu=(u="")=>ht(new Ht(u,"string")),Xu=u=>ht(new Ht(u,"ArrayBuffer"));Q("color",gu);Q("float",oi);Q("int",bu);Q("uint",Tu);Q("bool",Eu);Q("vec2",wu);Q("ivec2",_u);Q("uvec2",Su);Q("bvec2",Au);Q("vec3",Hr);Q("ivec3",Mu);Q("uvec3",Fu);Q("bvec3",Cu);Q("vec4",Ia);Q("ivec4",Ru);Q("uvec4",Pu);Q("bvec4",Nu);Q("mat2",Du);Q("imat2",Lu);Q("umat2",Iu);Q("bmat2",Bu);Q("mat3",Ou);Q("imat3",zu);Q("umat3",Uu);Q("bmat3",ku);Q("mat4",Gu);Q("imat4",Wu);Q("umat4",ju);Q("bmat4",Vu);Q("string",qu);Q("arrayBuffer",Xu);const Hu=he(Ya),Yu=(u,e)=>ht(new Ka(ht(u),e));Q("element",Hu);Q("convert",Yu);class lt extends Fn{constructor(e,t,r,...n){if(super(),this.op=e,n.length>0){let a=r;for(let o=0;o<n.length;o++)a=new lt(e,a,n[o]);r=a}this.aNode=t,this.bNode=r}getNodeType(e,t){const r=this.op,n=this.aNode,a=this.bNode,o=n.getNodeType(e),i=typeof a<"u"?a.getNodeType(e):null;if(o==="void"||i==="void")return"void";if(r==="%")return o;if(r==="~"||r==="&"||r==="|"||r==="^"||r===">>"||r==="<<")return e.getIntegerType(o);if(r==="!"||r==="=="||r==="&&"||r==="||"||r==="^^")return"bool";if(r==="<"||r===">"||r==="<="||r===">="){const h=t?e.getTypeLength(t):Math.max(e.getTypeLength(o),e.getTypeLength(i));return h>1?`bvec${h}`:"bool"}else return o==="float"&&e.isMatrix(i)?i:e.isMatrix(o)&&e.isVector(i)?e.getVectorFromMatrix(o):e.isVector(o)&&e.isMatrix(i)?e.getVectorFromMatrix(i):e.getTypeLength(i)>e.getTypeLength(o)?i:o}generate(e,t){const r=this.op,n=this.aNode,a=this.bNode,o=this.getNodeType(e,t);let i=null,h=null;o!=="void"?(i=n.getNodeType(e),h=typeof a<"u"?a.getNodeType(e):null,r==="<"||r===">"||r==="<="||r===">="||r==="=="?e.isVector(i)?h=i:i=h="float":r===">>"||r==="<<"?(i=o,h=e.changeComponentType(h,"uint")):e.isMatrix(i)&&e.isVector(h)?h=e.getVectorFromMatrix(i):e.isVector(i)&&e.isMatrix(h)?i=e.getVectorFromMatrix(h):i=h=o):i=h=o;const v=n.build(e,i),y=typeof a<"u"?a.build(e,h):null,g=e.getTypeLength(t),w=e.getFunctionOperator(r);if(t!=="void")return r==="<"&&g>1?e.format(`${e.getMethod("lessThan")}( ${v}, ${y} )`,o,t):r==="<="&&g>1?e.format(`${e.getMethod("lessThanEqual")}( ${v}, ${y} )`,o,t):r===">"&&g>1?e.format(`${e.getMethod("greaterThan")}( ${v}, ${y} )`,o,t):r===">="&&g>1?e.format(`${e.getMethod("greaterThanEqual")}( ${v}, ${y} )`,o,t):r==="!"||r==="~"?e.format(`(${r}${v})`,i,t):w?e.format(`${w}( ${v}, ${y} )`,o,t):e.format(`( ${v} ${r} ${y} )`,o,t);if(i!=="void")return w?e.format(`${w}( ${v}, ${y} )`,o,t):e.format(`${v} ${r} ${y}`,o,t)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const Ku=he(lt,"+"),Ba=he(lt,"-"),es=he(lt,"*"),Ys=he(lt,"/"),$u=he(lt,"%"),Qu=he(lt,"=="),Zu=he(lt,"!="),Ju=he(lt,"<"),ec=he(lt,">"),tc=he(lt,"<="),rc=he(lt,">="),nc=he(lt,"&&"),ic=he(lt,"||"),ac=he(lt,"!"),sc=he(lt,"^^"),oc=he(lt,"&"),uc=he(lt,"~"),cc=he(lt,"|"),hc=he(lt,"^"),lc=he(lt,"<<"),fc=he(lt,">>");Q("add",Ku);Q("sub",Ba);Q("mul",es);Q("div",Ys);Q("remainder",$u);Q("equal",Qu);Q("notEqual",Zu);Q("lessThan",Ju);Q("greaterThan",ec);Q("lessThanEqual",tc);Q("greaterThanEqual",rc);Q("and",nc);Q("or",ic);Q("not",ac);Q("xor",sc);Q("bitAnd",oc);Q("bitNot",uc);Q("bitOr",cc);Q("bitXor",hc);Q("shiftLeft",lc);Q("shiftRight",fc);Xt("OperatorNode",lt);class N extends Fn{constructor(e,t,r=null,n=null){super(),this.method=e,this.aNode=t,this.bNode=r,this.cNode=n}getInputType(e){const t=this.aNode.getNodeType(e),r=this.bNode?this.bNode.getNodeType(e):null,n=this.cNode?this.cNode.getNodeType(e):null,a=e.isMatrix(t)?0:e.getTypeLength(t),o=e.isMatrix(r)?0:e.getTypeLength(r),i=e.isMatrix(n)?0:e.getTypeLength(n);return a>o&&a>i?t:o>i?r:i>a?n:t}getNodeType(e){const t=this.method;return t===N.LENGTH||t===N.DISTANCE||t===N.DOT?"float":t===N.CROSS?"vec3":t===N.ALL?"bool":t===N.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):t===N.MOD?this.aNode.getNodeType(e):this.getInputType(e)}generate(e,t){const r=this.method,n=this.getNodeType(e),a=this.getInputType(e),o=this.aNode,i=this.bNode,h=this.cNode,v=e.renderer.isWebGLRenderer===!0;if(r===N.TRANSFORM_DIRECTION){let y=o,g=i;e.isMatrix(y.getNodeType(e))?g=Ia(Hr(g),0):y=Ia(Hr(y),0);const w=es(y,g).xyz;return Ks(w).build(e,t)}else{if(r===N.NEGATE)return e.format("( - "+o.build(e,a)+" )",n,t);if(r===N.ONE_MINUS)return Ba(1,o).build(e,t);if(r===N.RECIPROCAL)return Ys(1,o).build(e,t);if(r===N.DIFFERENCE)return ts(Ba(o,i)).build(e,t);{const y=[];return r===N.CROSS||r===N.MOD?y.push(o.build(e,n),i.build(e,n)):r===N.STEP?y.push(o.build(e,e.getTypeLength(o.getNodeType(e))===1?"float":a),i.build(e,a)):v&&(r===N.MIN||r===N.MAX)||r===N.MOD?y.push(o.build(e,a),i.build(e,e.getTypeLength(i.getNodeType(e))===1?"float":a)):r===N.REFRACT?y.push(o.build(e,a),i.build(e,a),h.build(e,"float")):r===N.MIX?y.push(o.build(e,a),i.build(e,a),h.build(e,e.getTypeLength(h.getNodeType(e))===1?"float":a)):(y.push(o.build(e,a)),i!==null&&y.push(i.build(e,a)),h!==null&&y.push(h.build(e,a))),e.format(`${e.getMethod(r,n)}( ${y.join(", ")} )`,n,t)}}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}N.ALL="all";N.ANY="any";N.EQUALS="equals";N.RADIANS="radians";N.DEGREES="degrees";N.EXP="exp";N.EXP2="exp2";N.LOG="log";N.LOG2="log2";N.SQRT="sqrt";N.INVERSE_SQRT="inversesqrt";N.FLOOR="floor";N.CEIL="ceil";N.NORMALIZE="normalize";N.FRACT="fract";N.SIN="sin";N.COS="cos";N.TAN="tan";N.ASIN="asin";N.ACOS="acos";N.ATAN="atan";N.ABS="abs";N.SIGN="sign";N.LENGTH="length";N.NEGATE="negate";N.ONE_MINUS="oneMinus";N.DFDX="dFdx";N.DFDY="dFdy";N.ROUND="round";N.RECIPROCAL="reciprocal";N.TRUNC="trunc";N.FWIDTH="fwidth";N.BITCAST="bitcast";N.ATAN2="atan2";N.MIN="min";N.MAX="max";N.MOD="mod";N.STEP="step";N.REFLECT="reflect";N.DISTANCE="distance";N.DIFFERENCE="difference";N.DOT="dot";N.CROSS="cross";N.POW="pow";N.TRANSFORM_DIRECTION="transformDirection";N.MIX="mix";N.CLAMP="clamp";N.REFRACT="refract";N.SMOOTHSTEP="smoothstep";N.FACEFORWARD="faceforward";const mc=oi(1e-6);oi(1e6);oi(Math.PI);oi(Math.PI*2);const yc=he(N,N.ALL),dc=he(N,N.ANY),pc=he(N,N.EQUALS),vc=he(N,N.RADIANS),xc=he(N,N.DEGREES),gc=he(N,N.EXP),bc=he(N,N.EXP2),Tc=he(N,N.LOG),Ec=he(N,N.LOG2),wc=he(N,N.SQRT),_c=he(N,N.INVERSE_SQRT),Sc=he(N,N.FLOOR),Ac=he(N,N.CEIL),Ks=he(N,N.NORMALIZE),Mc=he(N,N.FRACT),Fc=he(N,N.SIN),Cc=he(N,N.COS),Rc=he(N,N.TAN),Pc=he(N,N.ASIN),Nc=he(N,N.ACOS),Dc=he(N,N.ATAN),ts=he(N,N.ABS),$s=he(N,N.SIGN),Lc=he(N,N.LENGTH),Ic=he(N,N.NEGATE),Bc=he(N,N.ONE_MINUS),Oc=he(N,N.DFDX),zc=he(N,N.DFDY),Uc=he(N,N.ROUND),kc=he(N,N.RECIPROCAL),Gc=he(N,N.TRUNC),Wc=he(N,N.FWIDTH);he(N,N.BITCAST);const jc=he(N,N.ATAN2),Vc=he(N,N.MIN),qc=he(N,N.MAX),Xc=he(N,N.MOD),Hc=he(N,N.STEP),Yc=he(N,N.REFLECT),Kc=he(N,N.DISTANCE),$c=he(N,N.DIFFERENCE),Qs=he(N,N.DOT),Qc=he(N,N.CROSS),Zs=he(N,N.POW),Zc=he(N,N.POW,2),Jc=he(N,N.POW,3),eh=he(N,N.POW,4),th=he(N,N.TRANSFORM_DIRECTION),rh=u=>es($s(u),Zs(ts(u),1/3)),nh=u=>Qs(u,u),ih=he(N,N.MIX),Js=(u,e=0,t=1)=>ht(new N(N.CLAMP,ht(u),ht(e),ht(t))),ah=u=>Js(u),sh=he(N,N.REFRACT),oh=he(N,N.SMOOTHSTEP),uh=he(N,N.FACEFORWARD),ch=(u,e,t)=>ih(e,t,u),hh=(u,e,t)=>oh(e,t,u);Q("all",yc);Q("any",dc);Q("equals",pc);Q("radians",vc);Q("degrees",xc);Q("exp",gc);Q("exp2",bc);Q("log",Tc);Q("log2",Ec);Q("sqrt",wc);Q("inverseSqrt",_c);Q("floor",Sc);Q("ceil",Ac);Q("normalize",Ks);Q("fract",Mc);Q("sin",Fc);Q("cos",Cc);Q("tan",Rc);Q("asin",Pc);Q("acos",Nc);Q("atan",Dc);Q("abs",ts);Q("sign",$s);Q("length",Lc);Q("lengthSq",nh);Q("negate",Ic);Q("oneMinus",Bc);Q("dFdx",Oc);Q("dFdy",zc);Q("round",Uc);Q("reciprocal",kc);Q("trunc",Gc);Q("fwidth",Wc);Q("atan2",jc);Q("min",Vc);Q("max",qc);Q("mod",Xc);Q("step",Hc);Q("reflect",Yc);Q("distance",Kc);Q("dot",Qs);Q("cross",Qc);Q("pow",Zs);Q("pow2",Zc);Q("pow3",Jc);Q("pow4",eh);Q("transformDirection",th);Q("mix",ch);Q("clamp",Js);Q("refract",sh);Q("smoothstep",hh);Q("faceForward",uh);Q("difference",$c);Q("saturate",ah);Q("cbrt",rh);Xt("MathNode",N);const lh=si(({base:u,blend:e})=>{const t=r=>e[r].lessThan(mc).cond(e[r],u[r].oneMinus().div(e[r]).oneMinus().max(0));return Hr(t("x"),t("y"),t("z"))}).setLayout({name:"burnColor",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),fh=si(({base:u,blend:e})=>{const t=r=>e[r].equal(1).cond(e[r],u[r].div(e[r].oneMinus()).max(0));return Hr(t("x"),t("y"),t("z"))}).setLayout({name:"dodgeColor",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),mh=si(({base:u,blend:e})=>{const t=r=>u[r].oneMinus().mul(e[r].oneMinus()).oneMinus();return Hr(t("x"),t("y"),t("z"))}).setLayout({name:"screenColor",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),yh=si(({base:u,blend:e})=>{const t=r=>u[r].lessThan(.5).cond(u[r].mul(e[r],2),u[r].oneMinus().mul(e[r].oneMinus()).oneMinus());return Hr(t("x"),t("y"),t("z"))}).setLayout({name:"overlayColor",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]});class St extends Fn{constructor(e,t,r){super(),this.blendMode=e,this.baseNode=t,this.blendNode=r}setup(){const{blendMode:e,baseNode:t,blendNode:r}=this,n={base:t,blend:r};let a=null;return e===St.BURN?a=lh(n):e===St.DODGE?a=fh(n):e===St.SCREEN?a=mh(n):e===St.OVERLAY&&(a=yh(n)),a}}St.BURN="burn";St.DODGE="dodge";St.SCREEN="screen";St.OVERLAY="overlay";const dh=he(St,St.BURN),ph=he(St,St.DODGE),vh=he(St,St.OVERLAY),xh=he(St,St.SCREEN);Q("burn",dh);Q("dodge",ph);Q("overlay",vh);Q("screen",xh);Xt("BlendModeNode",St);var Wt,qt,Fr,wn,Cr,Dt,Rr,Jt,_n,Qn,Zn,Jn,ka,Ga,ei,Vr,pr,ti,Gi,eo,Wi,to,ji,ro,ri,Oa,Vi,no,qi,io,ni,za,Xi,ao;class gh{constructor(){_e(this,Gi);_e(this,Wi);_e(this,ji);_e(this,ri);_e(this,Vi);_e(this,qi);_e(this,ni);_e(this,Xi);ct(this,"canvas",document.querySelector("#canvas"));ct(this,"gl");_e(this,Wt,new Map);_e(this,qt,new Map);_e(this,Fr,void 0);_e(this,wn,void 0);_e(this,Cr,void 0);_e(this,Dt,new Uint8Array(600));_e(this,Rr,void 0);_e(this,Jt,new Uint8Array(3*40));_e(this,_n,void 0);_e(this,Qn,document.createTextNode("0"));_e(this,Zn,document.createTextNode("1"));_e(this,Jn,document.createTextNode("0"));_e(this,ka,0);_e(this,Ga,0);_e(this,ei,new Map);_e(this,Vr,void 0);_e(this,pr,void 0);_e(this,ti,document.querySelectorAll("button"));document.querySelector("#linesCleared").appendChild(ee(this,Qn)),document.querySelector("#speedLevel").appendChild(ee(this,Zn)),document.querySelector("#score").appendChild(ee(this,Jn));const e=document.styleSheets;let t=!1;for(let g=0;g<e.length&&!t;g++)e[g].href.includes("WebTetris")&&(Ce(this,Vr,e[g].cssRules),t=!0);ee(this,Wt).set(1,[255,0,0]),ee(this,Wt).set(2,[0,255,0]),ee(this,Wt).set(3,[255,255,0]),ee(this,Wt).set(4,[0,0,255]),ee(this,Wt).set(5,[180,90,246]),ee(this,Wt).set(6,[0,255,255]),ee(this,Wt).set(7,[255,140,40]),ee(this,qt).set("Z",1),ee(this,qt).set("S",2),ee(this,qt).set("O",3),ee(this,qt).set("J",4),ee(this,qt).set("T",5),ee(this,qt).set("I",6),ee(this,qt).set("L",7);let r=this.canvas.getContext("webgl");this.gl=r,r||document.body.appendChild(document.createTextNode("WebGL is not supported."));function n(g,w,b,F){return[g,w+F,g+b,w+F,g+b,w,g,w]}function a(g,w,b,F){let U=[g/2,g],te=[],R=(300-U[1])/2,J=(400-U[0])/2;te.push(...n(J,R,U[0],U[1])),te.push(...n(J-w-F,R,F,F));for(let $=0;$<3;$++)te.push(...n(J+w+U[0],R+$*(F+b),F,F));return te}const o={a_Position:{numComponents:2,data:a(250,3,0,30)},a_GridPos:{numComponents:2,data:[0,0,10,0,10,20,0,20,0,0,4,0,4,4,0,4,0,0,4,0,4,4,0,4,0,0,4,0,4,4,0,4,0,0,4,0,4,4,0,4]},a_QueueID:{numComponents:1,data:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3]},a_ShaderID:{numComponents:1,data:[0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},indices:{numComponents:3,data:[0,1,2,2,3,0,4,5,6,6,7,4,8,9,10,10,11,8,12,13,14,14,15,12,16,17,18,18,19,16]}};Ce(this,wn,wr.createBufferInfoFromArrays(r,o));let i=document.querySelector("#vertex-shader-2d").text,h=document.querySelector("#fragment-shader-2d").text;Ce(this,Fr,wr.createProgramInfo(r,[i,h]));let v={src:"textures/block.png",mag:r.LINEAR};Ce(this,_n,wr.createTexture(this.gl,v)),Ce(this,Cr,r.createTexture()),r.bindTexture(r.TEXTURE_2D,ee(this,Cr)),r.pixelStorei(r.UNPACK_ALIGNMENT,1),r.texImage2D(r.TEXTURE_2D,0,r.RGB,10,20,0,r.RGB,r.UNSIGNED_BYTE,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),Ce(this,Rr,r.createTexture()),r.bindTexture(r.TEXTURE_2D,ee(this,Rr)),r.pixelStorei(r.UNPACK_ALIGNMENT,1),r.texImage2D(r.TEXTURE_2D,0,r.RGB,4,2*5,0,r.RGB,r.UNSIGNED_BYTE,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.useProgram(ee(this,Fr).program),wr.setBuffersAndAttributes(r,ee(this,Fr),ee(this,wn));let y={u_Resolution:[this.gl.canvas.width,this.gl.canvas.height],u_GridData:ee(this,Cr),u_QueueData:ee(this,Rr),u_BlockTexture:ee(this,_n)};wr.setUniforms(ee(this,Fr),y),$e(this,qi,io).call(this,"#gameSpace"),Ce(this,pr,$e(this,ni,za).call(this,"button").fontSize),Ce(this,pr,Number(ee(this,pr).substring(0,ee(this,pr).length-2)))}updateData(e){$e(this,Gi,eo).call(this,e),$e(this,ji,ro).call(this,e),$e(this,Vi,no).call(this,e)}renderGame(){wr.resizeCanvasToDisplaySize(this.gl.canvas),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),$e(this,Xi,ao).call(this);let e={u_Resolution:[this.gl.canvas.width,this.gl.canvas.height],u_GridData:ee(this,Cr),u_QueueData:ee(this,Rr),u_BlockTexture:ee(this,_n)};wr.setUniforms(ee(this,Fr),e),wr.drawBufferInfo(this.gl,ee(this,wn))}}Wt=new WeakMap,qt=new WeakMap,Fr=new WeakMap,wn=new WeakMap,Cr=new WeakMap,Dt=new WeakMap,Rr=new WeakMap,Jt=new WeakMap,_n=new WeakMap,Qn=new WeakMap,Zn=new WeakMap,Jn=new WeakMap,ka=new WeakMap,Ga=new WeakMap,ei=new WeakMap,Vr=new WeakMap,pr=new WeakMap,ti=new WeakMap,Gi=new WeakSet,eo=function(e){for(let t=0;t<20;t++){let r=e.gridData[t];for(let n=0;n<10;n++){let a=$e(this,Wi,to).call(this,r,n),o=3*(10*t+n);if(a!=0){let i=ee(this,Wt).get(a);ee(this,Dt)[o]=i[0],ee(this,Dt)[o+1]=i[1],ee(this,Dt)[o+2]=i[2]}else ee(this,Dt)[o]=0,ee(this,Dt)[o+1]=0,ee(this,Dt)[o+2]=0}}if(e.playerPiece.active){let t=170;for(let n=0;n<4;n++){let a=3*(10*e.ghostBlocks[n][1]+e.ghostBlocks[n][0]);ee(this,Dt)[a]=t,ee(this,Dt)[a+1]=t,ee(this,Dt)[a+2]=t}let r=e.playerPiece.shape;for(let n=0;n<4;n++){let a=ee(this,Wt).get(ee(this,qt).get(r)),o=3*(10*e.playerPiece.blocks[n][1]+e.playerPiece.blocks[n][0]);ee(this,Dt)[o]=a[0],ee(this,Dt)[o+1]=a[1],ee(this,Dt)[o+2]=a[2]}}this.gl.bindTexture(this.gl.TEXTURE_2D,ee(this,Cr)),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,10,20,this.gl.RGB,this.gl.UNSIGNED_BYTE,ee(this,Dt))},Wi=new WeakSet,to=function(e,t){const r=32-(3+3*t),n=7<<r;return(e&n)>>>r},ji=new WeakSet,ro=function(e){for(let t=0;t<ee(this,Jt).length;t++)ee(this,Jt)[t]=0;e.heldPiece!=null&&$e(this,ri,Oa).call(this,e.heldPiece,0);for(let t=0;t<4;t++)$e(this,ri,Oa).call(this,e.pieceQueue[t],24*(1+t));this.gl.bindTexture(this.gl.TEXTURE_2D,ee(this,Rr)),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,4,10,this.gl.RGB,this.gl.UNSIGNED_BYTE,ee(this,Jt))},ri=new WeakSet,Oa=function(e,t){let r=Mr.getBaseShape(e),n=ee(this,Wt).get(ee(this,qt).get(e));for(let a=0;a<4;a++){let o=r[a],i=t+3*(o[1]*4+o[0]);ee(this,Jt)[i]=n[0],ee(this,Jt)[i+1]=n[1],ee(this,Jt)[i+2]=n[2]}if(e!="I"&&e!="O"){let a=t+21;ee(this,Jt)[a]=255}else e=="I"&&(ee(this,Jt)[t+21+1]=255)},Vi=new WeakSet,no=function(e){ee(this,Qn).nodeValue=e.linesCleared,ee(this,Zn).nodeValue=e.speedLevel==11?"MAX":e.speedLevel,ee(this,Jn).nodeValue=e.score},qi=new WeakSet,io=function(e){const t=document.querySelector(e),r=$e(this,ni,za).call(this,e);r!=null&&ee(this,ei).set(t,r)},ni=new WeakSet,za=function(e){let t=null;for(let r=0;r<ee(this,Vr).length&&t==null;r++)ee(this,Vr)[r].selectorText==e&&(t=ee(this,Vr)[r].style);return t},Xi=new WeakSet,ao=function(){const e=this.gl.canvas.width,t=this.gl.canvas.height,r=3*e>4*t;ee(this,ei).forEach(function(a,o,i){const h=a.left!="",v=a.top!="";let y=h?a.left:a.right,g=v?a.top:a.bottom,w=a.fontSize,b=a.width,F=a.height;y=Number(y.substring(0,y.length-2)),g=Number(g.substring(0,g.length-2)),b=Number(b.substring(0,b.length-2)),F=Number(F.substring(0,F.length-2)),w!=""&&(w=Number(w.substring(0,w.length-2))),r?(y=(4*t*(y-50)+150*e)/(3*e)+"vw",b=b*4*t/(3*e)+"vw",g=g+"vh",F=F+"vh"):(g=g*3*e/(4*t)+(100*t-75*e)/(2*t)+"vh",F=F*3*e/(4*t)+"vh",y=y+"vw",b=b+"vw",w!=""&&(w=w*3*e/(4*t))),w!=""&&(o.style.fontSize=w+"vh"),h?o.style.left=y:o.style.right=y,v?o.style.top=g:o.style.bottom=g,o.style.width=b,o.style.height=F});const n=r?ee(this,pr):ee(this,pr)*3*e/(4*t);for(let a=0;a<ee(this,ti).length;a++){let o=ee(this,ti)[a];o.style.fontSize=n+"vh"}};var Sn,An,qr,Pr,Nr,Dr,vr,Mn,ii;class bh{constructor(e){ct(this,"leftQueue",0);ct(this,"rightQueue",0);ct(this,"moveDown",!1);ct(this,"rotate",{left:!1,right:!1});ct(this,"hardDrop",!1);ct(this,"dragSensitivity",40);ct(this,"slamThreshold",150);ct(this,"slamTimeLimit",400);_e(this,Sn,void 0);_e(this,An,void 0);_e(this,qr,void 0);_e(this,Pr,void 0);_e(this,Nr,!1);_e(this,Dr,null);_e(this,vr,{startTime:0,startY:0,endY:0});_e(this,Mn,void 0);_e(this,ii,!1);e.addEventListener("touchmove",t=>{this.dragEvent(t)}),e.addEventListener("touchstart",t=>{this.touchStart(t)}),e.addEventListener("touchend",t=>{this.touchEnd(t)}),e.addEventListener("touchcancel",t=>{this.touchEnd(t)}),Ce(this,Sn,e),document.addEventListener("dblclick",function(t){t.preventDefault()},{passive:!1})}touchStart(e){if(ee(this,Dr)===null&&!e.target.classList.contains("blockGestures")){let t=e.touches.item(0);Ce(this,Dr,t.identifier),Ce(this,qr,t.pageX),Ce(this,Pr,t.pageY),Ce(this,An,t.pageX),Ce(this,Mn,Date.now()),Ce(this,ii,t.clientX<ee(this,Sn).getBoundingClientRect().x+ee(this,Sn).getBoundingClientRect().width*.5),Ce(this,vr,{startTime:Date.now(),startY:t.pageY,endY:t.pageY})}}touchEnd(e){let t=!0;for(let r=0;r<e.touches.length&&t;r++)e.touches.item(r).identifier===ee(this,Dr)&&(t=!1);t&&(Date.now()-ee(this,Mn)<300&&this.leftQueue==0&&this.rightQueue==0&&(ee(this,ii)?this.rotate.left=!0:this.rotate.right=!0),Date.now()-ee(this,vr).startTime<=this.slamTimeLimit&&ee(this,vr).endY-ee(this,vr).startY>this.slamThreshold&&(this.hardDrop=!0),Ce(this,Dr,null),this.leftQueue=0,this.rightQueue=0,this.moveDown=!1)}dragEvent(e){let t=!1,r=null;for(let n=0;n<e.changedTouches.length;n++)if(e.changedTouches.item(n).identifier===ee(this,Dr)){r=e.changedTouches.item(n);break}r!==null&&((r.pageX-ee(this,An))*(ee(this,Nr)?1:-1)>0&&(Ce(this,Nr,!ee(this,Nr)),Ce(this,qr,r.pageX+this.dragSensitivity*.5*(ee(this,Nr)?1:-1)),Ce(this,Pr,r.pageY)),Math.abs(r.pageX-ee(this,qr))>this.dragSensitivity&&(ee(this,Nr)?(this.leftQueue++,this.rightQueue=0):(this.rightQueue++,this.leftQueue=0),t=!0,ee(this,vr).startTime=0,this.moveDown=!1),r.pageY-ee(this,Pr)>this.dragSensitivity?(this.moveDown=!0,this.leftQueue=0,this.rightQueue=0,t=!0):ee(this,Pr)-r.pageY>this.dragSensitivity&&(this.moveDown=!1,t=!0),t&&(Ce(this,qr,r.pageX),Ce(this,Pr,r.pageY),Ce(this,Mn,0)),Ce(this,An,r.pageX),ee(this,vr).endY=r.pageY)}}Sn=new WeakMap,An=new WeakMap,qr=new WeakMap,Pr=new WeakMap,Nr=new WeakMap,Dr=new WeakMap,vr=new WeakMap,Mn=new WeakMap,ii=new WeakMap;class Th{constructor(e,t,r,n,a,o,i){ct(this,"inputStates",new Map);ct(this,"frameCounter",{moveLeft:0,moveRight:0,softDrop:0});this.inputStates.set("moveLeft",!1),this.inputStates.set("moveRight",!1),this.inputStates.set("softDrop",!1),this.inputStates.set("hold",!1),this.inputStates.set("hardDrop",!1),this.inputStates.set("rotateClockwise",!1),this.inputStates.set("rotateAnticlockwise",!1),this.addReleasableListeners(t,"moveLeft"),this.addReleasableListeners(r,"moveRight"),this.addReleasableListeners(n,"softDrop"),this.addListeners(a,"hardDrop"),this.addListeners(o,"rotateClockwise"),this.addListeners(i,"rotateAnticlockwise"),this.addListeners(e,"hold")}addListeners(e,t){e.addEventListener("pointerdown",r=>{this.inputStates.set(t,!0)}),e.addEventListener("click",r=>{r.pointerType===""&&this.inputStates.set(t,!0)})}addReleasableListeners(e,t){e.addEventListener("pointerdown",r=>{this.inputStates.set(t,!0)}),e.addEventListener("pointerup",r=>{this.inputStates.set(t,!1)}),e.addEventListener("click",r=>{r.pointerType===""&&(t==="moveLeft"?this.frameCounter.moveLeft++:t==="moveRight"?this.frameCounter.moveRight++:t==="softDrop"&&this.frameCounter.softDrop++)})}countFrame(){this.inputStates.get("moveLeft")&&this.frameCounter.moveLeft++,this.inputStates.get("moveRight")&&this.frameCounter.moveRight++,this.inputStates.get("softDrop")&&this.frameCounter.softDrop++}resetFlags(){this.inputStates.set("hold",!1),this.inputStates.set("hardDrop",!1),this.inputStates.set("rotateClockwise",!1),this.inputStates.set("rotateAnticlockwise",!1),this.inputStates.get("moveLeft")||(this.frameCounter.moveLeft=0),this.inputStates.get("moveRight")||(this.frameCounter.moveRight=0),this.inputStates.get("softDrop")||(this.frameCounter.softDrop=0)}getInput(e){return this.inputStates.get(e)}}let qn=null,Ua=new Map,so;function Eh(u){u.inputKeys.forEach(function(t,r,n){localStorage.setItem(t,r)})}function wh(u){let e=[];u.inputKeys.forEach(function(t,r,n){const a=localStorage.getItem(t);a!=null&&e.push({action:t,oldKey:r,newKey:a})});for(let t=0;t<e.length;t++)u.inputKeys.delete(e[t].oldKey);for(let t=0;t<e.length;t++)u.inputKeys.set(e[t].newKey,e[t].action)}function _h(u,e){const t=document.querySelectorAll(u);for(let a=0;a<t.length;a++){let o=t[a];o.classList.add("ready"),o.addEventListener("click",function(){e.selectedSpan!=null&&(e.selectedKey="Escape",n()),e.originalKeybind=o.innerText,e.selectedSpan=o,e.selectedAction=o.id.substring(2),qn.textContent="Rebinding "+e.selectedAction+" action (press key to rebind)...",document.addEventListener("keydown",r),o.classList.remove("ready"),o.classList.add("waiting"),o.innerText="..."}),o.innerText=e.actionToKey(o.id.substring(2)),o.innerText==" "&&(o.innerText="Space")}function r(a){e.selectedKey=a.key.length>1?a.key:a.key.toUpperCase(),n()}function n(){e.selectedKey=="Escape"||so.classList.contains("hide")?(e.selectedKey=e.originalKeybind,a(),qn.textContent="Rebind canceled.",e.updateCounters()):e.rebindControl(e.selectedAction,e.selectedKey)?(qn.textContent="Rebind successful!",a(),Eh(e)):qn.textContent="'"+e.selectedKey+"' is already in use (press another key)...";function a(){document.removeEventListener("keydown",r);const o=e.selectedKey==" "?"Space":e.selectedKey;e.selectedSpan.innerText=o,Ua.get(e.selectedAction).forEach(function(i,h,v){i.innerText=o}),e.selectedAction="",e.selectedKey="",e.selectedSpan.classList.remove("waiting"),e.selectedSpan.classList.add("ready"),e.selectedSpan=null}}}function Sh(u,e,t,r){so=r,qn=t,_h(u,e),e.actionStates.forEach(function(n,a,o){Ua.set(a,document.querySelectorAll("span.cd_"+a)),Ua.get(a).forEach(function(i,h,v){const y=e.actionToKey(a);i.innerText=y==" "?"Space":y})})}function Ah(){let u=document.createTextNode("");document.querySelector("#debug").appendChild(u);const e=document.querySelector("#startButton");let t=new lo;wh(t),document.addEventListener("keydown",function($){t.setInputState($.key,!0)}),document.addEventListener("keyup",function($){t.setInputState($.key,!1)});let r=new bh(document.querySelector("#gameGUI")),n=new Th(document.querySelector("#tib_Hold"),document.querySelector("#tib_MoveLeft"),document.querySelector("#tib_MoveRight"),document.querySelector("#tib_SoftDrop"),document.querySelector("#tib_HardDrop"),document.querySelector("#tib_RotateClockwise"),document.querySelector("#tib_RotateAnticlockwise")),a=new Aa,o=new gh;const i=document.querySelector("#titleScreen"),h=document.querySelector("#pauseScreen"),v=document.querySelector("#gameOverScreen"),y=document.querySelector("#settingsScreen");let g=!0;const w=document.createTextNode("0"),b=document.createTextNode("0");document.querySelector("#finalScore").appendChild(w),document.querySelector("#finalLines").append(b);let F=0,U=0;function te($){let B=($-U)*.001;U=$,F+=B,y.classList.contains("hide")?a.gameState.gameOver?g||v.classList.contains("hide")&&(v.classList.remove("hide"),w.textContent=a.gameState.score,b.textContent=a.gameState.linesCleared):(F>=a.gameTickTime&&(F=Math.min(F-a.gameTickTime,a.gameTickTime),t.updateCounters(),Mh(a,t,r,n),a.runTick(),t.getCounter("Pause")==1&&(a.gameState.isPaused?(a.pauseGame(!1),h.classList.add("hide")):(a.pauseGame(!0),h.classList.remove("hide")))),a.isStateChanged&&o.updateData(a.gameState)):(t.updateCounters(),t.getCounter("Pause")==1&&y.classList.add("hide")),o.renderGame(),requestAnimationFrame(te)}function R(){a.startNewGame(),o.updateData(a.gameState),o.renderGame(),document.querySelector("#titleScreen").classList.add("hide"),document.querySelector("#gameGUI").classList.remove("hide"),requestAnimationFrame(te),g=!1}e.addEventListener("click",R),document.querySelector("#heldPieceOverlay").addEventListener("click",function(){a.holdPiece()}),document.querySelector("#unpauseButton").addEventListener("click",function(){a.gameState.isPaused=!1,h.classList.add("hide")}),document.querySelector("#replayButton").addEventListener("click",function(){a.startNewGame(),o.updateData(a.gameState),o.renderGame(),v.classList.add("hide")}),document.querySelector("#returnToTitleButton").addEventListener("click",function(){i.classList.remove("hide"),v.classList.add("hide"),g=!0}),requestAnimationFrame(te);let J=document.createTextNode("");document.querySelector("#settingsConsoleText").appendChild(J),Sh(".controlRebind",t,J,y),document.querySelector("#exitSettingsButton").addEventListener("click",function(){y.classList.add("hide")}),document.querySelectorAll(".settingsButton").forEach(function($,B,X){$.addEventListener("click",function(){y.classList.remove("hide")})})}function Mh(u,e,t,r){let n=5;e.getCounter("HardDrop")==1&&(u.input.hardDrop=!0),e.getCounter("Hold")==1&&(u.input.hold=!0),e.getCounter("RotateClockwise")==1&&(u.input.rotClockwise=!0),e.getCounter("RotateAntiClockwise")==1&&(u.input.rotAntiClockwise=!0),e.getInputState("SoftDrop")&&(u.input.softDrop=!0),(e.getCounter("MoveLeft")==1||e.getCounter("MoveLeft")>n)&&(u.input.moveLeft=!0),(e.getCounter("MoveRight")==1||e.getCounter("MoveRight")>n)&&(u.input.moveRight=!0),t.leftQueue>0&&(u.input.moveLeft=!0,t.leftQueue--),t.rightQueue>0&&(u.input.moveRight=!0,t.rightQueue--),t.moveDown&&(u.input.softDrop=!0),t.rotate.left?u.input.rotAntiClockwise=!0:t.rotate.right&&(u.input.rotClockwise=!0),t.rotate={left:!1,right:!1},t.hardDrop&&(u.input.hardDrop=!0,t.hardDrop=!1),r.countFrame(),(r.frameCounter.moveLeft==1||r.frameCounter.moveLeft>n)&&(u.input.moveLeft=!0),(r.frameCounter.moveRight==1||r.frameCounter.moveRight>n)&&(u.input.moveRight=!0),r.frameCounter.softDrop>=1&&(u.input.softDrop=!0),r.getInput("hold")&&(u.input.hold=!0),r.getInput("rotateClockwise")&&(u.input.rotClockwise=!0),r.getInput("rotateAnticlockwise")&&(u.input.rotAntiClockwise=!0),r.getInput("hardDrop")&&(u.input.hardDrop=!0),r.resetFlags()}Ah();
