var qa=Object.defineProperty;var Ya=(re,l,f)=>l in re?qa(re,l,{enumerable:!0,configurable:!0,writable:!0,value:f}):re[l]=f;var nr=(re,l,f)=>(Ya(re,typeof l!="symbol"?l+"":l,f),f),Ea=(re,l,f)=>{if(!l.has(re))throw TypeError("Cannot "+f)};var U=(re,l,f)=>(Ea(re,l,"read from private field"),f?f.call(re):l.get(re)),Ee=(re,l,f)=>{if(l.has(re))throw TypeError("Cannot add the same private member more than once");l instanceof WeakSet?l.add(re):l.set(re,f)},Ae=(re,l,f,C)=>(Ea(re,l,"write to private field"),C?C.call(re,f):l.set(re,f),f);var Ta=(re,l,f,C)=>({set _(O){Ae(re,l,O,f)},get _(){return U(re,l,C)}}),ze=(re,l,f)=>(Ea(re,l,"access private method"),f);(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const O of document.querySelectorAll('link[rel="modulepreload"]'))C(O);new MutationObserver(O=>{for(const k of O)if(k.type==="childList")for(const Q of k.addedNodes)Q.tagName==="LINK"&&Q.rel==="modulepreload"&&C(Q)}).observe(document,{childList:!0,subtree:!0});function f(O){const k={};return O.integrity&&(k.integrity=O.integrity),O.referrerPolicy&&(k.referrerPolicy=O.referrerPolicy),O.crossOrigin==="use-credentials"?k.credentials="include":O.crossOrigin==="anonymous"?k.credentials="omit":k.credentials="same-origin",k}function C(O){if(O.ep)return;O.ep=!0;const k=f(O);fetch(O.href,k)}})();var kt,Qr,Zr,Xn,bt,jt,Mr,Et,Hn,Ba,Kn,Ia,qn,La,Yn,Oa,Vt,Vn,Tt,ln,hn,ga,zn,Ma,mn,Aa,Qn,Na,Wt,Wn,yn,_a;const vn=class vn{constructor(){Ee(this,Hn);Ee(this,Kn);Ee(this,qn);Ee(this,Yn);Ee(this,Vt);Ee(this,Tt);Ee(this,hn);Ee(this,zn);Ee(this,mn);Ee(this,Qn);Ee(this,Wt);Ee(this,yn);nr(this,"input",{moveLeft:!1,moveRight:!1,hardDrop:!1,softDrop:!1,hold:!1,rotClockwise:!1,rotAntiClockwise:!1});nr(this,"numRows",21);nr(this,"graceTimerDuration",.5);nr(this,"gameTickTime",1/30);nr(this,"pieceMap",new Map);nr(this,"gameState",{isPaused:!1,gameOver:!0,gridData:new Uint32Array(this.numRows),playerPiece:null,pieceQueue:[],heldPiece:null,ghostBlocks:[[0,0],[0,0],[0,0],[0,0]],linesCleared:0,speedLevel:1,score:0});Ee(this,kt,15);Ee(this,Qr,!0);Ee(this,Zr,0);Ee(this,Xn,!1);Ee(this,bt,-1);Ee(this,jt,0);Ee(this,Mr,!1);Ee(this,Et,!1);ze(this,Vt,Vn).call(this),ze(this,Tt,ln).call(this),ze(this,Wt,Wn).call(this),Ae(this,kt,15),this.pieceMap.set("Z",1),this.pieceMap.set("S",2),this.pieceMap.set("O",3),this.pieceMap.set("J",4),this.pieceMap.set("T",5),this.pieceMap.set("I",6),this.pieceMap.set("L",7),this.gameState.isPaused=!0}get isStateChanged(){const l=U(this,Qr);return Ae(this,Qr,!1),l}runTick(){if(this.gameState.isPaused)return;let l=!1;if(U(this,Et)){this.animationCount==null||this.rowCount==null?(this.animationCount=0,this.rowCount=0):(this.animationCount++,this.rowCount<this.numRows&&this.animationCount%4==0?(this.clearRow(0),this.rowCount++,Ae(this,Qr,!0)):this.rowCount==this.numRows&&(this.rowCount++,this.gameState.gameOver=!0));return}if(this.input.hardDrop)this.hardDropPlayerPiece(),this.finishWithPiece(),l=!0;else if(this.input.hold)this.holdPiece(),l=!0;else{U(this,Mr)&&ze(this,zn,Ma).call(this,this.gameTickTime),this.input.softDrop&&(l=this.tryMovePiece(0,-1)||l);let f=0;this.input.rotClockwise&&(f+=1),this.input.rotAntiClockwise&&(f-=1),f!=0&&(l=this.tryRotatePiece(f==1)||l);let C=0;if(this.input.moveLeft&&(C-=1),this.input.moveRight&&(C+=1),C!=0&&(l=this.tryMovePiece(C,0)||l),Ta(this,Zr)._++,U(this,Zr)>=U(this,kt)){let O=!this.tryMovePiece(0,-1);l||(l=!O),Ae(this,Zr,0),O&&!U(this,Mr)&&ze(this,hn,ga).call(this)}if(U(this,Mr)&&U(this,bt)<=0){let O=!this.tryMovePiece(0,-1);l=!0,O&&this.finishWithPiece()}else if(!U(this,Mr)){let O=!1;for(const k of this.gameState.playerPiece.blocks)O=O||this.isBlockHere(k[0],k[1]-1);O&&ze(this,hn,ga).call(this)}}l&&(ze(this,Wt,Wn).call(this),Ae(this,Qr,!0)),this.input={moveLeft:!1,moveRight:!1,hardDrop:!1,softDrop:!1,hold:!1,rotClockwise:!1,rotAntiClockwise:!1}}pauseGame(l){this.gameState.isPaused=l}startNewGame(){this.gameState.gameOver=!1,this.gameState.isPaused=!1,Ae(this,Et,!1),this.animationCount=null,this.rowCount=null;for(let l=0;l<this.gameState.gridData.length;l++)this.gameState.gridData[l]=0;this.gameState.linesCleared=0,this.gameState.speedLevel=0,this.gameState.score=0,this.gameState.pieceQueue=[],this.gameState.heldPiece=null,ze(this,Vt,Vn).call(this),ze(this,Tt,ln).call(this),ze(this,Wt,Wn).call(this),ze(this,yn,_a).call(this)}tryMovePiece(l,f){let C=!0;for(let O=0;O<4&&C;O++){let k=this.gameState.playerPiece.blocks[O][0]+l,Q=this.gameState.playerPiece.blocks[O][1]+f;this.isBlockHere(k,Q)&&(C=!1)}return C&&(ze(this,Kn,Ia).call(this,l,f),l!=0&&ze(this,mn,Aa).call(this),f!=0&&Ae(this,Mr,!1)),C}hardDropPlayerPiece(){for(;this.tryMovePiece(0,-1););}tryRotatePiece(l){let f=ze(this,qn,La).call(this,l);return f&&ze(this,mn,Aa).call(this),f}holdPiece(){if(this.gameState.heldPiece==null)this.gameState.heldPiece=this.gameState.playerPiece.shape,ze(this,Tt,ln).call(this),Ae(this,Qr,!0),Ae(this,Zr,0);else if(!this.gameState.playerPiece.wasHeld){let l=this.gameState.heldPiece;this.gameState.heldPiece=this.gameState.playerPiece.shape,this.gameState.playerPiece=new ot(l),this.gameState.playerPiece.wasHeld=!0,Ae(this,Qr,!0),Ae(this,Zr,0),this.isPlayerPieceValid()||(this.gameState.playerPiece.active=!1,Ae(this,Et,!0))}}finishWithPiece(){const l=this.gameState.linesCleared;this.gameState.playerPiece.shape=="T"&&Ae(this,Xn,!0),ze(this,Yn,Oa).call(this),ze(this,Tt,ln).call(this),Ae(this,Mr,!1),ze(this,Qn,Na).call(this),this.gameState.linesCleared!=l&&(ze(this,yn,_a).call(this),this.gameState.score+=Math.pow(this.gameState.linesCleared-l,2)*100)}clearRow(l){for(let f=l;f<this.numRows-1;f++)this.gameState.gridData[f]=this.gameState.gridData[f+1];this.gameState.gridData[this.numRows-1]=0}isBlockHere(l,f){if(l<0||f<0||l>=10||f>=this.numRows)return!0;const C=this.gameState.gridData[f],O=7<<32-(3+3*l);return(C&O)!=0}getBlockData(l,f){const C=this.gameState.gridData[f],O=32-(3+3*l),k=7<<O;return(C&k)>>>O}isPlayerPieceValid(){let l=!0;for(let f=0;f<4&&l;f++)this.isBlockHere(this.gameState.playerPiece.blocks[f][0],this.gameState.playerPiece.blocks[f][1])&&(l=!1);return l}};kt=new WeakMap,Qr=new WeakMap,Zr=new WeakMap,Xn=new WeakMap,bt=new WeakMap,jt=new WeakMap,Mr=new WeakMap,Et=new WeakMap,Hn=new WeakSet,Ba=function(l,f,C){const k=~(7<<32-(3+3*l));this.gameState.gridData[f]&=k;const Q=C<<32-(3+3*l);this.gameState.gridData[f]|=Q},Kn=new WeakSet,Ia=function(l,f){for(let C=0;C<4;C++)this.gameState.playerPiece.blocks[C][0]+=l,this.gameState.playerPiece.blocks[C][1]+=f},qn=new WeakSet,La=function(l){let f=(this.gameState.playerPiece.rotationIndex+4+(l?1:-1))%4,C=[...this.gameState.playerPiece.blocks[0]],O=[];for(let q=0;q<4;q++)O.push([...this.gameState.playerPiece.blocks[q]]);let k=1,Q=1;l?Q=-1:k=-1;let o;for(let q=0;q<4;q++)O[q][0]-=C[0],O[q][1]-=C[1],o=O[q][0],O[q][0]=k*O[q][1],O[q][1]=Q*o,O[q][0]+=C[0],O[q][1]+=C[1];let Y;switch(this.gameState.playerPiece.shape){case"O":Y=ot.offsets.O;break;case"I":Y=ot.offsets.I;break;default:Y=ot.offsets.OTHER;break}let ae,G,ie=!1;for(let q=0;q<5&&!ie;q++){ae=Y[q],G=[ae[this.gameState.playerPiece.rotationIndex][0]-ae[f][0],ae[this.gameState.playerPiece.rotationIndex][1]-ae[f][1]],ie=!0;for(let j=0;j<4;j++)O[j][0]+=G[0],O[j][1]+=G[1],this.isBlockHere(O[j][0],O[j][1])&&(ie=!1);if(!ie)for(let j=0;j<4;j++)O[j][0]-=G[0],O[j][1]-=G[1]}if(ie){for(let q=0;q<4;q++)this.gameState.playerPiece.blocks[q]=[...O[q]];this.gameState.playerPiece.rotationIndex=f}return ie},Yn=new WeakSet,Oa=function(){let l,f,C=this.pieceMap.get(this.gameState.playerPiece.shape);for(let O=0;O<4;O++)l=this.gameState.playerPiece.blocks[O][0],f=this.gameState.playerPiece.blocks[O][1],ze(this,Hn,Ba).call(this,l,f,C)},Vt=new WeakSet,Vn=function(){let l=["O","I","T","J","L","S","Z"],f;for(let C=0;C<7;C++)f=Math.floor(Math.random()*l.length),this.gameState.pieceQueue.push(l[f]),l.splice(f,1)},Tt=new WeakSet,ln=function(){let l=this.gameState.pieceQueue[0];this.gameState.pieceQueue.splice(0,1),this.gameState.pieceQueue.length<7&&ze(this,Vt,Vn).call(this),delete this.gameState.playerPiece,this.gameState.playerPiece=new ot(l),this.isPlayerPieceValid()||(this.gameState.playerPiece.active=!1,Ae(this,Et,!0)),Ae(this,Zr,0)},hn=new WeakSet,ga=function(){Ae(this,bt,this.graceTimerDuration),Ae(this,Mr,!0),Ae(this,jt,0)},zn=new WeakSet,Ma=function(l){Ae(this,bt,U(this,bt)-l)},mn=new WeakSet,Aa=function(){U(this,Mr)&&U(this,jt)<30&&(Ae(this,bt,this.graceTimerDuration),Ta(this,jt)._++)},Qn=new WeakSet,Na=function(){for(let l=0;l<this.numRows;l++){let f=!0;for(let C=0;C<10&&f;C++)this.isBlockHere(C,l)||(f=!1);f&&(this.clearRow(l),this.gameState.linesCleared++,l--)}},Wt=new WeakSet,Wn=function(){for(let f=0;f<4;f++)this.gameState.ghostBlocks[f]=[...this.gameState.playerPiece.blocks[f]];let l=!1;for(;!l;){for(let f=0;f<4;f++)this.isBlockHere(this.gameState.ghostBlocks[f][0],this.gameState.ghostBlocks[f][1]-1)&&(l=!0);if(!l)for(let f=0;f<4;f++)this.gameState.ghostBlocks[f][1]-=1}},yn=new WeakSet,_a=function(){this.gameState.speedLevel=Math.min(Math.floor(this.gameState.linesCleared/10)+1,vn.levels.max),Ae(this,kt,vn.levels[this.gameState.speedLevel])},nr(vn,"levels",{1:25,2:20,3:16,4:12,5:10,6:8,7:6,8:5,9:4,10:2,11:1,max:11});let Sa=vn;const Br=class Br{constructor(l){this.blocks=[],this.shape=l,this.rotationIndex=0,this.active=!0,this.wasHeld=!1;let f=Br.getBaseShape(l);for(let C=0;C<4;C++)this.blocks.push([...f[C]]),this.blocks[C][0]+=3,this.blocks[C][1]+=19}static getBaseShape(l){let f;switch(l){case"O":f=Br.pieces.O;break;case"I":f=Br.pieces.I;break;case"L":f=Br.pieces.L;break;case"J":f=Br.pieces.J;break;case"T":f=Br.pieces.T;break;case"S":f=Br.pieces.S;break;case"Z":f=Br.pieces.Z;break;default:f=[[0,0],[0,0],[0,0],[0,0]]}return f}};nr(Br,"offsets",{O:[[[0,0],[0,-1],[-1,-1],[-1,0]]],I:[[[0,0],[-1,0],[-1,1],[0,1]],[[-1,0],[0,0],[1,1],[0,1]],[[2,0],[0,0],[-2,1],[0,1]],[[-1,0],[0,1],[1,0],[0,-1]],[[2,0],[0,-2],[-2,0],[0,2]]],OTHER:[[[0,0],[0,0],[0,0],[0,0]],[[0,0],[1,0],[0,0],[-1,0]],[[0,0],[1,-1],[0,0],[-1,-1]],[[0,0],[0,2],[0,0],[0,2]],[[0,0],[1,2],[0,0],[-1,2]]]}),nr(Br,"pieces",{O:[[1,0],[1,1],[2,1],[2,0]],I:[[1,0],[0,0],[2,0],[3,0]],L:[[1,0],[0,0],[2,0],[2,1]],J:[[1,0],[0,0],[0,1],[2,0]],T:[[1,0],[0,0],[2,0],[1,1]],S:[[1,0],[0,0],[1,1],[2,1]],Z:[[1,0],[2,0],[1,1],[0,1]]});let ot=Br;class za{constructor(){nr(this,"selectedKey","");nr(this,"originalKeybind","");nr(this,"selectedAction","");nr(this,"selectedSpan",null);this.actionStates=new Map,this.actionStates.set("HardDrop",!1),this.actionStates.set("SoftDrop",!1),this.actionStates.set("MoveLeft",!1),this.actionStates.set("MoveRight",!1),this.actionStates.set("Hold",!1),this.actionStates.set("RotateClockwise",!1),this.actionStates.set("RotateAntiClockwise",!1),this.actionStates.set("Pause",!1),this.inputKeys=new Map,this.inputKeys.set("A","MoveLeft"),this.inputKeys.set("D","MoveRight"),this.inputKeys.set("W","HardDrop"),this.inputKeys.set("S","SoftDrop"),this.inputKeys.set("E","Hold"),this.inputKeys.set("ArrowLeft","RotateAntiClockwise"),this.inputKeys.set("ArrowRight","RotateClockwise"),this.inputKeys.set("Escape","Pause"),this.counters=new Map,this.counters.set("MoveLeft",0),this.counters.set("MoveRight",0),this.counters.set("RotateClockwise",0),this.counters.set("RotateAntiClockwise",0),this.counters.set("HardDrop",0),this.counters.set("Hold",0),this.counters.set("Pause",0)}keyToState(l){return l.length==1&&(l=l.toUpperCase()),this.inputKeys.get(l)}actionToKey(l){let f="";return this.inputKeys.forEach(function(C,O,k){C==l&&(f=O)}),f}rebindControl(l,f){let C=!1,O="";return this.inputKeys.forEach(function(k,Q,o){k==l&&(O=Q)}),O!=""&&(this.inputKeys.has(f)&&f!=O||(this.inputKeys.delete(O),this.inputKeys.set(f,l),C=!0)),C}setInputState(l,f){let C=this.keyToState(l);C!=null&&this.actionStates.set(C,f)}getInputState(l){return this.actionStates.has(l)?this.actionStates.get(l):(console.log("ERROR: trying to access an input action that doesn't exist ("+l+"). The allowed options are:"),this.actionStates.forEach(function(f,C,O){console.log("    - "+C)}),null)}updateCounters(){for(const[l,f]of this.counters)this.getInputState(l)?this.counters.set(l,f+1):this.counters.set(l,0)}getCounter(l){return this.counters.has(l)?this.counters.get(l):(console.log("ERROR: trying to access input action that doesn't have a counter ("+l+"). The counters are:"),this.counters.forEach(function(f,C,O){console.log("    - "+C+": "+f)}),null)}}var Qa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ua={exports:{}};/*!
 * @license twgl.js 5.5.4 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
 * Available via the MIT license.
 * see: http://github.com/greggman/twgl.js for details
 */(function(re,l){(function(C,O){re.exports=O()})(typeof self<"u"?self:Qa,()=>(()=>{var f={"./src/attributes.js":(Q,o,Y)=>{function ae(v){"@babel/helpers - typeof";return ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},ae(v)}o.__esModule=!0,o.createAttribsFromArrays=cr,o.createBufferFromArray=c,o.createBufferFromTypedArray=me,o.createBufferInfoFromArrays=u,o.createBuffersFromArrays=E,o.getArray_=N,o.getNumComponents_=Fe,o.setAttribInfoBufferFromArray=ar,o.setAttributeDefaults_=ur,o.setAttributePrefix=or;var G=j(Y("./src/typedarrays.js")),ie=j(Y("./src/helper.js"));function q(v){if(typeof WeakMap!="function")return null;var i=new WeakMap,a=new WeakMap;return(q=function(h){return h?a:i})(v)}function j(v,i){if(!i&&v&&v.__esModule)return v;if(v===null||ae(v)!="object"&&typeof v!="function")return{default:v};var a=q(i);if(a&&a.has(v))return a.get(v);var m={__proto__:null},h=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var T in v)if(T!=="default"&&Object.prototype.hasOwnProperty.call(v,T)){var _=h?Object.getOwnPropertyDescriptor(v,T):null;_&&(_.get||_.set)?Object.defineProperty(m,T,_):m[T]=v[T]}return m.default=v,a&&a.set(v,m),m}var oe=35044,Z=34962,Te=34963,F=34660,z=5120,H=5121,P=5122,W=5123,se=5124,Se=5125,Ge=5126,Ce={attribPrefix:""};function or(v){Ce.attribPrefix=v}function ur(v){ie.copyExistingProperties(v,Ce)}function er(v,i,a,m,h){v.bindBuffer(i,a),v.bufferData(i,m,h||oe)}function me(v,i,a,m){if(ie.isBuffer(v,i))return i;a=a||Z;var h=v.createBuffer();return er(v,a,h,i,m),h}function w(v){return v==="indices"}function B(v){return v===Int8Array||v===Uint8Array}function N(v){return v.length?v:v.data}var A=/coord|texture/i,de=/color|colour/i;function _e(v,i){var a;if(A.test(v)?a=2:de.test(v)?a=4:a=3,i%a>0)throw new Error("Can not guess numComponents for attribute '".concat(v,"'. Tried ").concat(a," but ").concat(i," values is not evenly divisible by ").concat(a,". You should specify it."));return a}function Fe(v,i,a){return v.numComponents||v.size||_e(i,a||N(v).length)}function We(v,i){if(G.isArrayBuffer(v))return v;if(G.isArrayBuffer(v.data))return v.data;Array.isArray(v)&&(v={data:v});var a=v.type?Je(v.type):void 0;return a||(w(i)?a=Uint16Array:a=Float32Array),new a(v.data)}function Ue(v){return typeof v=="number"?v:v?G.getGLTypeForTypedArrayType(v):Ge}function Je(v){return typeof v=="number"?G.getTypedArrayTypeForGLType(v):v||Float32Array}function Ke(v,i){return{buffer:i.buffer,numValues:24,type:Ue(i.type),arrayType:Je(i.type)}}function fr(v,i){var a=i.data||i,m=Je(i.type),h=a*m.BYTES_PER_ELEMENT,T=v.createBuffer();return v.bindBuffer(Z,T),v.bufferData(Z,h,i.drawType||oe),{buffer:T,numValues:a,type:G.getGLTypeForTypedArrayType(m),arrayType:m}}function Tr(v,i,a){var m=We(i,a);return{arrayType:m.constructor,buffer:me(v,m,void 0,i.drawType),type:G.getGLTypeForTypedArray(m),numValues:0}}function cr(v,i){var a={};return Object.keys(i).forEach(function(m){if(!w(m)){var h=i[m],T=h.attrib||h.name||h.attribName||Ce.attribPrefix+m;if(h.value){if(!Array.isArray(h.value)&&!G.isArrayBuffer(h.value))throw new Error("array.value is not array or typedarray");a[T]={value:h.value}}else{var _;h.buffer&&h.buffer instanceof WebGLBuffer?_=Ke:typeof h=="number"||typeof h.data=="number"?_=fr:_=Tr;var I=_(v,h,m),L=I.buffer,K=I.type,J=I.numValues,ee=I.arrayType,ue=h.normalize!==void 0?h.normalize:B(ee),ne=Fe(h,m,J);a[T]={buffer:L,numComponents:ne,type:K,normalize:ue,stride:h.stride||0,offset:h.offset||0,divisor:h.divisor===void 0?void 0:h.divisor,drawType:h.drawType}}}}),v.bindBuffer(Z,null),a}function ar(v,i,a,m){a=We(a),m!==void 0?(v.bindBuffer(Z,i.buffer),v.bufferSubData(Z,m,a)):er(v,Z,i.buffer,a,i.drawType)}function vr(v,i){return i===z||i===H?1:i===P||i===W?2:i===se||i===Se||i===Ge?4:0}var Sr=["position","positions","a_position"];function ce(v){var i,a;for(a=0;a<Sr.length&&(i=Sr[a],!(i in v));++a);a===Sr.length&&(i=Object.keys(v)[0]);var m=v[i],h=N(m).length;if(h===void 0)return 1;var T=Fe(m,i),_=h/T;if(h%T>0)throw new Error("numComponents ".concat(T," not correct for length ").concat(h));return _}function r(v,i){var a,m;for(m=0;m<Sr.length&&(a=Sr[m],!(a in i||(a=Ce.attribPrefix+a,a in i)));++m);m===Sr.length&&(a=Object.keys(i)[0]);var h=i[a];if(!h.buffer)return 1;v.bindBuffer(Z,h.buffer);var T=v.getBufferParameter(Z,F);v.bindBuffer(Z,null);var _=vr(v,h.type),I=T/_,L=h.numComponents||h.size,K=I/L;if(K%1!==0)throw new Error("numComponents ".concat(L," not correct for length ").concat(length));return K}function u(v,i,a){var m=cr(v,i),h=Object.assign({},a||{});h.attribs=Object.assign({},a?a.attribs:{},m);var T=i.indices;if(T){var _=We(T,"indices");h.indices=me(v,_,Te),h.numElements=_.length,h.elementType=G.getGLTypeForTypedArray(_)}else h.numElements||(h.numElements=r(v,h.attribs));return h}function c(v,i,a){var m=a==="indices"?Te:Z,h=We(i,a);return me(v,h,m)}function E(v,i){var a={};return Object.keys(i).forEach(function(m){a[m]=c(v,i[m],m)}),i.indices?(a.numElements=i.indices.length,a.elementType=G.getGLTypeForTypedArray(We(i.indices),"indices")):a.numElements=ce(i),a}},"./src/draw.js":(Q,o,Y)=>{function ae(F){"@babel/helpers - typeof";return ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(z){return typeof z}:function(z){return z&&typeof Symbol=="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z},ae(F)}o.__esModule=!0,o.drawBufferInfo=Z,o.drawObjectList=Te;var G=q(Y("./src/programs.js"));function ie(F){if(typeof WeakMap!="function")return null;var z=new WeakMap,H=new WeakMap;return(ie=function(W){return W?H:z})(F)}function q(F,z){if(!z&&F&&F.__esModule)return F;if(F===null||ae(F)!="object"&&typeof F!="function")return{default:F};var H=ie(z);if(H&&H.has(F))return H.get(F);var P={__proto__:null},W=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var se in F)if(se!=="default"&&Object.prototype.hasOwnProperty.call(F,se)){var Se=W?Object.getOwnPropertyDescriptor(F,se):null;Se&&(Se.get||Se.set)?Object.defineProperty(P,se,Se):P[se]=F[se]}return P.default=F,H&&H.set(F,P),P}var j=4,oe=5123;function Z(F,z,H,P,W,se){H=H===void 0?j:H;var Se=z.indices,Ge=z.elementType,Ce=P===void 0?z.numElements:P;W=W===void 0?0:W,Ge||Se?se!==void 0?F.drawElementsInstanced(H,Ce,Ge===void 0?oe:z.elementType,W,se):F.drawElements(H,Ce,Ge===void 0?oe:z.elementType,W):se!==void 0?F.drawArraysInstanced(H,W,Ce,se):F.drawArrays(H,W,Ce)}function Te(F,z){var H=null,P=null;z.forEach(function(W){if(W.active!==!1){var se=W.programInfo,Se=W.vertexArrayInfo||W.bufferInfo,Ge=!1,Ce=W.type===void 0?j:W.type;se!==H&&(H=se,F.useProgram(se.program),Ge=!0),(Ge||Se!==P)&&(P&&P.vertexArrayObject&&!Se.vertexArrayObject&&F.bindVertexArray(null),P=Se,G.setBuffersAndAttributes(F,se,Se)),G.setUniforms(se,W.uniforms),Z(F,Se,Ce,W.count,W.offset,W.instanceCount)}}),P&&P.vertexArrayObject&&F.bindVertexArray(null)}},"./src/framebuffers.js":(Q,o,Y)=>{function ae(ce){"@babel/helpers - typeof";return ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ae(ce)}o.__esModule=!0,o.bindFramebufferInfo=Sr,o.createFramebufferInfo=ar,o.resizeFramebufferInfo=vr;var G=j(Y("./src/textures.js")),ie=j(Y("./src/helper.js"));function q(ce){if(typeof WeakMap!="function")return null;var r=new WeakMap,u=new WeakMap;return(q=function(E){return E?u:r})(ce)}function j(ce,r){if(!r&&ce&&ce.__esModule)return ce;if(ce===null||ae(ce)!="object"&&typeof ce!="function")return{default:ce};var u=q(r);if(u&&u.has(ce))return u.get(ce);var c={__proto__:null},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in ce)if(v!=="default"&&Object.prototype.hasOwnProperty.call(ce,v)){var i=E?Object.getOwnPropertyDescriptor(ce,v):null;i&&(i.get||i.set)?Object.defineProperty(c,v,i):c[v]=ce[v]}return c.default=ce,u&&u.set(ce,c),c}var oe=36160,Z=36161,Te=3553,F=5121,z=6402,H=6408,P=33190,W=36012,se=35056,Se=36013,Ge=32854,Ce=32855,or=36194,ur=33189,er=6401,me=36168,w=34041,B=36064,N=36096,A=36128,de=33306,_e=33071,Fe=9729,We=[{format:H,type:F,min:Fe,wrap:_e},{format:w}],Ue={};Ue[w]=de,Ue[er]=A,Ue[me]=A,Ue[z]=N,Ue[ur]=N,Ue[P]=N,Ue[W]=N,Ue[se]=de,Ue[Se]=de;function Je(ce,r){return Ue[ce]||Ue[r]}var Ke={};Ke[Ge]=!0,Ke[Ce]=!0,Ke[or]=!0,Ke[w]=!0,Ke[ur]=!0,Ke[er]=!0,Ke[me]=!0;function fr(ce){return Ke[ce]}var Tr=32;function cr(ce){return ce>=B&&ce<B+Tr}function ar(ce,r,u,c){var E=oe,v=ce.createFramebuffer();ce.bindFramebuffer(E,v),u=u||ce.drawingBufferWidth,c=c||ce.drawingBufferHeight,r=r||We;var i=[],a={framebuffer:v,attachments:[],width:u,height:c};return r.forEach(function(m,h){var T=m.attachment,_=m.samples,I=m.format,L=m.attachmentPoint||Je(I,m.internalFormat);if(L||(L=B+h),cr(L)&&i.push(L),!T)if(_!==void 0||fr(I))T=ce.createRenderbuffer(),ce.bindRenderbuffer(Z,T),_>1?ce.renderbufferStorageMultisample(Z,_,I,u,c):ce.renderbufferStorage(Z,I,u,c);else{var K=Object.assign({},m);K.width=u,K.height=c,K.auto===void 0&&(K.auto=!1,K.min=K.min||K.minMag||Fe,K.mag=K.mag||K.minMag||Fe,K.wrapS=K.wrapS||K.wrap||_e,K.wrapT=K.wrapT||K.wrap||_e),T=G.createTexture(ce,K)}if(ie.isRenderbuffer(ce,T))ce.framebufferRenderbuffer(E,L,Z,T);else if(ie.isTexture(ce,T))m.layer!==void 0?ce.framebufferTextureLayer(E,L,T,m.level||0,m.layer):ce.framebufferTexture2D(E,L,m.target||Te,T,m.level||0);else throw new Error("unknown attachment type");a.attachments.push(T)}),ce.drawBuffers&&ce.drawBuffers(i),a}function vr(ce,r,u,c,E){c=c||ce.drawingBufferWidth,E=E||ce.drawingBufferHeight,r.width=c,r.height=E,u=u||We,u.forEach(function(v,i){var a=r.attachments[i],m=v.format,h=v.samples;if(h!==void 0||ie.isRenderbuffer(ce,a))ce.bindRenderbuffer(Z,a),h>1?ce.renderbufferStorageMultisample(Z,h,m,c,E):ce.renderbufferStorage(Z,m,c,E);else if(ie.isTexture(ce,a))G.resizeTexture(ce,a,v,c,E);else throw new Error("unknown attachment type")})}function Sr(ce,r,u){u=u||oe,r?(ce.bindFramebuffer(u,r.framebuffer),ce.viewport(0,0,r.width,r.height)):(ce.bindFramebuffer(u,null),ce.viewport(0,0,ce.drawingBufferWidth,ce.drawingBufferHeight))}},"./src/helper.js":(Q,o)=>{o.__esModule=!0,o.copyExistingProperties=G,o.copyNamedProperties=ae,o.error=ie,o.isBuffer=Z,o.isRenderbuffer=Te,o.isSampler=H,o.isShader=F,o.isTexture=z,o.warn=q;function Y(P){"@babel/helpers - typeof";return Y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(W){return typeof W}:function(W){return W&&typeof Symbol=="function"&&W.constructor===Symbol&&W!==Symbol.prototype?"symbol":typeof W},Y(P)}function ae(P,W,se){P.forEach(function(Se){var Ge=W[Se];Ge!==void 0&&(se[Se]=Ge)})}function G(P,W){Object.keys(W).forEach(function(se){W.hasOwnProperty(se)&&P.hasOwnProperty(se)&&(W[se]=P[se])})}function ie(){var P;(P=console).error.apply(P,arguments)}function q(){var P;(P=console).warn.apply(P,arguments)}var j=new Map;function oe(P,W){if(!P||Y(P)!=="object")return!1;var se=j.get(W);se||(se=new WeakMap,j.set(W,se));var Se=se.get(P);if(Se===void 0){var Ge=Object.prototype.toString.call(P);Se=Ge.substring(8,Ge.length-1)===W,se.set(P,Se)}return Se}function Z(P,W){return typeof WebGLBuffer<"u"&&oe(W,"WebGLBuffer")}function Te(P,W){return typeof WebGLRenderbuffer<"u"&&oe(W,"WebGLRenderbuffer")}function F(P,W){return typeof WebGLShader<"u"&&oe(W,"WebGLShader")}function z(P,W){return typeof WebGLTexture<"u"&&oe(W,"WebGLTexture")}function H(P,W){return typeof WebGLSampler<"u"&&oe(W,"WebGLSampler")}},"./src/m4.js":(Q,o,Y)=>{function ae(r){"@babel/helpers - typeof";return ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},ae(r)}o.__esModule=!0,o.axisRotate=Tr,o.axisRotation=fr,o.copy=F,o.create=Te,o.frustum=er,o.getAxis=Ge,o.getTranslation=Se,o.identity=z,o.inverse=P,o.lookAt=N,o.multiply=W,o.negate=Z,o.ortho=ur,o.perspective=or,o.rotateX=Fe,o.rotateY=Ue,o.rotateZ=Ke,o.rotationX=_e,o.rotationY=We,o.rotationZ=Je,o.scale=ar,o.scaling=cr,o.setAxis=Ce,o.setDefaultType=oe,o.setTranslation=se,o.transformDirection=Sr,o.transformNormal=ce,o.transformPoint=vr,o.translate=de,o.translation=A,o.transpose=H;var G=q(Y("./src/v3.js"));function ie(r){if(typeof WeakMap!="function")return null;var u=new WeakMap,c=new WeakMap;return(ie=function(v){return v?c:u})(r)}function q(r,u){if(!u&&r&&r.__esModule)return r;if(r===null||ae(r)!="object"&&typeof r!="function")return{default:r};var c=ie(u);if(c&&c.has(r))return c.get(r);var E={__proto__:null},v=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in r)if(i!=="default"&&Object.prototype.hasOwnProperty.call(r,i)){var a=v?Object.getOwnPropertyDescriptor(r,i):null;a&&(a.get||a.set)?Object.defineProperty(E,i,a):E[i]=r[i]}return E.default=r,c&&c.set(r,E),E}var j=Float32Array;function oe(r){var u=j;return j=r,u}function Z(r,u){return u=u||new j(16),u[0]=-r[0],u[1]=-r[1],u[2]=-r[2],u[3]=-r[3],u[4]=-r[4],u[5]=-r[5],u[6]=-r[6],u[7]=-r[7],u[8]=-r[8],u[9]=-r[9],u[10]=-r[10],u[11]=-r[11],u[12]=-r[12],u[13]=-r[13],u[14]=-r[14],u[15]=-r[15],u}function Te(){return new j(16).fill(0)}function F(r,u){return u=u||new j(16),u[0]=r[0],u[1]=r[1],u[2]=r[2],u[3]=r[3],u[4]=r[4],u[5]=r[5],u[6]=r[6],u[7]=r[7],u[8]=r[8],u[9]=r[9],u[10]=r[10],u[11]=r[11],u[12]=r[12],u[13]=r[13],u[14]=r[14],u[15]=r[15],u}function z(r){return r=r||new j(16),r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function H(r,u){if(u=u||new j(16),u===r){var c;return c=r[1],r[1]=r[4],r[4]=c,c=r[2],r[2]=r[8],r[8]=c,c=r[3],r[3]=r[12],r[12]=c,c=r[6],r[6]=r[9],r[9]=c,c=r[7],r[7]=r[13],r[13]=c,c=r[11],r[11]=r[14],r[14]=c,u}var E=r[0*4+0],v=r[0*4+1],i=r[0*4+2],a=r[0*4+3],m=r[1*4+0],h=r[1*4+1],T=r[1*4+2],_=r[1*4+3],I=r[2*4+0],L=r[2*4+1],K=r[2*4+2],J=r[2*4+3],ee=r[3*4+0],ue=r[3*4+1],ne=r[3*4+2],ve=r[3*4+3];return u[0]=E,u[1]=m,u[2]=I,u[3]=ee,u[4]=v,u[5]=h,u[6]=L,u[7]=ue,u[8]=i,u[9]=T,u[10]=K,u[11]=ne,u[12]=a,u[13]=_,u[14]=J,u[15]=ve,u}function P(r,u){u=u||new j(16);var c=r[0*4+0],E=r[0*4+1],v=r[0*4+2],i=r[0*4+3],a=r[1*4+0],m=r[1*4+1],h=r[1*4+2],T=r[1*4+3],_=r[2*4+0],I=r[2*4+1],L=r[2*4+2],K=r[2*4+3],J=r[3*4+0],ee=r[3*4+1],ue=r[3*4+2],ne=r[3*4+3],ve=L*ne,he=ue*K,te=h*ne,pe=ue*T,Oe=h*K,qe=L*T,ke=v*ne,Ve=ue*i,xe=v*K,De=L*i,Ze=v*T,Xe=h*i,Qe=_*ee,He=J*I,$e=a*ee,Be=J*m,Ne=a*I,yr=_*m,lr=c*ee,gr=J*E,_r=c*I,Lr=_*E,Ur=c*m,Gr=a*E,et=ve*m+pe*I+Oe*ee-(he*m+te*I+qe*ee),At=he*E+ke*I+De*ee-(ve*E+Ve*I+xe*ee),_t=te*E+Ve*m+Ze*ee-(pe*E+ke*m+Xe*ee),xt=qe*E+xe*m+Xe*I-(Oe*E+De*m+Ze*I),hr=1/(c*et+a*At+_*_t+J*xt);return u[0]=hr*et,u[1]=hr*At,u[2]=hr*_t,u[3]=hr*xt,u[4]=hr*(he*a+te*_+qe*J-(ve*a+pe*_+Oe*J)),u[5]=hr*(ve*c+Ve*_+xe*J-(he*c+ke*_+De*J)),u[6]=hr*(pe*c+ke*a+Xe*J-(te*c+Ve*a+Ze*J)),u[7]=hr*(Oe*c+De*a+Ze*_-(qe*c+xe*a+Xe*_)),u[8]=hr*(Qe*T+Be*K+Ne*ne-(He*T+$e*K+yr*ne)),u[9]=hr*(He*i+lr*K+Lr*ne-(Qe*i+gr*K+_r*ne)),u[10]=hr*($e*i+gr*T+Ur*ne-(Be*i+lr*T+Gr*ne)),u[11]=hr*(yr*i+_r*T+Gr*K-(Ne*i+Lr*T+Ur*K)),u[12]=hr*($e*L+yr*ue+He*h-(Ne*ue+Qe*h+Be*L)),u[13]=hr*(_r*ue+Qe*v+gr*L-(lr*L+Lr*ue+He*v)),u[14]=hr*(lr*h+Gr*ue+Be*v-(Ur*ue+$e*v+gr*h)),u[15]=hr*(Ur*L+Ne*v+Lr*h-(_r*h+Gr*L+yr*v)),u}function W(r,u,c){c=c||new j(16);var E=r[0],v=r[1],i=r[2],a=r[3],m=r[4],h=r[5],T=r[6],_=r[7],I=r[8],L=r[9],K=r[10],J=r[11],ee=r[12],ue=r[13],ne=r[14],ve=r[15],he=u[0],te=u[1],pe=u[2],Oe=u[3],qe=u[4],ke=u[5],Ve=u[6],xe=u[7],De=u[8],Ze=u[9],Xe=u[10],Qe=u[11],He=u[12],$e=u[13],Be=u[14],Ne=u[15];return c[0]=E*he+m*te+I*pe+ee*Oe,c[1]=v*he+h*te+L*pe+ue*Oe,c[2]=i*he+T*te+K*pe+ne*Oe,c[3]=a*he+_*te+J*pe+ve*Oe,c[4]=E*qe+m*ke+I*Ve+ee*xe,c[5]=v*qe+h*ke+L*Ve+ue*xe,c[6]=i*qe+T*ke+K*Ve+ne*xe,c[7]=a*qe+_*ke+J*Ve+ve*xe,c[8]=E*De+m*Ze+I*Xe+ee*Qe,c[9]=v*De+h*Ze+L*Xe+ue*Qe,c[10]=i*De+T*Ze+K*Xe+ne*Qe,c[11]=a*De+_*Ze+J*Xe+ve*Qe,c[12]=E*He+m*$e+I*Be+ee*Ne,c[13]=v*He+h*$e+L*Be+ue*Ne,c[14]=i*He+T*$e+K*Be+ne*Ne,c[15]=a*He+_*$e+J*Be+ve*Ne,c}function se(r,u,c){return c=c||z(),r!==c&&(c[0]=r[0],c[1]=r[1],c[2]=r[2],c[3]=r[3],c[4]=r[4],c[5]=r[5],c[6]=r[6],c[7]=r[7],c[8]=r[8],c[9]=r[9],c[10]=r[10],c[11]=r[11]),c[12]=u[0],c[13]=u[1],c[14]=u[2],c[15]=1,c}function Se(r,u){return u=u||G.create(),u[0]=r[12],u[1]=r[13],u[2]=r[14],u}function Ge(r,u,c){c=c||G.create();var E=u*4;return c[0]=r[E+0],c[1]=r[E+1],c[2]=r[E+2],c}function Ce(r,u,c,E){E!==r&&(E=F(r,E));var v=c*4;return E[v+0]=u[0],E[v+1]=u[1],E[v+2]=u[2],E}function or(r,u,c,E,v){v=v||new j(16);var i=Math.tan(Math.PI*.5-.5*r),a=1/(c-E);return v[0]=i/u,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=i,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=(c+E)*a,v[11]=-1,v[12]=0,v[13]=0,v[14]=c*E*a*2,v[15]=0,v}function ur(r,u,c,E,v,i,a){return a=a||new j(16),a[0]=2/(u-r),a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2/(E-c),a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2/(v-i),a[11]=0,a[12]=(u+r)/(r-u),a[13]=(E+c)/(c-E),a[14]=(i+v)/(v-i),a[15]=1,a}function er(r,u,c,E,v,i,a){a=a||new j(16);var m=u-r,h=E-c,T=v-i;return a[0]=2*v/m,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*v/h,a[6]=0,a[7]=0,a[8]=(r+u)/m,a[9]=(E+c)/h,a[10]=i/T,a[11]=-1,a[12]=0,a[13]=0,a[14]=v*i/T,a[15]=0,a}var me,w,B;function N(r,u,c,E){return E=E||new j(16),me=me||G.create(),w=w||G.create(),B=B||G.create(),G.normalize(G.subtract(r,u,B),B),G.normalize(G.cross(c,B,me),me),G.normalize(G.cross(B,me,w),w),E[0]=me[0],E[1]=me[1],E[2]=me[2],E[3]=0,E[4]=w[0],E[5]=w[1],E[6]=w[2],E[7]=0,E[8]=B[0],E[9]=B[1],E[10]=B[2],E[11]=0,E[12]=r[0],E[13]=r[1],E[14]=r[2],E[15]=1,E}function A(r,u){return u=u||new j(16),u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=r[0],u[13]=r[1],u[14]=r[2],u[15]=1,u}function de(r,u,c){c=c||new j(16);var E=u[0],v=u[1],i=u[2],a=r[0],m=r[1],h=r[2],T=r[3],_=r[1*4+0],I=r[1*4+1],L=r[1*4+2],K=r[1*4+3],J=r[2*4+0],ee=r[2*4+1],ue=r[2*4+2],ne=r[2*4+3],ve=r[3*4+0],he=r[3*4+1],te=r[3*4+2],pe=r[3*4+3];return r!==c&&(c[0]=a,c[1]=m,c[2]=h,c[3]=T,c[4]=_,c[5]=I,c[6]=L,c[7]=K,c[8]=J,c[9]=ee,c[10]=ue,c[11]=ne),c[12]=a*E+_*v+J*i+ve,c[13]=m*E+I*v+ee*i+he,c[14]=h*E+L*v+ue*i+te,c[15]=T*E+K*v+ne*i+pe,c}function _e(r,u){u=u||new j(16);var c=Math.cos(r),E=Math.sin(r);return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=c,u[6]=E,u[7]=0,u[8]=0,u[9]=-E,u[10]=c,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function Fe(r,u,c){c=c||new j(16);var E=r[4],v=r[5],i=r[6],a=r[7],m=r[8],h=r[9],T=r[10],_=r[11],I=Math.cos(u),L=Math.sin(u);return c[4]=I*E+L*m,c[5]=I*v+L*h,c[6]=I*i+L*T,c[7]=I*a+L*_,c[8]=I*m-L*E,c[9]=I*h-L*v,c[10]=I*T-L*i,c[11]=I*_-L*a,r!==c&&(c[0]=r[0],c[1]=r[1],c[2]=r[2],c[3]=r[3],c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c}function We(r,u){u=u||new j(16);var c=Math.cos(r),E=Math.sin(r);return u[0]=c,u[1]=0,u[2]=-E,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=E,u[9]=0,u[10]=c,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function Ue(r,u,c){c=c||new j(16);var E=r[0*4+0],v=r[0*4+1],i=r[0*4+2],a=r[0*4+3],m=r[2*4+0],h=r[2*4+1],T=r[2*4+2],_=r[2*4+3],I=Math.cos(u),L=Math.sin(u);return c[0]=I*E-L*m,c[1]=I*v-L*h,c[2]=I*i-L*T,c[3]=I*a-L*_,c[8]=I*m+L*E,c[9]=I*h+L*v,c[10]=I*T+L*i,c[11]=I*_+L*a,r!==c&&(c[4]=r[4],c[5]=r[5],c[6]=r[6],c[7]=r[7],c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c}function Je(r,u){u=u||new j(16);var c=Math.cos(r),E=Math.sin(r);return u[0]=c,u[1]=E,u[2]=0,u[3]=0,u[4]=-E,u[5]=c,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function Ke(r,u,c){c=c||new j(16);var E=r[0*4+0],v=r[0*4+1],i=r[0*4+2],a=r[0*4+3],m=r[1*4+0],h=r[1*4+1],T=r[1*4+2],_=r[1*4+3],I=Math.cos(u),L=Math.sin(u);return c[0]=I*E+L*m,c[1]=I*v+L*h,c[2]=I*i+L*T,c[3]=I*a+L*_,c[4]=I*m-L*E,c[5]=I*h-L*v,c[6]=I*T-L*i,c[7]=I*_-L*a,r!==c&&(c[8]=r[8],c[9]=r[9],c[10]=r[10],c[11]=r[11],c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c}function fr(r,u,c){c=c||new j(16);var E=r[0],v=r[1],i=r[2],a=Math.sqrt(E*E+v*v+i*i);E/=a,v/=a,i/=a;var m=E*E,h=v*v,T=i*i,_=Math.cos(u),I=Math.sin(u),L=1-_;return c[0]=m+(1-m)*_,c[1]=E*v*L+i*I,c[2]=E*i*L-v*I,c[3]=0,c[4]=E*v*L-i*I,c[5]=h+(1-h)*_,c[6]=v*i*L+E*I,c[7]=0,c[8]=E*i*L+v*I,c[9]=v*i*L-E*I,c[10]=T+(1-T)*_,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function Tr(r,u,c,E){E=E||new j(16);var v=u[0],i=u[1],a=u[2],m=Math.sqrt(v*v+i*i+a*a);v/=m,i/=m,a/=m;var h=v*v,T=i*i,_=a*a,I=Math.cos(c),L=Math.sin(c),K=1-I,J=h+(1-h)*I,ee=v*i*K+a*L,ue=v*a*K-i*L,ne=v*i*K-a*L,ve=T+(1-T)*I,he=i*a*K+v*L,te=v*a*K+i*L,pe=i*a*K-v*L,Oe=_+(1-_)*I,qe=r[0],ke=r[1],Ve=r[2],xe=r[3],De=r[4],Ze=r[5],Xe=r[6],Qe=r[7],He=r[8],$e=r[9],Be=r[10],Ne=r[11];return E[0]=J*qe+ee*De+ue*He,E[1]=J*ke+ee*Ze+ue*$e,E[2]=J*Ve+ee*Xe+ue*Be,E[3]=J*xe+ee*Qe+ue*Ne,E[4]=ne*qe+ve*De+he*He,E[5]=ne*ke+ve*Ze+he*$e,E[6]=ne*Ve+ve*Xe+he*Be,E[7]=ne*xe+ve*Qe+he*Ne,E[8]=te*qe+pe*De+Oe*He,E[9]=te*ke+pe*Ze+Oe*$e,E[10]=te*Ve+pe*Xe+Oe*Be,E[11]=te*xe+pe*Qe+Oe*Ne,r!==E&&(E[12]=r[12],E[13]=r[13],E[14]=r[14],E[15]=r[15]),E}function cr(r,u){return u=u||new j(16),u[0]=r[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=r[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=r[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function ar(r,u,c){c=c||new j(16);var E=u[0],v=u[1],i=u[2];return c[0]=E*r[0],c[1]=E*r[1],c[2]=E*r[2],c[3]=E*r[3],c[4]=v*r[4],c[5]=v*r[5],c[6]=v*r[6],c[7]=v*r[7],c[8]=i*r[8],c[9]=i*r[9],c[10]=i*r[10],c[11]=i*r[11],r!==c&&(c[12]=r[12],c[13]=r[13],c[14]=r[14],c[15]=r[15]),c}function vr(r,u,c){c=c||G.create();var E=u[0],v=u[1],i=u[2],a=E*r[0*4+3]+v*r[1*4+3]+i*r[2*4+3]+r[3*4+3];return c[0]=(E*r[0]+v*r[4]+i*r[8]+r[12])/a,c[1]=(E*r[1]+v*r[5]+i*r[9]+r[13])/a,c[2]=(E*r[2]+v*r[6]+i*r[10]+r[14])/a,c}function Sr(r,u,c){c=c||G.create();var E=u[0],v=u[1],i=u[2];return c[0]=E*r[0]+v*r[4]+i*r[8],c[1]=E*r[1]+v*r[5]+i*r[9],c[2]=E*r[2]+v*r[6]+i*r[10],c}function ce(r,u,c){c=c||G.create();var E=P(r),v=u[0],i=u[1],a=u[2];return c[0]=v*E[0]+i*E[1]+a*E[2],c[1]=v*E[4]+i*E[5]+a*E[6],c[2]=v*E[8]+i*E[9]+a*E[10],c}},"./src/primitives.js":(Q,o,Y)=>{function ae(i){"@babel/helpers - typeof";return ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},ae(i)}o.__esModule=!0,o.concatVertices=u,o.create3DFBuffers=o.create3DFBufferInfo=void 0,o.create3DFVertices=We,o.createAugmentedTypedArray=P,o.createCrescentBuffers=o.createCrescentBufferInfo=void 0,o.createCrescentVertices=Ue,o.createCubeBuffers=o.createCubeBufferInfo=o.createCresentVertices=o.createCresentBuffers=o.createCresentBufferInfo=void 0,o.createCubeVertices=de,o.createCylinderBuffers=o.createCylinderBufferInfo=void 0,o.createCylinderVertices=Je,o.createDiscBuffers=o.createDiscBufferInfo=void 0,o.createDiscVertices=fr,o.createPlaneBuffers=o.createPlaneBufferInfo=void 0,o.createPlaneVertices=B,o.createSphereBuffers=o.createSphereBufferInfo=void 0,o.createSphereVertices=N,o.createTorusBuffers=o.createTorusBufferInfo=void 0,o.createTorusVertices=Ke,o.createTruncatedConeBuffers=o.createTruncatedConeBufferInfo=void 0,o.createTruncatedConeVertices=_e,o.createXYQuadBuffers=o.createXYQuadBufferInfo=void 0,o.createXYQuadVertices=w,o.deindexVertices=se,o.duplicateVertices=c,o.flattenNormals=Se,o.makeRandomVertexColors=cr,o.reorientDirections=or,o.reorientNormals=ur,o.reorientPositions=er,o.reorientVertices=me;var G=Te(Y("./src/attributes.js")),ie=Te(Y("./src/helper.js")),q=Te(Y("./src/typedarrays.js")),j=Te(Y("./src/m4.js")),oe=Te(Y("./src/v3.js"));function Z(i){if(typeof WeakMap!="function")return null;var a=new WeakMap,m=new WeakMap;return(Z=function(T){return T?m:a})(i)}function Te(i,a){if(!a&&i&&i.__esModule)return i;if(i===null||ae(i)!="object"&&typeof i!="function")return{default:i};var m=Z(a);if(m&&m.has(i))return m.get(i);var h={__proto__:null},T=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var _ in i)if(_!=="default"&&Object.prototype.hasOwnProperty.call(i,_)){var I=T?Object.getOwnPropertyDescriptor(i,_):null;I&&(I.get||I.set)?Object.defineProperty(h,_,I):h[_]=i[_]}return h.default=i,m&&m.set(i,h),h}var F=G.getArray_,z=G.getNumComponents_;function H(i,a){var m=0;return i.push=function(){for(var h=0;h<arguments.length;++h){var T=arguments[h];if(T instanceof Array||q.isArrayBuffer(T))for(var _=0;_<T.length;++_)i[m++]=T[_];else i[m++]=T}},i.reset=function(h){m=h||0},i.numComponents=a,Object.defineProperty(i,"numElements",{get:function(){return this.length/this.numComponents|0}}),i}function P(i,a,m){var h=m||Float32Array;return H(new h(i*a),i)}function W(i){return i!=="indices"}function se(i){var a=i.indices,m={},h=a.length;function T(_){for(var I=i[_],L=I.numComponents,K=P(L,h,I.constructor),J=0;J<h;++J)for(var ee=a[J],ue=ee*L,ne=0;ne<L;++ne)K.push(I[ue+ne]);m[_]=K}return Object.keys(i).filter(W).forEach(T),m}function Se(i){if(i.indices)throw new Error("can not flatten normals of indexed vertices. deindex them first");for(var a=i.normal,m=a.length,h=0;h<m;h+=9){var T=a[h+0],_=a[h+1],I=a[h+2],L=a[h+3],K=a[h+4],J=a[h+5],ee=a[h+6],ue=a[h+7],ne=a[h+8],ve=T+L+ee,he=_+K+ue,te=I+J+ne,pe=Math.sqrt(ve*ve+he*he+te*te);ve/=pe,he/=pe,te/=pe,a[h+0]=ve,a[h+1]=he,a[h+2]=te,a[h+3]=ve,a[h+4]=he,a[h+5]=te,a[h+6]=ve,a[h+7]=he,a[h+8]=te}return i}function Ge(i,a,m){for(var h=i.length,T=new Float32Array(3),_=0;_<h;_+=3)m(a,[i[_],i[_+1],i[_+2]],T),i[_]=T[0],i[_+1]=T[1],i[_+2]=T[2]}function Ce(i,a,m){m=m||oe.create();var h=a[0],T=a[1],_=a[2];return m[0]=h*i[0]+T*i[1]+_*i[2],m[1]=h*i[4]+T*i[5]+_*i[6],m[2]=h*i[8]+T*i[9]+_*i[10],m}function or(i,a){return Ge(i,a,j.transformDirection),i}function ur(i,a){return Ge(i,j.inverse(a),Ce),i}function er(i,a){return Ge(i,a,j.transformPoint),i}function me(i,a){return Object.keys(i).forEach(function(m){var h=i[m];m.indexOf("pos")>=0?er(h,a):m.indexOf("tan")>=0||m.indexOf("binorm")>=0?or(h,a):m.indexOf("norm")>=0&&ur(h,a)}),i}function w(i,a,m){return i=i||2,a=a||0,m=m||0,i*=.5,{position:{numComponents:2,data:[a+-1*i,m+-1*i,a+1*i,m+-1*i,a+-1*i,m+1*i,a+1*i,m+1*i]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function B(i,a,m,h,T){i=i||1,a=a||1,m=m||1,h=h||1,T=T||j.identity();for(var _=(m+1)*(h+1),I=P(3,_),L=P(3,_),K=P(2,_),J=0;J<=h;J++)for(var ee=0;ee<=m;ee++){var ue=ee/m,ne=J/h;I.push(i*ue-i*.5,0,a*ne-a*.5),L.push(0,1,0),K.push(ue,ne)}for(var ve=m+1,he=P(3,m*h*2,Uint16Array),te=0;te<h;te++)for(var pe=0;pe<m;pe++)he.push((te+0)*ve+pe,(te+1)*ve+pe,(te+0)*ve+pe+1),he.push((te+1)*ve+pe,(te+1)*ve+pe+1,(te+0)*ve+pe+1);var Oe=me({position:I,normal:L,texcoord:K,indices:he},T);return Oe}function N(i,a,m,h,T,_,I){if(a<=0||m<=0)throw new Error("subdivisionAxis and subdivisionHeight must be > 0");h=h||0,T=T||Math.PI,_=_||0,I=I||Math.PI*2;for(var L=T-h,K=I-_,J=(a+1)*(m+1),ee=P(3,J),ue=P(3,J),ne=P(2,J),ve=0;ve<=m;ve++)for(var he=0;he<=a;he++){var te=he/a,pe=ve/m,Oe=K*te+_,qe=L*pe+h,ke=Math.sin(Oe),Ve=Math.cos(Oe),xe=Math.sin(qe),De=Math.cos(qe),Ze=Ve*xe,Xe=De,Qe=ke*xe;ee.push(i*Ze,i*Xe,i*Qe),ue.push(Ze,Xe,Qe),ne.push(1-te,pe)}for(var He=a+1,$e=P(3,a*m*2,Uint16Array),Be=0;Be<a;Be++)for(var Ne=0;Ne<m;Ne++)$e.push((Ne+0)*He+Be,(Ne+0)*He+Be+1,(Ne+1)*He+Be),$e.push((Ne+1)*He+Be,(Ne+0)*He+Be+1,(Ne+1)*He+Be+1);return{position:ee,normal:ue,texcoord:ne,indices:$e}}var A=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function de(i){i=i||1;for(var a=i/2,m=[[-a,-a,-a],[+a,-a,-a],[-a,+a,-a],[+a,+a,-a],[-a,-a,+a],[+a,-a,+a],[-a,+a,+a],[+a,+a,+a]],h=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],T=[[1,0],[0,0],[0,1],[1,1]],_=6*4,I=P(3,_),L=P(3,_),K=P(2,_),J=P(3,6*2,Uint16Array),ee=0;ee<6;++ee){for(var ue=A[ee],ne=0;ne<4;++ne){var ve=m[ue[ne]],he=h[ee],te=T[ne];I.push(ve),L.push(he),K.push(te)}var pe=4*ee;J.push(pe+0,pe+1,pe+2),J.push(pe+0,pe+2,pe+3)}return{position:I,normal:L,texcoord:K,indices:J}}function _e(i,a,m,h,T,_,I){if(h<3)throw new Error("radialSubdivisions must be 3 or greater");if(T<1)throw new Error("verticalSubdivisions must be 1 or greater");for(var L=_===void 0?!0:_,K=I===void 0?!0:I,J=(L?2:0)+(K?2:0),ee=(h+1)*(T+1+J),ue=P(3,ee),ne=P(3,ee),ve=P(2,ee),he=P(3,h*(T+J/2)*2,Uint16Array),te=h+1,pe=Math.atan2(i-a,m),Oe=Math.cos(pe),qe=Math.sin(pe),ke=L?-2:0,Ve=T+(K?2:0),xe=ke;xe<=Ve;++xe){var De=xe/T,Ze=m*De,Xe=void 0;xe<0?(Ze=0,De=1,Xe=i):xe>T?(Ze=m,De=1,Xe=a):Xe=i+(a-i)*(xe/T),(xe===-2||xe===T+2)&&(Xe=0,De=0),Ze-=m/2;for(var Qe=0;Qe<te;++Qe){var He=Math.sin(Qe*Math.PI*2/h),$e=Math.cos(Qe*Math.PI*2/h);ue.push(He*Xe,Ze,$e*Xe),xe<0?ne.push(0,-1,0):xe>T?ne.push(0,1,0):Xe===0?ne.push(0,0,0):ne.push(He*Oe,qe,$e*Oe),ve.push(Qe/h,1-De)}}for(var Be=0;Be<T+J;++Be)if(!(Be===1&&L||Be===T+J-2&&K))for(var Ne=0;Ne<h;++Ne)he.push(te*(Be+0)+0+Ne,te*(Be+0)+1+Ne,te*(Be+1)+1+Ne),he.push(te*(Be+0)+0+Ne,te*(Be+1)+1+Ne,te*(Be+1)+0+Ne);return{position:ue,normal:ne,texcoord:ve,indices:he}}function Fe(i,a){a=a||[];for(var m=[],h=0;h<i.length;h+=4){var T=i[h],_=i.slice(h+1,h+4);_.push.apply(_,a);for(var I=0;I<T;++I)m.push.apply(m,_)}return m}function We(){var i=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],a=[.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0],m=Fe([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),h=Fe([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),T=i.length/3,_={position:P(3,T),texcoord:P(2,T),normal:P(3,T),color:P(4,T,Uint8Array),indices:P(3,T/3,Uint16Array)};_.position.push(i),_.texcoord.push(a),_.normal.push(m),_.color.push(h);for(var I=0;I<T;++I)_.indices.push(I);return _}function Ue(i,a,m,h,T,_,I){if(T<=0)throw new Error("subdivisionDown must be > 0");_=_||0,I=I||1;var L=2,K=I-_,J=(T+1)*2*(2+L),ee=P(3,J),ue=P(3,J),ne=P(2,J);function ve(Ve,xe,De){return Ve+(xe-Ve)*De}function he(Ve,xe,De,Ze,Xe,Qe){for(var He=0;He<=T;He++){var $e=xe/(L-1),Be=He/T,Ne=($e-.5)*2,yr=(_+Be*K)*Math.PI,lr=Math.sin(yr),gr=Math.cos(yr),_r=ve(i,Ve,lr),Lr=Ne*h,Ur=gr*i,Gr=lr*_r;ee.push(Lr,Ur,Gr);var et=oe.add(oe.multiply([0,lr,gr],De),Ze);ue.push(et),ne.push($e*Xe+Qe,Be)}}for(var te=0;te<L;te++){var pe=(te/(L-1)-.5)*2;he(a,te,[1,1,1],[0,0,0],1,0),he(a,te,[0,0,0],[pe,0,0],0,0),he(m,te,[1,1,1],[0,0,0],1,0),he(m,te,[0,0,0],[pe,0,0],0,1)}var Oe=P(3,T*2*(2+L),Uint16Array);function qe(Ve,xe){for(var De=0;De<T;++De)Oe.push(Ve+De+0,Ve+De+1,xe+De+0),Oe.push(Ve+De+1,xe+De+1,xe+De+0)}var ke=T+1;return qe(ke*0,ke*4),qe(ke*5,ke*7),qe(ke*6,ke*2),qe(ke*3,ke*1),{position:ee,normal:ue,texcoord:ne,indices:Oe}}function Je(i,a,m,h,T,_){return _e(i,i,a,m,h,T,_)}function Ke(i,a,m,h,T,_){if(m<3)throw new Error("radialSubdivisions must be 3 or greater");if(h<3)throw new Error("verticalSubdivisions must be 3 or greater");T=T||0,_=_||Math.PI*2;for(var I=_-T,L=m+1,K=h+1,J=L*K,ee=P(3,J),ue=P(3,J),ne=P(2,J),ve=P(3,m*h*2,Uint16Array),he=0;he<K;++he)for(var te=he/h,pe=te*Math.PI*2,Oe=Math.sin(pe),qe=i+Oe*a,ke=Math.cos(pe),Ve=ke*a,xe=0;xe<L;++xe){var De=xe/m,Ze=T+De*I,Xe=Math.sin(Ze),Qe=Math.cos(Ze),He=Xe*qe,$e=Qe*qe,Be=Xe*Oe,Ne=Qe*Oe;ee.push(He,Ve,$e),ue.push(Be,ke,Ne),ne.push(De,1-te)}for(var yr=0;yr<h;++yr)for(var lr=0;lr<m;++lr){var gr=1+lr,_r=1+yr;ve.push(L*yr+lr,L*_r+lr,L*yr+gr),ve.push(L*_r+lr,L*_r+gr,L*yr+gr)}return{position:ee,normal:ue,texcoord:ne,indices:ve}}function fr(i,a,m,h,T){if(a<3)throw new Error("divisions must be at least 3");m=m||1,T=T||1,h=h||0;for(var _=(a+1)*(m+1),I=P(3,_),L=P(3,_),K=P(2,_),J=P(3,m*a*2,Uint16Array),ee=0,ue=i-h,ne=a+1,ve=0;ve<=m;++ve){for(var he=h+ue*Math.pow(ve/m,T),te=0;te<=a;++te){var pe=2*Math.PI*te/a,Oe=he*Math.cos(pe),qe=he*Math.sin(pe);if(I.push(Oe,0,qe),L.push(0,1,0),K.push(1-te/a,ve/m),ve>0&&te!==a){var ke=ee+(te+1),Ve=ee+te,xe=ee+te-ne,De=ee+(te+1)-ne;J.push(ke,Ve,xe),J.push(ke,xe,De)}}ee+=a+1}return{position:I,normal:L,texcoord:K,indices:J}}function Tr(i){return Math.random()*i|0}function cr(i,a){a=a||{};var m=i.position.numElements,h=P(4,m,Uint8Array),T=a.rand||function(ue,ne){return ne<3?Tr(256):255};if(i.color=h,i.indices)for(var _=0;_<m;++_)h.push(T(_,0),T(_,1),T(_,2),T(_,3));else for(var I=a.vertsPerColor||3,L=m/I,K=0;K<L;++K)for(var J=[T(K,0),T(K,1),T(K,2),T(K,3)],ee=0;ee<I;++ee)h.push(J);return i}function ar(i){return function(a){var m=i.apply(this,Array.prototype.slice.call(arguments,1));return G.createBuffersFromArrays(a,m)}}function vr(i){return function(a){var m=i.apply(null,Array.prototype.slice.call(arguments,1));return G.createBufferInfoFromArrays(a,m)}}var Sr=["numComponents","size","type","normalize","stride","offset","attrib","name","attribName"];function ce(i,a,m,h){h=h||0;for(var T=i.length,_=0;_<T;++_)a[m+_]=i[_]+h}function r(i,a){var m=F(i),h=new m.constructor(a),T=h;return m.numComponents&&m.numElements&&H(h,m.numComponents),i.data&&(T={data:h},ie.copyNamedProperties(Sr,i,T)),T}function u(i){for(var a={},m,h=function(){var ee=i[T];Object.keys(ee).forEach(function(ue){a[ue]||(a[ue]=[]),!m&&ue!=="indices"&&(m=ue);var ne=ee[ue],ve=z(ne,ue),he=F(ne),te=he.length/ve;a[ue].push(te)})},T=0;T<i.length;++T)h();function _(J){for(var ee=0,ue,ne=0;ne<i.length;++ne){var ve=i[ne],he=ve[J],te=F(he);ee+=te.length,(!ue||he.data)&&(ue=he)}return{length:ee,spec:ue}}function I(J,ee,ue){for(var ne=0,ve=0,he=0;he<i.length;++he){var te=i[he],pe=te[J],Oe=F(pe);J==="indices"?(ce(Oe,ue,ve,ne),ne+=ee[he]):ce(Oe,ue,ve),ve+=Oe.length}}var L=a[m],K={};return Object.keys(a).forEach(function(J){var ee=_(J),ue=r(ee.spec,ee.length);I(J,L,F(ue)),K[J]=ue}),K}function c(i){var a={};return Object.keys(i).forEach(function(m){var h=i[m],T=F(h),_=r(h,T.length);ce(T,F(_),0),a[m]=_}),a}o.create3DFBufferInfo=vr(We),o.create3DFBuffers=ar(We),o.createCubeBufferInfo=vr(de),o.createCubeBuffers=ar(de),o.createPlaneBufferInfo=vr(B),o.createPlaneBuffers=ar(B),o.createSphereBufferInfo=vr(N),o.createSphereBuffers=ar(N),o.createTruncatedConeBufferInfo=vr(_e),o.createTruncatedConeBuffers=ar(_e),o.createXYQuadBufferInfo=vr(w),o.createXYQuadBuffers=ar(w);var E=o.createCrescentBufferInfo=vr(Ue),v=o.createCrescentBuffers=ar(Ue);o.createCylinderBufferInfo=vr(Je),o.createCylinderBuffers=ar(Je),o.createTorusBufferInfo=vr(Ke),o.createTorusBuffers=ar(Ke),o.createDiscBufferInfo=vr(fr),o.createDiscBuffers=ar(fr),o.createCresentBufferInfo=E,o.createCresentBuffers=v,o.createCresentVertices=Ue},"./src/programs.js":(Q,o,Y)=>{function ae(e){"@babel/helpers - typeof";return ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ae(e)}o.__esModule=!0,o.bindTransformFeedbackInfo=Mt,o.bindUniformBlock=Nt,o.createAttributeSetters=fn,o.createProgram=mt,o.createProgramAsync=void 0,o.createProgramFromScripts=rn,o.createProgramFromSources=tn,o.createProgramInfo=s,o.createProgramInfoAsync=void 0,o.createProgramInfoFromProgram=Gt,o.createProgramInfos=g,o.createProgramInfosAsync=void 0,o.createPrograms=p,o.createProgramsAsync=void 0,o.createTransformFeedback=an,o.createTransformFeedbackInfo=Ot,o.createUniformBlockInfo=un,o.createUniformBlockInfoFromProgram=on,o.createUniformBlockSpecFromProgram=zr,o.createUniformSetters=nt,o.setAttributes=cn,o.setBlockUniforms=ha,o.setBuffersAndAttributes=ma,o.setUniformBlock=Un,o.setUniforms=Ut,o.setUniformsAndBindTextures=void 0;var G=j(Y("./src/utils.js")),ie=j(Y("./src/helper.js"));function q(e){if(typeof WeakMap!="function")return null;var t=new WeakMap,n=new WeakMap;return(q=function(b){return b?n:t})(e)}function j(e,t){if(!t&&e&&e.__esModule)return e;if(e===null||ae(e)!="object"&&typeof e!="function")return{default:e};var n=q(t);if(n&&n.has(e))return n.get(e);var d={__proto__:null},b=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var S in e)if(S!=="default"&&Object.prototype.hasOwnProperty.call(e,S)){var R=b?Object.getOwnPropertyDescriptor(e,S):null;R&&(R.get||R.set)?Object.defineProperty(d,S,R):d[S]=e[S]}return d.default=e,n&&n.set(e,d),d}function oe(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */oe=function(){return t};var e,t={},n=Object.prototype,d=n.hasOwnProperty,b=Object.defineProperty||function(le,X,$){le[X]=$.value},S=typeof Symbol=="function"?Symbol:{},R=S.iterator||"@@iterator",x=S.asyncIterator||"@@asyncIterator",M=S.toStringTag||"@@toStringTag";function D(le,X,$){return Object.defineProperty(le,X,{value:$,enumerable:!0,configurable:!0,writable:!0}),le[X]}try{D({},"")}catch{D=function($,ge,Le){return $[ge]=Le}}function V(le,X,$,ge){var Le=X&&X.prototype instanceof je?X:je,we=Object.create(Le.prototype),sr=new da(ge||[]);return b(we,"_invoke",{value:Ha(le,$,sr)}),we}function fe(le,X,$){try{return{type:"normal",arg:le.call(X,$)}}catch(ge){return{type:"throw",arg:ge}}}t.wrap=V;var ye="suspendedStart",be="suspendedYield",Re="executing",Me="completed",Ie={};function je(){}function Ye(){}function ir(){}var mr={};D(mr,R,function(){return this});var xr=Object.getPrototypeOf,Or=xr&&xr(xr(ba([])));Or&&Or!==n&&d.call(Or,R)&&(mr=Or);var Vr=ir.prototype=je.prototype=Object.create(mr);function kn(le){["next","throw","return"].forEach(function(X){D(le,X,function($){return this._invoke(X,$)})})}function jn(le,X){function $(Le,we,sr,Pr){var Cr=fe(le[Le],le,we);if(Cr.type!=="throw"){var pt=Cr.arg,at=pt.value;return at&&ae(at)=="object"&&d.call(at,"__await")?X.resolve(at.__await).then(function(dt){$("next",dt,sr,Pr)},function(dt){$("throw",dt,sr,Pr)}):X.resolve(at).then(function(dt){pt.value=dt,sr(pt)},function(dt){return $("throw",dt,sr,Pr)})}Pr(Cr.arg)}var ge;b(this,"_invoke",{value:function(we,sr){function Pr(){return new X(function(Cr,pt){$(we,sr,Cr,pt)})}return ge=ge?ge.then(Pr,Pr):Pr()}})}function Ha(le,X,$){var ge=ye;return function(Le,we){if(ge===Re)throw new Error("Generator is already running");if(ge===Me){if(Le==="throw")throw we;return{value:e,done:!0}}for($.method=Le,$.arg=we;;){var sr=$.delegate;if(sr){var Pr=Da(sr,$);if(Pr){if(Pr===Ie)continue;return Pr}}if($.method==="next")$.sent=$._sent=$.arg;else if($.method==="throw"){if(ge===ye)throw ge=Me,$.arg;$.dispatchException($.arg)}else $.method==="return"&&$.abrupt("return",$.arg);ge=Re;var Cr=fe(le,X,$);if(Cr.type==="normal"){if(ge=$.done?Me:be,Cr.arg===Ie)continue;return{value:Cr.arg,done:$.done}}Cr.type==="throw"&&(ge=Me,$.method="throw",$.arg=Cr.arg)}}}function Da(le,X){var $=X.method,ge=le.iterator[$];if(ge===e)return X.delegate=null,$==="throw"&&le.iterator.return&&(X.method="return",X.arg=e,Da(le,X),X.method==="throw")||$!=="return"&&(X.method="throw",X.arg=new TypeError("The iterator does not provide a '"+$+"' method")),Ie;var Le=fe(ge,le.iterator,X.arg);if(Le.type==="throw")return X.method="throw",X.arg=Le.arg,X.delegate=null,Ie;var we=Le.arg;return we?we.done?(X[le.resultName]=we.value,X.next=le.nextLoc,X.method!=="return"&&(X.method="next",X.arg=e),X.delegate=null,Ie):we:(X.method="throw",X.arg=new TypeError("iterator result is not an object"),X.delegate=null,Ie)}function Ka(le){var X={tryLoc:le[0]};1 in le&&(X.catchLoc=le[1]),2 in le&&(X.finallyLoc=le[2],X.afterLoc=le[3]),this.tryEntries.push(X)}function pa(le){var X=le.completion||{};X.type="normal",delete X.arg,le.completion=X}function da(le){this.tryEntries=[{tryLoc:"root"}],le.forEach(Ka,this),this.reset(!0)}function ba(le){if(le||le===""){var X=le[R];if(X)return X.call(le);if(typeof le.next=="function")return le;if(!isNaN(le.length)){var $=-1,ge=function Le(){for(;++$<le.length;)if(d.call(le,$))return Le.value=le[$],Le.done=!1,Le;return Le.value=e,Le.done=!0,Le};return ge.next=ge}}throw new TypeError(ae(le)+" is not iterable")}return Ye.prototype=ir,b(Vr,"constructor",{value:ir,configurable:!0}),b(ir,"constructor",{value:Ye,configurable:!0}),Ye.displayName=D(ir,M,"GeneratorFunction"),t.isGeneratorFunction=function(le){var X=typeof le=="function"&&le.constructor;return!!X&&(X===Ye||(X.displayName||X.name)==="GeneratorFunction")},t.mark=function(le){return Object.setPrototypeOf?Object.setPrototypeOf(le,ir):(le.__proto__=ir,D(le,M,"GeneratorFunction")),le.prototype=Object.create(Vr),le},t.awrap=function(le){return{__await:le}},kn(jn.prototype),D(jn.prototype,x,function(){return this}),t.AsyncIterator=jn,t.async=function(le,X,$,ge,Le){Le===void 0&&(Le=Promise);var we=new jn(V(le,X,$,ge),Le);return t.isGeneratorFunction(X)?we:we.next().then(function(sr){return sr.done?sr.value:we.next()})},kn(Vr),D(Vr,M,"Generator"),D(Vr,R,function(){return this}),D(Vr,"toString",function(){return"[object Generator]"}),t.keys=function(le){var X=Object(le),$=[];for(var ge in X)$.push(ge);return $.reverse(),function Le(){for(;$.length;){var we=$.pop();if(we in X)return Le.value=we,Le.done=!1,Le}return Le.done=!0,Le}},t.values=ba,da.prototype={constructor:da,reset:function(X){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(pa),!X)for(var $ in this)$.charAt(0)==="t"&&d.call(this,$)&&!isNaN(+$.slice(1))&&(this[$]=e)},stop:function(){this.done=!0;var X=this.tryEntries[0].completion;if(X.type==="throw")throw X.arg;return this.rval},dispatchException:function(X){if(this.done)throw X;var $=this;function ge(pt,at){return sr.type="throw",sr.arg=X,$.next=pt,at&&($.method="next",$.arg=e),!!at}for(var Le=this.tryEntries.length-1;Le>=0;--Le){var we=this.tryEntries[Le],sr=we.completion;if(we.tryLoc==="root")return ge("end");if(we.tryLoc<=this.prev){var Pr=d.call(we,"catchLoc"),Cr=d.call(we,"finallyLoc");if(Pr&&Cr){if(this.prev<we.catchLoc)return ge(we.catchLoc,!0);if(this.prev<we.finallyLoc)return ge(we.finallyLoc)}else if(Pr){if(this.prev<we.catchLoc)return ge(we.catchLoc,!0)}else{if(!Cr)throw new Error("try statement without catch or finally");if(this.prev<we.finallyLoc)return ge(we.finallyLoc)}}}},abrupt:function(X,$){for(var ge=this.tryEntries.length-1;ge>=0;--ge){var Le=this.tryEntries[ge];if(Le.tryLoc<=this.prev&&d.call(Le,"finallyLoc")&&this.prev<Le.finallyLoc){var we=Le;break}}we&&(X==="break"||X==="continue")&&we.tryLoc<=$&&$<=we.finallyLoc&&(we=null);var sr=we?we.completion:{};return sr.type=X,sr.arg=$,we?(this.method="next",this.next=we.finallyLoc,Ie):this.complete(sr)},complete:function(X,$){if(X.type==="throw")throw X.arg;return X.type==="break"||X.type==="continue"?this.next=X.arg:X.type==="return"?(this.rval=this.arg=X.arg,this.method="return",this.next="end"):X.type==="normal"&&$&&(this.next=$),Ie},finish:function(X){for(var $=this.tryEntries.length-1;$>=0;--$){var ge=this.tryEntries[$];if(ge.finallyLoc===X)return this.complete(ge.completion,ge.afterLoc),pa(ge),Ie}},catch:function(X){for(var $=this.tryEntries.length-1;$>=0;--$){var ge=this.tryEntries[$];if(ge.tryLoc===X){var Le=ge.completion;if(Le.type==="throw"){var we=Le.arg;pa(ge)}return we}}throw new Error("illegal catch attempt")},delegateYield:function(X,$,ge){return this.delegate={iterator:ba(X),resultName:$,nextLoc:ge},this.method==="next"&&(this.arg=e),Ie}},t}function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);t&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(e,b).enumerable})),n.push.apply(n,d)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Z(Object(n),!0).forEach(function(d){F(e,d,n[d])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach(function(d){Object.defineProperty(e,d,Object.getOwnPropertyDescriptor(n,d))})}return e}function F(e,t,n){return t=z(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z(e){var t=H(e,"string");return ae(t)=="symbol"?t:String(t)}function H(e,t){if(ae(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var d=n.call(e,t||"default");if(ae(d)!="object")return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function P(e,t,n,d,b,S,R){try{var x=e[S](R),M=x.value}catch(D){n(D);return}x.done?t(M):Promise.resolve(M).then(d,b)}function W(e){return function(){var t=this,n=arguments;return new Promise(function(d,b){var S=e.apply(t,n);function R(M){P(S,d,b,R,x,"next",M)}function x(M){P(S,d,b,R,x,"throw",M)}R(void 0)})}}function se(e,t){return Ce(e)||Ge(e,t)||me(e,t)||Se()}function Se(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ge(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var d,b,S,R,x=[],M=!0,D=!1;try{if(S=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;M=!1}else for(;!(M=(d=S.call(n)).done)&&(x.push(d.value),x.length!==t);M=!0);}catch(V){D=!0,b=V}finally{try{if(!M&&n.return!=null&&(R=n.return(),Object(R)!==R))return}finally{if(D)throw b}}return x}}function Ce(e){if(Array.isArray(e))return e}function or(e,t){var n=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=me(e))||t&&e&&typeof e.length=="number"){n&&(e=n);var d=0,b=function(){};return{s:b,n:function(){return d>=e.length?{done:!0}:{done:!1,value:e[d++]}},e:function(D){throw D},f:b}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var S=!0,R=!1,x;return{s:function(){n=n.call(e)},n:function(){var D=n.next();return S=D.done,D},e:function(D){R=!0,x=D},f:function(){try{!S&&n.return!=null&&n.return()}finally{if(R)throw x}}}}function ur(e){return B(e)||w(e)||me(e)||er()}function er(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function me(e,t){if(e){if(typeof e=="string")return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}}function w(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function B(e){if(Array.isArray(e))return N(e)}function N(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,d=new Array(t);n<t;n++)d[n]=e[n];return d}var A=ie.error,de=ie.warn;function _e(e){return typeof document<"u"&&document.getElementById?document.getElementById(e):null}var Fe=33984,We=35048,Ue=34962,Je=34963,Ke=35345,fr=35982,Tr=36386,cr=35713,ar=35714,vr=35632,Sr=35633,ce=35981,r=35718,u=35721,c=35971,E=35382,v=35396,i=35398,a=35392,m=35395,h=5126,T=35664,_=35665,I=35666,L=5124,K=35667,J=35668,ee=35669,ue=35670,ne=35671,ve=35672,he=35673,te=35674,pe=35675,Oe=35676,qe=35678,ke=35680,Ve=35679,xe=35682,De=35685,Ze=35686,Xe=35687,Qe=35688,He=35689,$e=35690,Be=36289,Ne=36292,yr=36293,lr=5125,gr=36294,_r=36295,Lr=36296,Ur=36298,Gr=36299,et=36300,At=36303,_t=36306,xt=36307,hr=36308,ta=36311,Pt=3553,wt=34067,zt=32879,Ct=35866,Pe={};function _n(e,t){return Pe[t].bindPoint}function na(e,t){return function(n){e.uniform1f(t,n)}}function aa(e,t){return function(n){e.uniform1fv(t,n)}}function ia(e,t){return function(n){e.uniform2fv(t,n)}}function oa(e,t){return function(n){e.uniform3fv(t,n)}}function ua(e,t){return function(n){e.uniform4fv(t,n)}}function xn(e,t){return function(n){e.uniform1i(t,n)}}function Pn(e,t){return function(n){e.uniform1iv(t,n)}}function wn(e,t){return function(n){e.uniform2iv(t,n)}}function Cn(e,t){return function(n){e.uniform3iv(t,n)}}function Rn(e,t){return function(n){e.uniform4iv(t,n)}}function kr(e,t){return function(n){e.uniform1ui(t,n)}}function tr(e,t){return function(n){e.uniform1uiv(t,n)}}function Rt(e,t){return function(n){e.uniform2uiv(t,n)}}function rt(e,t){return function(n){e.uniform3uiv(t,n)}}function Ft(e,t){return function(n){e.uniform4uiv(t,n)}}function Wr(e,t){return function(n){e.uniformMatrix2fv(t,!1,n)}}function pr(e,t){return function(n){e.uniformMatrix3fv(t,!1,n)}}function Fn(e,t){return function(n){e.uniformMatrix4fv(t,!1,n)}}function Dn(e,t){return function(n){e.uniformMatrix2x3fv(t,!1,n)}}function Bn(e,t){return function(n){e.uniformMatrix3x2fv(t,!1,n)}}function Rr(e,t){return function(n){e.uniformMatrix2x4fv(t,!1,n)}}function ht(e,t){return function(n){e.uniformMatrix4x2fv(t,!1,n)}}function Qt(e,t){return function(n){e.uniformMatrix3x4fv(t,!1,n)}}function fa(e,t){return function(n){e.uniformMatrix4x3fv(t,!1,n)}}function br(e,t,n,d){var b=_n(e,t);return G.isWebGL2(e)?function(S){var R,x;!S||ie.isTexture(e,S)?(R=S,x=null):(R=S.texture,x=S.sampler),e.uniform1i(d,n),e.activeTexture(Fe+n),e.bindTexture(b,R),e.bindSampler(n,x)}:function(S){e.uniform1i(d,n),e.activeTexture(Fe+n),e.bindTexture(b,S)}}function Er(e,t,n,d,b){for(var S=_n(e,t),R=new Int32Array(b),x=0;x<b;++x)R[x]=n+x;return G.isWebGL2(e)?function(M){e.uniform1iv(d,R),M.forEach(function(D,V){e.activeTexture(Fe+R[V]);var fe,ye;!D||ie.isTexture(e,D)?(fe=D,ye=null):(fe=D.texture,ye=D.sampler),e.bindSampler(n,ye),e.bindTexture(S,fe)})}:function(M){e.uniform1iv(d,R),M.forEach(function(D,V){e.activeTexture(Fe+R[V]),e.bindTexture(S,D)})}}Pe[h]={Type:Float32Array,size:4,setter:na,arraySetter:aa},Pe[T]={Type:Float32Array,size:8,setter:ia,cols:2},Pe[_]={Type:Float32Array,size:12,setter:oa,cols:3},Pe[I]={Type:Float32Array,size:16,setter:ua,cols:4},Pe[L]={Type:Int32Array,size:4,setter:xn,arraySetter:Pn},Pe[K]={Type:Int32Array,size:8,setter:wn,cols:2},Pe[J]={Type:Int32Array,size:12,setter:Cn,cols:3},Pe[ee]={Type:Int32Array,size:16,setter:Rn,cols:4},Pe[lr]={Type:Uint32Array,size:4,setter:kr,arraySetter:tr},Pe[gr]={Type:Uint32Array,size:8,setter:Rt,cols:2},Pe[_r]={Type:Uint32Array,size:12,setter:rt,cols:3},Pe[Lr]={Type:Uint32Array,size:16,setter:Ft,cols:4},Pe[ue]={Type:Uint32Array,size:4,setter:xn,arraySetter:Pn},Pe[ne]={Type:Uint32Array,size:8,setter:wn,cols:2},Pe[ve]={Type:Uint32Array,size:12,setter:Cn,cols:3},Pe[he]={Type:Uint32Array,size:16,setter:Rn,cols:4},Pe[te]={Type:Float32Array,size:32,setter:Wr,rows:2,cols:2},Pe[pe]={Type:Float32Array,size:48,setter:pr,rows:3,cols:3},Pe[Oe]={Type:Float32Array,size:64,setter:Fn,rows:4,cols:4},Pe[De]={Type:Float32Array,size:32,setter:Dn,rows:2,cols:3},Pe[Ze]={Type:Float32Array,size:32,setter:Rr,rows:2,cols:4},Pe[Xe]={Type:Float32Array,size:48,setter:Bn,rows:3,cols:2},Pe[Qe]={Type:Float32Array,size:48,setter:Qt,rows:3,cols:4},Pe[He]={Type:Float32Array,size:64,setter:ht,rows:4,cols:2},Pe[$e]={Type:Float32Array,size:64,setter:fa,rows:4,cols:3},Pe[qe]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Pt},Pe[ke]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:wt},Pe[Ve]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:zt},Pe[xe]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Pt},Pe[Be]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Ct},Pe[Ne]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Ct},Pe[yr]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:wt},Pe[Ur]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Pt},Pe[Gr]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:zt},Pe[et]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:wt},Pe[At]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Ct},Pe[_t]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Pt},Pe[xt]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:zt},Pe[hr]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:wt},Pe[ta]={Type:null,size:0,setter:br,arraySetter:Er,bindPoint:Ct};function Dt(e,t){return function(n){if(n.value)switch(e.disableVertexAttribArray(t),n.value.length){case 4:e.vertexAttrib4fv(t,n.value);break;case 3:e.vertexAttrib3fv(t,n.value);break;case 2:e.vertexAttrib2fv(t,n.value);break;case 1:e.vertexAttrib1fv(t,n.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else e.bindBuffer(Ue,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribPointer(t,n.numComponents||n.size,n.type||h,n.normalize||!1,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function wr(e,t){return function(n){if(n.value)if(e.disableVertexAttribArray(t),n.value.length===4)e.vertexAttrib4iv(t,n.value);else throw new Error("The length of an integer constant value must be 4!");else e.bindBuffer(Ue,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,n.numComponents||n.size,n.type||L,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function Dr(e,t){return function(n){if(n.value)if(e.disableVertexAttribArray(t),n.value.length===4)e.vertexAttrib4uiv(t,n.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else e.bindBuffer(Ue,n.buffer),e.enableVertexAttribArray(t),e.vertexAttribIPointer(t,n.numComponents||n.size,n.type||lr,n.stride||0,n.offset||0),e.vertexAttribDivisor&&e.vertexAttribDivisor(t,n.divisor||0)}}function Xr(e,t,n){var d=n.size,b=n.count;return function(S){e.bindBuffer(Ue,S.buffer);for(var R=S.size||S.numComponents||d,x=R/b,M=S.type||h,D=Pe[M],V=D.size*R,fe=S.normalize||!1,ye=S.offset||0,be=V/b,Re=0;Re<b;++Re)e.enableVertexAttribArray(t+Re),e.vertexAttribPointer(t+Re,x,M,fe,V,ye+be*Re),e.vertexAttribDivisor&&e.vertexAttribDivisor(t+Re,S.divisor||0)}}var rr={};rr[h]={size:4,setter:Dt},rr[T]={size:8,setter:Dt},rr[_]={size:12,setter:Dt},rr[I]={size:16,setter:Dt},rr[L]={size:4,setter:wr},rr[K]={size:8,setter:wr},rr[J]={size:12,setter:wr},rr[ee]={size:16,setter:wr},rr[lr]={size:4,setter:Dr},rr[gr]={size:8,setter:Dr},rr[_r]={size:12,setter:Dr},rr[Lr]={size:16,setter:Dr},rr[ue]={size:4,setter:wr},rr[ne]={size:8,setter:wr},rr[ve]={size:12,setter:wr},rr[he]={size:16,setter:wr},rr[te]={size:4,setter:Xr,count:2},rr[pe]={size:9,setter:Xr,count:3},rr[Oe]={size:16,setter:Xr,count:4};var Hr=/ERROR:\s*\d+:(\d+)/gi;function jr(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,d=ur(t.matchAll(Hr)),b=new Map(d.map(function(S,R){var x=parseInt(S[1]),M=d[R+1],D=M?M.index:t.length,V=t.substring(S.index,D);return[x-1,V]}));return e.split(`
`).map(function(S,R){var x=b.get(R);return"".concat(R+1+n,": ").concat(S).concat(x?`

^^^ `.concat(x):"")}).join(`
`)}var Zt=/^[ \t]*\n/;function dr(e){var t=0;return Zt.test(e)&&(t=1,e=e.replace(Zt,"")),{lineOffset:t,shaderSource:e}}function Bt(e,t){return e.errorCallback(t),e.callback&&setTimeout(function(){e.callback("".concat(t,`
`).concat(e.errors.join(`
`)))}),null}function It(e,t,n,d){d=d||A;var b=e.getShaderParameter(n,cr);if(!b){var S=e.getShaderInfoLog(n),R=dr(e.getShaderSource(n)),x=R.lineOffset,M=R.shaderSource,D="".concat(jr(M,S,x),`
Error compiling `).concat(G.glEnumToString(e,t),": ").concat(S);return d(D),D}return""}function Kr(e,t,n){var d,b,S;if(typeof t=="function"&&(n=t,t=void 0),typeof e=="function")n=e,e=void 0;else if(e&&!Array.isArray(e)){var R=e;n=R.errorCallback,e=R.attribLocations,d=R.transformFeedbackVaryings,b=R.transformFeedbackMode,S=R.callback}var x=n||A,M=[],D={errorCallback:function(ye){M.push(ye);for(var be=arguments.length,Re=new Array(be>1?be-1:0),Me=1;Me<be;Me++)Re[Me-1]=arguments[Me];x.apply(void 0,[ye].concat(Re))},transformFeedbackVaryings:d,transformFeedbackMode:b,callback:S,errors:M};{var V={};Array.isArray(e)?e.forEach(function(fe,ye){V[fe]=t?t[ye]:ye}):V=e||{},D.attribLocations=V}return D}var qr=["VERTEX_SHADER","FRAGMENT_SHADER"];function In(e,t){if(t.indexOf("frag")>=0)return vr;if(t.indexOf("vert")>=0)return Sr}function Ln(e,t,n){var d=e.getAttachedShaders(t),b=or(d),S;try{for(b.s();!(S=b.n()).done;){var R=S.value;n.has(R)&&e.deleteShader(R)}}catch(x){b.e(x)}finally{b.f()}e.deleteProgram(t)}var On=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new Promise(function(n){return setTimeout(n,t)})};function Mn(e,t,n){for(var d=e.createProgram(),b=Kr(n),S=b.attribLocations,R=b.transformFeedbackVaryings,x=b.transformFeedbackMode,M=0;M<t.length;++M){var D=t[M];if(typeof D=="string"){var V=_e(D),fe=V?V.text:D,ye=e[qr[M]];V&&V.type&&(ye=In(e,V.type)||ye),D=e.createShader(ye),e.shaderSource(D,dr(fe).shaderSource),e.compileShader(D),e.attachShader(d,D)}}Object.entries(S).forEach(function(Re){var Me=se(Re,2),Ie=Me[0],je=Me[1];return e.bindAttribLocation(d,je,Ie)});{var be=R;be&&(be.attribs&&(be=be.attribs),Array.isArray(be)||(be=Object.keys(be)),e.transformFeedbackVaryings(d,be,x||ce))}return e.linkProgram(d),d}function mt(e,t,n,d,b){var S=Kr(n,d,b),R=new Set(t),x=Mn(e,t,S);function M(D,V){var fe=en(D,V,S.errorCallback);return fe&&Ln(D,V,R),fe}if(S.callback){Jt(e,x).then(function(){var D=M(e,x);S.callback(D,D?void 0:x)});return}return M(e,x)?void 0:x}function Yr(e){return function(t,n){for(var d=arguments.length,b=new Array(d>2?d-2:0),S=2;S<d;S++)b[S-2]=arguments[S];return new Promise(function(R,x){var M=Kr.apply(void 0,b);M.callback=function(D,V){D?x(D):R(V)},e(t,n,M)})}}o.createProgramAsync=Yr(mt),o.createProgramInfoAsync=Yr(s);function Jt(e,t){return $t.apply(this,arguments)}function $t(){return $t=W(oe().mark(function e(t,n){var d,b,S;return oe().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:d=t.getExtension("KHR_parallel_shader_compile"),b=d?function(M,D){return M.getProgramParameter(D,d.COMPLETION_STATUS_KHR)}:function(){return!0},S=0;case 3:return x.next=5,On(S);case 5:S=16.666666666666668;case 6:if(!b(t,n)){x.next=3;break}case 7:case"end":return x.stop()}},e)})),$t.apply(this,arguments)}function tt(e,t){return Lt.apply(this,arguments)}function Lt(){return Lt=W(oe().mark(function e(t,n){var d,b,S;return oe().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:d=0,b=Object.values(n);case 1:if(!(d<b.length)){x.next=8;break}return S=b[d],x.next=5,Jt(t,S);case 5:d++,x.next=1;break;case 8:case"end":return x.stop()}},e)})),Lt.apply(this,arguments)}function en(e,t,n){n=n||A;var d=e.getProgramParameter(t,ar);if(!d){var b=e.getProgramInfoLog(t);n("Error in program linking: ".concat(b));var S=e.getAttachedShaders(t),R=S.map(function(x){return It(e,e.getShaderParameter(x,e.SHADER_TYPE),x,n)});return"".concat(b,`
`).concat(R.filter(function(x){return x}).join(`
`))}}function rn(e,t,n,d,b){var S=Kr(n,d,b),R=[],x=or(t),M;try{for(x.s();!(M=x.n()).done;){var D=M.value,V=_e(D);if(!V)return Bt(S,"unknown script element: ".concat(D));R.push(V.text)}}catch(fe){x.e(fe)}finally{x.f()}return mt(e,R,S)}function tn(e,t,n,d,b){return mt(e,t,n,d,b)}function nn(e){var t=e.name;return t.startsWith("gl_")||t.startsWith("webgl_")}var ca=/(\.|\[|]|\w+)/g,la=function(t){return t>="0"&&t<="9"};function yt(e,t,n,d){for(var b=e.split(ca).filter(function(Re){return Re!==""}),S=0,R="";;){var x=b[S++];R+=x;var M=la(x[0]),D=M?parseInt(x):x;M&&(R+=b[S++]);var V=S===b.length;if(V){n[D]=t;break}else{var fe=b[S++],ye=fe==="[",be=n[D]||(ye?[]:{});n[D]=be,n=be,d[R]=d[R]||function(Re){return function(Me){Gn(Re,Me)}}(be),R+=fe}}}function nt(e,t){var n=0;function d(ye,be,Re){var Me=be.name.endsWith("[0]"),Ie=be.type,je=Pe[Ie];if(!je)throw new Error("unknown type: 0x".concat(Ie.toString(16)));var Ye;if(je.bindPoint){var ir=n;n+=be.size,Me?Ye=je.arraySetter(e,Ie,ir,Re,be.size):Ye=je.setter(e,Ie,ir,Re,be.size)}else je.arraySetter&&Me?Ye=je.arraySetter(e,Re):Ye=je.setter(e,Re);return Ye.location=Re,Ye}for(var b={},S={},R=e.getProgramParameter(t,r),x=0;x<R;++x){var M=e.getActiveUniform(t,x);if(!nn(M)){var D=M.name;D.endsWith("[0]")&&(D=D.substr(0,D.length-3));var V=e.getUniformLocation(t,M.name);if(V){var fe=d(t,M,V);b[D]=fe,yt(D,fe,S,b)}}}return b}function Ot(e,t){for(var n={},d=e.getProgramParameter(t,c),b=0;b<d;++b){var S=e.getTransformFeedbackVarying(t,b);n[S.name]={index:b,type:S.type,size:S.size}}return n}function Mt(e,t,n){t.transformFeedbackInfo&&(t=t.transformFeedbackInfo),n.attribs&&(n=n.attribs);for(var d in n){var b=t[d];if(b){var S=n[d];S.offset?e.bindBufferRange(fr,b.index,S.buffer,S.offset,S.size):e.bindBufferBase(fr,b.index,S.buffer)}}}function an(e,t,n){var d=e.createTransformFeedback();return e.bindTransformFeedback(Tr,d),e.useProgram(t.program),Mt(e,t,n),e.bindTransformFeedback(Tr,null),d}function zr(e,t){for(var n=e.getProgramParameter(t,r),d=[],b=[],S=0;S<n;++S){b.push(S),d.push({});var R=e.getActiveUniform(t,S);d[S].name=R.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(ye){var be=ye[0],Re=ye[1];e.getActiveUniforms(t,b,e[be]).forEach(function(Me,Ie){d[Ie][Re]=Me})});for(var x={},M=e.getProgramParameter(t,E),D=0;D<M;++D){var V=e.getActiveUniformBlockName(t,D),fe={index:e.getUniformBlockIndex(t,V),usedByVertexShader:e.getActiveUniformBlockParameter(t,D,v),usedByFragmentShader:e.getActiveUniformBlockParameter(t,D,i),size:e.getActiveUniformBlockParameter(t,D,a),uniformIndices:e.getActiveUniformBlockParameter(t,D,m)};fe.used=fe.usedByVertexShader||fe.usedByFragmentShader,x[V]=fe}return{blockSpecs:x,uniformData:d}}var Nn=/\[\d+\]\.$/,sa=function(t,n){return((t+(n-1))/n|0)*n};function va(e,t,n,d){if(t||n){d=d||1;var b=e.length,S=b/4;return function(R){for(var x=0,M=0,D=0;D<S;++D){for(var V=0;V<d;++V)e[x++]=R[M++];x+=4-d}}}else return function(R){R.length?e.set(R):e[0]=R}}function on(e,t,n,d){var b=n.blockSpecs,S=n.uniformData,R=b[d];if(!R)return de("no uniform block object named:",d),{name:d,uniforms:{}};var x=new ArrayBuffer(R.size),M=e.createBuffer(),D=R.index;e.bindBuffer(Ke,M),e.uniformBlockBinding(t,R.index,D);var V=d+".";Nn.test(V)&&(V=V.replace(Nn,"."));var fe={},ye={},be={};return R.uniformIndices.forEach(function(Re){var Me=S[Re],Ie=Me.name;Ie.startsWith(V)&&(Ie=Ie.substr(V.length));var je=Ie.endsWith("[0]");je&&(Ie=Ie.substr(0,Ie.length-3));var Ye=Pe[Me.type],ir=Ye.Type,mr=je?sa(Ye.size,16)*Me.size:Ye.size*Me.size,xr=new ir(x,Me.offset,mr/ir.BYTES_PER_ELEMENT);fe[Ie]=xr;var Or=va(xr,je,Ye.rows,Ye.cols);ye[Ie]=Or,yt(Ie,Or,be,ye)}),{name:d,array:x,asFloat:new Float32Array(x),buffer:M,uniforms:fe,setters:ye}}function un(e,t,n){return on(e,t.program,t.uniformBlockSpec,n)}function Nt(e,t,n){var d=t.uniformBlockSpec||t,b=d.blockSpecs[n.name];if(b){var S=b.index;return e.bindBufferRange(Ke,S,n.buffer,n.offset||0,n.array.byteLength),!0}return!1}function Un(e,t,n){Nt(e,t,n)&&e.bufferData(Ke,n.array,We)}function ha(e,t){var n=e.setters;for(var d in t){var b=n[d];if(b){var S=t[d];b(S)}}}function Gn(e,t){for(var n in t){var d=e[n];typeof d=="function"?d(t[n]):Gn(e[n],t[n])}}function Ut(e){for(var t=e.uniformSetters||e,n=arguments.length<=1?0:arguments.length-1,d=0;d<n;++d){var b=d+1<1||arguments.length<=d+1?void 0:arguments[d+1];if(Array.isArray(b))for(var S=b.length,R=0;R<S;++R)Ut(t,b[R]);else for(var x in b){var M=t[x];M&&M(b[x])}}}o.setUniformsAndBindTextures=Ut;function fn(e,t){for(var n={},d=e.getProgramParameter(t,u),b=0;b<d;++b){var S=e.getActiveAttrib(t,b);if(!nn(S)){var R=e.getAttribLocation(t,S.name),x=rr[S.type],M=x.setter(e,R,x);M.location=R,n[S.name]=M}}return n}function cn(e,t){for(var n in t){var d=e[n];d&&d(t[n])}}function ma(e,t,n){n.vertexArrayObject?e.bindVertexArray(n.vertexArrayObject):(cn(t.attribSetters||t,n.attribs),n.indices&&e.bindBuffer(Je,n.indices))}function Gt(e,t){var n=nt(e,t),d=fn(e,t),b={program:t,uniformSetters:n,attribSetters:d};return G.isWebGL2(e)&&(b.uniformBlockSpec=zr(e,t),b.transformFeedbackInfo=Ot(e,t)),b}var ya=/\s|{|}|;/;function s(e,t,n,d,b){var S=Kr(n,d,b),R=[];if(t=t.map(function(D){if(!ya.test(D)){var V=_e(D);if(V)D=V.text;else{var fe="no element with id: ".concat(D);S.errorCallback(fe),R.push(fe)}}return D}),R.length)return Bt(S,"");var x=S.callback;x&&(S.callback=function(D,V){x(D,D?void 0:Gt(e,V))});var M=tn(e,t,S);return M?Gt(e,M):null}function y(e,t,n,d,b){for(var S=0,R=Object.entries(t);S<R.length;S++){var x=se(R[S],2),M=x[0],D=x[1],V=Te({},b),fe=n[M];Array.isArray(fe)||Object.assign(V,fe);var ye=en(e,D,V.errorCallback);if(ye){for(var be=0,Re=Object.values(t);be<Re.length;be++){var Me=Re[be],Ie=e.getAttachedShaders(Me);e.deleteProgram(Me);var je=or(Ie),Ye;try{for(je.s();!(Ye=je.n()).done;){var ir=Ye.value;d.has(ir)||e.deleteShader(ir)}}catch(mr){je.e(mr)}finally{je.f()}}return ye}}}function p(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},d=new Set,b=Object.fromEntries(Object.entries(t).map(function(R){var x=se(R,2),M=x[0],D=x[1],V=Te({},n),fe=Array.isArray(D)?D:D.shaders;return Array.isArray(D)||Object.assign(V,D),fe.forEach(d.add,d),[M,Mn(e,fe,V)]}));if(n.callback){tt(e,b).then(function(){var R=y(e,b,t,d,n);n.callback(R,R?void 0:b)});return}var S=y(e,b,t,d,n);return S?void 0:b}function g(e,t,n){n=Kr(n);function d(R,x){return Object.fromEntries(Object.entries(x).map(function(M){var D=se(M,2),V=D[0],fe=D[1];return[V,Gt(R,fe)]}))}var b=n.callback;b&&(n.callback=function(R,x){b(R,R?void 0:d(e,x))});var S=p(e,t,n);if(!(b||!S))return d(e,S)}o.createProgramsAsync=Yr(p),o.createProgramInfosAsync=Yr(g)},"./src/textures.js":(Q,o,Y)=>{function ae(s){"@babel/helpers - typeof";return ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},ae(s)}o.__esModule=!0,o.canFilter=On,o.canGenerateMipmap=Ln,o.createSampler=nn,o.createSamplers=ca,o.createTexture=cn,o.createTextures=ya,o.getBytesPerElementForInternalFormat=Kr,o.getFormatAndTypeForInternalFormat=qr,o.getNumComponentsForFormat=Mn,o.loadTextureFromUrl=Un,o.resizeTexture=ma,o.setDefaultTextureColor=Jt,o.setEmptyTexture=fn,o.setSamplerParameters=tn,o.setTextureDefaults_=$t,o.setTextureFilteringForSize=yt,o.setTextureFromArray=Ut,o.setTextureFromElement=an,o.setTextureParameters=rn;var G=oe(Y("./src/utils.js")),ie=oe(Y("./src/typedarrays.js")),q=oe(Y("./src/helper.js"));function j(s){if(typeof WeakMap!="function")return null;var y=new WeakMap,p=new WeakMap;return(j=function(e){return e?p:y})(s)}function oe(s,y){if(!y&&s&&s.__esModule)return s;if(s===null||ae(s)!="object"&&typeof s!="function")return{default:s};var p=j(y);if(p&&p.has(s))return p.get(s);var g={__proto__:null},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var t in s)if(t!=="default"&&Object.prototype.hasOwnProperty.call(s,t)){var n=e?Object.getOwnPropertyDescriptor(s,t):null;n&&(n.get||n.set)?Object.defineProperty(g,t,n):g[t]=s[t]}return g.default=s,p&&p.set(s,g),g}var Z={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},Te=ie.isArrayBuffer,F=function(){var s;return function(){return s=s||(typeof document<"u"&&document.createElement?document.createElement("canvas").getContext("2d"):null),s}}(),z=6406,H=6407,P=6408,W=6409,se=6410,Se=6402,Ge=34041,Ce=33071,or=9728,ur=9729,er=3553,me=34067,w=32879,B=35866,N=34069,A=34070,de=34071,_e=34072,Fe=34073,We=34074,Ue=10241,Je=10240,Ke=10242,fr=10243,Tr=32882,cr=33082,ar=33083,vr=33084,Sr=33085,ce=34892,r=34893,u=3317,c=3314,E=32878,v=3316,i=3315,a=32877,m=37443,h=37441,T=37440,_=33321,I=36756,L=33325,K=33326,J=33330,ee=33329,ue=33338,ne=33337,ve=33340,he=33339,te=33323,pe=36757,Oe=33327,qe=33328,ke=33336,Ve=33335,xe=33332,De=33331,Ze=33334,Xe=33333,Qe=32849,He=35905,$e=36194,Be=36758,Ne=35898,yr=35901,lr=34843,gr=34837,_r=36221,Lr=36239,Ur=36215,Gr=36233,et=36209,At=36227,_t=32856,xt=35907,hr=36759,ta=32855,Pt=32854,wt=32857,zt=34842,Ct=34836,Pe=36220,_n=36238,na=36975,aa=36214,ia=36232,oa=36226,ua=36208,xn=33189,Pn=33190,wn=36012,Cn=36013,Rn=35056,kr=5120,tr=5121,Rt=5122,rt=5123,Ft=5124,Wr=5125,pr=5126,Fn=32819,Dn=32820,Bn=33635,Rr=5131,ht=36193,Qt=33640,fa=35899,br=35902,Er=36269,Dt=34042,wr=33319,Dr=33320,Xr=6403,rr=36244,Hr=36248,jr=36249,Zt={};{var dr=Zt;dr[z]={numColorComponents:1},dr[W]={numColorComponents:1},dr[se]={numColorComponents:2},dr[H]={numColorComponents:3},dr[P]={numColorComponents:4},dr[Xr]={numColorComponents:1},dr[rr]={numColorComponents:1},dr[wr]={numColorComponents:2},dr[Dr]={numColorComponents:2},dr[H]={numColorComponents:3},dr[Hr]={numColorComponents:3},dr[P]={numColorComponents:4},dr[jr]={numColorComponents:4},dr[Se]={numColorComponents:1},dr[Ge]={numColorComponents:2}}var Bt;function It(s){if(!Bt){var y={};y[z]={textureFormat:z,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[tr,Rr,ht,pr]},y[W]={textureFormat:W,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[tr,Rr,ht,pr]},y[se]={textureFormat:se,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[tr,Rr,ht,pr]},y[H]={textureFormat:H,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[tr,Rr,ht,pr,Bn]},y[P]={textureFormat:P,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[tr,Rr,ht,pr,Fn,Dn]},y[Se]={textureFormat:Se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[Wr,rt]},y[_]={textureFormat:Xr,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[tr]},y[I]={textureFormat:Xr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[kr]},y[L]={textureFormat:Xr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[pr,Rr]},y[K]={textureFormat:Xr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[pr]},y[J]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[tr]},y[ee]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[kr]},y[xe]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[rt]},y[De]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[Rt]},y[Ze]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Wr]},y[Xe]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Ft]},y[te]={textureFormat:wr,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[tr]},y[pe]={textureFormat:wr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[kr]},y[Oe]={textureFormat:wr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[pr,Rr]},y[qe]={textureFormat:wr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[pr]},y[ke]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[tr]},y[Ve]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[kr]},y[ue]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[rt]},y[ne]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Rt]},y[ve]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Wr]},y[he]={textureFormat:Dr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Ft]},y[Qe]={textureFormat:H,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[tr]},y[He]={textureFormat:H,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[tr]},y[$e]={textureFormat:H,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[tr,Bn]},y[Be]={textureFormat:H,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[kr]},y[Ne]={textureFormat:H,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[pr,Rr,fa]},y[yr]={textureFormat:H,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[pr,Rr,br]},y[lr]={textureFormat:H,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[pr,Rr]},y[gr]={textureFormat:H,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[pr]},y[_r]={textureFormat:Hr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[tr]},y[Lr]={textureFormat:Hr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[kr]},y[Ur]={textureFormat:Hr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[rt]},y[Gr]={textureFormat:Hr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[Rt]},y[et]={textureFormat:Hr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[Wr]},y[At]={textureFormat:Hr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[Ft]},y[_t]={textureFormat:P,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[tr]},y[xt]={textureFormat:P,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[tr]},y[hr]={textureFormat:P,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[kr]},y[ta]={textureFormat:P,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[tr,Dn,Qt]},y[Pt]={textureFormat:P,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[tr,Fn]},y[wt]={textureFormat:P,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[Qt]},y[zt]={textureFormat:P,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[pr,Rr]},y[Ct]={textureFormat:P,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[pr]},y[Pe]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[tr]},y[_n]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[kr]},y[na]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Qt]},y[aa]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[rt]},y[ia]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Rt]},y[oa]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[Ft]},y[ua]={textureFormat:jr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[Wr]},y[xn]={textureFormat:Se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[rt,Wr]},y[Pn]={textureFormat:Se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Wr]},y[wn]={textureFormat:Se,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[pr]},y[Rn]={textureFormat:Ge,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Dt]},y[Cn]={textureFormat:Ge,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Er]},Object.keys(y).forEach(function(p){var g=y[p];g.bytesPerElementMap={},g.bytesPerElement.forEach(function(e,t){var n=g.type[t];g.bytesPerElementMap[n]=e})}),Bt=y}return Bt[s]}function Kr(s,y){var p=It(s);if(!p)throw"unknown internal format";var g=p.bytesPerElementMap[y];if(g===void 0)throw"unknown internal format";return g}function qr(s){var y=It(s);if(!y)throw"unknown internal format";return{format:y.textureFormat,type:y.type[0]}}function In(s){return(s&s-1)===0}function Ln(s,y,p,g){if(!G.isWebGL2(s))return In(y)&&In(p);var e=It(g);if(!e)throw"unknown internal format";return e.colorRenderable&&e.textureFilterable}function On(s){var y=It(s);if(!y)throw"unknown internal format";return y.textureFilterable}function Mn(s){var y=Zt[s];if(!y)throw"unknown format: "+s;return y.numColorComponents}function mt(s,y,p){return Te(y)?ie.getGLTypeForTypedArray(y):p||tr}function Yr(s,y,p,g,e){if(e%1!==0)throw"can't guess dimensions";if(!p&&!g){var t=Math.sqrt(e/(y===me?6:1));t%1===0?(p=t,g=t):(p=e,g=1)}else if(g){if(!p&&(p=e/g,p%1))throw"can't guess dimensions"}else if(g=e/p,g%1)throw"can't guess dimensions";return{width:p,height:g}}function Jt(s){Z.textureColor=new Uint8Array([s[0]*255,s[1]*255,s[2]*255,s[3]*255])}function $t(s){q.copyExistingProperties(s,Z),s.textureColor&&Jt(s.textureColor)}function tt(s,y){y.colorspaceConversion!==void 0&&s.pixelStorei(m,y.colorspaceConversion),y.premultiplyAlpha!==void 0&&s.pixelStorei(h,y.premultiplyAlpha),y.flipY!==void 0&&s.pixelStorei(T,y.flipY)}function Lt(s){s.pixelStorei(u,4),G.isWebGL2(s)&&(s.pixelStorei(c,0),s.pixelStorei(E,0),s.pixelStorei(v,0),s.pixelStorei(i,0),s.pixelStorei(a,0))}function en(s,y,p,g){g.minMag&&(p.call(s,y,Ue,g.minMag),p.call(s,y,Je,g.minMag)),g.min&&p.call(s,y,Ue,g.min),g.mag&&p.call(s,y,Je,g.mag),g.wrap&&(p.call(s,y,Ke,g.wrap),p.call(s,y,fr,g.wrap),(y===w||q.isSampler(s,y))&&p.call(s,y,Tr,g.wrap)),g.wrapR&&p.call(s,y,Tr,g.wrapR),g.wrapS&&p.call(s,y,Ke,g.wrapS),g.wrapT&&p.call(s,y,fr,g.wrapT),g.minLod!==void 0&&p.call(s,y,cr,g.minLod),g.maxLod!==void 0&&p.call(s,y,ar,g.maxLod),g.baseLevel!==void 0&&p.call(s,y,vr,g.baseLevel),g.maxLevel!==void 0&&p.call(s,y,Sr,g.maxLevel),g.compareFunc!==void 0&&p.call(s,y,r,g.compareFunc),g.compareMode!==void 0&&p.call(s,y,ce,g.compareMode)}function rn(s,y,p){var g=p.target||er;s.bindTexture(g,y),en(s,g,s.texParameteri,p)}function tn(s,y,p){en(s,y,s.samplerParameteri,p)}function nn(s,y){var p=s.createSampler();return tn(s,p,y),p}function ca(s,y){var p={};return Object.keys(y).forEach(function(g){p[g]=nn(s,y[g])}),p}function la(s){return s=s||Z.textureColor,Te(s)?s:new Uint8Array([s[0]*255,s[1]*255,s[2]*255,s[3]*255])}function yt(s,y,p,g,e,t){p=p||Z.textureOptions,t=t||P;var n=p.target||er;if(g=g||p.width,e=e||p.height,s.bindTexture(n,y),Ln(s,g,e,t))s.generateMipmap(n);else{var d=On(t)?ur:or;s.texParameteri(n,Ue,d),s.texParameteri(n,Je,d),s.texParameteri(n,Ke,Ce),s.texParameteri(n,fr,Ce)}}function nt(s){return s.auto===!0||s.auto===void 0&&s.level===void 0}function Ot(s,y){return y=y||{},y.cubeFaceOrder||[N,A,de,_e,Fe,We]}function Mt(s,y){var p=Ot(s,y),g=p.map(function(e,t){return{face:e,ndx:t}});return g.sort(function(e,t){return e.face-t.face}),g}function an(s,y,p,g){g=g||Z.textureOptions;var e=g.target||er,t=g.level||0,n=p.width,d=p.height,b=g.internalFormat||g.format||P,S=qr(b),R=g.format||S.format,x=g.type||S.type;if(tt(s,g),s.bindTexture(e,y),e===me){var M=p.width,D=p.height,V,fe;if(M/6===D)V=D,fe=[0,0,1,0,2,0,3,0,4,0,5,0];else if(D/6===M)V=M,fe=[0,0,0,1,0,2,0,3,0,4,0,5];else if(M/3===D/2)V=M/3,fe=[0,0,1,0,2,0,0,1,1,1,2,1];else if(M/2===D/3)V=M/2,fe=[0,0,1,0,0,1,1,1,0,2,1,2];else throw"can't figure out cube map from element: "+(p.src?p.src:p.nodeName);var ye=F();ye?(ye.canvas.width=V,ye.canvas.height=V,n=V,d=V,Mt(s,g).forEach(function(xr){var Or=fe[xr.ndx*2+0]*V,Vr=fe[xr.ndx*2+1]*V;ye.drawImage(p,Or,Vr,V,V,0,0,V,V),s.texImage2D(xr.face,t,b,R,x,ye.canvas)}),ye.canvas.width=1,ye.canvas.height=1):typeof createImageBitmap<"u"&&(n=V,d=V,Mt(s,g).forEach(function(xr){var Or=fe[xr.ndx*2+0]*V,Vr=fe[xr.ndx*2+1]*V;s.texImage2D(xr.face,t,b,V,V,0,R,x,null),createImageBitmap(p,Or,Vr,V,V,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(function(kn){tt(s,g),s.bindTexture(e,y),s.texImage2D(xr.face,t,b,R,x,kn),nt(g)&&yt(s,y,g,n,d,b)})}))}else if(e===w||e===B){var be=Math.min(p.width,p.height),Re=Math.max(p.width,p.height),Me=Re/be;if(Me%1!==0)throw"can not compute 3D dimensions of element";var Ie=p.width===Re?1:0,je=p.height===Re?1:0;s.pixelStorei(u,1),s.pixelStorei(c,p.width),s.pixelStorei(E,0),s.pixelStorei(a,0),s.texImage3D(e,t,b,be,be,be,0,R,x,null);for(var Ye=0;Ye<Me;++Ye){var ir=Ye*be*Ie,mr=Ye*be*je;s.pixelStorei(v,ir),s.pixelStorei(i,mr),s.texSubImage3D(e,t,0,0,Ye,be,be,1,R,x,p)}Lt(s)}else s.texImage2D(e,t,b,R,x,p);nt(g)&&yt(s,y,g,n,d,b),rn(s,y,g)}function zr(){}function Nn(s){if(typeof document<"u"){var y=document.createElement("a");return y.href=s,y.hostname===location.hostname&&y.port===location.port&&y.protocol===location.protocol}else{var p=new URL(location.href).origin,g=new URL(s,location.href).origin;return g===p}}function sa(s,y){return y===void 0&&!Nn(s)?"anonymous":y}function va(s,y,p){p=p||zr;var g;if(y=y!==void 0?y:Z.crossOrigin,y=sa(s,y),typeof Image<"u"){g=new Image,y!==void 0&&(g.crossOrigin=y);var e=function(){g.removeEventListener("error",t),g.removeEventListener("load",n),g=null},t=function(){var M="couldn't load image: "+s;q.error(M),p(M,g),e()},n=function(){p(null,g),e()};return g.addEventListener("error",t),g.addEventListener("load",n),g.src=s,g}else if(typeof ImageBitmap<"u"){var d,b,S=function(){p(d,b)},R={};y&&(R.mode="cors"),fetch(s,R).then(function(x){if(!x.ok)throw x;return x.blob()}).then(function(x){return createImageBitmap(x,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}).then(function(x){b=x,setTimeout(S)}).catch(function(x){d=x,setTimeout(S)}),g=null}return g}function on(s){return typeof ImageBitmap<"u"&&s instanceof ImageBitmap||typeof ImageData<"u"&&s instanceof ImageData||typeof HTMLElement<"u"&&s instanceof HTMLElement}function un(s,y,p){return on(s)?(setTimeout(function(){p(null,s)}),s):va(s,y,p)}function Nt(s,y,p){p=p||Z.textureOptions;var g=p.target||er;if(s.bindTexture(g,y),p.color!==!1){var e=la(p.color);if(g===me)for(var t=0;t<6;++t)s.texImage2D(N+t,0,P,1,1,0,P,tr,e);else g===w||g===B?s.texImage3D(g,0,P,1,1,1,0,P,tr,e):s.texImage2D(g,0,P,1,1,0,P,tr,e)}}function Un(s,y,p,g){g=g||zr,p=p||Z.textureOptions,Nt(s,y,p),p=Object.assign({},p);var e=un(p.src,p.crossOrigin,function(t,n){t?g(t,y,n):(an(s,y,n,p),g(null,y,n))});return e}function ha(s,y,p,g){g=g||zr;var e=p.src;if(e.length!==6)throw"there must be 6 urls for a cubemap";var t=p.level||0,n=p.internalFormat||p.format||P,d=qr(n),b=p.format||d.format,S=p.type||tr,R=p.target||er;if(R!==me)throw"target must be TEXTURE_CUBE_MAP";Nt(s,y,p),p=Object.assign({},p);var x=6,M=[],D=Ot(s,p),V;function fe(ye){return function(be,Re){--x,be?M.push(be):Re.width!==Re.height?M.push("cubemap face img is not a square: "+Re.src):(tt(s,p),s.bindTexture(R,y),x===5?Ot().forEach(function(Me){s.texImage2D(Me,t,n,b,S,Re)}):s.texImage2D(ye,t,n,b,S,Re),nt(p)&&s.generateMipmap(R)),x===0&&g(M.length?M:void 0,y,V)}}V=e.map(function(ye,be){return un(ye,p.crossOrigin,fe(D[be]))})}function Gn(s,y,p,g){g=g||zr;var e=p.src,t=p.internalFormat||p.format||P,n=qr(t),d=p.format||n.format,b=p.type||tr,S=p.target||B;if(S!==w&&S!==B)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";Nt(s,y,p),p=Object.assign({},p);var R=e.length,x=[],M,D=p.level||0,V=p.width,fe=p.height,ye=e.length,be=!0;function Re(Me){return function(Ie,je){if(--R,Ie)x.push(Ie);else{if(tt(s,p),s.bindTexture(S,y),be){be=!1,V=p.width||je.width,fe=p.height||je.height,s.texImage3D(S,D,t,V,fe,ye,0,d,b,null);for(var Ye=0;Ye<ye;++Ye)s.texSubImage3D(S,D,0,0,Ye,V,fe,1,d,b,je)}else{var ir=je,mr;(je.width!==V||je.height!==fe)&&(mr=F(),ir=mr.canvas,mr.canvas.width=V,mr.canvas.height=fe,mr.drawImage(je,0,0,V,fe)),s.texSubImage3D(S,D,0,0,Me,V,fe,1,d,b,ir),mr&&ir===mr.canvas&&(mr.canvas.width=0,mr.canvas.height=0)}nt(p)&&s.generateMipmap(S)}R===0&&g(x.length?x:void 0,y,M)}}M=e.map(function(Me,Ie){return un(Me,p.crossOrigin,Re(Ie))})}function Ut(s,y,p,g){g=g||Z.textureOptions;var e=g.target||er;s.bindTexture(e,y);var t=g.width,n=g.height,d=g.depth,b=g.level||0,S=g.internalFormat||g.format||P,R=qr(S),x=g.format||R.format,M=g.type||mt(s,p,R.type);if(Te(p))p instanceof Uint8ClampedArray&&(p=new Uint8Array(p.buffer));else{var D=ie.getTypedArrayTypeForGLType(M);p=new D(p)}var V=Kr(S,M),fe=p.byteLength/V;if(fe%1)throw"length wrong size for format: "+G.glEnumToString(s,x);var ye;if(e===w||e===B)if(!t&&!n&&!d){var be=Math.cbrt(fe);if(be%1!==0)throw"can't guess cube size of array of numElements: "+fe;t=be,n=be,d=be}else t&&(!n||!d)?(ye=Yr(s,e,n,d,fe/t),n=ye.width,d=ye.height):n&&(!t||!d)?(ye=Yr(s,e,t,d,fe/n),t=ye.width,d=ye.height):(ye=Yr(s,e,t,n,fe/d),t=ye.width,n=ye.height);else ye=Yr(s,e,t,n,fe),t=ye.width,n=ye.height;if(Lt(s),s.pixelStorei(u,g.unpackAlignment||1),tt(s,g),e===me){var Re=V/p.BYTES_PER_ELEMENT,Me=fe/6*Re;Mt(s,g).forEach(function(Ie){var je=Me*Ie.ndx,Ye=p.subarray(je,je+Me);s.texImage2D(Ie.face,b,S,t,n,0,x,M,Ye)})}else e===w||e===B?s.texImage3D(e,b,S,t,n,d,0,x,M,p):s.texImage2D(e,b,S,t,n,0,x,M,p);return{width:t,height:n,depth:d,type:M}}function fn(s,y,p){var g=p.target||er;s.bindTexture(g,y);var e=p.level||0,t=p.internalFormat||p.format||P,n=qr(t),d=p.format||n.format,b=p.type||n.type;if(tt(s,p),g===me)for(var S=0;S<6;++S)s.texImage2D(N+S,e,t,p.width,p.height,0,d,b,null);else g===w||g===B?s.texImage3D(g,e,t,p.width,p.height,p.depth,0,d,b,null):s.texImage2D(g,e,t,p.width,p.height,0,d,b,null)}function cn(s,y,p){p=p||zr,y=y||Z.textureOptions;var g=s.createTexture(),e=y.target||er,t=y.width||1,n=y.height||1,d=y.internalFormat||P;s.bindTexture(e,g),e===me&&(s.texParameteri(e,Ke,Ce),s.texParameteri(e,fr,Ce));var b=y.src;if(b)if(typeof b=="function"&&(b=b(s,y)),typeof b=="string")Un(s,g,y,p);else if(Te(b)||Array.isArray(b)&&(typeof b[0]=="number"||Array.isArray(b[0])||Te(b[0]))){var S=Ut(s,g,b,y);t=S.width,n=S.height}else Array.isArray(b)&&(typeof b[0]=="string"||on(b[0]))?e===me?ha(s,g,y,p):Gn(s,g,y,p):(an(s,g,b,y),t=b.width,n=b.height);else fn(s,g,y);return nt(y)&&yt(s,g,y,t,n,d),rn(s,g,y),g}function ma(s,y,p,g,e,t){g=g||p.width,e=e||p.height,t=t||p.depth;var n=p.target||er;s.bindTexture(n,y);var d=p.level||0,b=p.internalFormat||p.format||P,S=qr(b),R=p.format||S.format,x,M=p.src;if(M&&(Te(M)||Array.isArray(M)&&typeof M[0]=="number")?x=p.type||mt(s,M,S.type):x=p.type||S.type,n===me)for(var D=0;D<6;++D)s.texImage2D(N+D,d,b,g,e,0,R,x,null);else n===w||n===B?s.texImage3D(n,d,b,g,e,t,0,R,x,null):s.texImage2D(n,d,b,g,e,0,R,x,null)}function Gt(s){return typeof s=="string"||Array.isArray(s)&&typeof s[0]=="string"}function ya(s,y,p){p=p||zr;var g=0,e=[],t={},n={};function d(){g===0&&setTimeout(function(){p(e.length?e:void 0,t,n)},0)}return Object.keys(y).forEach(function(b){var S=y[b],R;Gt(S.src)&&(R=function(M,D,V){n[b]=V,--g,M&&e.push(M),d()},++g),t[b]=cn(s,S,R)}),d(),t}},"./src/twgl-full.js":(Q,o,Y)=>{function ae(F){"@babel/helpers - typeof";return ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(z){return typeof z}:function(z){return z&&typeof Symbol=="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z},ae(F)}o.__esModule=!0;var G={m4:!0,v3:!0,primitives:!0};o.v3=o.primitives=o.m4=void 0;var ie=Te(Y("./src/m4.js"));o.m4=ie;var q=Te(Y("./src/v3.js"));o.v3=q;var j=Te(Y("./src/primitives.js"));o.primitives=j;var oe=Y("./src/twgl.js");Object.keys(oe).forEach(function(F){F==="default"||F==="__esModule"||Object.prototype.hasOwnProperty.call(G,F)||F in o&&o[F]===oe[F]||(o[F]=oe[F])});function Z(F){if(typeof WeakMap!="function")return null;var z=new WeakMap,H=new WeakMap;return(Z=function(W){return W?H:z})(F)}function Te(F,z){if(!z&&F&&F.__esModule)return F;if(F===null||ae(F)!="object"&&typeof F!="function")return{default:F};var H=Z(z);if(H&&H.has(F))return H.get(F);var P={__proto__:null},W=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var se in F)if(se!=="default"&&Object.prototype.hasOwnProperty.call(F,se)){var Se=W?Object.getOwnPropertyDescriptor(F,se):null;Se&&(Se.get||Se.set)?Object.defineProperty(P,se,Se):P[se]=F[se]}return P.default=F,H&&H.set(F,P),P}},"./src/twgl.js":(Q,o,Y)=>{function ae(A){"@babel/helpers - typeof";return ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(de){return typeof de}:function(de){return de&&typeof Symbol=="function"&&de.constructor===Symbol&&de!==Symbol.prototype?"symbol":typeof de},ae(A)}o.__esModule=!0;var G={addExtensionsToContext:!0,getContext:!0,getWebGLContext:!0,resizeCanvasToDisplaySize:!0,setDefaults:!0,attributes:!0,textures:!0,utils:!0,draw:!0,framebuffers:!0,programs:!0,typedarrays:!0,vertexArrays:!0};o.addExtensionsToContext=ur,o.framebuffers=o.draw=o.attributes=void 0,o.getContext=B,o.getWebGLContext=me,o.programs=void 0,o.resizeCanvasToDisplaySize=N,o.setDefaults=Se,o.vertexArrays=o.utils=o.typedarrays=o.textures=void 0;var ie=W(Y("./src/attributes.js"));o.attributes=ie,Object.keys(ie).forEach(function(A){A==="default"||A==="__esModule"||Object.prototype.hasOwnProperty.call(G,A)||A in o&&o[A]===ie[A]||(o[A]=ie[A])});var q=W(Y("./src/textures.js"));o.textures=q,Object.keys(q).forEach(function(A){A==="default"||A==="__esModule"||Object.prototype.hasOwnProperty.call(G,A)||A in o&&o[A]===q[A]||(o[A]=q[A])});var j=W(Y("./src/helper.js")),oe=W(Y("./src/utils.js"));o.utils=oe,Object.keys(oe).forEach(function(A){A==="default"||A==="__esModule"||Object.prototype.hasOwnProperty.call(G,A)||A in o&&o[A]===oe[A]||(o[A]=oe[A])});var Z=W(Y("./src/draw.js"));o.draw=Z,Object.keys(Z).forEach(function(A){A==="default"||A==="__esModule"||Object.prototype.hasOwnProperty.call(G,A)||A in o&&o[A]===Z[A]||(o[A]=Z[A])});var Te=W(Y("./src/framebuffers.js"));o.framebuffers=Te,Object.keys(Te).forEach(function(A){A==="default"||A==="__esModule"||Object.prototype.hasOwnProperty.call(G,A)||A in o&&o[A]===Te[A]||(o[A]=Te[A])});var F=W(Y("./src/programs.js"));o.programs=F,Object.keys(F).forEach(function(A){A==="default"||A==="__esModule"||Object.prototype.hasOwnProperty.call(G,A)||A in o&&o[A]===F[A]||(o[A]=F[A])});var z=W(Y("./src/typedarrays.js"));o.typedarrays=z,Object.keys(z).forEach(function(A){A==="default"||A==="__esModule"||Object.prototype.hasOwnProperty.call(G,A)||A in o&&o[A]===z[A]||(o[A]=z[A])});var H=W(Y("./src/vertex-arrays.js"));o.vertexArrays=H,Object.keys(H).forEach(function(A){A==="default"||A==="__esModule"||Object.prototype.hasOwnProperty.call(G,A)||A in o&&o[A]===H[A]||(o[A]=H[A])});function P(A){if(typeof WeakMap!="function")return null;var de=new WeakMap,_e=new WeakMap;return(P=function(We){return We?_e:de})(A)}function W(A,de){if(!de&&A&&A.__esModule)return A;if(A===null||ae(A)!="object"&&typeof A!="function")return{default:A};var _e=P(de);if(_e&&_e.has(A))return _e.get(A);var Fe={__proto__:null},We=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Ue in A)if(Ue!=="default"&&Object.prototype.hasOwnProperty.call(A,Ue)){var Je=We?Object.getOwnPropertyDescriptor(A,Ue):null;Je&&(Je.get||Je.set)?Object.defineProperty(Fe,Ue,Je):Fe[Ue]=A[Ue]}return Fe.default=A,_e&&_e.set(A,Fe),Fe}var se={addExtensionsToContext:!0};function Se(A){j.copyExistingProperties(A,se),ie.setAttributeDefaults_(A),q.setTextureDefaults_(A)}var Ge=/^(.*?)_/;function Ce(A,de){oe.glEnumToString(A,0);var _e=A.getExtension(de);if(_e){var Fe={},We=Ge.exec(de)[1],Ue="_"+We;for(var Je in _e){var Ke=_e[Je],fr=typeof Ke=="function",Tr=fr?We:Ue,cr=Je;Je.endsWith(Tr)&&(cr=Je.substring(0,Je.length-Tr.length)),A[cr]!==void 0?!fr&&A[cr]!==Ke&&j.warn(cr,A[cr],Ke,Je):fr?A[cr]=function(ar){return function(){return ar.apply(_e,arguments)}}(Ke):(A[cr]=Ke,Fe[cr]=Ke)}Fe.constructor={name:_e.constructor.name},oe.glEnumToString(Fe,0)}return _e}var or=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_depth_texture","WEBGL_draw_buffers"];function ur(A){for(var de=0;de<or.length;++de)Ce(A,or[de])}function er(A,de){for(var _e=["webgl","experimental-webgl"],Fe=null,We=0;We<_e.length;++We)if(Fe=A.getContext(_e[We],de),Fe){se.addExtensionsToContext&&ur(Fe);break}return Fe}function me(A,de){var _e=er(A,de);return _e}function w(A,de){for(var _e=["webgl2","webgl","experimental-webgl"],Fe=null,We=0;We<_e.length;++We)if(Fe=A.getContext(_e[We],de),Fe){se.addExtensionsToContext&&ur(Fe);break}return Fe}function B(A,de){var _e=w(A,de);return _e}function N(A,de){de=de||1,de=Math.max(0,de);var _e=A.clientWidth*de|0,Fe=A.clientHeight*de|0;return A.width!==_e||A.height!==Fe?(A.width=_e,A.height=Fe,!0):!1}},"./src/typedarrays.js":(Q,o)=>{o.__esModule=!0,o.getGLTypeForTypedArray=or,o.getGLTypeForTypedArrayType=ur,o.getTypedArrayTypeForGLType=er,o.isArrayBuffer=void 0;var Y=5120,ae=5121,G=5122,ie=5123,q=5124,j=5125,oe=5126,Z=32819,Te=32820,F=33635,z=5131,H=33640,P=35899,W=35902,se=36269,Se=34042,Ge={};{var Ce=Ge;Ce[Y]=Int8Array,Ce[ae]=Uint8Array,Ce[G]=Int16Array,Ce[ie]=Uint16Array,Ce[q]=Int32Array,Ce[j]=Uint32Array,Ce[oe]=Float32Array,Ce[Z]=Uint16Array,Ce[Te]=Uint16Array,Ce[F]=Uint16Array,Ce[z]=Uint16Array,Ce[H]=Uint32Array,Ce[P]=Uint32Array,Ce[W]=Uint32Array,Ce[se]=Uint32Array,Ce[Se]=Uint32Array}function or(me){if(me instanceof Int8Array)return Y;if(me instanceof Uint8Array||me instanceof Uint8ClampedArray)return ae;if(me instanceof Int16Array)return G;if(me instanceof Uint16Array)return ie;if(me instanceof Int32Array)return q;if(me instanceof Uint32Array)return j;if(me instanceof Float32Array)return oe;throw new Error("unsupported typed array type")}function ur(me){if(me===Int8Array)return Y;if(me===Uint8Array||me===Uint8ClampedArray)return ae;if(me===Int16Array)return G;if(me===Uint16Array)return ie;if(me===Int32Array)return q;if(me===Uint32Array)return j;if(me===Float32Array)return oe;throw new Error("unsupported typed array type")}function er(me){var w=Ge[me];if(!w)throw new Error("unknown gl type");return w}o.isArrayBuffer=typeof SharedArrayBuffer<"u"?function(w){return w&&w.buffer&&(w.buffer instanceof ArrayBuffer||w.buffer instanceof SharedArrayBuffer)}:function(w){return w&&w.buffer&&w.buffer instanceof ArrayBuffer}},"./src/utils.js":(Q,o)=>{o.__esModule=!0,o.glEnumToString=void 0,o.isWebGL1=ae,o.isWebGL2=Y;function Y(G){return!!G.texStorage2D}function ae(G){return!G.texStorage2D}o.glEnumToString=function(){var G={},ie={};function q(j){var oe=j.constructor.name;if(!G[oe]){for(var Z in j)if(typeof j[Z]=="number"){var Te=ie[j[Z]];ie[j[Z]]=Te?"".concat(Te," | ").concat(Z):Z}G[oe]=!0}}return function(oe,Z){return q(oe),ie[Z]||(typeof Z=="number"?"0x".concat(Z.toString(16)):Z)}}()},"./src/v3.js":(Q,o)=>{o.__esModule=!0,o.add=ie,o.copy=ur,o.create=G,o.cross=H,o.distance=Se,o.distanceSq=Ge,o.divScalar=z,o.divide=me,o.dot=P,o.length=W,o.lengthSq=se,o.lerp=j,o.lerpV=oe,o.max=Z,o.min=Te,o.mulScalar=F,o.multiply=er,o.negate=or,o.normalize=Ce,o.setDefaultType=ae,o.subtract=q;var Y=Float32Array;function ae(w){var B=Y;return Y=w,B}function G(w,B,N){var A=new Y(3);return w&&(A[0]=w),B&&(A[1]=B),N&&(A[2]=N),A}function ie(w,B,N){return N=N||new Y(3),N[0]=w[0]+B[0],N[1]=w[1]+B[1],N[2]=w[2]+B[2],N}function q(w,B,N){return N=N||new Y(3),N[0]=w[0]-B[0],N[1]=w[1]-B[1],N[2]=w[2]-B[2],N}function j(w,B,N,A){return A=A||new Y(3),A[0]=w[0]+N*(B[0]-w[0]),A[1]=w[1]+N*(B[1]-w[1]),A[2]=w[2]+N*(B[2]-w[2]),A}function oe(w,B,N,A){return A=A||new Y(3),A[0]=w[0]+N[0]*(B[0]-w[0]),A[1]=w[1]+N[1]*(B[1]-w[1]),A[2]=w[2]+N[2]*(B[2]-w[2]),A}function Z(w,B,N){return N=N||new Y(3),N[0]=Math.max(w[0],B[0]),N[1]=Math.max(w[1],B[1]),N[2]=Math.max(w[2],B[2]),N}function Te(w,B,N){return N=N||new Y(3),N[0]=Math.min(w[0],B[0]),N[1]=Math.min(w[1],B[1]),N[2]=Math.min(w[2],B[2]),N}function F(w,B,N){return N=N||new Y(3),N[0]=w[0]*B,N[1]=w[1]*B,N[2]=w[2]*B,N}function z(w,B,N){return N=N||new Y(3),N[0]=w[0]/B,N[1]=w[1]/B,N[2]=w[2]/B,N}function H(w,B,N){N=N||new Y(3);var A=w[2]*B[0]-w[0]*B[2],de=w[0]*B[1]-w[1]*B[0];return N[0]=w[1]*B[2]-w[2]*B[1],N[1]=A,N[2]=de,N}function P(w,B){return w[0]*B[0]+w[1]*B[1]+w[2]*B[2]}function W(w){return Math.sqrt(w[0]*w[0]+w[1]*w[1]+w[2]*w[2])}function se(w){return w[0]*w[0]+w[1]*w[1]+w[2]*w[2]}function Se(w,B){var N=w[0]-B[0],A=w[1]-B[1],de=w[2]-B[2];return Math.sqrt(N*N+A*A+de*de)}function Ge(w,B){var N=w[0]-B[0],A=w[1]-B[1],de=w[2]-B[2];return N*N+A*A+de*de}function Ce(w,B){B=B||new Y(3);var N=w[0]*w[0]+w[1]*w[1]+w[2]*w[2],A=Math.sqrt(N);return A>1e-5?(B[0]=w[0]/A,B[1]=w[1]/A,B[2]=w[2]/A):(B[0]=0,B[1]=0,B[2]=0),B}function or(w,B){return B=B||new Y(3),B[0]=-w[0],B[1]=-w[1],B[2]=-w[2],B}function ur(w,B){return B=B||new Y(3),B[0]=w[0],B[1]=w[1],B[2]=w[2],B}function er(w,B,N){return N=N||new Y(3),N[0]=w[0]*B[0],N[1]=w[1]*B[1],N[2]=w[2]*B[2],N}function me(w,B,N){return N=N||new Y(3),N[0]=w[0]/B[0],N[1]=w[1]/B[1],N[2]=w[2]/B[2],N}},"./src/vertex-arrays.js":(Q,o,Y)=>{function ae(F){"@babel/helpers - typeof";return ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(z){return typeof z}:function(z){return z&&typeof Symbol=="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z},ae(F)}o.__esModule=!0,o.createVAOAndSetAttributes=Z,o.createVAOFromBufferInfo=Te,o.createVertexArrayInfo=oe;var G=q(Y("./src/programs.js"));function ie(F){if(typeof WeakMap!="function")return null;var z=new WeakMap,H=new WeakMap;return(ie=function(W){return W?H:z})(F)}function q(F,z){if(!z&&F&&F.__esModule)return F;if(F===null||ae(F)!="object"&&typeof F!="function")return{default:F};var H=ie(z);if(H&&H.has(F))return H.get(F);var P={__proto__:null},W=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var se in F)if(se!=="default"&&Object.prototype.hasOwnProperty.call(F,se)){var Se=W?Object.getOwnPropertyDescriptor(F,se):null;Se&&(Se.get||Se.set)?Object.defineProperty(P,se,Se):P[se]=F[se]}return P.default=F,H&&H.set(F,P),P}var j=34963;function oe(F,z,H){var P=F.createVertexArray();return F.bindVertexArray(P),z.length||(z=[z]),z.forEach(function(W){G.setBuffersAndAttributes(F,W,H)}),F.bindVertexArray(null),{numElements:H.numElements,elementType:H.elementType,vertexArrayObject:P}}function Z(F,z,H,P){var W=F.createVertexArray();return F.bindVertexArray(W),G.setAttributes(z,H),P&&F.bindBuffer(j,P),F.bindVertexArray(null),W}function Te(F,z,H){return Z(F,z.attribSetters||z,H.attribs,H.indices)}}},C={};function O(Q){var o=C[Q];if(o!==void 0)return o.exports;var Y=C[Q]={exports:{}};return f[Q](Y,Y.exports,O),Y.exports}var k=O("./src/twgl-full.js");return k})())})(Ua);var it=Ua.exports,Fr,Ir,ut,Xt,ft,Ar,ct,Nr,Ht,pn,dn,bn,Ca,Ra,En,St,Jr,Tn,Zn,Ga,Jn,ka,$n,ja,Sn,xa,ea,Va,Fa,Ja,gn,Pa,ra,Wa;class Za{constructor(){Ee(this,Zn);Ee(this,Jn);Ee(this,$n);Ee(this,Sn);Ee(this,ea);Ee(this,Fa);Ee(this,gn);Ee(this,ra);nr(this,"canvas",document.querySelector("#canvas"));nr(this,"gl");Ee(this,Fr,new Map);Ee(this,Ir,new Map);Ee(this,ut,void 0);Ee(this,Xt,void 0);Ee(this,ft,void 0);Ee(this,Ar,new Uint8Array(600));Ee(this,ct,void 0);Ee(this,Nr,new Uint8Array(3*40));Ee(this,Ht,void 0);Ee(this,pn,document.createTextNode("0"));Ee(this,dn,document.createTextNode("1"));Ee(this,bn,document.createTextNode("0"));Ee(this,Ca,0);Ee(this,Ra,0);Ee(this,En,new Map);Ee(this,St,void 0);Ee(this,Jr,void 0);Ee(this,Tn,document.querySelectorAll("button"));console.log("Constructing renderer");let l=document.querySelector("#debug2");l.textContent="Adding lines cleared node",document.querySelector("#linesCleared").appendChild(U(this,pn)),l.textContent="Adding speed level node",document.querySelector("#speedLevel").appendChild(U(this,dn)),l.textContent="Adding score node",document.querySelector("#score").appendChild(U(this,bn)),l.textContent="Creating color map",U(this,Fr).set(1,[255,0,0]),U(this,Fr).set(2,[0,255,0]),U(this,Fr).set(3,[255,255,0]),U(this,Fr).set(4,[0,0,255]),U(this,Fr).set(5,[180,90,246]),U(this,Fr).set(6,[0,255,255]),U(this,Fr).set(7,[255,140,40]),U(this,Ir).set("Z",1),U(this,Ir).set("S",2),U(this,Ir).set("O",3),U(this,Ir).set("J",4),U(this,Ir).set("T",5),U(this,Ir).set("I",6),U(this,Ir).set("L",7),l.textContent="Finding webgl context";let f=this.canvas.getContext("webgl");this.gl=f,f||document.body.appendChild(document.createTextNode("WebGL is not supported."));function C(q,j,oe,Z){return[q,j+Z,q+oe,j+Z,q+oe,j,q,j]}function O(q,j,oe,Z){let Te=[q/2,q],F=[],z=(500-Te[1])/2,H=(400-Te[0])/2;F.push(...C(H,z,Te[0],Te[1])),F.push(...C(H-j-Z,z,Z,Z));for(let P=0;P<3;P++)F.push(...C(H+j+Te[0],z+P*(Z+oe),Z,Z));return F}l.textContent="Creating vertex arrays";const k={a_Position:{numComponents:2,data:O(500,5,0,70)},a_GridPos:{numComponents:2,data:[0,0,10,0,10,20,0,20,0,0,4,0,4,4,0,4,0,0,4,0,4,4,0,4,0,0,4,0,4,4,0,4,0,0,4,0,4,4,0,4]},a_QueueID:{numComponents:1,data:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3]},a_ShaderID:{numComponents:1,data:[0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},indices:{numComponents:3,data:[0,1,2,2,3,0,4,5,6,6,7,4,8,9,10,10,11,8,12,13,14,14,15,12,16,17,18,18,19,16]}};l.textContent="Creating vertex buffer info",Ae(this,Xt,it.createBufferInfoFromArrays(f,k)),l.textContent="Compiling shaders";let Q=document.querySelector("#vertex-shader-2d").text,o=document.querySelector("#fragment-shader-2d").text;Ae(this,ut,it.createProgramInfo(f,[Q,o])),l.textContent="Creating block texture";let Y={src:"textures/block.png",mag:f.LINEAR};Ae(this,Ht,it.createTexture(this.gl,Y)),l.textContent="Creating data textures",Ae(this,ft,f.createTexture()),f.bindTexture(f.TEXTURE_2D,U(this,ft)),f.pixelStorei(f.UNPACK_ALIGNMENT,1),f.texImage2D(f.TEXTURE_2D,0,f.RGB,10,20,0,f.RGB,f.UNSIGNED_BYTE,null),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),Ae(this,ct,f.createTexture()),f.bindTexture(f.TEXTURE_2D,U(this,ct)),f.pixelStorei(f.UNPACK_ALIGNMENT,1),f.texImage2D(f.TEXTURE_2D,0,f.RGB,4,2*5,0,f.RGB,f.UNSIGNED_BYTE,null),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),l.textContent="Binding buffers",f.useProgram(U(this,ut).program),it.setBuffersAndAttributes(f,U(this,ut),U(this,Xt)),l.textContent="Setting initial uniforms";let ae={u_Resolution:[this.gl.canvas.width,this.gl.canvas.height],u_GridData:U(this,ft),u_QueueData:U(this,ct),u_BlockTexture:U(this,Ht)};it.setUniforms(U(this,ut),ae),l.textContent="Retrieving style sheet";const G=document.styleSheets;let ie=!1;for(let q=0;q<G.length&&!ie;q++)G[q].href.includes("WebTetris")&&(Ae(this,St,G[q].cssRules),ie=!0);l.textContent=G.length+" style sheets, match "+(ie?"":"not ")+"found.",Ae(this,Jr,ze(this,gn,Pa).call(this,"button").fontSize),l.textContent="Getting button font size",Ae(this,Jr,Number(U(this,Jr).substring(0,U(this,Jr).length-2))),l.textContent="Renderer completed",l.textContent=G.length+" style sheets, match "+(ie?"":"not ")+"found.",console.log("Renderer constructed")}updateData(l){ze(this,Zn,Ga).call(this,l),ze(this,$n,ja).call(this,l),ze(this,ea,Va).call(this,l)}renderGame(){it.resizeCanvasToDisplaySize(this.gl.canvas),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),ze(this,ra,Wa).call(this);let l={u_Resolution:[this.gl.canvas.width,this.gl.canvas.height],u_GridData:U(this,ft),u_QueueData:U(this,ct),u_BlockTexture:U(this,Ht)};it.setUniforms(U(this,ut),l),it.drawBufferInfo(this.gl,U(this,Xt))}}Fr=new WeakMap,Ir=new WeakMap,ut=new WeakMap,Xt=new WeakMap,ft=new WeakMap,Ar=new WeakMap,ct=new WeakMap,Nr=new WeakMap,Ht=new WeakMap,pn=new WeakMap,dn=new WeakMap,bn=new WeakMap,Ca=new WeakMap,Ra=new WeakMap,En=new WeakMap,St=new WeakMap,Jr=new WeakMap,Tn=new WeakMap,Zn=new WeakSet,Ga=function(l){for(let f=0;f<20;f++){let C=l.gridData[f];for(let O=0;O<10;O++){let k=ze(this,Jn,ka).call(this,C,O),Q=3*(10*f+O);if(k!=0){let o=U(this,Fr).get(k);U(this,Ar)[Q]=o[0],U(this,Ar)[Q+1]=o[1],U(this,Ar)[Q+2]=o[2]}else U(this,Ar)[Q]=0,U(this,Ar)[Q+1]=0,U(this,Ar)[Q+2]=0}}if(l.playerPiece.active){let f=170;for(let O=0;O<4;O++){let k=3*(10*l.ghostBlocks[O][1]+l.ghostBlocks[O][0]);U(this,Ar)[k]=f,U(this,Ar)[k+1]=f,U(this,Ar)[k+2]=f}let C=l.playerPiece.shape;for(let O=0;O<4;O++){let k=U(this,Fr).get(U(this,Ir).get(C)),Q=3*(10*l.playerPiece.blocks[O][1]+l.playerPiece.blocks[O][0]);U(this,Ar)[Q]=k[0],U(this,Ar)[Q+1]=k[1],U(this,Ar)[Q+2]=k[2]}}this.gl.bindTexture(this.gl.TEXTURE_2D,U(this,ft)),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,10,20,this.gl.RGB,this.gl.UNSIGNED_BYTE,U(this,Ar))},Jn=new WeakSet,ka=function(l,f){const C=32-(3+3*f),O=7<<C;return(l&O)>>>C},$n=new WeakSet,ja=function(l){for(let f=0;f<U(this,Nr).length;f++)U(this,Nr)[f]=0;l.heldPiece!=null&&ze(this,Sn,xa).call(this,l.heldPiece,0);for(let f=0;f<4;f++)ze(this,Sn,xa).call(this,l.pieceQueue[f],24*(1+f));this.gl.bindTexture(this.gl.TEXTURE_2D,U(this,ct)),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,4,10,this.gl.RGB,this.gl.UNSIGNED_BYTE,U(this,Nr))},Sn=new WeakSet,xa=function(l,f){let C=ot.getBaseShape(l),O=U(this,Fr).get(U(this,Ir).get(l));for(let k=0;k<4;k++){let Q=C[k],o=f+3*(Q[1]*4+Q[0]);U(this,Nr)[o]=O[0],U(this,Nr)[o+1]=O[1],U(this,Nr)[o+2]=O[2]}if(l!="I"&&l!="O"){let k=f+21;U(this,Nr)[k]=255}else l=="I"&&(U(this,Nr)[f+21+1]=255)},ea=new WeakSet,Va=function(l){U(this,pn).nodeValue=l.linesCleared,U(this,dn).nodeValue=l.speedLevel==11?"MAX":l.speedLevel,U(this,bn).nodeValue=l.score},Fa=new WeakSet,Ja=function(l){const f=document.querySelector(l),C=ze(this,gn,Pa).call(this,l);C!=null&&U(this,En).set(f,C)},gn=new WeakSet,Pa=function(l){let f=null;for(let C=0;C<U(this,St).length&&f==null;C++)U(this,St)[C].selectorText==l&&(f=U(this,St)[C].style);return f},ra=new WeakSet,Wa=function(){const l=this.gl.canvas.width,f=this.gl.canvas.height,C=3*l>4*f;U(this,En).forEach(function(k,Q,o){const Y=k.left!="",ae=k.top!="";let G=Y?k.left:k.right,ie=ae?k.top:k.bottom,q=k.fontSize,j=k.width,oe=k.height;G=Number(G.substring(0,G.length-2)),ie=Number(ie.substring(0,ie.length-2)),j=Number(j.substring(0,j.length-2)),oe=Number(oe.substring(0,oe.length-2)),q!=""&&(q=Number(q.substring(0,q.length-2))),C?(G=(4*f*(G-50)+150*l)/(3*l)+"vw",j=j*4*f/(3*l)+"vw",ie=ie+"vh",oe=oe+"vh"):(ie=ie*3*l/(4*f)+(100*f-75*l)/(2*f)+"vh",oe=oe*3*l/(4*f)+"vh",G=G+"vw",j=j+"vw",q!=""&&(q=q*3*l/(4*f))),q!=""&&(Q.style.fontSize=q+"vh"),Y?Q.style.left=G:Q.style.right=G,ae?Q.style.top=ie:Q.style.bottom=ie,Q.style.width=j,Q.style.height=oe});const O=C?U(this,Jr):U(this,Jr)*3*l/(4*f);for(let k=0;k<U(this,Tn).length;k++){let Q=U(this,Tn)[k];Q.style.fontSize=O+"vh"}};var Kt,qt,gt,lt,st,vt,$r,Yt,An;class $a{constructor(l){nr(this,"leftQueue",0);nr(this,"rightQueue",0);nr(this,"moveDown",!1);nr(this,"rotate",{left:!1,right:!1});nr(this,"hardDrop",!1);nr(this,"dragSensitivity",40);nr(this,"slamThreshold",150);nr(this,"slamTimeLimit",400);Ee(this,Kt,void 0);Ee(this,qt,void 0);Ee(this,gt,void 0);Ee(this,lt,void 0);Ee(this,st,!1);Ee(this,vt,null);Ee(this,$r,{startTime:0,startY:0,endY:0});Ee(this,Yt,void 0);Ee(this,An,!1);l.addEventListener("touchmove",f=>{this.dragEvent(f)}),l.addEventListener("touchstart",f=>{this.touchStart(f)}),l.addEventListener("touchend",f=>{this.touchEnd(f)}),l.addEventListener("touchcancel",f=>{this.touchEnd(f)}),Ae(this,Kt,l),document.addEventListener("dblclick",function(f){f.preventDefault()},{passive:!1})}touchStart(l){if(U(this,vt)===null&&l.target.closest(".blockGestures")===null){let f=l.touches.item(0);Ae(this,vt,f.identifier),Ae(this,gt,f.pageX),Ae(this,lt,f.pageY),Ae(this,qt,f.pageX),Ae(this,Yt,Date.now()),Ae(this,An,f.clientX<U(this,Kt).getBoundingClientRect().x+U(this,Kt).getBoundingClientRect().width*.5),Ae(this,$r,{startTime:Date.now(),startY:f.pageY,endY:f.pageY})}}touchEnd(l){let f=!0;for(let C=0;C<l.touches.length&&f;C++)l.touches.item(C).identifier===U(this,vt)&&(f=!1);f&&(Date.now()-U(this,Yt)<300&&this.leftQueue==0&&this.rightQueue==0&&(U(this,An)?this.rotate.left=!0:this.rotate.right=!0),Date.now()-U(this,$r).startTime<=this.slamTimeLimit&&U(this,$r).endY-U(this,$r).startY>this.slamThreshold&&(this.hardDrop=!0),Ae(this,vt,null),this.leftQueue=0,this.rightQueue=0,this.moveDown=!1)}dragEvent(l){let f=!1,C=null;for(let O=0;O<l.changedTouches.length;O++)if(l.changedTouches.item(O).identifier===U(this,vt)){C=l.changedTouches.item(O);break}C!==null&&((C.pageX-U(this,qt))*(U(this,st)?1:-1)>0&&(Ae(this,st,!U(this,st)),Ae(this,gt,C.pageX+this.dragSensitivity*.5*(U(this,st)?1:-1)),Ae(this,lt,C.pageY)),Math.abs(C.pageX-U(this,gt))>this.dragSensitivity&&(U(this,st)?(this.leftQueue++,this.rightQueue=0):(this.rightQueue++,this.leftQueue=0),f=!0,U(this,$r).startTime=0,this.moveDown=!1),C.pageY-U(this,lt)>this.dragSensitivity?(this.moveDown=!0,this.leftQueue=0,this.rightQueue=0,f=!0):U(this,lt)-C.pageY>this.dragSensitivity&&(this.moveDown=!1,f=!0),f&&(Ae(this,gt,C.pageX),Ae(this,lt,C.pageY),Ae(this,Yt,0)),Ae(this,qt,C.pageX),U(this,$r).endY=C.pageY)}}Kt=new WeakMap,qt=new WeakMap,gt=new WeakMap,lt=new WeakMap,st=new WeakMap,vt=new WeakMap,$r=new WeakMap,Yt=new WeakMap,An=new WeakMap;class ei{constructor(l,f,C,O,k,Q,o){nr(this,"inputStates",new Map);nr(this,"frameCounter",{moveLeft:0,moveRight:0,softDrop:0});this.inputStates.set("moveLeft",!1),this.inputStates.set("moveRight",!1),this.inputStates.set("softDrop",!1),this.inputStates.set("hold",!1),this.inputStates.set("hardDrop",!1),this.inputStates.set("rotateClockwise",!1),this.inputStates.set("rotateAnticlockwise",!1),this.addReleasableListeners(f,"moveLeft"),this.addReleasableListeners(C,"moveRight"),this.addReleasableListeners(O,"softDrop"),this.addListeners(k,"hardDrop"),this.addListeners(Q,"rotateClockwise"),this.addListeners(o,"rotateAnticlockwise"),this.addListeners(l,"hold")}addListeners(l,f){l.addEventListener("pointerdown",C=>{this.inputStates.set(f,!0),l.classList.add("pressed")}),l.addEventListener("click",C=>{C.pointerType===""&&this.inputStates.set(f,!0)}),l.addEventListener("pointerup",C=>{l.classList.remove("pressed")}),l.addEventListener("pointerleave",C=>{l.classList.remove("pressed")})}addReleasableListeners(l,f){l.addEventListener("pointerdown",C=>{this.inputStates.set(f,!0),l.classList.add("pressed")}),l.addEventListener("pointerup",C=>{this.inputStates.set(f,!1),l.classList.remove("pressed")}),l.addEventListener("pointerleave",C=>{this.inputStates.set(f,!1),l.classList.remove("pressed")}),l.addEventListener("click",C=>{C.pointerType===""&&(f==="moveLeft"?this.frameCounter.moveLeft++:f==="moveRight"?this.frameCounter.moveRight++:f==="softDrop"&&this.frameCounter.softDrop++)})}countFrame(){this.inputStates.get("moveLeft")&&this.frameCounter.moveLeft++,this.inputStates.get("moveRight")&&this.frameCounter.moveRight++,this.inputStates.get("softDrop")&&this.frameCounter.softDrop++}resetFlags(){this.inputStates.set("hold",!1),this.inputStates.set("hardDrop",!1),this.inputStates.set("rotateClockwise",!1),this.inputStates.set("rotateAnticlockwise",!1),this.inputStates.get("moveLeft")||(this.frameCounter.moveLeft=0),this.inputStates.get("moveRight")||(this.frameCounter.moveRight=0),this.inputStates.get("softDrop")||(this.frameCounter.softDrop=0)}getInput(l){return this.inputStates.get(l)}}let sn=null,wa=new Map,Xa;function ri(re){re.inputKeys.forEach(function(f,C,O){localStorage.setItem(f,C)})}function ti(re){let l=[];re.inputKeys.forEach(function(f,C,O){const k=localStorage.getItem(f);k!=null&&l.push({action:f,oldKey:C,newKey:k})});for(let f=0;f<l.length;f++)re.inputKeys.delete(l[f].oldKey);for(let f=0;f<l.length;f++)re.inputKeys.set(l[f].newKey,l[f].action)}function ni(re,l){const f=document.querySelectorAll(re);for(let k=0;k<f.length;k++){let Q=f[k];Q.classList.add("ready"),Q.addEventListener("click",function(){l.selectedSpan!=null&&(l.selectedKey="Escape",O()),l.originalKeybind=Q.innerText,l.selectedSpan=Q,l.selectedAction=Q.id.substring(2),sn.textContent="Rebinding "+l.selectedAction+" action (press key to rebind)...",document.addEventListener("keydown",C),Q.classList.remove("ready"),Q.classList.add("waiting"),Q.innerText="..."}),Q.innerText=l.actionToKey(Q.id.substring(2)),Q.innerText==" "&&(Q.innerText="Space")}function C(k){l.selectedKey=k.key.length>1?k.key:k.key.toUpperCase(),O()}function O(){l.selectedKey=="Escape"||Xa.classList.contains("hide")?(l.selectedKey=l.originalKeybind,k(),sn.textContent="Rebind canceled.",l.updateCounters()):l.rebindControl(l.selectedAction,l.selectedKey)?(sn.textContent="Rebind successful!",k(),ri(l)):sn.textContent="'"+l.selectedKey+"' is already in use (press another key)...";function k(){document.removeEventListener("keydown",C);const Q=l.selectedKey==" "?"Space":l.selectedKey;l.selectedSpan.innerText=Q,wa.get(l.selectedAction).forEach(function(o,Y,ae){o.innerText=Q}),l.selectedAction="",l.selectedKey="",l.selectedSpan.classList.remove("waiting"),l.selectedSpan.classList.add("ready"),l.selectedSpan=null}}}function ai(re,l,f,C){Xa=C,sn=f,ni(re,l),l.actionStates.forEach(function(O,k,Q){wa.set(k,document.querySelectorAll("span.cd_"+k)),wa.get(k).forEach(function(o,Y,ae){const G=l.actionToKey(k);o.innerText=G==" "?"Space":G})})}function ii(){let re=document.createTextNode("");document.querySelector("#debug").appendChild(re),re.textContent="Starting program";const l=document.querySelector("#startButton");re.textContent="Creating base input module";let f=new za;ti(f),document.addEventListener("keydown",function(H){f.setInputState(H.key,!0)}),document.addEventListener("keyup",function(H){f.setInputState(H.key,!1)}),re.textContent="Creating touch input module";let C=new $a(document.querySelector("#gameGUI"));re.textContent="Creating button input module";let O=new ei(document.querySelector("#tib_Hold"),document.querySelector("#tib_MoveLeft"),document.querySelector("#tib_MoveRight"),document.querySelector("#tib_SoftDrop"),document.querySelector("#tib_HardDrop"),document.querySelector("#tib_RotateClockwise"),document.querySelector("#tib_RotateAnticlockwise"));re.textContent="Creating game module";let k=new Sa;re.textContent="Creating rendering module",console.log("Creating rendering module");let Q=new Za;console.log("Rendering module complete"),re.textContent="Selecting screens";const o=document.querySelector("#titleScreen"),Y=document.querySelector("#pauseScreen"),ae=document.querySelector("#gameOverScreen"),G=document.querySelector("#settingsScreen");let ie=!0;re.textContent="Adding score nodes";const q=document.createTextNode("0"),j=document.createTextNode("0");document.querySelector("#finalScore").appendChild(q),document.querySelector("#finalLines").append(j),re.textContent="Creating game loop";let oe=0,Z=0;function Te(H){let P=(H-Z)*.001;Z=H,oe+=P,G.classList.contains("hide")?k.gameState.gameOver?ie||ae.classList.contains("hide")&&(ae.classList.remove("hide"),q.textContent=k.gameState.score,j.textContent=k.gameState.linesCleared):(oe>=k.gameTickTime&&(oe=Math.min(oe-k.gameTickTime,k.gameTickTime),f.updateCounters(),oi(k,f,C,O),k.runTick(),f.getCounter("Pause")==1&&(k.gameState.isPaused?(k.pauseGame(!1),Y.classList.add("hide")):(k.pauseGame(!0),Y.classList.remove("hide")))),k.isStateChanged&&Q.updateData(k.gameState)):(f.updateCounters(),f.getCounter("Pause")==1&&G.classList.add("hide")),Q.renderGame(),requestAnimationFrame(Te)}function F(){k.startNewGame(),Q.updateData(k.gameState),Q.renderGame(),document.querySelector("#titleScreen").classList.add("hide"),document.querySelector("#gameGUI").classList.remove("hide"),requestAnimationFrame(Te),ie=!1}re.textContent="Configuring buttons",l.addEventListener("click",F),document.querySelector("#heldPieceOverlay").addEventListener("click",function(){k.holdPiece()}),document.querySelector("#unpauseButton").addEventListener("click",function(){k.gameState.isPaused=!1,Y.classList.add("hide")}),document.querySelector("#replayButton").addEventListener("click",function(){k.startNewGame(),Q.updateData(k.gameState),Q.renderGame(),ae.classList.add("hide")}),document.querySelector("#returnToTitleButton").addEventListener("click",function(){o.classList.remove("hide"),ae.classList.add("hide"),ie=!0}),re.textContent="Starting engine",requestAnimationFrame(Te),re.textContent="Configuring settings page";let z=document.createTextNode("");document.querySelector("#settingsConsoleText").appendChild(z),ai(".controlRebind",f,z,G),document.querySelector("#exitSettingsButton").addEventListener("click",function(){G.classList.add("hide")}),document.querySelectorAll(".settingsButton").forEach(function(H,P,W){H.addEventListener("click",function(){G.classList.remove("hide")})}),re.textContent="Script complete"}function oi(re,l,f,C){let O=5;l.getCounter("HardDrop")==1&&(re.input.hardDrop=!0),l.getCounter("Hold")==1&&(re.input.hold=!0),l.getCounter("RotateClockwise")==1&&(re.input.rotClockwise=!0),l.getCounter("RotateAntiClockwise")==1&&(re.input.rotAntiClockwise=!0),l.getInputState("SoftDrop")&&(re.input.softDrop=!0),(l.getCounter("MoveLeft")==1||l.getCounter("MoveLeft")>O)&&(re.input.moveLeft=!0),(l.getCounter("MoveRight")==1||l.getCounter("MoveRight")>O)&&(re.input.moveRight=!0),f.leftQueue>0&&(re.input.moveLeft=!0,f.leftQueue--),f.rightQueue>0&&(re.input.moveRight=!0,f.rightQueue--),f.moveDown&&(re.input.softDrop=!0),f.rotate.left?re.input.rotAntiClockwise=!0:f.rotate.right&&(re.input.rotClockwise=!0),f.rotate={left:!1,right:!1},f.hardDrop&&(re.input.hardDrop=!0,f.hardDrop=!1),C.countFrame(),(C.frameCounter.moveLeft==1||C.frameCounter.moveLeft>O)&&(re.input.moveLeft=!0),(C.frameCounter.moveRight==1||C.frameCounter.moveRight>O)&&(re.input.moveRight=!0),C.frameCounter.softDrop>=1&&(re.input.softDrop=!0),C.getInput("hold")&&(re.input.hold=!0),C.getInput("rotateClockwise")&&(re.input.rotClockwise=!0),C.getInput("rotateAnticlockwise")&&(re.input.rotAntiClockwise=!0),C.getInput("hardDrop")&&(re.input.hardDrop=!0),C.resetFlags()}ii();
