var eo=Object.defineProperty;var to=(h,e,t)=>e in h?eo(h,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):h[e]=t;var Ot=(h,e,t)=>(to(h,typeof e!="symbol"?e+"":e,t),t),aa=(h,e,t)=>{if(!e.has(h))throw TypeError("Cannot "+t)};var se=(h,e,t)=>(aa(h,e,"read from private field"),t?t.call(h):e.get(h)),Fe=(h,e,t)=>{if(e.has(h))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(h):e.set(h,t)},Je=(h,e,t,r)=>(aa(h,e,"write to private field"),r?r.call(h,t):e.set(h,t),t);var sa=(h,e,t,r)=>({set _(n){Je(h,e,n,t)},get _(){return se(h,e,r)}}),Ke=(h,e,t)=>(aa(h,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function t(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(n){if(n.ep)return;n.ep=!0;const a=t(n);fetch(n.href,a)}})();class ro{constructor(){Ot(this,"selectedKey","");Ot(this,"originalKeybind","");Ot(this,"selectedAction","");Ot(this,"selectedSpan",null);this.actionStates=new Map,this.actionStates.set("HardDrop",!1),this.actionStates.set("SoftDrop",!1),this.actionStates.set("MoveLeft",!1),this.actionStates.set("MoveRight",!1),this.actionStates.set("Hold",!1),this.actionStates.set("RotateClockwise",!1),this.actionStates.set("RotateAntiClockwise",!1),this.actionStates.set("Pause",!1),this.inputKeys=new Map,this.inputKeys.set("A","MoveLeft"),this.inputKeys.set("D","MoveRight"),this.inputKeys.set("W","HardDrop"),this.inputKeys.set("S","SoftDrop"),this.inputKeys.set("E","Hold"),this.inputKeys.set("ArrowLeft","RotateAntiClockwise"),this.inputKeys.set("ArrowRight","RotateClockwise"),this.inputKeys.set("Escape","Pause"),this.counters=new Map,this.counters.set("MoveLeft",0),this.counters.set("MoveRight",0),this.counters.set("RotateClockwise",0),this.counters.set("RotateAntiClockwise",0),this.counters.set("HardDrop",0),this.counters.set("Hold",0),this.counters.set("Pause",0)}keyToState(e){return e.length==1&&(e=e.toUpperCase()),this.inputKeys.get(e)}actionToKey(e){let t="";return this.inputKeys.forEach(function(r,n,a){r==e&&(t=n)}),t}rebindControl(e,t){let r=!1,n="";return this.inputKeys.forEach(function(a,u,i){a==e&&(n=u)}),n!=""&&(this.inputKeys.has(t)&&t!=n||(this.inputKeys.delete(n),this.inputKeys.set(t,e),r=!0)),r}setInputState(e,t){let r=this.keyToState(e);r!=null&&this.actionStates.set(r,t)}getInputState(e){return this.actionStates.has(e)?this.actionStates.get(e):(console.log("ERROR: trying to access an input action that doesn't exist ("+e+"). The allowed options are:"),this.actionStates.forEach(function(t,r,n){console.log("    - "+r)}),null)}updateCounters(){for(const[e,t]of this.counters)this.getInputState(e)?this.counters.set(e,t+1):this.counters.set(e,0)}getCounter(e){return this.counters.has(e)?this.counters.get(e):(console.log("ERROR: trying to access input action that doesn't have a counter ("+e+"). The counters are:"),this.counters.forEach(function(t,r,n){console.log("    - "+r+": "+t)}),null)}}var yn,mr,yr,Ai,Lr,dn,Qt,zr,Si,xs,Mi,gs,Fi,bs,Ci,Ts,pn,_i,Ur,On,kn,xa,Ri,Es,Gn,ga,Pi,_s,vn,wi,Wn,ba;const Un=class Un{constructor(){Fe(this,Si);Fe(this,Mi);Fe(this,Fi);Fe(this,Ci);Fe(this,pn);Fe(this,Ur);Fe(this,kn);Fe(this,Ri);Fe(this,Gn);Fe(this,Pi);Fe(this,vn);Fe(this,Wn);Ot(this,"numRows",21);Ot(this,"graceTimerDuration",.5);Ot(this,"gameTickTime",1/30);Ot(this,"pieceMap",new Map);Ot(this,"gameState",{isPaused:!1,gameOver:!0,gridData:new Uint32Array(this.numRows),playerPiece:null,pieceQueue:[],heldPiece:null,ghostBlocks:[[0,0],[0,0],[0,0],[0,0]],linesCleared:0,speedLevel:1,score:0});Fe(this,yn,15);Fe(this,mr,!0);Fe(this,yr,0);Fe(this,Ai,!1);Fe(this,Lr,-1);Fe(this,dn,0);Fe(this,Qt,!1);Fe(this,zr,!1);Ke(this,pn,_i).call(this),Ke(this,Ur,On).call(this),Ke(this,vn,wi).call(this),Je(this,yn,15),this.pieceMap.set("Z",1),this.pieceMap.set("S",2),this.pieceMap.set("O",3),this.pieceMap.set("J",4),this.pieceMap.set("T",5),this.pieceMap.set("I",6),this.pieceMap.set("L",7),this.gameState.isPaused=!0}get isStateChanged(){const e=se(this,mr);return Je(this,mr,!1),e}runTick(e){if(!this.gameState.isPaused){let t=!1;if(se(this,zr))this.animationCount==null||this.rowCount==null?(this.animationCount=0,this.rowCount=0):(this.animationCount++,this.rowCount<this.numRows&&this.animationCount%4==0?(this.clearRow(0),this.rowCount++,Je(this,mr,!0)):this.rowCount==this.numRows&&(this.rowCount++,this.gameState.gameOver=!0));else if(e.getCounter("HardDrop")==1)this.hardDropPlayerPiece(),this.finishWithPiece(),t=!0;else if(e.getCounter("Hold")==1)this.holdPiece(),t=!0;else{se(this,Qt)&&Ke(this,Ri,Es).call(this,this.gameTickTime),e.getInputState("SoftDrop")&&(t=this.tryMovePiece(0,-1)||t);let r=0;e.getCounter("RotateClockwise")==1&&(r+=1),e.getCounter("RotateAntiClockwise")==1&&(r-=1),r!=0&&(t=this.tryRotatePiece(r==1)||t);let n=0;if((e.getCounter("MoveLeft")==1||e.getCounter("MoveLeft")>5)&&(n-=1),(e.getCounter("MoveRight")==1||e.getCounter("MoveRight")>5)&&(n+=1),n!=0&&(t=this.tryMovePiece(n,0)||t),sa(this,yr)._++,se(this,yr)>=se(this,yn)){let a=!this.tryMovePiece(0,-1);t||(t=!a),Je(this,yr,0),a&&!se(this,Qt)&&Ke(this,kn,xa).call(this)}if(se(this,Qt)&&se(this,Lr)<=0){let a=!this.tryMovePiece(0,-1);t=!0,a&&this.finishWithPiece()}else if(!se(this,Qt)){let a=!1;for(const u of this.gameState.playerPiece.blocks)a=a||this.isBlockHere(u[0],u[1]-1);a&&Ke(this,kn,xa).call(this)}}t&&(Ke(this,vn,wi).call(this),Je(this,mr,!0))}}pauseGame(e){this.gameState.isPaused=e}startNewGame(){this.gameState.gameOver=!1,this.gameState.isPaused=!1,Je(this,zr,!1),this.animationCount=null,this.rowCount=null;for(let e=0;e<this.gameState.gridData.length;e++)this.gameState.gridData[e]=0;this.gameState.linesCleared=0,this.gameState.speedLevel=0,this.gameState.score=0,this.gameState.pieceQueue=[],this.gameState.heldPiece=null,Ke(this,pn,_i).call(this),Ke(this,Ur,On).call(this),Ke(this,vn,wi).call(this),Ke(this,Wn,ba).call(this)}tryMovePiece(e,t){let r=!0;for(let n=0;n<4&&r;n++){let a=this.gameState.playerPiece.blocks[n][0]+e,u=this.gameState.playerPiece.blocks[n][1]+t;this.isBlockHere(a,u)&&(r=!1)}return r&&(Ke(this,Mi,gs).call(this,e,t),e!=0&&Ke(this,Gn,ga).call(this),t!=0&&Je(this,Qt,!1)),r}hardDropPlayerPiece(){for(;this.tryMovePiece(0,-1););}tryRotatePiece(e){let t=Ke(this,Fi,bs).call(this,e);return t&&Ke(this,Gn,ga).call(this),t}holdPiece(){if(this.gameState.heldPiece==null)this.gameState.heldPiece=this.gameState.playerPiece.shape,Ke(this,Ur,On).call(this),Je(this,mr,!0),Je(this,yr,0);else if(!this.gameState.playerPiece.wasHeld){let e=this.gameState.heldPiece;this.gameState.heldPiece=this.gameState.playerPiece.shape,this.gameState.playerPiece=new Sr(e),this.gameState.playerPiece.wasHeld=!0,Je(this,mr,!0),Je(this,yr,0),this.isPlayerPieceValid()||(this.gameState.playerPiece.active=!1,Je(this,zr,!0))}}finishWithPiece(){const e=this.gameState.linesCleared;this.gameState.playerPiece.shape=="T"&&Je(this,Ai,!0),Ke(this,Ci,Ts).call(this),Ke(this,Ur,On).call(this),Je(this,Qt,!1),Ke(this,Pi,_s).call(this),this.gameState.linesCleared!=e&&(Ke(this,Wn,ba).call(this),this.gameState.score+=Math.pow(this.gameState.linesCleared-e,2)*100)}clearRow(e){for(let t=e;t<this.numRows-1;t++)this.gameState.gridData[t]=this.gameState.gridData[t+1];this.gameState.gridData[this.numRows-1]=0}isBlockHere(e,t){if(e<0||t<0||e>=10||t>=this.numRows)return!0;const r=this.gameState.gridData[t],n=7<<32-(3+3*e);return(r&n)!=0}getBlockData(e,t){const r=this.gameState.gridData[t],n=32-(3+3*e),a=7<<n;return(r&a)>>>n}isPlayerPieceValid(){let e=!0;for(let t=0;t<4&&e;t++)this.isBlockHere(this.gameState.playerPiece.blocks[t][0],this.gameState.playerPiece.blocks[t][1])&&(e=!1);return e}};yn=new WeakMap,mr=new WeakMap,yr=new WeakMap,Ai=new WeakMap,Lr=new WeakMap,dn=new WeakMap,Qt=new WeakMap,zr=new WeakMap,Si=new WeakSet,xs=function(e,t,r){const a=~(7<<32-(3+3*e));this.gameState.gridData[t]&=a;const u=r<<32-(3+3*e);this.gameState.gridData[t]|=u},Mi=new WeakSet,gs=function(e,t){for(let r=0;r<4;r++)this.gameState.playerPiece.blocks[r][0]+=e,this.gameState.playerPiece.blocks[r][1]+=t},Fi=new WeakSet,bs=function(e){let t=(this.gameState.playerPiece.rotationIndex+4+(e?1:-1))%4,r=[...this.gameState.playerPiece.blocks[0]],n=[];for(let _=0;_<4;_++)n.push([...this.gameState.playerPiece.blocks[_]]);let a=1,u=1;e?u=-1:a=-1;let i;for(let _=0;_<4;_++)n[_][0]-=r[0],n[_][1]-=r[1],i=n[_][0],n[_][0]=a*n[_][1],n[_][1]=u*i,n[_][0]+=r[0],n[_][1]+=r[1];let c;switch(this.gameState.playerPiece.shape){case"O":c=Sr.offsets.O;break;case"I":c=Sr.offsets.I;break;default:c=Sr.offsets.OTHER;break}let v,d,g=!1;for(let _=0;_<5&&!g;_++){v=c[_],d=[v[this.gameState.playerPiece.rotationIndex][0]-v[t][0],v[this.gameState.playerPiece.rotationIndex][1]-v[t][1]],g=!0;for(let b=0;b<4;b++)n[b][0]+=d[0],n[b][1]+=d[1],this.isBlockHere(n[b][0],n[b][1])&&(g=!1);if(!g)for(let b=0;b<4;b++)n[b][0]-=d[0],n[b][1]-=d[1]}if(g){for(let _=0;_<4;_++)this.gameState.playerPiece.blocks[_]=[...n[_]];this.gameState.playerPiece.rotationIndex=t}return g},Ci=new WeakSet,Ts=function(){let e,t,r=this.pieceMap.get(this.gameState.playerPiece.shape);for(let n=0;n<4;n++)e=this.gameState.playerPiece.blocks[n][0],t=this.gameState.playerPiece.blocks[n][1],Ke(this,Si,xs).call(this,e,t,r)},pn=new WeakSet,_i=function(){let e=["O","I","T","J","L","S","Z"],t;for(let r=0;r<7;r++)t=Math.floor(Math.random()*e.length),this.gameState.pieceQueue.push(e[t]),e.splice(t,1)},Ur=new WeakSet,On=function(){let e=this.gameState.pieceQueue[0];this.gameState.pieceQueue.splice(0,1),this.gameState.pieceQueue.length<7&&Ke(this,pn,_i).call(this),delete this.gameState.playerPiece,this.gameState.playerPiece=new Sr(e),this.isPlayerPieceValid()||(this.gameState.playerPiece.active=!1,Je(this,zr,!0)),Je(this,yr,0)},kn=new WeakSet,xa=function(){Je(this,Lr,this.graceTimerDuration),Je(this,Qt,!0),Je(this,dn,0)},Ri=new WeakSet,Es=function(e){Je(this,Lr,se(this,Lr)-e)},Gn=new WeakSet,ga=function(){se(this,Qt)&&se(this,dn)<30&&(Je(this,Lr,this.graceTimerDuration),sa(this,dn)._++)},Pi=new WeakSet,_s=function(){for(let e=0;e<this.numRows;e++){let t=!0;for(let r=0;r<10&&t;r++)this.isBlockHere(r,e)||(t=!1);t&&(this.clearRow(e),this.gameState.linesCleared++,e--)}},vn=new WeakSet,wi=function(){for(let t=0;t<4;t++)this.gameState.ghostBlocks[t]=[...this.gameState.playerPiece.blocks[t]];let e=!1;for(;!e;){for(let t=0;t<4;t++)this.isBlockHere(this.gameState.ghostBlocks[t][0],this.gameState.ghostBlocks[t][1]-1)&&(e=!0);if(!e)for(let t=0;t<4;t++)this.gameState.ghostBlocks[t][1]-=1}},Wn=new WeakSet,ba=function(){this.gameState.speedLevel=Math.min(Math.floor(this.gameState.linesCleared/10)+1,Un.levels.max),Je(this,yn,Un.levels[this.gameState.speedLevel])},Ot(Un,"levels",{1:25,2:20,3:16,4:12,5:10,6:8,7:6,8:5,9:4,10:2,11:1,max:11});let va=Un;const Vt=class Vt{constructor(e){this.blocks=[],this.shape=e,this.rotationIndex=0,this.active=!0,this.wasHeld=!1;let t=Vt.getBaseShape(e);for(let r=0;r<4;r++)this.blocks.push([...t[r]]),this.blocks[r][0]+=3,this.blocks[r][1]+=19}static getBaseShape(e){let t;switch(e){case"O":t=Vt.pieces.O;break;case"I":t=Vt.pieces.I;break;case"L":t=Vt.pieces.L;break;case"J":t=Vt.pieces.J;break;case"T":t=Vt.pieces.T;break;case"S":t=Vt.pieces.S;break;case"Z":t=Vt.pieces.Z;break;default:t=[[0,0],[0,0],[0,0],[0,0]]}return t}};Ot(Vt,"offsets",{O:[[[0,0],[0,-1],[-1,-1],[-1,0]]],I:[[[0,0],[-1,0],[-1,1],[0,1]],[[-1,0],[0,0],[1,1],[0,1]],[[2,0],[0,0],[-2,1],[0,1]],[[-1,0],[0,1],[1,0],[0,-1]],[[2,0],[0,-2],[-2,0],[0,2]]],OTHER:[[[0,0],[0,0],[0,0],[0,0]],[[0,0],[1,0],[0,0],[-1,0]],[[0,0],[1,-1],[0,0],[-1,-1]],[[0,0],[0,2],[0,0],[0,2]],[[0,0],[1,2],[0,0],[-1,2]]]}),Ot(Vt,"pieces",{O:[[1,0],[1,1],[2,1],[2,0]],I:[[1,0],[0,0],[2,0],[3,0]],L:[[1,0],[0,0],[2,0],[2,1]],J:[[1,0],[0,0],[0,1],[2,0]],T:[[1,0],[0,0],[2,0],[1,1]],S:[[1,0],[0,0],[1,1],[2,1]],Z:[[1,0],[2,0],[1,1],[0,1]]});let Sr=Vt;var no=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ws={exports:{}};/*!
 * @license twgl.js 5.5.4 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
 * Available via the MIT license.
 * see: http://github.com/greggman/twgl.js for details
 */(function(h,e){(function(r,n){h.exports=n()})(typeof self<"u"?self:no,()=>(()=>{var t={"./src/attributes.js":(u,i,c)=>{function v(E){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(y){return typeof y}:function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},v(E)}i.__esModule=!0,i.createAttribsFromArrays=yt,i.createBufferFromArray=x,i.createBufferFromTypedArray=ge,i.createBufferInfoFromArrays=p,i.createBuffersFromArrays=I,i.getArray_=Z,i.getNumComponents_=Se,i.setAttribInfoBufferFromArray=lt,i.setAttributeDefaults_=ot,i.setAttributePrefix=st;var d=b(c("./src/typedarrays.js")),g=b(c("./src/helper.js"));function _(E){if(typeof WeakMap!="function")return null;var y=new WeakMap,m=new WeakMap;return(_=function(w){return w?m:y})(E)}function b(E,y){if(!y&&E&&E.__esModule)return E;if(E===null||v(E)!="object"&&typeof E!="function")return{default:E};var m=_(y);if(m&&m.has(E))return m.get(E);var A={__proto__:null},w=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var B in E)if(B!=="default"&&Object.prototype.hasOwnProperty.call(E,B)){var k=w?Object.getOwnPropertyDescriptor(E,B):null;k&&(k.get||k.set)?Object.defineProperty(A,B,k):A[B]=E[B]}return A.default=E,m&&m.set(E,A),A}var C=35044,U=34962,ee=34963,M=34660,Q=5120,J=5121,z=5122,q=5123,ne=5124,ae=5125,De=5126,Ae={attribPrefix:""};function st(E){Ae.attribPrefix=E}function ot(E){g.copyExistingProperties(E,Ae)}function qe(E,y,m,A,w){E.bindBuffer(y,m),E.bufferData(y,A,w||C)}function ge(E,y,m,A){if(g.isBuffer(E,y))return y;m=m||U;var w=E.createBuffer();return qe(E,m,w,y,A),w}function G(E){return E==="indices"}function V(E){return E===Int8Array||E===Uint8Array}function Z(E){return E.length?E:E.data}var D=/coord|texture/i,be=/color|colour/i;function we(E,y){var m;if(D.test(E)?m=2:be.test(E)?m=4:m=3,y%m>0)throw new Error("Can not guess numComponents for attribute '".concat(E,"'. Tried ").concat(m," but ").concat(y," values is not evenly divisible by ").concat(m,". You should specify it."));return m}function Se(E,y,m){return E.numComponents||E.size||we(y,m||Z(E).length)}function Ge(E,y){if(d.isArrayBuffer(E))return E;if(d.isArrayBuffer(E.data))return E.data;Array.isArray(E)&&(E={data:E});var m=E.type?rt(E.type):void 0;return m||(G(y)?m=Uint16Array:m=Float32Array),new m(E.data)}function We(E){return typeof E=="number"?E:E?d.getGLTypeForTypedArrayType(E):De}function rt(E){return typeof E=="number"?d.getTypedArrayTypeForGLType(E):E||Float32Array}function $e(E,y){return{buffer:y.buffer,numValues:24,type:We(y.type),arrayType:rt(y.type)}}function mt(E,y){var m=y.data||y,A=rt(y.type),w=m*A.BYTES_PER_ELEMENT,B=E.createBuffer();return E.bindBuffer(U,B),E.bufferData(U,w,y.drawType||C),{buffer:B,numValues:m,type:d.getGLTypeForTypedArrayType(A),arrayType:A}}function Mt(E,y,m){var A=Ge(y,m);return{arrayType:A.constructor,buffer:ge(E,A,void 0,y.drawType),type:d.getGLTypeForTypedArray(A),numValues:0}}function yt(E,y){var m={};return Object.keys(y).forEach(function(A){if(!G(A)){var w=y[A],B=w.attrib||w.name||w.attribName||Ae.attribPrefix+A;if(w.value){if(!Array.isArray(w.value)&&!d.isArrayBuffer(w.value))throw new Error("array.value is not array or typedarray");m[B]={value:w.value}}else{var k;w.buffer&&w.buffer instanceof WebGLBuffer?k=$e:typeof w=="number"||typeof w.data=="number"?k=mt:k=Mt;var X=k(E,w,A),Y=X.buffer,ie=X.type,oe=X.numValues,ce=X.arrayType,me=w.normalize!==void 0?w.normalize:V(ce),fe=Se(w,A,oe);m[B]={buffer:Y,numComponents:fe,type:ie,normalize:me,stride:w.stride||0,offset:w.offset||0,divisor:w.divisor===void 0?void 0:w.divisor,drawType:w.drawType}}}}),E.bindBuffer(U,null),m}function lt(E,y,m,A){m=Ge(m),A!==void 0?(E.bindBuffer(U,y.buffer),E.bufferSubData(U,A,m)):qe(E,U,y.buffer,m,y.drawType)}function vt(E,y){return y===Q||y===J?1:y===z||y===q?2:y===ne||y===ae||y===De?4:0}var Ft=["position","positions","a_position"];function de(E){var y,m;for(m=0;m<Ft.length&&(y=Ft[m],!(y in E));++m);m===Ft.length&&(y=Object.keys(E)[0]);var A=E[y],w=Z(A).length;if(w===void 0)return 1;var B=Se(A,y),k=w/B;if(w%B>0)throw new Error("numComponents ".concat(B," not correct for length ").concat(w));return k}function o(E,y){var m,A;for(A=0;A<Ft.length&&(m=Ft[A],!(m in y||(m=Ae.attribPrefix+m,m in y)));++A);A===Ft.length&&(m=Object.keys(y)[0]);var w=y[m];if(!w.buffer)return 1;E.bindBuffer(U,w.buffer);var B=E.getBufferParameter(U,M);E.bindBuffer(U,null);var k=vt(E,w.type),X=B/k,Y=w.numComponents||w.size,ie=X/Y;if(ie%1!==0)throw new Error("numComponents ".concat(Y," not correct for length ").concat(length));return ie}function p(E,y,m){var A=yt(E,y),w=Object.assign({},m||{});w.attribs=Object.assign({},m?m.attribs:{},A);var B=y.indices;if(B){var k=Ge(B,"indices");w.indices=ge(E,k,ee),w.numElements=k.length,w.elementType=d.getGLTypeForTypedArray(k)}else w.numElements||(w.numElements=o(E,w.attribs));return w}function x(E,y,m){var A=m==="indices"?ee:U,w=Ge(y,m);return ge(E,w,A)}function I(E,y){var m={};return Object.keys(y).forEach(function(A){m[A]=x(E,y[A],A)}),y.indices?(m.numElements=y.indices.length,m.elementType=d.getGLTypeForTypedArray(Ge(y.indices),"indices")):m.numElements=de(y),m}},"./src/draw.js":(u,i,c)=>{function v(M){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Q){return typeof Q}:function(Q){return Q&&typeof Symbol=="function"&&Q.constructor===Symbol&&Q!==Symbol.prototype?"symbol":typeof Q},v(M)}i.__esModule=!0,i.drawBufferInfo=U,i.drawObjectList=ee;var d=_(c("./src/programs.js"));function g(M){if(typeof WeakMap!="function")return null;var Q=new WeakMap,J=new WeakMap;return(g=function(q){return q?J:Q})(M)}function _(M,Q){if(!Q&&M&&M.__esModule)return M;if(M===null||v(M)!="object"&&typeof M!="function")return{default:M};var J=g(Q);if(J&&J.has(M))return J.get(M);var z={__proto__:null},q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ne in M)if(ne!=="default"&&Object.prototype.hasOwnProperty.call(M,ne)){var ae=q?Object.getOwnPropertyDescriptor(M,ne):null;ae&&(ae.get||ae.set)?Object.defineProperty(z,ne,ae):z[ne]=M[ne]}return z.default=M,J&&J.set(M,z),z}var b=4,C=5123;function U(M,Q,J,z,q,ne){J=J===void 0?b:J;var ae=Q.indices,De=Q.elementType,Ae=z===void 0?Q.numElements:z;q=q===void 0?0:q,De||ae?ne!==void 0?M.drawElementsInstanced(J,Ae,De===void 0?C:Q.elementType,q,ne):M.drawElements(J,Ae,De===void 0?C:Q.elementType,q):ne!==void 0?M.drawArraysInstanced(J,q,Ae,ne):M.drawArrays(J,q,Ae)}function ee(M,Q){var J=null,z=null;Q.forEach(function(q){if(q.active!==!1){var ne=q.programInfo,ae=q.vertexArrayInfo||q.bufferInfo,De=!1,Ae=q.type===void 0?b:q.type;ne!==J&&(J=ne,M.useProgram(ne.program),De=!0),(De||ae!==z)&&(z&&z.vertexArrayObject&&!ae.vertexArrayObject&&M.bindVertexArray(null),z=ae,d.setBuffersAndAttributes(M,ne,ae)),d.setUniforms(ne,q.uniforms),U(M,ae,Ae,q.count,q.offset,q.instanceCount)}}),z&&z.vertexArrayObject&&M.bindVertexArray(null)}},"./src/framebuffers.js":(u,i,c)=>{function v(de){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},v(de)}i.__esModule=!0,i.bindFramebufferInfo=Ft,i.createFramebufferInfo=lt,i.resizeFramebufferInfo=vt;var d=b(c("./src/textures.js")),g=b(c("./src/helper.js"));function _(de){if(typeof WeakMap!="function")return null;var o=new WeakMap,p=new WeakMap;return(_=function(I){return I?p:o})(de)}function b(de,o){if(!o&&de&&de.__esModule)return de;if(de===null||v(de)!="object"&&typeof de!="function")return{default:de};var p=_(o);if(p&&p.has(de))return p.get(de);var x={__proto__:null},I=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var E in de)if(E!=="default"&&Object.prototype.hasOwnProperty.call(de,E)){var y=I?Object.getOwnPropertyDescriptor(de,E):null;y&&(y.get||y.set)?Object.defineProperty(x,E,y):x[E]=de[E]}return x.default=de,p&&p.set(de,x),x}var C=36160,U=36161,ee=3553,M=5121,Q=6402,J=6408,z=33190,q=36012,ne=35056,ae=36013,De=32854,Ae=32855,st=36194,ot=33189,qe=6401,ge=36168,G=34041,V=36064,Z=36096,D=36128,be=33306,we=33071,Se=9729,Ge=[{format:J,type:M,min:Se,wrap:we},{format:G}],We={};We[G]=be,We[qe]=D,We[ge]=D,We[Q]=Z,We[ot]=Z,We[z]=Z,We[q]=Z,We[ne]=be,We[ae]=be;function rt(de,o){return We[de]||We[o]}var $e={};$e[De]=!0,$e[Ae]=!0,$e[st]=!0,$e[G]=!0,$e[ot]=!0,$e[qe]=!0,$e[ge]=!0;function mt(de){return $e[de]}var Mt=32;function yt(de){return de>=V&&de<V+Mt}function lt(de,o,p,x){var I=C,E=de.createFramebuffer();de.bindFramebuffer(I,E),p=p||de.drawingBufferWidth,x=x||de.drawingBufferHeight,o=o||Ge;var y=[],m={framebuffer:E,attachments:[],width:p,height:x};return o.forEach(function(A,w){var B=A.attachment,k=A.samples,X=A.format,Y=A.attachmentPoint||rt(X,A.internalFormat);if(Y||(Y=V+w),yt(Y)&&y.push(Y),!B)if(k!==void 0||mt(X))B=de.createRenderbuffer(),de.bindRenderbuffer(U,B),k>1?de.renderbufferStorageMultisample(U,k,X,p,x):de.renderbufferStorage(U,X,p,x);else{var ie=Object.assign({},A);ie.width=p,ie.height=x,ie.auto===void 0&&(ie.auto=!1,ie.min=ie.min||ie.minMag||Se,ie.mag=ie.mag||ie.minMag||Se,ie.wrapS=ie.wrapS||ie.wrap||we,ie.wrapT=ie.wrapT||ie.wrap||we),B=d.createTexture(de,ie)}if(g.isRenderbuffer(de,B))de.framebufferRenderbuffer(I,Y,U,B);else if(g.isTexture(de,B))A.layer!==void 0?de.framebufferTextureLayer(I,Y,B,A.level||0,A.layer):de.framebufferTexture2D(I,Y,A.target||ee,B,A.level||0);else throw new Error("unknown attachment type");m.attachments.push(B)}),de.drawBuffers&&de.drawBuffers(y),m}function vt(de,o,p,x,I){x=x||de.drawingBufferWidth,I=I||de.drawingBufferHeight,o.width=x,o.height=I,p=p||Ge,p.forEach(function(E,y){var m=o.attachments[y],A=E.format,w=E.samples;if(w!==void 0||g.isRenderbuffer(de,m))de.bindRenderbuffer(U,m),w>1?de.renderbufferStorageMultisample(U,w,A,x,I):de.renderbufferStorage(U,A,x,I);else if(g.isTexture(de,m))d.resizeTexture(de,m,E,x,I);else throw new Error("unknown attachment type")})}function Ft(de,o,p){p=p||C,o?(de.bindFramebuffer(p,o.framebuffer),de.viewport(0,0,o.width,o.height)):(de.bindFramebuffer(p,null),de.viewport(0,0,de.drawingBufferWidth,de.drawingBufferHeight))}},"./src/helper.js":(u,i)=>{i.__esModule=!0,i.copyExistingProperties=d,i.copyNamedProperties=v,i.error=g,i.isBuffer=U,i.isRenderbuffer=ee,i.isSampler=J,i.isShader=M,i.isTexture=Q,i.warn=_;function c(z){"@babel/helpers - typeof";return c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(q){return typeof q}:function(q){return q&&typeof Symbol=="function"&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q},c(z)}function v(z,q,ne){z.forEach(function(ae){var De=q[ae];De!==void 0&&(ne[ae]=De)})}function d(z,q){Object.keys(q).forEach(function(ne){q.hasOwnProperty(ne)&&z.hasOwnProperty(ne)&&(q[ne]=z[ne])})}function g(){var z;(z=console).error.apply(z,arguments)}function _(){var z;(z=console).warn.apply(z,arguments)}var b=new Map;function C(z,q){if(!z||c(z)!=="object")return!1;var ne=b.get(q);ne||(ne=new WeakMap,b.set(q,ne));var ae=ne.get(z);if(ae===void 0){var De=Object.prototype.toString.call(z);ae=De.substring(8,De.length-1)===q,ne.set(z,ae)}return ae}function U(z,q){return typeof WebGLBuffer<"u"&&C(q,"WebGLBuffer")}function ee(z,q){return typeof WebGLRenderbuffer<"u"&&C(q,"WebGLRenderbuffer")}function M(z,q){return typeof WebGLShader<"u"&&C(q,"WebGLShader")}function Q(z,q){return typeof WebGLTexture<"u"&&C(q,"WebGLTexture")}function J(z,q){return typeof WebGLSampler<"u"&&C(q,"WebGLSampler")}},"./src/m4.js":(u,i,c)=>{function v(o){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(p){return typeof p}:function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},v(o)}i.__esModule=!0,i.axisRotate=Mt,i.axisRotation=mt,i.copy=M,i.create=ee,i.frustum=qe,i.getAxis=De,i.getTranslation=ae,i.identity=Q,i.inverse=z,i.lookAt=Z,i.multiply=q,i.negate=U,i.ortho=ot,i.perspective=st,i.rotateX=Se,i.rotateY=We,i.rotateZ=$e,i.rotationX=we,i.rotationY=Ge,i.rotationZ=rt,i.scale=lt,i.scaling=yt,i.setAxis=Ae,i.setDefaultType=C,i.setTranslation=ne,i.transformDirection=Ft,i.transformNormal=de,i.transformPoint=vt,i.translate=be,i.translation=D,i.transpose=J;var d=_(c("./src/v3.js"));function g(o){if(typeof WeakMap!="function")return null;var p=new WeakMap,x=new WeakMap;return(g=function(E){return E?x:p})(o)}function _(o,p){if(!p&&o&&o.__esModule)return o;if(o===null||v(o)!="object"&&typeof o!="function")return{default:o};var x=g(p);if(x&&x.has(o))return x.get(o);var I={__proto__:null},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in o)if(y!=="default"&&Object.prototype.hasOwnProperty.call(o,y)){var m=E?Object.getOwnPropertyDescriptor(o,y):null;m&&(m.get||m.set)?Object.defineProperty(I,y,m):I[y]=o[y]}return I.default=o,x&&x.set(o,I),I}var b=Float32Array;function C(o){var p=b;return b=o,p}function U(o,p){return p=p||new b(16),p[0]=-o[0],p[1]=-o[1],p[2]=-o[2],p[3]=-o[3],p[4]=-o[4],p[5]=-o[5],p[6]=-o[6],p[7]=-o[7],p[8]=-o[8],p[9]=-o[9],p[10]=-o[10],p[11]=-o[11],p[12]=-o[12],p[13]=-o[13],p[14]=-o[14],p[15]=-o[15],p}function ee(){return new b(16).fill(0)}function M(o,p){return p=p||new b(16),p[0]=o[0],p[1]=o[1],p[2]=o[2],p[3]=o[3],p[4]=o[4],p[5]=o[5],p[6]=o[6],p[7]=o[7],p[8]=o[8],p[9]=o[9],p[10]=o[10],p[11]=o[11],p[12]=o[12],p[13]=o[13],p[14]=o[14],p[15]=o[15],p}function Q(o){return o=o||new b(16),o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function J(o,p){if(p=p||new b(16),p===o){var x;return x=o[1],o[1]=o[4],o[4]=x,x=o[2],o[2]=o[8],o[8]=x,x=o[3],o[3]=o[12],o[12]=x,x=o[6],o[6]=o[9],o[9]=x,x=o[7],o[7]=o[13],o[13]=x,x=o[11],o[11]=o[14],o[14]=x,p}var I=o[0*4+0],E=o[0*4+1],y=o[0*4+2],m=o[0*4+3],A=o[1*4+0],w=o[1*4+1],B=o[1*4+2],k=o[1*4+3],X=o[2*4+0],Y=o[2*4+1],ie=o[2*4+2],oe=o[2*4+3],ce=o[3*4+0],me=o[3*4+1],fe=o[3*4+2],ve=o[3*4+3];return p[0]=I,p[1]=A,p[2]=X,p[3]=ce,p[4]=E,p[5]=w,p[6]=Y,p[7]=me,p[8]=y,p[9]=B,p[10]=ie,p[11]=fe,p[12]=m,p[13]=k,p[14]=oe,p[15]=ve,p}function z(o,p){p=p||new b(16);var x=o[0*4+0],I=o[0*4+1],E=o[0*4+2],y=o[0*4+3],m=o[1*4+0],A=o[1*4+1],w=o[1*4+2],B=o[1*4+3],k=o[2*4+0],X=o[2*4+1],Y=o[2*4+2],ie=o[2*4+3],oe=o[3*4+0],ce=o[3*4+1],me=o[3*4+2],fe=o[3*4+3],ve=Y*fe,xe=me*ie,le=w*fe,Ee=me*B,ze=w*ie,Ze=Y*B,je=E*fe,He=me*y,Ce=E*ie,Ie=Y*y,tt=E*B,Xe=w*y,et=k*ce,Ye=oe*X,nt=m*ce,Be=oe*A,ke=m*X,Tt=k*A,dt=x*ce,Ct=oe*I,Dt=x*X,Yt=k*I,Jt=x*A,er=m*I,vr=ve*A+Ee*X+ze*ce-(xe*A+le*X+Ze*ce),Vr=xe*I+je*X+Ie*ce-(ve*I+He*X+Ce*ce),Hr=le*I+He*A+tt*ce-(Ee*I+je*A+Xe*ce),qr=Ze*I+Ce*A+Xe*X-(ze*I+Ie*A+tt*X),xt=1/(x*vr+m*Vr+k*Hr+oe*qr);return p[0]=xt*vr,p[1]=xt*Vr,p[2]=xt*Hr,p[3]=xt*qr,p[4]=xt*(xe*m+le*k+Ze*oe-(ve*m+Ee*k+ze*oe)),p[5]=xt*(ve*x+He*k+Ce*oe-(xe*x+je*k+Ie*oe)),p[6]=xt*(Ee*x+je*m+Xe*oe-(le*x+He*m+tt*oe)),p[7]=xt*(ze*x+Ie*m+tt*k-(Ze*x+Ce*m+Xe*k)),p[8]=xt*(et*B+Be*ie+ke*fe-(Ye*B+nt*ie+Tt*fe)),p[9]=xt*(Ye*y+dt*ie+Yt*fe-(et*y+Ct*ie+Dt*fe)),p[10]=xt*(nt*y+Ct*B+Jt*fe-(Be*y+dt*B+er*fe)),p[11]=xt*(Tt*y+Dt*B+er*ie-(ke*y+Yt*B+Jt*ie)),p[12]=xt*(nt*Y+Tt*me+Ye*w-(ke*me+et*w+Be*Y)),p[13]=xt*(Dt*me+et*E+Ct*Y-(dt*Y+Yt*me+Ye*E)),p[14]=xt*(dt*w+er*me+Be*E-(Jt*me+nt*E+Ct*w)),p[15]=xt*(Jt*Y+ke*E+Yt*w-(Dt*w+er*Y+Tt*E)),p}function q(o,p,x){x=x||new b(16);var I=o[0],E=o[1],y=o[2],m=o[3],A=o[4],w=o[5],B=o[6],k=o[7],X=o[8],Y=o[9],ie=o[10],oe=o[11],ce=o[12],me=o[13],fe=o[14],ve=o[15],xe=p[0],le=p[1],Ee=p[2],ze=p[3],Ze=p[4],je=p[5],He=p[6],Ce=p[7],Ie=p[8],tt=p[9],Xe=p[10],et=p[11],Ye=p[12],nt=p[13],Be=p[14],ke=p[15];return x[0]=I*xe+A*le+X*Ee+ce*ze,x[1]=E*xe+w*le+Y*Ee+me*ze,x[2]=y*xe+B*le+ie*Ee+fe*ze,x[3]=m*xe+k*le+oe*Ee+ve*ze,x[4]=I*Ze+A*je+X*He+ce*Ce,x[5]=E*Ze+w*je+Y*He+me*Ce,x[6]=y*Ze+B*je+ie*He+fe*Ce,x[7]=m*Ze+k*je+oe*He+ve*Ce,x[8]=I*Ie+A*tt+X*Xe+ce*et,x[9]=E*Ie+w*tt+Y*Xe+me*et,x[10]=y*Ie+B*tt+ie*Xe+fe*et,x[11]=m*Ie+k*tt+oe*Xe+ve*et,x[12]=I*Ye+A*nt+X*Be+ce*ke,x[13]=E*Ye+w*nt+Y*Be+me*ke,x[14]=y*Ye+B*nt+ie*Be+fe*ke,x[15]=m*Ye+k*nt+oe*Be+ve*ke,x}function ne(o,p,x){return x=x||Q(),o!==x&&(x[0]=o[0],x[1]=o[1],x[2]=o[2],x[3]=o[3],x[4]=o[4],x[5]=o[5],x[6]=o[6],x[7]=o[7],x[8]=o[8],x[9]=o[9],x[10]=o[10],x[11]=o[11]),x[12]=p[0],x[13]=p[1],x[14]=p[2],x[15]=1,x}function ae(o,p){return p=p||d.create(),p[0]=o[12],p[1]=o[13],p[2]=o[14],p}function De(o,p,x){x=x||d.create();var I=p*4;return x[0]=o[I+0],x[1]=o[I+1],x[2]=o[I+2],x}function Ae(o,p,x,I){I!==o&&(I=M(o,I));var E=x*4;return I[E+0]=p[0],I[E+1]=p[1],I[E+2]=p[2],I}function st(o,p,x,I,E){E=E||new b(16);var y=Math.tan(Math.PI*.5-.5*o),m=1/(x-I);return E[0]=y/p,E[1]=0,E[2]=0,E[3]=0,E[4]=0,E[5]=y,E[6]=0,E[7]=0,E[8]=0,E[9]=0,E[10]=(x+I)*m,E[11]=-1,E[12]=0,E[13]=0,E[14]=x*I*m*2,E[15]=0,E}function ot(o,p,x,I,E,y,m){return m=m||new b(16),m[0]=2/(p-o),m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=2/(I-x),m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=2/(E-y),m[11]=0,m[12]=(p+o)/(o-p),m[13]=(I+x)/(x-I),m[14]=(y+E)/(E-y),m[15]=1,m}function qe(o,p,x,I,E,y,m){m=m||new b(16);var A=p-o,w=I-x,B=E-y;return m[0]=2*E/A,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=2*E/w,m[6]=0,m[7]=0,m[8]=(o+p)/A,m[9]=(I+x)/w,m[10]=y/B,m[11]=-1,m[12]=0,m[13]=0,m[14]=E*y/B,m[15]=0,m}var ge,G,V;function Z(o,p,x,I){return I=I||new b(16),ge=ge||d.create(),G=G||d.create(),V=V||d.create(),d.normalize(d.subtract(o,p,V),V),d.normalize(d.cross(x,V,ge),ge),d.normalize(d.cross(V,ge,G),G),I[0]=ge[0],I[1]=ge[1],I[2]=ge[2],I[3]=0,I[4]=G[0],I[5]=G[1],I[6]=G[2],I[7]=0,I[8]=V[0],I[9]=V[1],I[10]=V[2],I[11]=0,I[12]=o[0],I[13]=o[1],I[14]=o[2],I[15]=1,I}function D(o,p){return p=p||new b(16),p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=o[0],p[13]=o[1],p[14]=o[2],p[15]=1,p}function be(o,p,x){x=x||new b(16);var I=p[0],E=p[1],y=p[2],m=o[0],A=o[1],w=o[2],B=o[3],k=o[1*4+0],X=o[1*4+1],Y=o[1*4+2],ie=o[1*4+3],oe=o[2*4+0],ce=o[2*4+1],me=o[2*4+2],fe=o[2*4+3],ve=o[3*4+0],xe=o[3*4+1],le=o[3*4+2],Ee=o[3*4+3];return o!==x&&(x[0]=m,x[1]=A,x[2]=w,x[3]=B,x[4]=k,x[5]=X,x[6]=Y,x[7]=ie,x[8]=oe,x[9]=ce,x[10]=me,x[11]=fe),x[12]=m*I+k*E+oe*y+ve,x[13]=A*I+X*E+ce*y+xe,x[14]=w*I+Y*E+me*y+le,x[15]=B*I+ie*E+fe*y+Ee,x}function we(o,p){p=p||new b(16);var x=Math.cos(o),I=Math.sin(o);return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=x,p[6]=I,p[7]=0,p[8]=0,p[9]=-I,p[10]=x,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}function Se(o,p,x){x=x||new b(16);var I=o[4],E=o[5],y=o[6],m=o[7],A=o[8],w=o[9],B=o[10],k=o[11],X=Math.cos(p),Y=Math.sin(p);return x[4]=X*I+Y*A,x[5]=X*E+Y*w,x[6]=X*y+Y*B,x[7]=X*m+Y*k,x[8]=X*A-Y*I,x[9]=X*w-Y*E,x[10]=X*B-Y*y,x[11]=X*k-Y*m,o!==x&&(x[0]=o[0],x[1]=o[1],x[2]=o[2],x[3]=o[3],x[12]=o[12],x[13]=o[13],x[14]=o[14],x[15]=o[15]),x}function Ge(o,p){p=p||new b(16);var x=Math.cos(o),I=Math.sin(o);return p[0]=x,p[1]=0,p[2]=-I,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=I,p[9]=0,p[10]=x,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}function We(o,p,x){x=x||new b(16);var I=o[0*4+0],E=o[0*4+1],y=o[0*4+2],m=o[0*4+3],A=o[2*4+0],w=o[2*4+1],B=o[2*4+2],k=o[2*4+3],X=Math.cos(p),Y=Math.sin(p);return x[0]=X*I-Y*A,x[1]=X*E-Y*w,x[2]=X*y-Y*B,x[3]=X*m-Y*k,x[8]=X*A+Y*I,x[9]=X*w+Y*E,x[10]=X*B+Y*y,x[11]=X*k+Y*m,o!==x&&(x[4]=o[4],x[5]=o[5],x[6]=o[6],x[7]=o[7],x[12]=o[12],x[13]=o[13],x[14]=o[14],x[15]=o[15]),x}function rt(o,p){p=p||new b(16);var x=Math.cos(o),I=Math.sin(o);return p[0]=x,p[1]=I,p[2]=0,p[3]=0,p[4]=-I,p[5]=x,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}function $e(o,p,x){x=x||new b(16);var I=o[0*4+0],E=o[0*4+1],y=o[0*4+2],m=o[0*4+3],A=o[1*4+0],w=o[1*4+1],B=o[1*4+2],k=o[1*4+3],X=Math.cos(p),Y=Math.sin(p);return x[0]=X*I+Y*A,x[1]=X*E+Y*w,x[2]=X*y+Y*B,x[3]=X*m+Y*k,x[4]=X*A-Y*I,x[5]=X*w-Y*E,x[6]=X*B-Y*y,x[7]=X*k-Y*m,o!==x&&(x[8]=o[8],x[9]=o[9],x[10]=o[10],x[11]=o[11],x[12]=o[12],x[13]=o[13],x[14]=o[14],x[15]=o[15]),x}function mt(o,p,x){x=x||new b(16);var I=o[0],E=o[1],y=o[2],m=Math.sqrt(I*I+E*E+y*y);I/=m,E/=m,y/=m;var A=I*I,w=E*E,B=y*y,k=Math.cos(p),X=Math.sin(p),Y=1-k;return x[0]=A+(1-A)*k,x[1]=I*E*Y+y*X,x[2]=I*y*Y-E*X,x[3]=0,x[4]=I*E*Y-y*X,x[5]=w+(1-w)*k,x[6]=E*y*Y+I*X,x[7]=0,x[8]=I*y*Y+E*X,x[9]=E*y*Y-I*X,x[10]=B+(1-B)*k,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x}function Mt(o,p,x,I){I=I||new b(16);var E=p[0],y=p[1],m=p[2],A=Math.sqrt(E*E+y*y+m*m);E/=A,y/=A,m/=A;var w=E*E,B=y*y,k=m*m,X=Math.cos(x),Y=Math.sin(x),ie=1-X,oe=w+(1-w)*X,ce=E*y*ie+m*Y,me=E*m*ie-y*Y,fe=E*y*ie-m*Y,ve=B+(1-B)*X,xe=y*m*ie+E*Y,le=E*m*ie+y*Y,Ee=y*m*ie-E*Y,ze=k+(1-k)*X,Ze=o[0],je=o[1],He=o[2],Ce=o[3],Ie=o[4],tt=o[5],Xe=o[6],et=o[7],Ye=o[8],nt=o[9],Be=o[10],ke=o[11];return I[0]=oe*Ze+ce*Ie+me*Ye,I[1]=oe*je+ce*tt+me*nt,I[2]=oe*He+ce*Xe+me*Be,I[3]=oe*Ce+ce*et+me*ke,I[4]=fe*Ze+ve*Ie+xe*Ye,I[5]=fe*je+ve*tt+xe*nt,I[6]=fe*He+ve*Xe+xe*Be,I[7]=fe*Ce+ve*et+xe*ke,I[8]=le*Ze+Ee*Ie+ze*Ye,I[9]=le*je+Ee*tt+ze*nt,I[10]=le*He+Ee*Xe+ze*Be,I[11]=le*Ce+Ee*et+ze*ke,o!==I&&(I[12]=o[12],I[13]=o[13],I[14]=o[14],I[15]=o[15]),I}function yt(o,p){return p=p||new b(16),p[0]=o[0],p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=o[1],p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=o[2],p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}function lt(o,p,x){x=x||new b(16);var I=p[0],E=p[1],y=p[2];return x[0]=I*o[0],x[1]=I*o[1],x[2]=I*o[2],x[3]=I*o[3],x[4]=E*o[4],x[5]=E*o[5],x[6]=E*o[6],x[7]=E*o[7],x[8]=y*o[8],x[9]=y*o[9],x[10]=y*o[10],x[11]=y*o[11],o!==x&&(x[12]=o[12],x[13]=o[13],x[14]=o[14],x[15]=o[15]),x}function vt(o,p,x){x=x||d.create();var I=p[0],E=p[1],y=p[2],m=I*o[0*4+3]+E*o[1*4+3]+y*o[2*4+3]+o[3*4+3];return x[0]=(I*o[0]+E*o[4]+y*o[8]+o[12])/m,x[1]=(I*o[1]+E*o[5]+y*o[9]+o[13])/m,x[2]=(I*o[2]+E*o[6]+y*o[10]+o[14])/m,x}function Ft(o,p,x){x=x||d.create();var I=p[0],E=p[1],y=p[2];return x[0]=I*o[0]+E*o[4]+y*o[8],x[1]=I*o[1]+E*o[5]+y*o[9],x[2]=I*o[2]+E*o[6]+y*o[10],x}function de(o,p,x){x=x||d.create();var I=z(o),E=p[0],y=p[1],m=p[2];return x[0]=E*I[0]+y*I[1]+m*I[2],x[1]=E*I[4]+y*I[5]+m*I[6],x[2]=E*I[8]+y*I[9]+m*I[10],x}},"./src/primitives.js":(u,i,c)=>{function v(y){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},v(y)}i.__esModule=!0,i.concatVertices=p,i.create3DFBuffers=i.create3DFBufferInfo=void 0,i.create3DFVertices=Ge,i.createAugmentedTypedArray=z,i.createCrescentBuffers=i.createCrescentBufferInfo=void 0,i.createCrescentVertices=We,i.createCubeBuffers=i.createCubeBufferInfo=i.createCresentVertices=i.createCresentBuffers=i.createCresentBufferInfo=void 0,i.createCubeVertices=be,i.createCylinderBuffers=i.createCylinderBufferInfo=void 0,i.createCylinderVertices=rt,i.createDiscBuffers=i.createDiscBufferInfo=void 0,i.createDiscVertices=mt,i.createPlaneBuffers=i.createPlaneBufferInfo=void 0,i.createPlaneVertices=V,i.createSphereBuffers=i.createSphereBufferInfo=void 0,i.createSphereVertices=Z,i.createTorusBuffers=i.createTorusBufferInfo=void 0,i.createTorusVertices=$e,i.createTruncatedConeBuffers=i.createTruncatedConeBufferInfo=void 0,i.createTruncatedConeVertices=we,i.createXYQuadBuffers=i.createXYQuadBufferInfo=void 0,i.createXYQuadVertices=G,i.deindexVertices=ne,i.duplicateVertices=x,i.flattenNormals=ae,i.makeRandomVertexColors=yt,i.reorientDirections=st,i.reorientNormals=ot,i.reorientPositions=qe,i.reorientVertices=ge;var d=ee(c("./src/attributes.js")),g=ee(c("./src/helper.js")),_=ee(c("./src/typedarrays.js")),b=ee(c("./src/m4.js")),C=ee(c("./src/v3.js"));function U(y){if(typeof WeakMap!="function")return null;var m=new WeakMap,A=new WeakMap;return(U=function(B){return B?A:m})(y)}function ee(y,m){if(!m&&y&&y.__esModule)return y;if(y===null||v(y)!="object"&&typeof y!="function")return{default:y};var A=U(m);if(A&&A.has(y))return A.get(y);var w={__proto__:null},B=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var k in y)if(k!=="default"&&Object.prototype.hasOwnProperty.call(y,k)){var X=B?Object.getOwnPropertyDescriptor(y,k):null;X&&(X.get||X.set)?Object.defineProperty(w,k,X):w[k]=y[k]}return w.default=y,A&&A.set(y,w),w}var M=d.getArray_,Q=d.getNumComponents_;function J(y,m){var A=0;return y.push=function(){for(var w=0;w<arguments.length;++w){var B=arguments[w];if(B instanceof Array||_.isArrayBuffer(B))for(var k=0;k<B.length;++k)y[A++]=B[k];else y[A++]=B}},y.reset=function(w){A=w||0},y.numComponents=m,Object.defineProperty(y,"numElements",{get:function(){return this.length/this.numComponents|0}}),y}function z(y,m,A){var w=A||Float32Array;return J(new w(y*m),y)}function q(y){return y!=="indices"}function ne(y){var m=y.indices,A={},w=m.length;function B(k){for(var X=y[k],Y=X.numComponents,ie=z(Y,w,X.constructor),oe=0;oe<w;++oe)for(var ce=m[oe],me=ce*Y,fe=0;fe<Y;++fe)ie.push(X[me+fe]);A[k]=ie}return Object.keys(y).filter(q).forEach(B),A}function ae(y){if(y.indices)throw new Error("can not flatten normals of indexed vertices. deindex them first");for(var m=y.normal,A=m.length,w=0;w<A;w+=9){var B=m[w+0],k=m[w+1],X=m[w+2],Y=m[w+3],ie=m[w+4],oe=m[w+5],ce=m[w+6],me=m[w+7],fe=m[w+8],ve=B+Y+ce,xe=k+ie+me,le=X+oe+fe,Ee=Math.sqrt(ve*ve+xe*xe+le*le);ve/=Ee,xe/=Ee,le/=Ee,m[w+0]=ve,m[w+1]=xe,m[w+2]=le,m[w+3]=ve,m[w+4]=xe,m[w+5]=le,m[w+6]=ve,m[w+7]=xe,m[w+8]=le}return y}function De(y,m,A){for(var w=y.length,B=new Float32Array(3),k=0;k<w;k+=3)A(m,[y[k],y[k+1],y[k+2]],B),y[k]=B[0],y[k+1]=B[1],y[k+2]=B[2]}function Ae(y,m,A){A=A||C.create();var w=m[0],B=m[1],k=m[2];return A[0]=w*y[0]+B*y[1]+k*y[2],A[1]=w*y[4]+B*y[5]+k*y[6],A[2]=w*y[8]+B*y[9]+k*y[10],A}function st(y,m){return De(y,m,b.transformDirection),y}function ot(y,m){return De(y,b.inverse(m),Ae),y}function qe(y,m){return De(y,m,b.transformPoint),y}function ge(y,m){return Object.keys(y).forEach(function(A){var w=y[A];A.indexOf("pos")>=0?qe(w,m):A.indexOf("tan")>=0||A.indexOf("binorm")>=0?st(w,m):A.indexOf("norm")>=0&&ot(w,m)}),y}function G(y,m,A){return y=y||2,m=m||0,A=A||0,y*=.5,{position:{numComponents:2,data:[m+-1*y,A+-1*y,m+1*y,A+-1*y,m+-1*y,A+1*y,m+1*y,A+1*y]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function V(y,m,A,w,B){y=y||1,m=m||1,A=A||1,w=w||1,B=B||b.identity();for(var k=(A+1)*(w+1),X=z(3,k),Y=z(3,k),ie=z(2,k),oe=0;oe<=w;oe++)for(var ce=0;ce<=A;ce++){var me=ce/A,fe=oe/w;X.push(y*me-y*.5,0,m*fe-m*.5),Y.push(0,1,0),ie.push(me,fe)}for(var ve=A+1,xe=z(3,A*w*2,Uint16Array),le=0;le<w;le++)for(var Ee=0;Ee<A;Ee++)xe.push((le+0)*ve+Ee,(le+1)*ve+Ee,(le+0)*ve+Ee+1),xe.push((le+1)*ve+Ee,(le+1)*ve+Ee+1,(le+0)*ve+Ee+1);var ze=ge({position:X,normal:Y,texcoord:ie,indices:xe},B);return ze}function Z(y,m,A,w,B,k,X){if(m<=0||A<=0)throw new Error("subdivisionAxis and subdivisionHeight must be > 0");w=w||0,B=B||Math.PI,k=k||0,X=X||Math.PI*2;for(var Y=B-w,ie=X-k,oe=(m+1)*(A+1),ce=z(3,oe),me=z(3,oe),fe=z(2,oe),ve=0;ve<=A;ve++)for(var xe=0;xe<=m;xe++){var le=xe/m,Ee=ve/A,ze=ie*le+k,Ze=Y*Ee+w,je=Math.sin(ze),He=Math.cos(ze),Ce=Math.sin(Ze),Ie=Math.cos(Ze),tt=He*Ce,Xe=Ie,et=je*Ce;ce.push(y*tt,y*Xe,y*et),me.push(tt,Xe,et),fe.push(1-le,Ee)}for(var Ye=m+1,nt=z(3,m*A*2,Uint16Array),Be=0;Be<m;Be++)for(var ke=0;ke<A;ke++)nt.push((ke+0)*Ye+Be,(ke+0)*Ye+Be+1,(ke+1)*Ye+Be),nt.push((ke+1)*Ye+Be,(ke+0)*Ye+Be+1,(ke+1)*Ye+Be+1);return{position:ce,normal:me,texcoord:fe,indices:nt}}var D=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function be(y){y=y||1;for(var m=y/2,A=[[-m,-m,-m],[+m,-m,-m],[-m,+m,-m],[+m,+m,-m],[-m,-m,+m],[+m,-m,+m],[-m,+m,+m],[+m,+m,+m]],w=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],B=[[1,0],[0,0],[0,1],[1,1]],k=6*4,X=z(3,k),Y=z(3,k),ie=z(2,k),oe=z(3,6*2,Uint16Array),ce=0;ce<6;++ce){for(var me=D[ce],fe=0;fe<4;++fe){var ve=A[me[fe]],xe=w[ce],le=B[fe];X.push(ve),Y.push(xe),ie.push(le)}var Ee=4*ce;oe.push(Ee+0,Ee+1,Ee+2),oe.push(Ee+0,Ee+2,Ee+3)}return{position:X,normal:Y,texcoord:ie,indices:oe}}function we(y,m,A,w,B,k,X){if(w<3)throw new Error("radialSubdivisions must be 3 or greater");if(B<1)throw new Error("verticalSubdivisions must be 1 or greater");for(var Y=k===void 0?!0:k,ie=X===void 0?!0:X,oe=(Y?2:0)+(ie?2:0),ce=(w+1)*(B+1+oe),me=z(3,ce),fe=z(3,ce),ve=z(2,ce),xe=z(3,w*(B+oe/2)*2,Uint16Array),le=w+1,Ee=Math.atan2(y-m,A),ze=Math.cos(Ee),Ze=Math.sin(Ee),je=Y?-2:0,He=B+(ie?2:0),Ce=je;Ce<=He;++Ce){var Ie=Ce/B,tt=A*Ie,Xe=void 0;Ce<0?(tt=0,Ie=1,Xe=y):Ce>B?(tt=A,Ie=1,Xe=m):Xe=y+(m-y)*(Ce/B),(Ce===-2||Ce===B+2)&&(Xe=0,Ie=0),tt-=A/2;for(var et=0;et<le;++et){var Ye=Math.sin(et*Math.PI*2/w),nt=Math.cos(et*Math.PI*2/w);me.push(Ye*Xe,tt,nt*Xe),Ce<0?fe.push(0,-1,0):Ce>B?fe.push(0,1,0):Xe===0?fe.push(0,0,0):fe.push(Ye*ze,Ze,nt*ze),ve.push(et/w,1-Ie)}}for(var Be=0;Be<B+oe;++Be)if(!(Be===1&&Y||Be===B+oe-2&&ie))for(var ke=0;ke<w;++ke)xe.push(le*(Be+0)+0+ke,le*(Be+0)+1+ke,le*(Be+1)+1+ke),xe.push(le*(Be+0)+0+ke,le*(Be+1)+1+ke,le*(Be+1)+0+ke);return{position:me,normal:fe,texcoord:ve,indices:xe}}function Se(y,m){m=m||[];for(var A=[],w=0;w<y.length;w+=4){var B=y[w],k=y.slice(w+1,w+4);k.push.apply(k,m);for(var X=0;X<B;++X)A.push.apply(A,k)}return A}function Ge(){var y=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],m=[.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0],A=Se([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),w=Se([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),B=y.length/3,k={position:z(3,B),texcoord:z(2,B),normal:z(3,B),color:z(4,B,Uint8Array),indices:z(3,B/3,Uint16Array)};k.position.push(y),k.texcoord.push(m),k.normal.push(A),k.color.push(w);for(var X=0;X<B;++X)k.indices.push(X);return k}function We(y,m,A,w,B,k,X){if(B<=0)throw new Error("subdivisionDown must be > 0");k=k||0,X=X||1;var Y=2,ie=X-k,oe=(B+1)*2*(2+Y),ce=z(3,oe),me=z(3,oe),fe=z(2,oe);function ve(He,Ce,Ie){return He+(Ce-He)*Ie}function xe(He,Ce,Ie,tt,Xe,et){for(var Ye=0;Ye<=B;Ye++){var nt=Ce/(Y-1),Be=Ye/B,ke=(nt-.5)*2,Tt=(k+Be*ie)*Math.PI,dt=Math.sin(Tt),Ct=Math.cos(Tt),Dt=ve(y,He,dt),Yt=ke*w,Jt=Ct*y,er=dt*Dt;ce.push(Yt,Jt,er);var vr=C.add(C.multiply([0,dt,Ct],Ie),tt);me.push(vr),fe.push(nt*Xe+et,Be)}}for(var le=0;le<Y;le++){var Ee=(le/(Y-1)-.5)*2;xe(m,le,[1,1,1],[0,0,0],1,0),xe(m,le,[0,0,0],[Ee,0,0],0,0),xe(A,le,[1,1,1],[0,0,0],1,0),xe(A,le,[0,0,0],[Ee,0,0],0,1)}var ze=z(3,B*2*(2+Y),Uint16Array);function Ze(He,Ce){for(var Ie=0;Ie<B;++Ie)ze.push(He+Ie+0,He+Ie+1,Ce+Ie+0),ze.push(He+Ie+1,Ce+Ie+1,Ce+Ie+0)}var je=B+1;return Ze(je*0,je*4),Ze(je*5,je*7),Ze(je*6,je*2),Ze(je*3,je*1),{position:ce,normal:me,texcoord:fe,indices:ze}}function rt(y,m,A,w,B,k){return we(y,y,m,A,w,B,k)}function $e(y,m,A,w,B,k){if(A<3)throw new Error("radialSubdivisions must be 3 or greater");if(w<3)throw new Error("verticalSubdivisions must be 3 or greater");B=B||0,k=k||Math.PI*2;for(var X=k-B,Y=A+1,ie=w+1,oe=Y*ie,ce=z(3,oe),me=z(3,oe),fe=z(2,oe),ve=z(3,A*w*2,Uint16Array),xe=0;xe<ie;++xe)for(var le=xe/w,Ee=le*Math.PI*2,ze=Math.sin(Ee),Ze=y+ze*m,je=Math.cos(Ee),He=je*m,Ce=0;Ce<Y;++Ce){var Ie=Ce/A,tt=B+Ie*X,Xe=Math.sin(tt),et=Math.cos(tt),Ye=Xe*Ze,nt=et*Ze,Be=Xe*ze,ke=et*ze;ce.push(Ye,He,nt),me.push(Be,je,ke),fe.push(Ie,1-le)}for(var Tt=0;Tt<w;++Tt)for(var dt=0;dt<A;++dt){var Ct=1+dt,Dt=1+Tt;ve.push(Y*Tt+dt,Y*Dt+dt,Y*Tt+Ct),ve.push(Y*Dt+dt,Y*Dt+Ct,Y*Tt+Ct)}return{position:ce,normal:me,texcoord:fe,indices:ve}}function mt(y,m,A,w,B){if(m<3)throw new Error("divisions must be at least 3");A=A||1,B=B||1,w=w||0;for(var k=(m+1)*(A+1),X=z(3,k),Y=z(3,k),ie=z(2,k),oe=z(3,A*m*2,Uint16Array),ce=0,me=y-w,fe=m+1,ve=0;ve<=A;++ve){for(var xe=w+me*Math.pow(ve/A,B),le=0;le<=m;++le){var Ee=2*Math.PI*le/m,ze=xe*Math.cos(Ee),Ze=xe*Math.sin(Ee);if(X.push(ze,0,Ze),Y.push(0,1,0),ie.push(1-le/m,ve/A),ve>0&&le!==m){var je=ce+(le+1),He=ce+le,Ce=ce+le-fe,Ie=ce+(le+1)-fe;oe.push(je,He,Ce),oe.push(je,Ce,Ie)}}ce+=m+1}return{position:X,normal:Y,texcoord:ie,indices:oe}}function Mt(y){return Math.random()*y|0}function yt(y,m){m=m||{};var A=y.position.numElements,w=z(4,A,Uint8Array),B=m.rand||function(me,fe){return fe<3?Mt(256):255};if(y.color=w,y.indices)for(var k=0;k<A;++k)w.push(B(k,0),B(k,1),B(k,2),B(k,3));else for(var X=m.vertsPerColor||3,Y=A/X,ie=0;ie<Y;++ie)for(var oe=[B(ie,0),B(ie,1),B(ie,2),B(ie,3)],ce=0;ce<X;++ce)w.push(oe);return y}function lt(y){return function(m){var A=y.apply(this,Array.prototype.slice.call(arguments,1));return d.createBuffersFromArrays(m,A)}}function vt(y){return function(m){var A=y.apply(null,Array.prototype.slice.call(arguments,1));return d.createBufferInfoFromArrays(m,A)}}var Ft=["numComponents","size","type","normalize","stride","offset","attrib","name","attribName"];function de(y,m,A,w){w=w||0;for(var B=y.length,k=0;k<B;++k)m[A+k]=y[k]+w}function o(y,m){var A=M(y),w=new A.constructor(m),B=w;return A.numComponents&&A.numElements&&J(w,A.numComponents),y.data&&(B={data:w},g.copyNamedProperties(Ft,y,B)),B}function p(y){for(var m={},A,w=function(){var ce=y[B];Object.keys(ce).forEach(function(me){m[me]||(m[me]=[]),!A&&me!=="indices"&&(A=me);var fe=ce[me],ve=Q(fe,me),xe=M(fe),le=xe.length/ve;m[me].push(le)})},B=0;B<y.length;++B)w();function k(oe){for(var ce=0,me,fe=0;fe<y.length;++fe){var ve=y[fe],xe=ve[oe],le=M(xe);ce+=le.length,(!me||xe.data)&&(me=xe)}return{length:ce,spec:me}}function X(oe,ce,me){for(var fe=0,ve=0,xe=0;xe<y.length;++xe){var le=y[xe],Ee=le[oe],ze=M(Ee);oe==="indices"?(de(ze,me,ve,fe),fe+=ce[xe]):de(ze,me,ve),ve+=ze.length}}var Y=m[A],ie={};return Object.keys(m).forEach(function(oe){var ce=k(oe),me=o(ce.spec,ce.length);X(oe,Y,M(me)),ie[oe]=me}),ie}function x(y){var m={};return Object.keys(y).forEach(function(A){var w=y[A],B=M(w),k=o(w,B.length);de(B,M(k),0),m[A]=k}),m}i.create3DFBufferInfo=vt(Ge),i.create3DFBuffers=lt(Ge),i.createCubeBufferInfo=vt(be),i.createCubeBuffers=lt(be),i.createPlaneBufferInfo=vt(V),i.createPlaneBuffers=lt(V),i.createSphereBufferInfo=vt(Z),i.createSphereBuffers=lt(Z),i.createTruncatedConeBufferInfo=vt(we),i.createTruncatedConeBuffers=lt(we),i.createXYQuadBufferInfo=vt(G),i.createXYQuadBuffers=lt(G);var I=i.createCrescentBufferInfo=vt(We),E=i.createCrescentBuffers=lt(We);i.createCylinderBufferInfo=vt(rt),i.createCylinderBuffers=lt(rt),i.createTorusBufferInfo=vt($e),i.createTorusBuffers=lt($e),i.createDiscBufferInfo=vt(mt),i.createDiscBuffers=lt(mt),i.createCresentBufferInfo=I,i.createCresentBuffers=E,i.createCresentVertices=We},"./src/programs.js":(u,i,c)=>{function v(s){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(l){return typeof l}:function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},v(s)}i.__esModule=!0,i.bindTransformFeedbackInfo=nn,i.bindUniformBlock=an,i.createAttributeSetters=Dn,i.createProgram=Dr,i.createProgramAsync=void 0,i.createProgramFromScripts=Mn,i.createProgramFromSources=Fn,i.createProgramInfo=T,i.createProgramInfoAsync=void 0,i.createProgramInfoFromProgram=on,i.createProgramInfos=L,i.createProgramInfosAsync=void 0,i.createPrograms=F,i.createProgramsAsync=void 0,i.createTransformFeedback=Rn,i.createTransformFeedbackInfo=rn,i.createUniformBlockInfo=Nn,i.createUniformBlockInfoFromProgram=Pn,i.createUniformBlockSpecFromProgram=lr,i.createUniformSetters=br,i.setAttributes=In,i.setBlockUniforms=Ji,i.setBuffersAndAttributes=ea,i.setUniformBlock=mi,i.setUniforms=sn,i.setUniformsAndBindTextures=void 0;var d=b(c("./src/utils.js")),g=b(c("./src/helper.js"));function _(s){if(typeof WeakMap!="function")return null;var l=new WeakMap,f=new WeakMap;return(_=function(P){return P?f:l})(s)}function b(s,l){if(!l&&s&&s.__esModule)return s;if(s===null||v(s)!="object"&&typeof s!="function")return{default:s};var f=_(l);if(f&&f.has(s))return f.get(s);var R={__proto__:null},P=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var O in s)if(O!=="default"&&Object.prototype.hasOwnProperty.call(s,O)){var j=P?Object.getOwnPropertyDescriptor(s,O):null;j&&(j.get||j.set)?Object.defineProperty(R,O,j):R[O]=s[O]}return R.default=s,f&&f.set(s,R),R}function C(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */C=function(){return l};var s,l={},f=Object.prototype,R=f.hasOwnProperty,P=Object.defineProperty||function(pe,re,ue){pe[re]=ue.value},O=typeof Symbol=="function"?Symbol:{},j=O.iterator||"@@iterator",W=O.asyncIterator||"@@asyncIterator",K=O.toStringTag||"@@toStringTag";function H(pe,re,ue){return Object.defineProperty(pe,re,{value:ue,enumerable:!0,configurable:!0,writable:!0}),pe[re]}try{H({},"")}catch{H=function(ue,Me,Le){return ue[Me]=Le}}function te(pe,re,ue,Me){var Le=re&&re.prototype instanceof Ve?re:Ve,Pe=Object.create(Le.prototype),pt=new na(Me||[]);return P(Pe,"_invoke",{value:Qs(pe,ue,pt)}),Pe}function ye(pe,re,ue){try{return{type:"normal",arg:pe.call(re,ue)}}catch(Me){return{type:"throw",arg:Me}}}l.wrap=te;var Te="suspendedStart",_e="suspendedYield",Ne="executing",Ue="completed",Oe={};function Ve(){}function Qe(){}function ft(){}var bt={};H(bt,j,function(){return this});var It=Object.getPrototypeOf,Kt=It&&It(It(ia([])));Kt&&Kt!==f&&R.call(Kt,j)&&(bt=Kt);var nr=ft.prototype=Ve.prototype=Object.create(bt);function di(pe){["next","throw","return"].forEach(function(re){H(pe,re,function(ue){return this._invoke(re,ue)})})}function pi(pe,re){function ue(Le,Pe,pt,Bt){var Ut=ye(pe[Le],pe,Pe);if(Ut.type!=="throw"){var Br=Ut.arg,Tr=Br.value;return Tr&&v(Tr)=="object"&&R.call(Tr,"__await")?re.resolve(Tr.__await).then(function(Or){ue("next",Or,pt,Bt)},function(Or){ue("throw",Or,pt,Bt)}):re.resolve(Tr).then(function(Or){Br.value=Or,pt(Br)},function(Or){return ue("throw",Or,pt,Bt)})}Bt(Ut.arg)}var Me;P(this,"_invoke",{value:function(Pe,pt){function Bt(){return new re(function(Ut,Br){ue(Pe,pt,Ut,Br)})}return Me=Me?Me.then(Bt,Bt):Bt()}})}function Qs(pe,re,ue){var Me=Te;return function(Le,Pe){if(Me===Ne)throw new Error("Generator is already running");if(Me===Ue){if(Le==="throw")throw Pe;return{value:s,done:!0}}for(ue.method=Le,ue.arg=Pe;;){var pt=ue.delegate;if(pt){var Bt=Xa(pt,ue);if(Bt){if(Bt===Oe)continue;return Bt}}if(ue.method==="next")ue.sent=ue._sent=ue.arg;else if(ue.method==="throw"){if(Me===Te)throw Me=Ue,ue.arg;ue.dispatchException(ue.arg)}else ue.method==="return"&&ue.abrupt("return",ue.arg);Me=Ne;var Ut=ye(pe,re,ue);if(Ut.type==="normal"){if(Me=ue.done?Ue:_e,Ut.arg===Oe)continue;return{value:Ut.arg,done:ue.done}}Ut.type==="throw"&&(Me=Ue,ue.method="throw",ue.arg=Ut.arg)}}}function Xa(pe,re){var ue=re.method,Me=pe.iterator[ue];if(Me===s)return re.delegate=null,ue==="throw"&&pe.iterator.return&&(re.method="return",re.arg=s,Xa(pe,re),re.method==="throw")||ue!=="return"&&(re.method="throw",re.arg=new TypeError("The iterator does not provide a '"+ue+"' method")),Oe;var Le=ye(Me,pe.iterator,re.arg);if(Le.type==="throw")return re.method="throw",re.arg=Le.arg,re.delegate=null,Oe;var Pe=Le.arg;return Pe?Pe.done?(re[pe.resultName]=Pe.value,re.next=pe.nextLoc,re.method!=="return"&&(re.method="next",re.arg=s),re.delegate=null,Oe):Pe:(re.method="throw",re.arg=new TypeError("iterator result is not an object"),re.delegate=null,Oe)}function Js(pe){var re={tryLoc:pe[0]};1 in pe&&(re.catchLoc=pe[1]),2 in pe&&(re.finallyLoc=pe[2],re.afterLoc=pe[3]),this.tryEntries.push(re)}function ra(pe){var re=pe.completion||{};re.type="normal",delete re.arg,pe.completion=re}function na(pe){this.tryEntries=[{tryLoc:"root"}],pe.forEach(Js,this),this.reset(!0)}function ia(pe){if(pe||pe===""){var re=pe[j];if(re)return re.call(pe);if(typeof pe.next=="function")return pe;if(!isNaN(pe.length)){var ue=-1,Me=function Le(){for(;++ue<pe.length;)if(R.call(pe,ue))return Le.value=pe[ue],Le.done=!1,Le;return Le.value=s,Le.done=!0,Le};return Me.next=Me}}throw new TypeError(v(pe)+" is not iterable")}return Qe.prototype=ft,P(nr,"constructor",{value:ft,configurable:!0}),P(ft,"constructor",{value:Qe,configurable:!0}),Qe.displayName=H(ft,K,"GeneratorFunction"),l.isGeneratorFunction=function(pe){var re=typeof pe=="function"&&pe.constructor;return!!re&&(re===Qe||(re.displayName||re.name)==="GeneratorFunction")},l.mark=function(pe){return Object.setPrototypeOf?Object.setPrototypeOf(pe,ft):(pe.__proto__=ft,H(pe,K,"GeneratorFunction")),pe.prototype=Object.create(nr),pe},l.awrap=function(pe){return{__await:pe}},di(pi.prototype),H(pi.prototype,W,function(){return this}),l.AsyncIterator=pi,l.async=function(pe,re,ue,Me,Le){Le===void 0&&(Le=Promise);var Pe=new pi(te(pe,re,ue,Me),Le);return l.isGeneratorFunction(re)?Pe:Pe.next().then(function(pt){return pt.done?pt.value:Pe.next()})},di(nr),H(nr,K,"Generator"),H(nr,j,function(){return this}),H(nr,"toString",function(){return"[object Generator]"}),l.keys=function(pe){var re=Object(pe),ue=[];for(var Me in re)ue.push(Me);return ue.reverse(),function Le(){for(;ue.length;){var Pe=ue.pop();if(Pe in re)return Le.value=Pe,Le.done=!1,Le}return Le.done=!0,Le}},l.values=ia,na.prototype={constructor:na,reset:function(re){if(this.prev=0,this.next=0,this.sent=this._sent=s,this.done=!1,this.delegate=null,this.method="next",this.arg=s,this.tryEntries.forEach(ra),!re)for(var ue in this)ue.charAt(0)==="t"&&R.call(this,ue)&&!isNaN(+ue.slice(1))&&(this[ue]=s)},stop:function(){this.done=!0;var re=this.tryEntries[0].completion;if(re.type==="throw")throw re.arg;return this.rval},dispatchException:function(re){if(this.done)throw re;var ue=this;function Me(Br,Tr){return pt.type="throw",pt.arg=re,ue.next=Br,Tr&&(ue.method="next",ue.arg=s),!!Tr}for(var Le=this.tryEntries.length-1;Le>=0;--Le){var Pe=this.tryEntries[Le],pt=Pe.completion;if(Pe.tryLoc==="root")return Me("end");if(Pe.tryLoc<=this.prev){var Bt=R.call(Pe,"catchLoc"),Ut=R.call(Pe,"finallyLoc");if(Bt&&Ut){if(this.prev<Pe.catchLoc)return Me(Pe.catchLoc,!0);if(this.prev<Pe.finallyLoc)return Me(Pe.finallyLoc)}else if(Bt){if(this.prev<Pe.catchLoc)return Me(Pe.catchLoc,!0)}else{if(!Ut)throw new Error("try statement without catch or finally");if(this.prev<Pe.finallyLoc)return Me(Pe.finallyLoc)}}}},abrupt:function(re,ue){for(var Me=this.tryEntries.length-1;Me>=0;--Me){var Le=this.tryEntries[Me];if(Le.tryLoc<=this.prev&&R.call(Le,"finallyLoc")&&this.prev<Le.finallyLoc){var Pe=Le;break}}Pe&&(re==="break"||re==="continue")&&Pe.tryLoc<=ue&&ue<=Pe.finallyLoc&&(Pe=null);var pt=Pe?Pe.completion:{};return pt.type=re,pt.arg=ue,Pe?(this.method="next",this.next=Pe.finallyLoc,Oe):this.complete(pt)},complete:function(re,ue){if(re.type==="throw")throw re.arg;return re.type==="break"||re.type==="continue"?this.next=re.arg:re.type==="return"?(this.rval=this.arg=re.arg,this.method="return",this.next="end"):re.type==="normal"&&ue&&(this.next=ue),Oe},finish:function(re){for(var ue=this.tryEntries.length-1;ue>=0;--ue){var Me=this.tryEntries[ue];if(Me.finallyLoc===re)return this.complete(Me.completion,Me.afterLoc),ra(Me),Oe}},catch:function(re){for(var ue=this.tryEntries.length-1;ue>=0;--ue){var Me=this.tryEntries[ue];if(Me.tryLoc===re){var Le=Me.completion;if(Le.type==="throw"){var Pe=Le.arg;ra(Me)}return Pe}}throw new Error("illegal catch attempt")},delegateYield:function(re,ue,Me){return this.delegate={iterator:ia(re),resultName:ue,nextLoc:Me},this.method==="next"&&(this.arg=s),Oe}},l}function U(s,l){var f=Object.keys(s);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(s);l&&(R=R.filter(function(P){return Object.getOwnPropertyDescriptor(s,P).enumerable})),f.push.apply(f,R)}return f}function ee(s){for(var l=1;l<arguments.length;l++){var f=arguments[l]!=null?arguments[l]:{};l%2?U(Object(f),!0).forEach(function(R){M(s,R,f[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(f)):U(Object(f)).forEach(function(R){Object.defineProperty(s,R,Object.getOwnPropertyDescriptor(f,R))})}return s}function M(s,l,f){return l=Q(l),l in s?Object.defineProperty(s,l,{value:f,enumerable:!0,configurable:!0,writable:!0}):s[l]=f,s}function Q(s){var l=J(s,"string");return v(l)=="symbol"?l:String(l)}function J(s,l){if(v(s)!="object"||!s)return s;var f=s[Symbol.toPrimitive];if(f!==void 0){var R=f.call(s,l||"default");if(v(R)!="object")return R;throw new TypeError("@@toPrimitive must return a primitive value.")}return(l==="string"?String:Number)(s)}function z(s,l,f,R,P,O,j){try{var W=s[O](j),K=W.value}catch(H){f(H);return}W.done?l(K):Promise.resolve(K).then(R,P)}function q(s){return function(){var l=this,f=arguments;return new Promise(function(R,P){var O=s.apply(l,f);function j(K){z(O,R,P,j,W,"next",K)}function W(K){z(O,R,P,j,W,"throw",K)}j(void 0)})}}function ne(s,l){return Ae(s)||De(s,l)||ge(s,l)||ae()}function ae(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function De(s,l){var f=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(f!=null){var R,P,O,j,W=[],K=!0,H=!1;try{if(O=(f=f.call(s)).next,l===0){if(Object(f)!==f)return;K=!1}else for(;!(K=(R=O.call(f)).done)&&(W.push(R.value),W.length!==l);K=!0);}catch(te){H=!0,P=te}finally{try{if(!K&&f.return!=null&&(j=f.return(),Object(j)!==j))return}finally{if(H)throw P}}return W}}function Ae(s){if(Array.isArray(s))return s}function st(s,l){var f=typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(!f){if(Array.isArray(s)||(f=ge(s))||l&&s&&typeof s.length=="number"){f&&(s=f);var R=0,P=function(){};return{s:P,n:function(){return R>=s.length?{done:!0}:{done:!1,value:s[R++]}},e:function(H){throw H},f:P}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var O=!0,j=!1,W;return{s:function(){f=f.call(s)},n:function(){var H=f.next();return O=H.done,H},e:function(H){j=!0,W=H},f:function(){try{!O&&f.return!=null&&f.return()}finally{if(j)throw W}}}}function ot(s){return V(s)||G(s)||ge(s)||qe()}function qe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ge(s,l){if(s){if(typeof s=="string")return Z(s,l);var f=Object.prototype.toString.call(s).slice(8,-1);if(f==="Object"&&s.constructor&&(f=s.constructor.name),f==="Map"||f==="Set")return Array.from(s);if(f==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(f))return Z(s,l)}}function G(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function V(s){if(Array.isArray(s))return Z(s)}function Z(s,l){(l==null||l>s.length)&&(l=s.length);for(var f=0,R=new Array(l);f<l;f++)R[f]=s[f];return R}var D=g.error,be=g.warn;function we(s){return typeof document<"u"&&document.getElementById?document.getElementById(s):null}var Se=33984,Ge=35048,We=34962,rt=34963,$e=35345,mt=35982,Mt=36386,yt=35713,lt=35714,vt=35632,Ft=35633,de=35981,o=35718,p=35721,x=35971,I=35382,E=35396,y=35398,m=35392,A=35395,w=5126,B=35664,k=35665,X=35666,Y=5124,ie=35667,oe=35668,ce=35669,me=35670,fe=35671,ve=35672,xe=35673,le=35674,Ee=35675,ze=35676,Ze=35678,je=35680,He=35679,Ce=35682,Ie=35685,tt=35686,Xe=35687,et=35688,Ye=35689,nt=35690,Be=36289,ke=36292,Tt=36293,dt=5125,Ct=36294,Dt=36295,Yt=36296,Jt=36298,er=36299,vr=36300,Vr=36303,Hr=36306,qr=36307,xt=36308,Wi=36311,Xr=3553,Yr=34067,Tn=32879,Kr=35866,Re={};function Jn(s,l){return Re[l].bindPoint}function ji(s,l){return function(f){s.uniform1f(l,f)}}function Vi(s,l){return function(f){s.uniform1fv(l,f)}}function Hi(s,l){return function(f){s.uniform2fv(l,f)}}function qi(s,l){return function(f){s.uniform3fv(l,f)}}function Xi(s,l){return function(f){s.uniform4fv(l,f)}}function ei(s,l){return function(f){s.uniform1i(l,f)}}function ti(s,l){return function(f){s.uniform1iv(l,f)}}function ri(s,l){return function(f){s.uniform2iv(l,f)}}function ni(s,l){return function(f){s.uniform3iv(l,f)}}function ii(s,l){return function(f){s.uniform4iv(l,f)}}function tr(s,l){return function(f){s.uniform1ui(l,f)}}function ut(s,l){return function(f){s.uniform1uiv(l,f)}}function $r(s,l){return function(f){s.uniform2uiv(l,f)}}function xr(s,l){return function(f){s.uniform3uiv(l,f)}}function Zr(s,l){return function(f){s.uniform4uiv(l,f)}}function ar(s,l){return function(f){s.uniformMatrix2fv(l,!1,f)}}function Et(s,l){return function(f){s.uniformMatrix3fv(l,!1,f)}}function ai(s,l){return function(f){s.uniformMatrix4fv(l,!1,f)}}function si(s,l){return function(f){s.uniformMatrix2x3fv(l,!1,f)}}function oi(s,l){return function(f){s.uniformMatrix3x2fv(l,!1,f)}}function kt(s,l){return function(f){s.uniformMatrix2x4fv(l,!1,f)}}function Nr(s,l){return function(f){s.uniformMatrix4x2fv(l,!1,f)}}function En(s,l){return function(f){s.uniformMatrix3x4fv(l,!1,f)}}function Yi(s,l){return function(f){s.uniformMatrix4x3fv(l,!1,f)}}function At(s,l,f,R){var P=Jn(s,l);return d.isWebGL2(s)?function(O){var j,W;!O||g.isTexture(s,O)?(j=O,W=null):(j=O.texture,W=O.sampler),s.uniform1i(R,f),s.activeTexture(Se+f),s.bindTexture(P,j),s.bindSampler(f,W)}:function(O){s.uniform1i(R,f),s.activeTexture(Se+f),s.bindTexture(P,O)}}function St(s,l,f,R,P){for(var O=Jn(s,l),j=new Int32Array(P),W=0;W<P;++W)j[W]=f+W;return d.isWebGL2(s)?function(K){s.uniform1iv(R,j),K.forEach(function(H,te){s.activeTexture(Se+j[te]);var ye,Te;!H||g.isTexture(s,H)?(ye=H,Te=null):(ye=H.texture,Te=H.sampler),s.bindSampler(f,Te),s.bindTexture(O,ye)})}:function(K){s.uniform1iv(R,j),K.forEach(function(H,te){s.activeTexture(Se+j[te]),s.bindTexture(O,H)})}}Re[w]={Type:Float32Array,size:4,setter:ji,arraySetter:Vi},Re[B]={Type:Float32Array,size:8,setter:Hi,cols:2},Re[k]={Type:Float32Array,size:12,setter:qi,cols:3},Re[X]={Type:Float32Array,size:16,setter:Xi,cols:4},Re[Y]={Type:Int32Array,size:4,setter:ei,arraySetter:ti},Re[ie]={Type:Int32Array,size:8,setter:ri,cols:2},Re[oe]={Type:Int32Array,size:12,setter:ni,cols:3},Re[ce]={Type:Int32Array,size:16,setter:ii,cols:4},Re[dt]={Type:Uint32Array,size:4,setter:tr,arraySetter:ut},Re[Ct]={Type:Uint32Array,size:8,setter:$r,cols:2},Re[Dt]={Type:Uint32Array,size:12,setter:xr,cols:3},Re[Yt]={Type:Uint32Array,size:16,setter:Zr,cols:4},Re[me]={Type:Uint32Array,size:4,setter:ei,arraySetter:ti},Re[fe]={Type:Uint32Array,size:8,setter:ri,cols:2},Re[ve]={Type:Uint32Array,size:12,setter:ni,cols:3},Re[xe]={Type:Uint32Array,size:16,setter:ii,cols:4},Re[le]={Type:Float32Array,size:32,setter:ar,rows:2,cols:2},Re[Ee]={Type:Float32Array,size:48,setter:Et,rows:3,cols:3},Re[ze]={Type:Float32Array,size:64,setter:ai,rows:4,cols:4},Re[Ie]={Type:Float32Array,size:32,setter:si,rows:2,cols:3},Re[tt]={Type:Float32Array,size:32,setter:kt,rows:2,cols:4},Re[Xe]={Type:Float32Array,size:48,setter:oi,rows:3,cols:2},Re[et]={Type:Float32Array,size:48,setter:En,rows:3,cols:4},Re[Ye]={Type:Float32Array,size:64,setter:Nr,rows:4,cols:2},Re[nt]={Type:Float32Array,size:64,setter:Yi,rows:4,cols:3},Re[Ze]={Type:null,size:0,setter:At,arraySetter:St,bindPoint:Xr},Re[je]={Type:null,size:0,setter:At,arraySetter:St,bindPoint:Yr},Re[He]={Type:null,size:0,setter:At,arraySetter:St,bindPoint:Tn},Re[Ce]={Type:null,size:0,setter:At,arraySetter:St,bindPoint:Xr},Re[Be]={Type:null,size:0,setter:At,arraySetter:St,bindPoint:Kr},Re[ke]={Type:null,size:0,setter:At,arraySetter:St,bindPoint:Kr},Re[Tt]={Type:null,size:0,setter:At,arraySetter:St,bindPoint:Yr},Re[Jt]={Type:null,size:0,setter:At,arraySetter:St,bindPoint:Xr},Re[er]={Type:null,size:0,setter:At,arraySetter:St,bindPoint:Tn},Re[vr]={Type:null,size:0,setter:At,arraySetter:St,bindPoint:Yr},Re[Vr]={Type:null,size:0,setter:At,arraySetter:St,bindPoint:Kr},Re[Hr]={Type:null,size:0,setter:At,arraySetter:St,bindPoint:Xr},Re[qr]={Type:null,size:0,setter:At,arraySetter:St,bindPoint:Tn},Re[xt]={Type:null,size:0,setter:At,arraySetter:St,bindPoint:Yr},Re[Wi]={Type:null,size:0,setter:At,arraySetter:St,bindPoint:Kr};function Qr(s,l){return function(f){if(f.value)switch(s.disableVertexAttribArray(l),f.value.length){case 4:s.vertexAttrib4fv(l,f.value);break;case 3:s.vertexAttrib3fv(l,f.value);break;case 2:s.vertexAttrib2fv(l,f.value);break;case 1:s.vertexAttrib1fv(l,f.value);break;default:throw new Error("the length of a float constant value must be between 1 and 4!")}else s.bindBuffer(We,f.buffer),s.enableVertexAttribArray(l),s.vertexAttribPointer(l,f.numComponents||f.size,f.type||w,f.normalize||!1,f.stride||0,f.offset||0),s.vertexAttribDivisor&&s.vertexAttribDivisor(l,f.divisor||0)}}function zt(s,l){return function(f){if(f.value)if(s.disableVertexAttribArray(l),f.value.length===4)s.vertexAttrib4iv(l,f.value);else throw new Error("The length of an integer constant value must be 4!");else s.bindBuffer(We,f.buffer),s.enableVertexAttribArray(l),s.vertexAttribIPointer(l,f.numComponents||f.size,f.type||Y,f.stride||0,f.offset||0),s.vertexAttribDivisor&&s.vertexAttribDivisor(l,f.divisor||0)}}function jt(s,l){return function(f){if(f.value)if(s.disableVertexAttribArray(l),f.value.length===4)s.vertexAttrib4uiv(l,f.value);else throw new Error("The length of an unsigned integer constant value must be 4!");else s.bindBuffer(We,f.buffer),s.enableVertexAttribArray(l),s.vertexAttribIPointer(l,f.numComponents||f.size,f.type||dt,f.stride||0,f.offset||0),s.vertexAttribDivisor&&s.vertexAttribDivisor(l,f.divisor||0)}}function sr(s,l,f){var R=f.size,P=f.count;return function(O){s.bindBuffer(We,O.buffer);for(var j=O.size||O.numComponents||R,W=j/P,K=O.type||w,H=Re[K],te=H.size*j,ye=O.normalize||!1,Te=O.offset||0,_e=te/P,Ne=0;Ne<P;++Ne)s.enableVertexAttribArray(l+Ne),s.vertexAttribPointer(l+Ne,W,K,ye,te,Te+_e*Ne),s.vertexAttribDivisor&&s.vertexAttribDivisor(l+Ne,O.divisor||0)}}var at={};at[w]={size:4,setter:Qr},at[B]={size:8,setter:Qr},at[k]={size:12,setter:Qr},at[X]={size:16,setter:Qr},at[Y]={size:4,setter:zt},at[ie]={size:8,setter:zt},at[oe]={size:12,setter:zt},at[ce]={size:16,setter:zt},at[dt]={size:4,setter:jt},at[Ct]={size:8,setter:jt},at[Dt]={size:12,setter:jt},at[Yt]={size:16,setter:jt},at[me]={size:4,setter:zt},at[fe]={size:8,setter:zt},at[ve]={size:12,setter:zt},at[xe]={size:16,setter:zt},at[le]={size:4,setter:sr,count:2},at[Ee]={size:9,setter:sr,count:3},at[ze]={size:16,setter:sr,count:4};var or=/ERROR:\s*\d+:(\d+)/gi;function rr(s){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,R=ot(l.matchAll(or)),P=new Map(R.map(function(O,j){var W=parseInt(O[1]),K=R[j+1],H=K?K.index:l.length,te=l.substring(O.index,H);return[W-1,te]}));return s.split(`
`).map(function(O,j){var W=P.get(j);return"".concat(j+1+f,": ").concat(O).concat(W?`

^^^ `.concat(W):"")}).join(`
`)}var _n=/^[ \t]*\n/;function _t(s){var l=0;return _n.test(s)&&(l=1,s=s.replace(_n,"")),{lineOffset:l,shaderSource:s}}function Jr(s,l){return s.errorCallback(l),s.callback&&setTimeout(function(){s.callback("".concat(l,`
`).concat(s.errors.join(`
`)))}),null}function en(s,l,f,R){R=R||D;var P=s.getShaderParameter(f,yt);if(!P){var O=s.getShaderInfoLog(f),j=_t(s.getShaderSource(f)),W=j.lineOffset,K=j.shaderSource,H="".concat(rr(K,O,W),`
Error compiling `).concat(d.glEnumToString(s,l),": ").concat(O);return R(H),H}return""}function ur(s,l,f){var R,P,O;if(typeof l=="function"&&(f=l,l=void 0),typeof s=="function")f=s,s=void 0;else if(s&&!Array.isArray(s)){var j=s;f=j.errorCallback,s=j.attribLocations,R=j.transformFeedbackVaryings,P=j.transformFeedbackMode,O=j.callback}var W=f||D,K=[],H={errorCallback:function(Te){K.push(Te);for(var _e=arguments.length,Ne=new Array(_e>1?_e-1:0),Ue=1;Ue<_e;Ue++)Ne[Ue-1]=arguments[Ue];W.apply(void 0,[Te].concat(Ne))},transformFeedbackVaryings:R,transformFeedbackMode:P,callback:O,errors:K};{var te={};Array.isArray(s)?s.forEach(function(ye,Te){te[ye]=l?l[Te]:Te}):te=s||{},H.attribLocations=te}return H}var cr=["VERTEX_SHADER","FRAGMENT_SHADER"];function ui(s,l){if(l.indexOf("frag")>=0)return vt;if(l.indexOf("vert")>=0)return Ft}function ci(s,l,f){var R=s.getAttachedShaders(l),P=st(R),O;try{for(P.s();!(O=P.n()).done;){var j=O.value;f.has(j)&&s.deleteShader(j)}}catch(W){P.e(W)}finally{P.f()}s.deleteProgram(l)}var hi=function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return new Promise(function(f){return setTimeout(f,l)})};function li(s,l,f){for(var R=s.createProgram(),P=ur(f),O=P.attribLocations,j=P.transformFeedbackVaryings,W=P.transformFeedbackMode,K=0;K<l.length;++K){var H=l[K];if(typeof H=="string"){var te=we(H),ye=te?te.text:H,Te=s[cr[K]];te&&te.type&&(Te=ui(s,te.type)||Te),H=s.createShader(Te),s.shaderSource(H,_t(ye).shaderSource),s.compileShader(H),s.attachShader(R,H)}}Object.entries(O).forEach(function(Ne){var Ue=ne(Ne,2),Oe=Ue[0],Ve=Ue[1];return s.bindAttribLocation(R,Ve,Oe)});{var _e=j;_e&&(_e.attribs&&(_e=_e.attribs),Array.isArray(_e)||(_e=Object.keys(_e)),s.transformFeedbackVaryings(R,_e,W||de))}return s.linkProgram(R),R}function Dr(s,l,f,R,P){var O=ur(f,R,P),j=new Set(l),W=li(s,l,O);function K(H,te){var ye=Sn(H,te,O.errorCallback);return ye&&ci(H,te,j),ye}if(O.callback){wn(s,W).then(function(){var H=K(s,W);O.callback(H,H?void 0:W)});return}return K(s,W)?void 0:W}function hr(s){return function(l,f){for(var R=arguments.length,P=new Array(R>2?R-2:0),O=2;O<R;O++)P[O-2]=arguments[O];return new Promise(function(j,W){var K=ur.apply(void 0,P);K.callback=function(H,te){H?W(H):j(te)},s(l,f,K)})}}i.createProgramAsync=hr(Dr),i.createProgramInfoAsync=hr(T);function wn(s,l){return An.apply(this,arguments)}function An(){return An=q(C().mark(function s(l,f){var R,P,O;return C().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:R=l.getExtension("KHR_parallel_shader_compile"),P=R?function(K,H){return K.getProgramParameter(H,R.COMPLETION_STATUS_KHR)}:function(){return!0},O=0;case 3:return W.next=5,hi(O);case 5:O=16.666666666666668;case 6:if(!P(l,f)){W.next=3;break}case 7:case"end":return W.stop()}},s)})),An.apply(this,arguments)}function gr(s,l){return tn.apply(this,arguments)}function tn(){return tn=q(C().mark(function s(l,f){var R,P,O;return C().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:R=0,P=Object.values(f);case 1:if(!(R<P.length)){W.next=8;break}return O=P[R],W.next=5,wn(l,O);case 5:R++,W.next=1;break;case 8:case"end":return W.stop()}},s)})),tn.apply(this,arguments)}function Sn(s,l,f){f=f||D;var R=s.getProgramParameter(l,lt);if(!R){var P=s.getProgramInfoLog(l);f("Error in program linking: ".concat(P));var O=s.getAttachedShaders(l),j=O.map(function(W){return en(s,s.getShaderParameter(W,s.SHADER_TYPE),W,f)});return"".concat(P,`
`).concat(j.filter(function(W){return W}).join(`
`))}}function Mn(s,l,f,R,P){var O=ur(f,R,P),j=[],W=st(l),K;try{for(W.s();!(K=W.n()).done;){var H=K.value,te=we(H);if(!te)return Jr(O,"unknown script element: ".concat(H));j.push(te.text)}}catch(ye){W.e(ye)}finally{W.f()}return Dr(s,j,O)}function Fn(s,l,f,R,P){return Dr(s,l,f,R,P)}function Cn(s){var l=s.name;return l.startsWith("gl_")||l.startsWith("webgl_")}var Ki=/(\.|\[|]|\w+)/g,$i=function(l){return l>="0"&&l<="9"};function Ir(s,l,f,R){for(var P=s.split(Ki).filter(function(Ne){return Ne!==""}),O=0,j="";;){var W=P[O++];j+=W;var K=$i(W[0]),H=K?parseInt(W):W;K&&(j+=P[O++]);var te=O===P.length;if(te){f[H]=l;break}else{var ye=P[O++],Te=ye==="[",_e=f[H]||(Te?[]:{});f[H]=_e,f=_e,R[j]=R[j]||function(Ne){return function(Ue){yi(Ne,Ue)}}(_e),j+=ye}}}function br(s,l){var f=0;function R(Te,_e,Ne){var Ue=_e.name.endsWith("[0]"),Oe=_e.type,Ve=Re[Oe];if(!Ve)throw new Error("unknown type: 0x".concat(Oe.toString(16)));var Qe;if(Ve.bindPoint){var ft=f;f+=_e.size,Ue?Qe=Ve.arraySetter(s,Oe,ft,Ne,_e.size):Qe=Ve.setter(s,Oe,ft,Ne,_e.size)}else Ve.arraySetter&&Ue?Qe=Ve.arraySetter(s,Ne):Qe=Ve.setter(s,Ne);return Qe.location=Ne,Qe}for(var P={},O={},j=s.getProgramParameter(l,o),W=0;W<j;++W){var K=s.getActiveUniform(l,W);if(!Cn(K)){var H=K.name;H.endsWith("[0]")&&(H=H.substr(0,H.length-3));var te=s.getUniformLocation(l,K.name);if(te){var ye=R(l,K,te);P[H]=ye,Ir(H,ye,O,P)}}}return P}function rn(s,l){for(var f={},R=s.getProgramParameter(l,x),P=0;P<R;++P){var O=s.getTransformFeedbackVarying(l,P);f[O.name]={index:P,type:O.type,size:O.size}}return f}function nn(s,l,f){l.transformFeedbackInfo&&(l=l.transformFeedbackInfo),f.attribs&&(f=f.attribs);for(var R in f){var P=l[R];if(P){var O=f[R];O.offset?s.bindBufferRange(mt,P.index,O.buffer,O.offset,O.size):s.bindBufferBase(mt,P.index,O.buffer)}}}function Rn(s,l,f){var R=s.createTransformFeedback();return s.bindTransformFeedback(Mt,R),s.useProgram(l.program),nn(s,l,f),s.bindTransformFeedback(Mt,null),R}function lr(s,l){for(var f=s.getProgramParameter(l,o),R=[],P=[],O=0;O<f;++O){P.push(O),R.push({});var j=s.getActiveUniform(l,O);R[O].name=j.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(Te){var _e=Te[0],Ne=Te[1];s.getActiveUniforms(l,P,s[_e]).forEach(function(Ue,Oe){R[Oe][Ne]=Ue})});for(var W={},K=s.getProgramParameter(l,I),H=0;H<K;++H){var te=s.getActiveUniformBlockName(l,H),ye={index:s.getUniformBlockIndex(l,te),usedByVertexShader:s.getActiveUniformBlockParameter(l,H,E),usedByFragmentShader:s.getActiveUniformBlockParameter(l,H,y),size:s.getActiveUniformBlockParameter(l,H,m),uniformIndices:s.getActiveUniformBlockParameter(l,H,A)};ye.used=ye.usedByVertexShader||ye.usedByFragmentShader,W[te]=ye}return{blockSpecs:W,uniformData:R}}var fi=/\[\d+\]\.$/,Zi=function(l,f){return((l+(f-1))/f|0)*f};function Qi(s,l,f,R){if(l||f){R=R||1;var P=s.length,O=P/4;return function(j){for(var W=0,K=0,H=0;H<O;++H){for(var te=0;te<R;++te)s[W++]=j[K++];W+=4-R}}}else return function(j){j.length?s.set(j):s[0]=j}}function Pn(s,l,f,R){var P=f.blockSpecs,O=f.uniformData,j=P[R];if(!j)return be("no uniform block object named:",R),{name:R,uniforms:{}};var W=new ArrayBuffer(j.size),K=s.createBuffer(),H=j.index;s.bindBuffer($e,K),s.uniformBlockBinding(l,j.index,H);var te=R+".";fi.test(te)&&(te=te.replace(fi,"."));var ye={},Te={},_e={};return j.uniformIndices.forEach(function(Ne){var Ue=O[Ne],Oe=Ue.name;Oe.startsWith(te)&&(Oe=Oe.substr(te.length));var Ve=Oe.endsWith("[0]");Ve&&(Oe=Oe.substr(0,Oe.length-3));var Qe=Re[Ue.type],ft=Qe.Type,bt=Ve?Zi(Qe.size,16)*Ue.size:Qe.size*Ue.size,It=new ft(W,Ue.offset,bt/ft.BYTES_PER_ELEMENT);ye[Oe]=It;var Kt=Qi(It,Ve,Qe.rows,Qe.cols);Te[Oe]=Kt,Ir(Oe,Kt,_e,Te)}),{name:R,array:W,asFloat:new Float32Array(W),buffer:K,uniforms:ye,setters:Te}}function Nn(s,l,f){return Pn(s,l.program,l.uniformBlockSpec,f)}function an(s,l,f){var R=l.uniformBlockSpec||l,P=R.blockSpecs[f.name];if(P){var O=P.index;return s.bindBufferRange($e,O,f.buffer,f.offset||0,f.array.byteLength),!0}return!1}function mi(s,l,f){an(s,l,f)&&s.bufferData($e,f.array,Ge)}function Ji(s,l){var f=s.setters;for(var R in l){var P=f[R];if(P){var O=l[R];P(O)}}}function yi(s,l){for(var f in l){var R=s[f];typeof R=="function"?R(l[f]):yi(s[f],l[f])}}function sn(s){for(var l=s.uniformSetters||s,f=arguments.length<=1?0:arguments.length-1,R=0;R<f;++R){var P=R+1<1||arguments.length<=R+1?void 0:arguments[R+1];if(Array.isArray(P))for(var O=P.length,j=0;j<O;++j)sn(l,P[j]);else for(var W in P){var K=l[W];K&&K(P[W])}}}i.setUniformsAndBindTextures=sn;function Dn(s,l){for(var f={},R=s.getProgramParameter(l,p),P=0;P<R;++P){var O=s.getActiveAttrib(l,P);if(!Cn(O)){var j=s.getAttribLocation(l,O.name),W=at[O.type],K=W.setter(s,j,W);K.location=j,f[O.name]=K}}return f}function In(s,l){for(var f in l){var R=s[f];R&&R(l[f])}}function ea(s,l,f){f.vertexArrayObject?s.bindVertexArray(f.vertexArrayObject):(In(l.attribSetters||l,f.attribs),f.indices&&s.bindBuffer(rt,f.indices))}function on(s,l){var f=br(s,l),R=Dn(s,l),P={program:l,uniformSetters:f,attribSetters:R};return d.isWebGL2(s)&&(P.uniformBlockSpec=lr(s,l),P.transformFeedbackInfo=rn(s,l)),P}var ta=/\s|{|}|;/;function T(s,l,f,R,P){var O=ur(f,R,P),j=[];if(l=l.map(function(H){if(!ta.test(H)){var te=we(H);if(te)H=te.text;else{var ye="no element with id: ".concat(H);O.errorCallback(ye),j.push(ye)}}return H}),j.length)return Jr(O,"");var W=O.callback;W&&(O.callback=function(H,te){W(H,H?void 0:on(s,te))});var K=Fn(s,l,O);return K?on(s,K):null}function S(s,l,f,R,P){for(var O=0,j=Object.entries(l);O<j.length;O++){var W=ne(j[O],2),K=W[0],H=W[1],te=ee({},P),ye=f[K];Array.isArray(ye)||Object.assign(te,ye);var Te=Sn(s,H,te.errorCallback);if(Te){for(var _e=0,Ne=Object.values(l);_e<Ne.length;_e++){var Ue=Ne[_e],Oe=s.getAttachedShaders(Ue);s.deleteProgram(Ue);var Ve=st(Oe),Qe;try{for(Ve.s();!(Qe=Ve.n()).done;){var ft=Qe.value;R.has(ft)||s.deleteShader(ft)}}catch(bt){Ve.e(bt)}finally{Ve.f()}}return Te}}}function F(s,l){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},R=new Set,P=Object.fromEntries(Object.entries(l).map(function(j){var W=ne(j,2),K=W[0],H=W[1],te=ee({},f),ye=Array.isArray(H)?H:H.shaders;return Array.isArray(H)||Object.assign(te,H),ye.forEach(R.add,R),[K,li(s,ye,te)]}));if(f.callback){gr(s,P).then(function(){var j=S(s,P,l,R,f);f.callback(j,j?void 0:P)});return}var O=S(s,P,l,R,f);return O?void 0:P}function L(s,l,f){f=ur(f);function R(j,W){return Object.fromEntries(Object.entries(W).map(function(K){var H=ne(K,2),te=H[0],ye=H[1];return[te,on(j,ye)]}))}var P=f.callback;P&&(f.callback=function(j,W){P(j,j?void 0:R(s,W))});var O=F(s,l,f);if(!(P||!O))return R(s,O)}i.createProgramsAsync=hr(F),i.createProgramInfosAsync=hr(L)},"./src/textures.js":(u,i,c)=>{function v(T){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S},v(T)}i.__esModule=!0,i.canFilter=hi,i.canGenerateMipmap=ci,i.createSampler=Cn,i.createSamplers=Ki,i.createTexture=In,i.createTextures=ta,i.getBytesPerElementForInternalFormat=ur,i.getFormatAndTypeForInternalFormat=cr,i.getNumComponentsForFormat=li,i.loadTextureFromUrl=mi,i.resizeTexture=ea,i.setDefaultTextureColor=wn,i.setEmptyTexture=Dn,i.setSamplerParameters=Fn,i.setTextureDefaults_=An,i.setTextureFilteringForSize=Ir,i.setTextureFromArray=sn,i.setTextureFromElement=Rn,i.setTextureParameters=Mn;var d=C(c("./src/utils.js")),g=C(c("./src/typedarrays.js")),_=C(c("./src/helper.js"));function b(T){if(typeof WeakMap!="function")return null;var S=new WeakMap,F=new WeakMap;return(b=function(s){return s?F:S})(T)}function C(T,S){if(!S&&T&&T.__esModule)return T;if(T===null||v(T)!="object"&&typeof T!="function")return{default:T};var F=b(S);if(F&&F.has(T))return F.get(T);var L={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in T)if(l!=="default"&&Object.prototype.hasOwnProperty.call(T,l)){var f=s?Object.getOwnPropertyDescriptor(T,l):null;f&&(f.get||f.set)?Object.defineProperty(L,l,f):L[l]=T[l]}return L.default=T,F&&F.set(T,L),L}var U={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},ee=g.isArrayBuffer,M=function(){var T;return function(){return T=T||(typeof document<"u"&&document.createElement?document.createElement("canvas").getContext("2d"):null),T}}(),Q=6406,J=6407,z=6408,q=6409,ne=6410,ae=6402,De=34041,Ae=33071,st=9728,ot=9729,qe=3553,ge=34067,G=32879,V=35866,Z=34069,D=34070,be=34071,we=34072,Se=34073,Ge=34074,We=10241,rt=10240,$e=10242,mt=10243,Mt=32882,yt=33082,lt=33083,vt=33084,Ft=33085,de=34892,o=34893,p=3317,x=3314,I=32878,E=3316,y=3315,m=32877,A=37443,w=37441,B=37440,k=33321,X=36756,Y=33325,ie=33326,oe=33330,ce=33329,me=33338,fe=33337,ve=33340,xe=33339,le=33323,Ee=36757,ze=33327,Ze=33328,je=33336,He=33335,Ce=33332,Ie=33331,tt=33334,Xe=33333,et=32849,Ye=35905,nt=36194,Be=36758,ke=35898,Tt=35901,dt=34843,Ct=34837,Dt=36221,Yt=36239,Jt=36215,er=36233,vr=36209,Vr=36227,Hr=32856,qr=35907,xt=36759,Wi=32855,Xr=32854,Yr=32857,Tn=34842,Kr=34836,Re=36220,Jn=36238,ji=36975,Vi=36214,Hi=36232,qi=36226,Xi=36208,ei=33189,ti=33190,ri=36012,ni=36013,ii=35056,tr=5120,ut=5121,$r=5122,xr=5123,Zr=5124,ar=5125,Et=5126,ai=32819,si=32820,oi=33635,kt=5131,Nr=36193,En=33640,Yi=35899,At=35902,St=36269,Qr=34042,zt=33319,jt=33320,sr=6403,at=36244,or=36248,rr=36249,_n={};{var _t=_n;_t[Q]={numColorComponents:1},_t[q]={numColorComponents:1},_t[ne]={numColorComponents:2},_t[J]={numColorComponents:3},_t[z]={numColorComponents:4},_t[sr]={numColorComponents:1},_t[at]={numColorComponents:1},_t[zt]={numColorComponents:2},_t[jt]={numColorComponents:2},_t[J]={numColorComponents:3},_t[or]={numColorComponents:3},_t[z]={numColorComponents:4},_t[rr]={numColorComponents:4},_t[ae]={numColorComponents:1},_t[De]={numColorComponents:2}}var Jr;function en(T){if(!Jr){var S={};S[Q]={textureFormat:Q,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[ut,kt,Nr,Et]},S[q]={textureFormat:q,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[ut,kt,Nr,Et]},S[ne]={textureFormat:ne,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[ut,kt,Nr,Et]},S[J]={textureFormat:J,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[ut,kt,Nr,Et,oi]},S[z]={textureFormat:z,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[ut,kt,Nr,Et,ai,si]},S[ae]={textureFormat:ae,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[ar,xr]},S[k]={textureFormat:sr,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1],type:[ut]},S[X]={textureFormat:sr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[1],type:[tr]},S[Y]={textureFormat:sr,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[Et,kt]},S[ie]={textureFormat:sr,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[4],type:[Et]},S[oe]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[ut]},S[ce]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[1],type:[tr]},S[Ce]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[xr]},S[Ie]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[$r]},S[tt]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ar]},S[Xe]={textureFormat:at,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Zr]},S[le]={textureFormat:zt,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2],type:[ut]},S[Ee]={textureFormat:zt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[2],type:[tr]},S[ze]={textureFormat:zt,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[Et,kt]},S[Ze]={textureFormat:zt,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[8],type:[Et]},S[je]={textureFormat:jt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[ut]},S[He]={textureFormat:jt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2],type:[tr]},S[me]={textureFormat:jt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[xr]},S[fe]={textureFormat:jt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[$r]},S[ve]={textureFormat:jt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[ar]},S[xe]={textureFormat:jt,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[Zr]},S[et]={textureFormat:J,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3],type:[ut]},S[Ye]={textureFormat:J,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[ut]},S[nt]={textureFormat:J,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[ut,oi]},S[Be]={textureFormat:J,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[3],type:[tr]},S[ke]={textureFormat:J,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[Et,kt,Yi]},S[Tt]={textureFormat:J,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[Et,kt,At]},S[dt]={textureFormat:J,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[Et,kt]},S[Ct]={textureFormat:J,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[Et]},S[Dt]={textureFormat:or,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[ut]},S[Yt]={textureFormat:or,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[3],type:[tr]},S[Jt]={textureFormat:or,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[xr]},S[er]={textureFormat:or,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[6],type:[$r]},S[vr]={textureFormat:or,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[ar]},S[Vr]={textureFormat:or,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[12],type:[Zr]},S[Hr]={textureFormat:z,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[ut]},S[qr]={textureFormat:z,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[ut]},S[xt]={textureFormat:z,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4],type:[tr]},S[Wi]={textureFormat:z,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[ut,si,En]},S[Xr]={textureFormat:z,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[ut,ai]},S[Yr]={textureFormat:z,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4],type:[En]},S[Tn]={textureFormat:z,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[Et,kt]},S[Kr]={textureFormat:z,colorRenderable:!1,textureFilterable:!1,bytesPerElement:[16],type:[Et]},S[Re]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ut]},S[Jn]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[tr]},S[ji]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[En]},S[Vi]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[xr]},S[Hi]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[8],type:[$r]},S[qi]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[Zr]},S[Xi]={textureFormat:rr,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[16],type:[ar]},S[ei]={textureFormat:ae,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[xr,ar]},S[ti]={textureFormat:ae,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[ar]},S[ri]={textureFormat:ae,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Et]},S[ii]={textureFormat:De,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[Qr]},S[ni]={textureFormat:De,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[4],type:[St]},Object.keys(S).forEach(function(F){var L=S[F];L.bytesPerElementMap={},L.bytesPerElement.forEach(function(s,l){var f=L.type[l];L.bytesPerElementMap[f]=s})}),Jr=S}return Jr[T]}function ur(T,S){var F=en(T);if(!F)throw"unknown internal format";var L=F.bytesPerElementMap[S];if(L===void 0)throw"unknown internal format";return L}function cr(T){var S=en(T);if(!S)throw"unknown internal format";return{format:S.textureFormat,type:S.type[0]}}function ui(T){return(T&T-1)===0}function ci(T,S,F,L){if(!d.isWebGL2(T))return ui(S)&&ui(F);var s=en(L);if(!s)throw"unknown internal format";return s.colorRenderable&&s.textureFilterable}function hi(T){var S=en(T);if(!S)throw"unknown internal format";return S.textureFilterable}function li(T){var S=_n[T];if(!S)throw"unknown format: "+T;return S.numColorComponents}function Dr(T,S,F){return ee(S)?g.getGLTypeForTypedArray(S):F||ut}function hr(T,S,F,L,s){if(s%1!==0)throw"can't guess dimensions";if(!F&&!L){var l=Math.sqrt(s/(S===ge?6:1));l%1===0?(F=l,L=l):(F=s,L=1)}else if(L){if(!F&&(F=s/L,F%1))throw"can't guess dimensions"}else if(L=s/F,L%1)throw"can't guess dimensions";return{width:F,height:L}}function wn(T){U.textureColor=new Uint8Array([T[0]*255,T[1]*255,T[2]*255,T[3]*255])}function An(T){_.copyExistingProperties(T,U),T.textureColor&&wn(T.textureColor)}function gr(T,S){S.colorspaceConversion!==void 0&&T.pixelStorei(A,S.colorspaceConversion),S.premultiplyAlpha!==void 0&&T.pixelStorei(w,S.premultiplyAlpha),S.flipY!==void 0&&T.pixelStorei(B,S.flipY)}function tn(T){T.pixelStorei(p,4),d.isWebGL2(T)&&(T.pixelStorei(x,0),T.pixelStorei(I,0),T.pixelStorei(E,0),T.pixelStorei(y,0),T.pixelStorei(m,0))}function Sn(T,S,F,L){L.minMag&&(F.call(T,S,We,L.minMag),F.call(T,S,rt,L.minMag)),L.min&&F.call(T,S,We,L.min),L.mag&&F.call(T,S,rt,L.mag),L.wrap&&(F.call(T,S,$e,L.wrap),F.call(T,S,mt,L.wrap),(S===G||_.isSampler(T,S))&&F.call(T,S,Mt,L.wrap)),L.wrapR&&F.call(T,S,Mt,L.wrapR),L.wrapS&&F.call(T,S,$e,L.wrapS),L.wrapT&&F.call(T,S,mt,L.wrapT),L.minLod!==void 0&&F.call(T,S,yt,L.minLod),L.maxLod!==void 0&&F.call(T,S,lt,L.maxLod),L.baseLevel!==void 0&&F.call(T,S,vt,L.baseLevel),L.maxLevel!==void 0&&F.call(T,S,Ft,L.maxLevel),L.compareFunc!==void 0&&F.call(T,S,o,L.compareFunc),L.compareMode!==void 0&&F.call(T,S,de,L.compareMode)}function Mn(T,S,F){var L=F.target||qe;T.bindTexture(L,S),Sn(T,L,T.texParameteri,F)}function Fn(T,S,F){Sn(T,S,T.samplerParameteri,F)}function Cn(T,S){var F=T.createSampler();return Fn(T,F,S),F}function Ki(T,S){var F={};return Object.keys(S).forEach(function(L){F[L]=Cn(T,S[L])}),F}function $i(T){return T=T||U.textureColor,ee(T)?T:new Uint8Array([T[0]*255,T[1]*255,T[2]*255,T[3]*255])}function Ir(T,S,F,L,s,l){F=F||U.textureOptions,l=l||z;var f=F.target||qe;if(L=L||F.width,s=s||F.height,T.bindTexture(f,S),ci(T,L,s,l))T.generateMipmap(f);else{var R=hi(l)?ot:st;T.texParameteri(f,We,R),T.texParameteri(f,rt,R),T.texParameteri(f,$e,Ae),T.texParameteri(f,mt,Ae)}}function br(T){return T.auto===!0||T.auto===void 0&&T.level===void 0}function rn(T,S){return S=S||{},S.cubeFaceOrder||[Z,D,be,we,Se,Ge]}function nn(T,S){var F=rn(T,S),L=F.map(function(s,l){return{face:s,ndx:l}});return L.sort(function(s,l){return s.face-l.face}),L}function Rn(T,S,F,L){L=L||U.textureOptions;var s=L.target||qe,l=L.level||0,f=F.width,R=F.height,P=L.internalFormat||L.format||z,O=cr(P),j=L.format||O.format,W=L.type||O.type;if(gr(T,L),T.bindTexture(s,S),s===ge){var K=F.width,H=F.height,te,ye;if(K/6===H)te=H,ye=[0,0,1,0,2,0,3,0,4,0,5,0];else if(H/6===K)te=K,ye=[0,0,0,1,0,2,0,3,0,4,0,5];else if(K/3===H/2)te=K/3,ye=[0,0,1,0,2,0,0,1,1,1,2,1];else if(K/2===H/3)te=K/2,ye=[0,0,1,0,0,1,1,1,0,2,1,2];else throw"can't figure out cube map from element: "+(F.src?F.src:F.nodeName);var Te=M();Te?(Te.canvas.width=te,Te.canvas.height=te,f=te,R=te,nn(T,L).forEach(function(It){var Kt=ye[It.ndx*2+0]*te,nr=ye[It.ndx*2+1]*te;Te.drawImage(F,Kt,nr,te,te,0,0,te,te),T.texImage2D(It.face,l,P,j,W,Te.canvas)}),Te.canvas.width=1,Te.canvas.height=1):typeof createImageBitmap<"u"&&(f=te,R=te,nn(T,L).forEach(function(It){var Kt=ye[It.ndx*2+0]*te,nr=ye[It.ndx*2+1]*te;T.texImage2D(It.face,l,P,te,te,0,j,W,null),createImageBitmap(F,Kt,nr,te,te,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(function(di){gr(T,L),T.bindTexture(s,S),T.texImage2D(It.face,l,P,j,W,di),br(L)&&Ir(T,S,L,f,R,P)})}))}else if(s===G||s===V){var _e=Math.min(F.width,F.height),Ne=Math.max(F.width,F.height),Ue=Ne/_e;if(Ue%1!==0)throw"can not compute 3D dimensions of element";var Oe=F.width===Ne?1:0,Ve=F.height===Ne?1:0;T.pixelStorei(p,1),T.pixelStorei(x,F.width),T.pixelStorei(I,0),T.pixelStorei(m,0),T.texImage3D(s,l,P,_e,_e,_e,0,j,W,null);for(var Qe=0;Qe<Ue;++Qe){var ft=Qe*_e*Oe,bt=Qe*_e*Ve;T.pixelStorei(E,ft),T.pixelStorei(y,bt),T.texSubImage3D(s,l,0,0,Qe,_e,_e,1,j,W,F)}tn(T)}else T.texImage2D(s,l,P,j,W,F);br(L)&&Ir(T,S,L,f,R,P),Mn(T,S,L)}function lr(){}function fi(T){if(typeof document<"u"){var S=document.createElement("a");return S.href=T,S.hostname===location.hostname&&S.port===location.port&&S.protocol===location.protocol}else{var F=new URL(location.href).origin,L=new URL(T,location.href).origin;return L===F}}function Zi(T,S){return S===void 0&&!fi(T)?"anonymous":S}function Qi(T,S,F){F=F||lr;var L;if(S=S!==void 0?S:U.crossOrigin,S=Zi(T,S),typeof Image<"u"){L=new Image,S!==void 0&&(L.crossOrigin=S);var s=function(){L.removeEventListener("error",l),L.removeEventListener("load",f),L=null},l=function(){var K="couldn't load image: "+T;_.error(K),F(K,L),s()},f=function(){F(null,L),s()};return L.addEventListener("error",l),L.addEventListener("load",f),L.src=T,L}else if(typeof ImageBitmap<"u"){var R,P,O=function(){F(R,P)},j={};S&&(j.mode="cors"),fetch(T,j).then(function(W){if(!W.ok)throw W;return W.blob()}).then(function(W){return createImageBitmap(W,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}).then(function(W){P=W,setTimeout(O)}).catch(function(W){R=W,setTimeout(O)}),L=null}return L}function Pn(T){return typeof ImageBitmap<"u"&&T instanceof ImageBitmap||typeof ImageData<"u"&&T instanceof ImageData||typeof HTMLElement<"u"&&T instanceof HTMLElement}function Nn(T,S,F){return Pn(T)?(setTimeout(function(){F(null,T)}),T):Qi(T,S,F)}function an(T,S,F){F=F||U.textureOptions;var L=F.target||qe;if(T.bindTexture(L,S),F.color!==!1){var s=$i(F.color);if(L===ge)for(var l=0;l<6;++l)T.texImage2D(Z+l,0,z,1,1,0,z,ut,s);else L===G||L===V?T.texImage3D(L,0,z,1,1,1,0,z,ut,s):T.texImage2D(L,0,z,1,1,0,z,ut,s)}}function mi(T,S,F,L){L=L||lr,F=F||U.textureOptions,an(T,S,F),F=Object.assign({},F);var s=Nn(F.src,F.crossOrigin,function(l,f){l?L(l,S,f):(Rn(T,S,f,F),L(null,S,f))});return s}function Ji(T,S,F,L){L=L||lr;var s=F.src;if(s.length!==6)throw"there must be 6 urls for a cubemap";var l=F.level||0,f=F.internalFormat||F.format||z,R=cr(f),P=F.format||R.format,O=F.type||ut,j=F.target||qe;if(j!==ge)throw"target must be TEXTURE_CUBE_MAP";an(T,S,F),F=Object.assign({},F);var W=6,K=[],H=rn(T,F),te;function ye(Te){return function(_e,Ne){--W,_e?K.push(_e):Ne.width!==Ne.height?K.push("cubemap face img is not a square: "+Ne.src):(gr(T,F),T.bindTexture(j,S),W===5?rn().forEach(function(Ue){T.texImage2D(Ue,l,f,P,O,Ne)}):T.texImage2D(Te,l,f,P,O,Ne),br(F)&&T.generateMipmap(j)),W===0&&L(K.length?K:void 0,S,te)}}te=s.map(function(Te,_e){return Nn(Te,F.crossOrigin,ye(H[_e]))})}function yi(T,S,F,L){L=L||lr;var s=F.src,l=F.internalFormat||F.format||z,f=cr(l),R=F.format||f.format,P=F.type||ut,O=F.target||V;if(O!==G&&O!==V)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";an(T,S,F),F=Object.assign({},F);var j=s.length,W=[],K,H=F.level||0,te=F.width,ye=F.height,Te=s.length,_e=!0;function Ne(Ue){return function(Oe,Ve){if(--j,Oe)W.push(Oe);else{if(gr(T,F),T.bindTexture(O,S),_e){_e=!1,te=F.width||Ve.width,ye=F.height||Ve.height,T.texImage3D(O,H,l,te,ye,Te,0,R,P,null);for(var Qe=0;Qe<Te;++Qe)T.texSubImage3D(O,H,0,0,Qe,te,ye,1,R,P,Ve)}else{var ft=Ve,bt;(Ve.width!==te||Ve.height!==ye)&&(bt=M(),ft=bt.canvas,bt.canvas.width=te,bt.canvas.height=ye,bt.drawImage(Ve,0,0,te,ye)),T.texSubImage3D(O,H,0,0,Ue,te,ye,1,R,P,ft),bt&&ft===bt.canvas&&(bt.canvas.width=0,bt.canvas.height=0)}br(F)&&T.generateMipmap(O)}j===0&&L(W.length?W:void 0,S,K)}}K=s.map(function(Ue,Oe){return Nn(Ue,F.crossOrigin,Ne(Oe))})}function sn(T,S,F,L){L=L||U.textureOptions;var s=L.target||qe;T.bindTexture(s,S);var l=L.width,f=L.height,R=L.depth,P=L.level||0,O=L.internalFormat||L.format||z,j=cr(O),W=L.format||j.format,K=L.type||Dr(T,F,j.type);if(ee(F))F instanceof Uint8ClampedArray&&(F=new Uint8Array(F.buffer));else{var H=g.getTypedArrayTypeForGLType(K);F=new H(F)}var te=ur(O,K),ye=F.byteLength/te;if(ye%1)throw"length wrong size for format: "+d.glEnumToString(T,W);var Te;if(s===G||s===V)if(!l&&!f&&!R){var _e=Math.cbrt(ye);if(_e%1!==0)throw"can't guess cube size of array of numElements: "+ye;l=_e,f=_e,R=_e}else l&&(!f||!R)?(Te=hr(T,s,f,R,ye/l),f=Te.width,R=Te.height):f&&(!l||!R)?(Te=hr(T,s,l,R,ye/f),l=Te.width,R=Te.height):(Te=hr(T,s,l,f,ye/R),l=Te.width,f=Te.height);else Te=hr(T,s,l,f,ye),l=Te.width,f=Te.height;if(tn(T),T.pixelStorei(p,L.unpackAlignment||1),gr(T,L),s===ge){var Ne=te/F.BYTES_PER_ELEMENT,Ue=ye/6*Ne;nn(T,L).forEach(function(Oe){var Ve=Ue*Oe.ndx,Qe=F.subarray(Ve,Ve+Ue);T.texImage2D(Oe.face,P,O,l,f,0,W,K,Qe)})}else s===G||s===V?T.texImage3D(s,P,O,l,f,R,0,W,K,F):T.texImage2D(s,P,O,l,f,0,W,K,F);return{width:l,height:f,depth:R,type:K}}function Dn(T,S,F){var L=F.target||qe;T.bindTexture(L,S);var s=F.level||0,l=F.internalFormat||F.format||z,f=cr(l),R=F.format||f.format,P=F.type||f.type;if(gr(T,F),L===ge)for(var O=0;O<6;++O)T.texImage2D(Z+O,s,l,F.width,F.height,0,R,P,null);else L===G||L===V?T.texImage3D(L,s,l,F.width,F.height,F.depth,0,R,P,null):T.texImage2D(L,s,l,F.width,F.height,0,R,P,null)}function In(T,S,F){F=F||lr,S=S||U.textureOptions;var L=T.createTexture(),s=S.target||qe,l=S.width||1,f=S.height||1,R=S.internalFormat||z;T.bindTexture(s,L),s===ge&&(T.texParameteri(s,$e,Ae),T.texParameteri(s,mt,Ae));var P=S.src;if(P)if(typeof P=="function"&&(P=P(T,S)),typeof P=="string")mi(T,L,S,F);else if(ee(P)||Array.isArray(P)&&(typeof P[0]=="number"||Array.isArray(P[0])||ee(P[0]))){var O=sn(T,L,P,S);l=O.width,f=O.height}else Array.isArray(P)&&(typeof P[0]=="string"||Pn(P[0]))?s===ge?Ji(T,L,S,F):yi(T,L,S,F):(Rn(T,L,P,S),l=P.width,f=P.height);else Dn(T,L,S);return br(S)&&Ir(T,L,S,l,f,R),Mn(T,L,S),L}function ea(T,S,F,L,s,l){L=L||F.width,s=s||F.height,l=l||F.depth;var f=F.target||qe;T.bindTexture(f,S);var R=F.level||0,P=F.internalFormat||F.format||z,O=cr(P),j=F.format||O.format,W,K=F.src;if(K&&(ee(K)||Array.isArray(K)&&typeof K[0]=="number")?W=F.type||Dr(T,K,O.type):W=F.type||O.type,f===ge)for(var H=0;H<6;++H)T.texImage2D(Z+H,R,P,L,s,0,j,W,null);else f===G||f===V?T.texImage3D(f,R,P,L,s,l,0,j,W,null):T.texImage2D(f,R,P,L,s,0,j,W,null)}function on(T){return typeof T=="string"||Array.isArray(T)&&typeof T[0]=="string"}function ta(T,S,F){F=F||lr;var L=0,s=[],l={},f={};function R(){L===0&&setTimeout(function(){F(s.length?s:void 0,l,f)},0)}return Object.keys(S).forEach(function(P){var O=S[P],j;on(O.src)&&(j=function(K,H,te){f[P]=te,--L,K&&s.push(K),R()},++L),l[P]=In(T,O,j)}),R(),l}},"./src/twgl-full.js":(u,i,c)=>{function v(M){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Q){return typeof Q}:function(Q){return Q&&typeof Symbol=="function"&&Q.constructor===Symbol&&Q!==Symbol.prototype?"symbol":typeof Q},v(M)}i.__esModule=!0;var d={m4:!0,v3:!0,primitives:!0};i.v3=i.primitives=i.m4=void 0;var g=ee(c("./src/m4.js"));i.m4=g;var _=ee(c("./src/v3.js"));i.v3=_;var b=ee(c("./src/primitives.js"));i.primitives=b;var C=c("./src/twgl.js");Object.keys(C).forEach(function(M){M==="default"||M==="__esModule"||Object.prototype.hasOwnProperty.call(d,M)||M in i&&i[M]===C[M]||(i[M]=C[M])});function U(M){if(typeof WeakMap!="function")return null;var Q=new WeakMap,J=new WeakMap;return(U=function(q){return q?J:Q})(M)}function ee(M,Q){if(!Q&&M&&M.__esModule)return M;if(M===null||v(M)!="object"&&typeof M!="function")return{default:M};var J=U(Q);if(J&&J.has(M))return J.get(M);var z={__proto__:null},q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ne in M)if(ne!=="default"&&Object.prototype.hasOwnProperty.call(M,ne)){var ae=q?Object.getOwnPropertyDescriptor(M,ne):null;ae&&(ae.get||ae.set)?Object.defineProperty(z,ne,ae):z[ne]=M[ne]}return z.default=M,J&&J.set(M,z),z}},"./src/twgl.js":(u,i,c)=>{function v(D){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(be){return typeof be}:function(be){return be&&typeof Symbol=="function"&&be.constructor===Symbol&&be!==Symbol.prototype?"symbol":typeof be},v(D)}i.__esModule=!0;var d={addExtensionsToContext:!0,getContext:!0,getWebGLContext:!0,resizeCanvasToDisplaySize:!0,setDefaults:!0,attributes:!0,textures:!0,utils:!0,draw:!0,framebuffers:!0,programs:!0,typedarrays:!0,vertexArrays:!0};i.addExtensionsToContext=ot,i.framebuffers=i.draw=i.attributes=void 0,i.getContext=V,i.getWebGLContext=ge,i.programs=void 0,i.resizeCanvasToDisplaySize=Z,i.setDefaults=ae,i.vertexArrays=i.utils=i.typedarrays=i.textures=void 0;var g=q(c("./src/attributes.js"));i.attributes=g,Object.keys(g).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(d,D)||D in i&&i[D]===g[D]||(i[D]=g[D])});var _=q(c("./src/textures.js"));i.textures=_,Object.keys(_).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(d,D)||D in i&&i[D]===_[D]||(i[D]=_[D])});var b=q(c("./src/helper.js")),C=q(c("./src/utils.js"));i.utils=C,Object.keys(C).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(d,D)||D in i&&i[D]===C[D]||(i[D]=C[D])});var U=q(c("./src/draw.js"));i.draw=U,Object.keys(U).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(d,D)||D in i&&i[D]===U[D]||(i[D]=U[D])});var ee=q(c("./src/framebuffers.js"));i.framebuffers=ee,Object.keys(ee).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(d,D)||D in i&&i[D]===ee[D]||(i[D]=ee[D])});var M=q(c("./src/programs.js"));i.programs=M,Object.keys(M).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(d,D)||D in i&&i[D]===M[D]||(i[D]=M[D])});var Q=q(c("./src/typedarrays.js"));i.typedarrays=Q,Object.keys(Q).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(d,D)||D in i&&i[D]===Q[D]||(i[D]=Q[D])});var J=q(c("./src/vertex-arrays.js"));i.vertexArrays=J,Object.keys(J).forEach(function(D){D==="default"||D==="__esModule"||Object.prototype.hasOwnProperty.call(d,D)||D in i&&i[D]===J[D]||(i[D]=J[D])});function z(D){if(typeof WeakMap!="function")return null;var be=new WeakMap,we=new WeakMap;return(z=function(Ge){return Ge?we:be})(D)}function q(D,be){if(!be&&D&&D.__esModule)return D;if(D===null||v(D)!="object"&&typeof D!="function")return{default:D};var we=z(be);if(we&&we.has(D))return we.get(D);var Se={__proto__:null},Ge=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var We in D)if(We!=="default"&&Object.prototype.hasOwnProperty.call(D,We)){var rt=Ge?Object.getOwnPropertyDescriptor(D,We):null;rt&&(rt.get||rt.set)?Object.defineProperty(Se,We,rt):Se[We]=D[We]}return Se.default=D,we&&we.set(D,Se),Se}var ne={addExtensionsToContext:!0};function ae(D){b.copyExistingProperties(D,ne),g.setAttributeDefaults_(D),_.setTextureDefaults_(D)}var De=/^(.*?)_/;function Ae(D,be){C.glEnumToString(D,0);var we=D.getExtension(be);if(we){var Se={},Ge=De.exec(be)[1],We="_"+Ge;for(var rt in we){var $e=we[rt],mt=typeof $e=="function",Mt=mt?Ge:We,yt=rt;rt.endsWith(Mt)&&(yt=rt.substring(0,rt.length-Mt.length)),D[yt]!==void 0?!mt&&D[yt]!==$e&&b.warn(yt,D[yt],$e,rt):mt?D[yt]=function(lt){return function(){return lt.apply(we,arguments)}}($e):(D[yt]=$e,Se[yt]=$e)}Se.constructor={name:we.constructor.name},C.glEnumToString(Se,0)}return we}var st=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_depth_texture","WEBGL_draw_buffers"];function ot(D){for(var be=0;be<st.length;++be)Ae(D,st[be])}function qe(D,be){for(var we=["webgl","experimental-webgl"],Se=null,Ge=0;Ge<we.length;++Ge)if(Se=D.getContext(we[Ge],be),Se){ne.addExtensionsToContext&&ot(Se);break}return Se}function ge(D,be){var we=qe(D,be);return we}function G(D,be){for(var we=["webgl2","webgl","experimental-webgl"],Se=null,Ge=0;Ge<we.length;++Ge)if(Se=D.getContext(we[Ge],be),Se){ne.addExtensionsToContext&&ot(Se);break}return Se}function V(D,be){var we=G(D,be);return we}function Z(D,be){be=be||1,be=Math.max(0,be);var we=D.clientWidth*be|0,Se=D.clientHeight*be|0;return D.width!==we||D.height!==Se?(D.width=we,D.height=Se,!0):!1}},"./src/typedarrays.js":(u,i)=>{i.__esModule=!0,i.getGLTypeForTypedArray=st,i.getGLTypeForTypedArrayType=ot,i.getTypedArrayTypeForGLType=qe,i.isArrayBuffer=void 0;var c=5120,v=5121,d=5122,g=5123,_=5124,b=5125,C=5126,U=32819,ee=32820,M=33635,Q=5131,J=33640,z=35899,q=35902,ne=36269,ae=34042,De={};{var Ae=De;Ae[c]=Int8Array,Ae[v]=Uint8Array,Ae[d]=Int16Array,Ae[g]=Uint16Array,Ae[_]=Int32Array,Ae[b]=Uint32Array,Ae[C]=Float32Array,Ae[U]=Uint16Array,Ae[ee]=Uint16Array,Ae[M]=Uint16Array,Ae[Q]=Uint16Array,Ae[J]=Uint32Array,Ae[z]=Uint32Array,Ae[q]=Uint32Array,Ae[ne]=Uint32Array,Ae[ae]=Uint32Array}function st(ge){if(ge instanceof Int8Array)return c;if(ge instanceof Uint8Array||ge instanceof Uint8ClampedArray)return v;if(ge instanceof Int16Array)return d;if(ge instanceof Uint16Array)return g;if(ge instanceof Int32Array)return _;if(ge instanceof Uint32Array)return b;if(ge instanceof Float32Array)return C;throw new Error("unsupported typed array type")}function ot(ge){if(ge===Int8Array)return c;if(ge===Uint8Array||ge===Uint8ClampedArray)return v;if(ge===Int16Array)return d;if(ge===Uint16Array)return g;if(ge===Int32Array)return _;if(ge===Uint32Array)return b;if(ge===Float32Array)return C;throw new Error("unsupported typed array type")}function qe(ge){var G=De[ge];if(!G)throw new Error("unknown gl type");return G}i.isArrayBuffer=typeof SharedArrayBuffer<"u"?function(G){return G&&G.buffer&&(G.buffer instanceof ArrayBuffer||G.buffer instanceof SharedArrayBuffer)}:function(G){return G&&G.buffer&&G.buffer instanceof ArrayBuffer}},"./src/utils.js":(u,i)=>{i.__esModule=!0,i.glEnumToString=void 0,i.isWebGL1=v,i.isWebGL2=c;function c(d){return!!d.texStorage2D}function v(d){return!d.texStorage2D}i.glEnumToString=function(){var d={},g={};function _(b){var C=b.constructor.name;if(!d[C]){for(var U in b)if(typeof b[U]=="number"){var ee=g[b[U]];g[b[U]]=ee?"".concat(ee," | ").concat(U):U}d[C]=!0}}return function(C,U){return _(C),g[U]||(typeof U=="number"?"0x".concat(U.toString(16)):U)}}()},"./src/v3.js":(u,i)=>{i.__esModule=!0,i.add=g,i.copy=ot,i.create=d,i.cross=J,i.distance=ae,i.distanceSq=De,i.divScalar=Q,i.divide=ge,i.dot=z,i.length=q,i.lengthSq=ne,i.lerp=b,i.lerpV=C,i.max=U,i.min=ee,i.mulScalar=M,i.multiply=qe,i.negate=st,i.normalize=Ae,i.setDefaultType=v,i.subtract=_;var c=Float32Array;function v(G){var V=c;return c=G,V}function d(G,V,Z){var D=new c(3);return G&&(D[0]=G),V&&(D[1]=V),Z&&(D[2]=Z),D}function g(G,V,Z){return Z=Z||new c(3),Z[0]=G[0]+V[0],Z[1]=G[1]+V[1],Z[2]=G[2]+V[2],Z}function _(G,V,Z){return Z=Z||new c(3),Z[0]=G[0]-V[0],Z[1]=G[1]-V[1],Z[2]=G[2]-V[2],Z}function b(G,V,Z,D){return D=D||new c(3),D[0]=G[0]+Z*(V[0]-G[0]),D[1]=G[1]+Z*(V[1]-G[1]),D[2]=G[2]+Z*(V[2]-G[2]),D}function C(G,V,Z,D){return D=D||new c(3),D[0]=G[0]+Z[0]*(V[0]-G[0]),D[1]=G[1]+Z[1]*(V[1]-G[1]),D[2]=G[2]+Z[2]*(V[2]-G[2]),D}function U(G,V,Z){return Z=Z||new c(3),Z[0]=Math.max(G[0],V[0]),Z[1]=Math.max(G[1],V[1]),Z[2]=Math.max(G[2],V[2]),Z}function ee(G,V,Z){return Z=Z||new c(3),Z[0]=Math.min(G[0],V[0]),Z[1]=Math.min(G[1],V[1]),Z[2]=Math.min(G[2],V[2]),Z}function M(G,V,Z){return Z=Z||new c(3),Z[0]=G[0]*V,Z[1]=G[1]*V,Z[2]=G[2]*V,Z}function Q(G,V,Z){return Z=Z||new c(3),Z[0]=G[0]/V,Z[1]=G[1]/V,Z[2]=G[2]/V,Z}function J(G,V,Z){Z=Z||new c(3);var D=G[2]*V[0]-G[0]*V[2],be=G[0]*V[1]-G[1]*V[0];return Z[0]=G[1]*V[2]-G[2]*V[1],Z[1]=D,Z[2]=be,Z}function z(G,V){return G[0]*V[0]+G[1]*V[1]+G[2]*V[2]}function q(G){return Math.sqrt(G[0]*G[0]+G[1]*G[1]+G[2]*G[2])}function ne(G){return G[0]*G[0]+G[1]*G[1]+G[2]*G[2]}function ae(G,V){var Z=G[0]-V[0],D=G[1]-V[1],be=G[2]-V[2];return Math.sqrt(Z*Z+D*D+be*be)}function De(G,V){var Z=G[0]-V[0],D=G[1]-V[1],be=G[2]-V[2];return Z*Z+D*D+be*be}function Ae(G,V){V=V||new c(3);var Z=G[0]*G[0]+G[1]*G[1]+G[2]*G[2],D=Math.sqrt(Z);return D>1e-5?(V[0]=G[0]/D,V[1]=G[1]/D,V[2]=G[2]/D):(V[0]=0,V[1]=0,V[2]=0),V}function st(G,V){return V=V||new c(3),V[0]=-G[0],V[1]=-G[1],V[2]=-G[2],V}function ot(G,V){return V=V||new c(3),V[0]=G[0],V[1]=G[1],V[2]=G[2],V}function qe(G,V,Z){return Z=Z||new c(3),Z[0]=G[0]*V[0],Z[1]=G[1]*V[1],Z[2]=G[2]*V[2],Z}function ge(G,V,Z){return Z=Z||new c(3),Z[0]=G[0]/V[0],Z[1]=G[1]/V[1],Z[2]=G[2]/V[2],Z}},"./src/vertex-arrays.js":(u,i,c)=>{function v(M){"@babel/helpers - typeof";return v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Q){return typeof Q}:function(Q){return Q&&typeof Symbol=="function"&&Q.constructor===Symbol&&Q!==Symbol.prototype?"symbol":typeof Q},v(M)}i.__esModule=!0,i.createVAOAndSetAttributes=U,i.createVAOFromBufferInfo=ee,i.createVertexArrayInfo=C;var d=_(c("./src/programs.js"));function g(M){if(typeof WeakMap!="function")return null;var Q=new WeakMap,J=new WeakMap;return(g=function(q){return q?J:Q})(M)}function _(M,Q){if(!Q&&M&&M.__esModule)return M;if(M===null||v(M)!="object"&&typeof M!="function")return{default:M};var J=g(Q);if(J&&J.has(M))return J.get(M);var z={__proto__:null},q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ne in M)if(ne!=="default"&&Object.prototype.hasOwnProperty.call(M,ne)){var ae=q?Object.getOwnPropertyDescriptor(M,ne):null;ae&&(ae.get||ae.set)?Object.defineProperty(z,ne,ae):z[ne]=M[ne]}return z.default=M,J&&J.set(M,z),z}var b=34963;function C(M,Q,J){var z=M.createVertexArray();return M.bindVertexArray(z),Q.length||(Q=[Q]),Q.forEach(function(q){d.setBuffersAndAttributes(M,q,J)}),M.bindVertexArray(null),{numElements:J.numElements,elementType:J.elementType,vertexArrayObject:z}}function U(M,Q,J,z){var q=M.createVertexArray();return M.bindVertexArray(q),d.setAttributes(Q,J),z&&M.bindBuffer(b,z),M.bindVertexArray(null),q}function ee(M,Q,J){return U(M,Q.attribSetters||Q,J.attribs,J.indices)}}},r={};function n(u){var i=r[u];if(i!==void 0)return i.exports;var c=r[u]={exports:{}};return t[u](c,c.exports,n),c.exports}var a=n("./src/twgl-full.js");return a})())})(ws);var Er=ws.exports;/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const As="162",Ss=300,Ya=1e3,vi=1001,Ka=1002,$a=1003,io=1006,ao=1008,so=1009,oo=1014,uo=1020,co=1023,oa=1026,Za=1027,Ms="",Ar="srgb",Da="srgb-linear",ho="display-p3",Fs="display-p3-linear",Ta="linear",Qa="srgb",Ja="rec709",es="p3",lo=515,xi=2e3,ts=2001;class Ia{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const n=this._listeners[e];if(n!==void 0){const a=n.indexOf(t);a!==-1&&n.splice(a,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const n=r.slice(0);for(let a=0,u=n.length;a<u;a++)n[a].call(this,e);e.target=null}}}const Rt=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let rs=1234567;const Cs=Math.PI/180,Rs=180/Math.PI;function zi(){const h=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Rt[h&255]+Rt[h>>8&255]+Rt[h>>16&255]+Rt[h>>24&255]+"-"+Rt[e&255]+Rt[e>>8&255]+"-"+Rt[e>>16&15|64]+Rt[e>>24&255]+"-"+Rt[t&63|128]+Rt[t>>8&255]+"-"+Rt[t>>16&255]+Rt[t>>24&255]+Rt[r&255]+Rt[r>>8&255]+Rt[r>>16&255]+Rt[r>>24&255]).toLowerCase()}function Lt(h,e,t){return Math.max(e,Math.min(t,h))}function Ba(h,e){return(h%e+e)%e}function fo(h,e,t,r,n){return r+(h-e)*(n-r)/(t-e)}function mo(h,e,t){return h!==e?(t-h)/(e-h):0}function zn(h,e,t){return(1-t)*h+t*e}function yo(h,e,t,r){return zn(h,e,1-Math.exp(-t*r))}function po(h,e=1){return e-Math.abs(Ba(h,e*2)-e)}function vo(h,e,t){return h<=e?0:h>=t?1:(h=(h-e)/(t-e),h*h*(3-2*h))}function xo(h,e,t){return h<=e?0:h>=t?1:(h=(h-e)/(t-e),h*h*h*(h*(h*6-15)+10))}function go(h,e){return h+Math.floor(Math.random()*(e-h+1))}function bo(h,e){return h+Math.random()*(e-h)}function To(h){return h*(.5-Math.random())}function Eo(h){h!==void 0&&(rs=h);let e=rs+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function _o(h){return h*Cs}function wo(h){return h*Rs}function Ao(h){return(h&h-1)===0&&h!==0}function So(h){return Math.pow(2,Math.ceil(Math.log(h)/Math.LN2))}function Mo(h){return Math.pow(2,Math.floor(Math.log(h)/Math.LN2))}function Fo(h,e,t,r,n){const a=Math.cos,u=Math.sin,i=a(t/2),c=u(t/2),v=a((e+r)/2),d=u((e+r)/2),g=a((e-r)/2),_=u((e-r)/2),b=a((r-e)/2),C=u((r-e)/2);switch(n){case"XYX":h.set(i*d,c*g,c*_,i*v);break;case"YZY":h.set(c*_,i*d,c*g,i*v);break;case"ZXZ":h.set(c*g,c*_,i*d,i*v);break;case"XZX":h.set(i*d,c*C,c*b,i*v);break;case"YXY":h.set(c*b,i*d,c*C,i*v);break;case"ZYZ":h.set(c*C,c*b,i*d,i*v);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function Co(h,e){switch(e.constructor){case Float32Array:return h;case Uint32Array:return h/4294967295;case Uint16Array:return h/65535;case Uint8Array:return h/255;case Int32Array:return Math.max(h/2147483647,-1);case Int16Array:return Math.max(h/32767,-1);case Int8Array:return Math.max(h/127,-1);default:throw new Error("Invalid component type.")}}function Ro(h,e){switch(e.constructor){case Float32Array:return h;case Uint32Array:return Math.round(h*4294967295);case Uint16Array:return Math.round(h*65535);case Uint8Array:return Math.round(h*255);case Int32Array:return Math.round(h*2147483647);case Int16Array:return Math.round(h*32767);case Int8Array:return Math.round(h*127);default:throw new Error("Invalid component type.")}}const Po={DEG2RAD:Cs,RAD2DEG:Rs,generateUUID:zi,clamp:Lt,euclideanModulo:Ba,mapLinear:fo,inverseLerp:mo,lerp:zn,damp:yo,pingpong:po,smoothstep:vo,smootherstep:xo,randInt:go,randFloat:bo,randFloatSpread:To,seededRandom:Eo,degToRad:_o,radToDeg:wo,isPowerOfTwo:Ao,ceilPowerOfTwo:So,floorPowerOfTwo:Mo,setQuaternionFromProperEuler:Fo,normalize:Ro,denormalize:Co};class fn{constructor(e=0,t=0){fn.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6],this.y=n[1]*t+n[4]*r+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Lt(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),n=Math.sin(t),a=this.x-e.x,u=this.y-e.y;return this.x=a*r-u*n+e.x,this.y=a*n+u*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Pr{constructor(e,t,r,n,a,u,i,c,v){Pr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,n,a,u,i,c,v)}set(e,t,r,n,a,u,i,c,v){const d=this.elements;return d[0]=e,d[1]=n,d[2]=i,d[3]=t,d[4]=a,d[5]=c,d[6]=r,d[7]=u,d[8]=v,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,n=t.elements,a=this.elements,u=r[0],i=r[3],c=r[6],v=r[1],d=r[4],g=r[7],_=r[2],b=r[5],C=r[8],U=n[0],ee=n[3],M=n[6],Q=n[1],J=n[4],z=n[7],q=n[2],ne=n[5],ae=n[8];return a[0]=u*U+i*Q+c*q,a[3]=u*ee+i*J+c*ne,a[6]=u*M+i*z+c*ae,a[1]=v*U+d*Q+g*q,a[4]=v*ee+d*J+g*ne,a[7]=v*M+d*z+g*ae,a[2]=_*U+b*Q+C*q,a[5]=_*ee+b*J+C*ne,a[8]=_*M+b*z+C*ae,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],n=e[2],a=e[3],u=e[4],i=e[5],c=e[6],v=e[7],d=e[8];return t*u*d-t*i*v-r*a*d+r*i*c+n*a*v-n*u*c}invert(){const e=this.elements,t=e[0],r=e[1],n=e[2],a=e[3],u=e[4],i=e[5],c=e[6],v=e[7],d=e[8],g=d*u-i*v,_=i*c-d*a,b=v*a-u*c,C=t*g+r*_+n*b;if(C===0)return this.set(0,0,0,0,0,0,0,0,0);const U=1/C;return e[0]=g*U,e[1]=(n*v-d*r)*U,e[2]=(i*r-n*u)*U,e[3]=_*U,e[4]=(d*t-n*c)*U,e[5]=(n*a-i*t)*U,e[6]=b*U,e[7]=(r*c-v*t)*U,e[8]=(u*t-r*a)*U,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,n,a,u,i){const c=Math.cos(a),v=Math.sin(a);return this.set(r*c,r*v,-r*(c*u+v*i)+u+e,-n*v,n*c,-n*(-v*u+c*i)+i+t,0,0,1),this}scale(e,t){return this.premultiply(ua.makeScale(e,t)),this}rotate(e){return this.premultiply(ua.makeRotation(-e)),this}translate(e,t){return this.premultiply(ua.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let n=0;n<9;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const ua=new Pr;function ns(h){return document.createElementNS("http://www.w3.org/1999/xhtml",h)}const is=new Pr().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),as=new Pr().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),gi={[Da]:{transfer:Ta,primaries:Ja,toReference:h=>h,fromReference:h=>h},[Ar]:{transfer:Qa,primaries:Ja,toReference:h=>h.convertSRGBToLinear(),fromReference:h=>h.convertLinearToSRGB()},[Fs]:{transfer:Ta,primaries:es,toReference:h=>h.applyMatrix3(as),fromReference:h=>h.applyMatrix3(is)},[ho]:{transfer:Qa,primaries:es,toReference:h=>h.convertSRGBToLinear().applyMatrix3(as),fromReference:h=>h.applyMatrix3(is).convertLinearToSRGB()}},No=new Set([Da,Fs]),$t={enabled:!0,_workingColorSpace:Da,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(h){if(!No.has(h))throw new Error(`Unsupported working color space, "${h}".`);this._workingColorSpace=h},convert:function(h,e,t){if(this.enabled===!1||e===t||!e||!t)return h;const r=gi[e].toReference,n=gi[t].fromReference;return n(r(h))},fromWorkingColorSpace:function(h,e){return this.convert(h,this._workingColorSpace,e)},toWorkingColorSpace:function(h,e){return this.convert(h,e,this._workingColorSpace)},getPrimaries:function(h){return gi[h].primaries},getTransfer:function(h){return h===Ms?Ta:gi[h].transfer}};function mn(h){return h<.04045?h*.0773993808:Math.pow(h*.9478672986+.0521327014,2.4)}function ca(h){return h<.0031308?h*12.92:1.055*Math.pow(h,.41666)-.055}let un;class Do{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{un===void 0&&(un=ns("canvas")),un.width=e.width,un.height=e.height;const r=un.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=un}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=ns("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const n=r.getImageData(0,0,e.width,e.height),a=n.data;for(let u=0;u<a.length;u++)a[u]=mn(a[u]/255)*255;return r.putImageData(n,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(mn(t[r]/255)*255):t[r]=mn(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let Io=0;class Bo{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Io++}),this.uuid=zi(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},n=this.data;if(n!==null){let a;if(Array.isArray(n)){a=[];for(let u=0,i=n.length;u<i;u++)n[u].isDataTexture?a.push(ha(n[u].image)):a.push(ha(n[u]))}else a=ha(n);r.url=a}return t||(e.images[this.uuid]=r),r}}function ha(h){return typeof HTMLImageElement<"u"&&h instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&h instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&h instanceof ImageBitmap?Do.getDataURL(h):h.data?{data:Array.from(h.data),width:h.width,height:h.height,type:h.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Oo=0;class Rr extends Ia{constructor(e=Rr.DEFAULT_IMAGE,t=Rr.DEFAULT_MAPPING,r=vi,n=vi,a=io,u=ao,i=co,c=so,v=Rr.DEFAULT_ANISOTROPY,d=Ms){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Oo++}),this.uuid=zi(),this.name="",this.source=new Bo(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=n,this.magFilter=a,this.minFilter=u,this.anisotropy=v,this.format=i,this.internalFormat=null,this.type=c,this.offset=new fn(0,0),this.repeat=new fn(1,1),this.center=new fn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Pr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=d,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Ss)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Ya:e.x=e.x-Math.floor(e.x);break;case vi:e.x=e.x<0?0:1;break;case Ka:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Ya:e.y=e.y-Math.floor(e.y);break;case vi:e.y=e.y<0?0:1;break;case Ka:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}Rr.DEFAULT_IMAGE=null;Rr.DEFAULT_MAPPING=Ss;Rr.DEFAULT_ANISOTROPY=1;class Oa{constructor(e=0,t=0,r=0,n=1){Oa.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,n){return this.x=e,this.y=t,this.z=r,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,n=this.z,a=this.w,u=e.elements;return this.x=u[0]*t+u[4]*r+u[8]*n+u[12]*a,this.y=u[1]*t+u[5]*r+u[9]*n+u[13]*a,this.z=u[2]*t+u[6]*r+u[10]*n+u[14]*a,this.w=u[3]*t+u[7]*r+u[11]*n+u[15]*a,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,n,a;const c=e.elements,v=c[0],d=c[4],g=c[8],_=c[1],b=c[5],C=c[9],U=c[2],ee=c[6],M=c[10];if(Math.abs(d-_)<.01&&Math.abs(g-U)<.01&&Math.abs(C-ee)<.01){if(Math.abs(d+_)<.1&&Math.abs(g+U)<.1&&Math.abs(C+ee)<.1&&Math.abs(v+b+M-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const J=(v+1)/2,z=(b+1)/2,q=(M+1)/2,ne=(d+_)/4,ae=(g+U)/4,De=(C+ee)/4;return J>z&&J>q?J<.01?(r=0,n=.707106781,a=.707106781):(r=Math.sqrt(J),n=ne/r,a=ae/r):z>q?z<.01?(r=.707106781,n=0,a=.707106781):(n=Math.sqrt(z),r=ne/n,a=De/n):q<.01?(r=.707106781,n=.707106781,a=0):(a=Math.sqrt(q),r=ae/a,n=De/a),this.set(r,n,a,t),this}let Q=Math.sqrt((ee-C)*(ee-C)+(g-U)*(g-U)+(_-d)*(_-d));return Math.abs(Q)<.001&&(Q=1),this.x=(ee-C)/Q,this.y=(g-U)/Q,this.z=(_-d)/Q,this.w=Math.acos((v+b+M-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class $n{constructor(e=0,t=0,r=0,n=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=n}static slerpFlat(e,t,r,n,a,u,i){let c=r[n+0],v=r[n+1],d=r[n+2],g=r[n+3];const _=a[u+0],b=a[u+1],C=a[u+2],U=a[u+3];if(i===0){e[t+0]=c,e[t+1]=v,e[t+2]=d,e[t+3]=g;return}if(i===1){e[t+0]=_,e[t+1]=b,e[t+2]=C,e[t+3]=U;return}if(g!==U||c!==_||v!==b||d!==C){let ee=1-i;const M=c*_+v*b+d*C+g*U,Q=M>=0?1:-1,J=1-M*M;if(J>Number.EPSILON){const q=Math.sqrt(J),ne=Math.atan2(q,M*Q);ee=Math.sin(ee*ne)/q,i=Math.sin(i*ne)/q}const z=i*Q;if(c=c*ee+_*z,v=v*ee+b*z,d=d*ee+C*z,g=g*ee+U*z,ee===1-i){const q=1/Math.sqrt(c*c+v*v+d*d+g*g);c*=q,v*=q,d*=q,g*=q}}e[t]=c,e[t+1]=v,e[t+2]=d,e[t+3]=g}static multiplyQuaternionsFlat(e,t,r,n,a,u){const i=r[n],c=r[n+1],v=r[n+2],d=r[n+3],g=a[u],_=a[u+1],b=a[u+2],C=a[u+3];return e[t]=i*C+d*g+c*b-v*_,e[t+1]=c*C+d*_+v*g-i*b,e[t+2]=v*C+d*b+i*_-c*g,e[t+3]=d*C-i*g-c*_-v*b,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,n){return this._x=e,this._y=t,this._z=r,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const r=e._x,n=e._y,a=e._z,u=e._order,i=Math.cos,c=Math.sin,v=i(r/2),d=i(n/2),g=i(a/2),_=c(r/2),b=c(n/2),C=c(a/2);switch(u){case"XYZ":this._x=_*d*g+v*b*C,this._y=v*b*g-_*d*C,this._z=v*d*C+_*b*g,this._w=v*d*g-_*b*C;break;case"YXZ":this._x=_*d*g+v*b*C,this._y=v*b*g-_*d*C,this._z=v*d*C-_*b*g,this._w=v*d*g+_*b*C;break;case"ZXY":this._x=_*d*g-v*b*C,this._y=v*b*g+_*d*C,this._z=v*d*C+_*b*g,this._w=v*d*g-_*b*C;break;case"ZYX":this._x=_*d*g-v*b*C,this._y=v*b*g+_*d*C,this._z=v*d*C-_*b*g,this._w=v*d*g+_*b*C;break;case"YZX":this._x=_*d*g+v*b*C,this._y=v*b*g+_*d*C,this._z=v*d*C-_*b*g,this._w=v*d*g-_*b*C;break;case"XZY":this._x=_*d*g-v*b*C,this._y=v*b*g-_*d*C,this._z=v*d*C+_*b*g,this._w=v*d*g+_*b*C;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+u)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],n=t[4],a=t[8],u=t[1],i=t[5],c=t[9],v=t[2],d=t[6],g=t[10],_=r+i+g;if(_>0){const b=.5/Math.sqrt(_+1);this._w=.25/b,this._x=(d-c)*b,this._y=(a-v)*b,this._z=(u-n)*b}else if(r>i&&r>g){const b=2*Math.sqrt(1+r-i-g);this._w=(d-c)/b,this._x=.25*b,this._y=(n+u)/b,this._z=(a+v)/b}else if(i>g){const b=2*Math.sqrt(1+i-r-g);this._w=(a-v)/b,this._x=(n+u)/b,this._y=.25*b,this._z=(c+d)/b}else{const b=2*Math.sqrt(1+g-r-i);this._w=(u-n)/b,this._x=(a+v)/b,this._y=(c+d)/b,this._z=.25*b}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Lt(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const n=Math.min(1,t/r);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,n=e._y,a=e._z,u=e._w,i=t._x,c=t._y,v=t._z,d=t._w;return this._x=r*d+u*i+n*v-a*c,this._y=n*d+u*c+a*i-r*v,this._z=a*d+u*v+r*c-n*i,this._w=u*d-r*i-n*c-a*v,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,n=this._y,a=this._z,u=this._w;let i=u*e._w+r*e._x+n*e._y+a*e._z;if(i<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,i=-i):this.copy(e),i>=1)return this._w=u,this._x=r,this._y=n,this._z=a,this;const c=1-i*i;if(c<=Number.EPSILON){const b=1-t;return this._w=b*u+t*this._w,this._x=b*r+t*this._x,this._y=b*n+t*this._y,this._z=b*a+t*this._z,this.normalize(),this}const v=Math.sqrt(c),d=Math.atan2(v,i),g=Math.sin((1-t)*d)/v,_=Math.sin(t*d)/v;return this._w=u*g+this._w*_,this._x=r*g+this._x*_,this._y=n*g+this._y*_,this._z=a*g+this._z*_,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),r=Math.random(),n=Math.sqrt(1-r),a=Math.sqrt(r);return this.set(n*Math.sin(e),n*Math.cos(e),a*Math.sin(t),a*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class gt{constructor(e=0,t=0,r=0){gt.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(ss.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(ss.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,n=this.z,a=e.elements;return this.x=a[0]*t+a[3]*r+a[6]*n,this.y=a[1]*t+a[4]*r+a[7]*n,this.z=a[2]*t+a[5]*r+a[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,n=this.z,a=e.elements,u=1/(a[3]*t+a[7]*r+a[11]*n+a[15]);return this.x=(a[0]*t+a[4]*r+a[8]*n+a[12])*u,this.y=(a[1]*t+a[5]*r+a[9]*n+a[13])*u,this.z=(a[2]*t+a[6]*r+a[10]*n+a[14])*u,this}applyQuaternion(e){const t=this.x,r=this.y,n=this.z,a=e.x,u=e.y,i=e.z,c=e.w,v=2*(u*n-i*r),d=2*(i*t-a*n),g=2*(a*r-u*t);return this.x=t+c*v+u*g-i*d,this.y=r+c*d+i*v-a*g,this.z=n+c*g+a*d-u*v,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,n=this.z,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*n,this.y=a[1]*t+a[5]*r+a[9]*n,this.z=a[2]*t+a[6]*r+a[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,n=e.y,a=e.z,u=t.x,i=t.y,c=t.z;return this.x=n*c-a*i,this.y=a*u-r*c,this.z=r*i-n*u,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return la.copy(this).projectOnVector(e),this.sub(la)}reflect(e){return this.sub(la.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Lt(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return t*t+r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const n=Math.sin(t)*e;return this.x=n*Math.sin(r),this.y=Math.cos(t)*e,this.z=n*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,r=Math.sqrt(1-t*t);return this.x=r*Math.cos(e),this.y=t,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const la=new gt,ss=new $n;class ir{constructor(e,t,r,n,a,u,i,c,v,d,g,_,b,C,U,ee){ir.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,n,a,u,i,c,v,d,g,_,b,C,U,ee)}set(e,t,r,n,a,u,i,c,v,d,g,_,b,C,U,ee){const M=this.elements;return M[0]=e,M[4]=t,M[8]=r,M[12]=n,M[1]=a,M[5]=u,M[9]=i,M[13]=c,M[2]=v,M[6]=d,M[10]=g,M[14]=_,M[3]=b,M[7]=C,M[11]=U,M[15]=ee,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ir().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,n=1/cn.setFromMatrixColumn(e,0).length(),a=1/cn.setFromMatrixColumn(e,1).length(),u=1/cn.setFromMatrixColumn(e,2).length();return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=0,t[4]=r[4]*a,t[5]=r[5]*a,t[6]=r[6]*a,t[7]=0,t[8]=r[8]*u,t[9]=r[9]*u,t[10]=r[10]*u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,n=e.y,a=e.z,u=Math.cos(r),i=Math.sin(r),c=Math.cos(n),v=Math.sin(n),d=Math.cos(a),g=Math.sin(a);if(e.order==="XYZ"){const _=u*d,b=u*g,C=i*d,U=i*g;t[0]=c*d,t[4]=-c*g,t[8]=v,t[1]=b+C*v,t[5]=_-U*v,t[9]=-i*c,t[2]=U-_*v,t[6]=C+b*v,t[10]=u*c}else if(e.order==="YXZ"){const _=c*d,b=c*g,C=v*d,U=v*g;t[0]=_+U*i,t[4]=C*i-b,t[8]=u*v,t[1]=u*g,t[5]=u*d,t[9]=-i,t[2]=b*i-C,t[6]=U+_*i,t[10]=u*c}else if(e.order==="ZXY"){const _=c*d,b=c*g,C=v*d,U=v*g;t[0]=_-U*i,t[4]=-u*g,t[8]=C+b*i,t[1]=b+C*i,t[5]=u*d,t[9]=U-_*i,t[2]=-u*v,t[6]=i,t[10]=u*c}else if(e.order==="ZYX"){const _=u*d,b=u*g,C=i*d,U=i*g;t[0]=c*d,t[4]=C*v-b,t[8]=_*v+U,t[1]=c*g,t[5]=U*v+_,t[9]=b*v-C,t[2]=-v,t[6]=i*c,t[10]=u*c}else if(e.order==="YZX"){const _=u*c,b=u*v,C=i*c,U=i*v;t[0]=c*d,t[4]=U-_*g,t[8]=C*g+b,t[1]=g,t[5]=u*d,t[9]=-i*d,t[2]=-v*d,t[6]=b*g+C,t[10]=_-U*g}else if(e.order==="XZY"){const _=u*c,b=u*v,C=i*c,U=i*v;t[0]=c*d,t[4]=-g,t[8]=v*d,t[1]=_*g+U,t[5]=u*d,t[9]=b*g-C,t[2]=C*g-b,t[6]=i*d,t[10]=U*g+_}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Lo,e,zo)}lookAt(e,t,r){const n=this.elements;return Gt.subVectors(e,t),Gt.lengthSq()===0&&(Gt.z=1),Gt.normalize(),_r.crossVectors(r,Gt),_r.lengthSq()===0&&(Math.abs(r.z)===1?Gt.x+=1e-4:Gt.z+=1e-4,Gt.normalize(),_r.crossVectors(r,Gt)),_r.normalize(),bi.crossVectors(Gt,_r),n[0]=_r.x,n[4]=bi.x,n[8]=Gt.x,n[1]=_r.y,n[5]=bi.y,n[9]=Gt.y,n[2]=_r.z,n[6]=bi.z,n[10]=Gt.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,n=t.elements,a=this.elements,u=r[0],i=r[4],c=r[8],v=r[12],d=r[1],g=r[5],_=r[9],b=r[13],C=r[2],U=r[6],ee=r[10],M=r[14],Q=r[3],J=r[7],z=r[11],q=r[15],ne=n[0],ae=n[4],De=n[8],Ae=n[12],st=n[1],ot=n[5],qe=n[9],ge=n[13],G=n[2],V=n[6],Z=n[10],D=n[14],be=n[3],we=n[7],Se=n[11],Ge=n[15];return a[0]=u*ne+i*st+c*G+v*be,a[4]=u*ae+i*ot+c*V+v*we,a[8]=u*De+i*qe+c*Z+v*Se,a[12]=u*Ae+i*ge+c*D+v*Ge,a[1]=d*ne+g*st+_*G+b*be,a[5]=d*ae+g*ot+_*V+b*we,a[9]=d*De+g*qe+_*Z+b*Se,a[13]=d*Ae+g*ge+_*D+b*Ge,a[2]=C*ne+U*st+ee*G+M*be,a[6]=C*ae+U*ot+ee*V+M*we,a[10]=C*De+U*qe+ee*Z+M*Se,a[14]=C*Ae+U*ge+ee*D+M*Ge,a[3]=Q*ne+J*st+z*G+q*be,a[7]=Q*ae+J*ot+z*V+q*we,a[11]=Q*De+J*qe+z*Z+q*Se,a[15]=Q*Ae+J*ge+z*D+q*Ge,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],n=e[8],a=e[12],u=e[1],i=e[5],c=e[9],v=e[13],d=e[2],g=e[6],_=e[10],b=e[14],C=e[3],U=e[7],ee=e[11],M=e[15];return C*(+a*c*g-n*v*g-a*i*_+r*v*_+n*i*b-r*c*b)+U*(+t*c*b-t*v*_+a*u*_-n*u*b+n*v*d-a*c*d)+ee*(+t*v*g-t*i*b-a*u*g+r*u*b+a*i*d-r*v*d)+M*(-n*i*d-t*c*g+t*i*_+n*u*g-r*u*_+r*c*d)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],n=e[2],a=e[3],u=e[4],i=e[5],c=e[6],v=e[7],d=e[8],g=e[9],_=e[10],b=e[11],C=e[12],U=e[13],ee=e[14],M=e[15],Q=g*ee*v-U*_*v+U*c*b-i*ee*b-g*c*M+i*_*M,J=C*_*v-d*ee*v-C*c*b+u*ee*b+d*c*M-u*_*M,z=d*U*v-C*g*v+C*i*b-u*U*b-d*i*M+u*g*M,q=C*g*c-d*U*c-C*i*_+u*U*_+d*i*ee-u*g*ee,ne=t*Q+r*J+n*z+a*q;if(ne===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ae=1/ne;return e[0]=Q*ae,e[1]=(U*_*a-g*ee*a-U*n*b+r*ee*b+g*n*M-r*_*M)*ae,e[2]=(i*ee*a-U*c*a+U*n*v-r*ee*v-i*n*M+r*c*M)*ae,e[3]=(g*c*a-i*_*a-g*n*v+r*_*v+i*n*b-r*c*b)*ae,e[4]=J*ae,e[5]=(d*ee*a-C*_*a+C*n*b-t*ee*b-d*n*M+t*_*M)*ae,e[6]=(C*c*a-u*ee*a-C*n*v+t*ee*v+u*n*M-t*c*M)*ae,e[7]=(u*_*a-d*c*a+d*n*v-t*_*v-u*n*b+t*c*b)*ae,e[8]=z*ae,e[9]=(C*g*a-d*U*a-C*r*b+t*U*b+d*r*M-t*g*M)*ae,e[10]=(u*U*a-C*i*a+C*r*v-t*U*v-u*r*M+t*i*M)*ae,e[11]=(d*i*a-u*g*a-d*r*v+t*g*v+u*r*b-t*i*b)*ae,e[12]=q*ae,e[13]=(d*U*n-C*g*n+C*r*_-t*U*_-d*r*ee+t*g*ee)*ae,e[14]=(C*i*n-u*U*n-C*r*c+t*U*c+u*r*ee-t*i*ee)*ae,e[15]=(u*g*n-d*i*n+d*r*c-t*g*c-u*r*_+t*i*_)*ae,this}scale(e){const t=this.elements,r=e.x,n=e.y,a=e.z;return t[0]*=r,t[4]*=n,t[8]*=a,t[1]*=r,t[5]*=n,t[9]*=a,t[2]*=r,t[6]*=n,t[10]*=a,t[3]*=r,t[7]*=n,t[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,n))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),n=Math.sin(t),a=1-r,u=e.x,i=e.y,c=e.z,v=a*u,d=a*i;return this.set(v*u+r,v*i-n*c,v*c+n*i,0,v*i+n*c,d*i+r,d*c-n*u,0,v*c-n*i,d*c+n*u,a*c*c+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,n,a,u){return this.set(1,r,a,0,e,1,u,0,t,n,1,0,0,0,0,1),this}compose(e,t,r){const n=this.elements,a=t._x,u=t._y,i=t._z,c=t._w,v=a+a,d=u+u,g=i+i,_=a*v,b=a*d,C=a*g,U=u*d,ee=u*g,M=i*g,Q=c*v,J=c*d,z=c*g,q=r.x,ne=r.y,ae=r.z;return n[0]=(1-(U+M))*q,n[1]=(b+z)*q,n[2]=(C-J)*q,n[3]=0,n[4]=(b-z)*ne,n[5]=(1-(_+M))*ne,n[6]=(ee+Q)*ne,n[7]=0,n[8]=(C+J)*ae,n[9]=(ee-Q)*ae,n[10]=(1-(_+U))*ae,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,r){const n=this.elements;let a=cn.set(n[0],n[1],n[2]).length();const u=cn.set(n[4],n[5],n[6]).length(),i=cn.set(n[8],n[9],n[10]).length();this.determinant()<0&&(a=-a),e.x=n[12],e.y=n[13],e.z=n[14],Zt.copy(this);const v=1/a,d=1/u,g=1/i;return Zt.elements[0]*=v,Zt.elements[1]*=v,Zt.elements[2]*=v,Zt.elements[4]*=d,Zt.elements[5]*=d,Zt.elements[6]*=d,Zt.elements[8]*=g,Zt.elements[9]*=g,Zt.elements[10]*=g,t.setFromRotationMatrix(Zt),r.x=a,r.y=u,r.z=i,this}makePerspective(e,t,r,n,a,u,i=xi){const c=this.elements,v=2*a/(t-e),d=2*a/(r-n),g=(t+e)/(t-e),_=(r+n)/(r-n);let b,C;if(i===xi)b=-(u+a)/(u-a),C=-2*u*a/(u-a);else if(i===ts)b=-u/(u-a),C=-u*a/(u-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+i);return c[0]=v,c[4]=0,c[8]=g,c[12]=0,c[1]=0,c[5]=d,c[9]=_,c[13]=0,c[2]=0,c[6]=0,c[10]=b,c[14]=C,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,t,r,n,a,u,i=xi){const c=this.elements,v=1/(t-e),d=1/(r-n),g=1/(u-a),_=(t+e)*v,b=(r+n)*d;let C,U;if(i===xi)C=(u+a)*g,U=-2*g;else if(i===ts)C=a*g,U=-1*g;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+i);return c[0]=2*v,c[4]=0,c[8]=0,c[12]=-_,c[1]=0,c[5]=2*d,c[9]=0,c[13]=-b,c[2]=0,c[6]=0,c[10]=U,c[14]=-C,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let n=0;n<16;n++)if(t[n]!==r[n])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const cn=new gt,Zt=new ir,Lo=new gt(0,0,0),zo=new gt(1,1,1),_r=new gt,bi=new gt,Gt=new gt,os=new ir,us=new $n;class Ui{constructor(e=0,t=0,r=0,n=Ui.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,n=this._order){return this._x=e,this._y=t,this._z=r,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const n=e.elements,a=n[0],u=n[4],i=n[8],c=n[1],v=n[5],d=n[9],g=n[2],_=n[6],b=n[10];switch(t){case"XYZ":this._y=Math.asin(Lt(i,-1,1)),Math.abs(i)<.9999999?(this._x=Math.atan2(-d,b),this._z=Math.atan2(-u,a)):(this._x=Math.atan2(_,v),this._z=0);break;case"YXZ":this._x=Math.asin(-Lt(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(i,b),this._z=Math.atan2(c,v)):(this._y=Math.atan2(-g,a),this._z=0);break;case"ZXY":this._x=Math.asin(Lt(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(-g,b),this._z=Math.atan2(-u,v)):(this._y=0,this._z=Math.atan2(c,a));break;case"ZYX":this._y=Math.asin(-Lt(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(_,b),this._z=Math.atan2(c,a)):(this._x=0,this._z=Math.atan2(-u,v));break;case"YZX":this._z=Math.asin(Lt(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,v),this._y=Math.atan2(-g,a)):(this._x=0,this._y=Math.atan2(i,b));break;case"XZY":this._z=Math.asin(-Lt(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(_,v),this._y=Math.atan2(i,a)):(this._x=Math.atan2(-d,b),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return os.makeRotationFromQuaternion(e),this.setFromRotationMatrix(os,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return us.setFromEuler(this),this.setFromQuaternion(us,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Ui.DEFAULT_ORDER="XYZ";class Uo{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let ko=0;const cs=new gt,hn=new $n,fr=new ir,Ti=new gt,Bn=new gt,Go=new gt,Wo=new $n,hs=new gt(1,0,0),ls=new gt(0,1,0),fs=new gt(0,0,1),jo={type:"added"},Vo={type:"removed"},fa={type:"childadded",child:null},ma={type:"childremoved",child:null};class Gr extends Ia{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:ko++}),this.uuid=zi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Gr.DEFAULT_UP.clone();const e=new gt,t=new Ui,r=new $n,n=new gt(1,1,1);function a(){r.setFromEuler(t,!1)}function u(){t.setFromQuaternion(r,void 0,!1)}t._onChange(a),r._onChange(u),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new ir},normalMatrix:{value:new Pr}}),this.matrix=new ir,this.matrixWorld=new ir,this.matrixAutoUpdate=Gr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Gr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Uo,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return hn.setFromAxisAngle(e,t),this.quaternion.multiply(hn),this}rotateOnWorldAxis(e,t){return hn.setFromAxisAngle(e,t),this.quaternion.premultiply(hn),this}rotateX(e){return this.rotateOnAxis(hs,e)}rotateY(e){return this.rotateOnAxis(ls,e)}rotateZ(e){return this.rotateOnAxis(fs,e)}translateOnAxis(e,t){return cs.copy(e).applyQuaternion(this.quaternion),this.position.add(cs.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(hs,e)}translateY(e){return this.translateOnAxis(ls,e)}translateZ(e){return this.translateOnAxis(fs,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(fr.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?Ti.copy(e):Ti.set(e,t,r);const n=this.parent;this.updateWorldMatrix(!0,!1),Bn.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?fr.lookAt(Bn,Ti,this.up):fr.lookAt(Ti,Bn,this.up),this.quaternion.setFromRotationMatrix(fr),n&&(fr.extractRotation(n.matrixWorld),hn.setFromRotationMatrix(fr),this.quaternion.premultiply(hn.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(jo),fa.child=e,this.dispatchEvent(fa),fa.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(Vo),ma.child=e,this.dispatchEvent(ma),ma.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),fr.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),fr.multiply(e.parent.matrixWorld)),e.applyMatrix4(fr),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,n=this.children.length;r<n;r++){const u=this.children[r].getObjectByProperty(e,t);if(u!==void 0)return u}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);const n=this.children;for(let a=0,u=n.length;a<u;a++)n[a].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Bn,e,Go),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Bn,Wo,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,n=t.length;r<n;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,n=t.length;r<n;r++){const a=t[r];(a.matrixWorldAutoUpdate===!0||e===!0)&&a.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const n=this.children;for(let a=0,u=n.length;a<u;a++){const i=n[a];i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),n.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(n.type="BatchedMesh",n.perObjectFrustumCulled=this.perObjectFrustumCulled,n.sortObjects=this.sortObjects,n.drawRanges=this._drawRanges,n.reservedRanges=this._reservedRanges,n.visibility=this._visibility,n.active=this._active,n.bounds=this._bounds.map(i=>({boxInitialized:i.boxInitialized,boxMin:i.box.min.toArray(),boxMax:i.box.max.toArray(),sphereInitialized:i.sphereInitialized,sphereRadius:i.sphere.radius,sphereCenter:i.sphere.center.toArray()})),n.maxGeometryCount=this._maxGeometryCount,n.maxVertexCount=this._maxVertexCount,n.maxIndexCount=this._maxIndexCount,n.geometryInitialized=this._geometryInitialized,n.geometryCount=this._geometryCount,n.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(n.boundingSphere={center:n.boundingSphere.center.toArray(),radius:n.boundingSphere.radius}),this.boundingBox!==null&&(n.boundingBox={min:n.boundingBox.min.toArray(),max:n.boundingBox.max.toArray()}));function a(i,c){return i[c.uuid]===void 0&&(i[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=a(e.geometries,this.geometry);const i=this.geometry.parameters;if(i!==void 0&&i.shapes!==void 0){const c=i.shapes;if(Array.isArray(c))for(let v=0,d=c.length;v<d;v++){const g=c[v];a(e.shapes,g)}else a(e.shapes,c)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const i=[];for(let c=0,v=this.material.length;c<v;c++)i.push(a(e.materials,this.material[c]));n.material=i}else n.material=a(e.materials,this.material);if(this.children.length>0){n.children=[];for(let i=0;i<this.children.length;i++)n.children.push(this.children[i].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let i=0;i<this.animations.length;i++){const c=this.animations[i];n.animations.push(a(e.animations,c))}}if(t){const i=u(e.geometries),c=u(e.materials),v=u(e.textures),d=u(e.images),g=u(e.shapes),_=u(e.skeletons),b=u(e.animations),C=u(e.nodes);i.length>0&&(r.geometries=i),c.length>0&&(r.materials=c),v.length>0&&(r.textures=v),d.length>0&&(r.images=d),g.length>0&&(r.shapes=g),_.length>0&&(r.skeletons=_),b.length>0&&(r.animations=b),C.length>0&&(r.nodes=C)}return r.object=n,r;function u(i){const c=[];for(const v in i){const d=i[v];delete d.metadata,c.push(d)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const n=e.children[r];this.add(n.clone())}return this}}Gr.DEFAULT_UP=new gt(0,1,0);Gr.DEFAULT_MATRIX_AUTO_UPDATE=!0;Gr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Ps={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},wr={h:0,s:0,l:0},Ei={h:0,s:0,l:0};function ya(h,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?h+(e-h)*6*t:t<1/2?e:t<2/3?h+(e-h)*6*(2/3-t):h}class La{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(t===void 0&&r===void 0){const n=e;n&&n.isColor?this.copy(n):typeof n=="number"?this.setHex(n):typeof n=="string"&&this.setStyle(n)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Ar){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,$t.toWorkingColorSpace(this,t),this}setRGB(e,t,r,n=$t.workingColorSpace){return this.r=e,this.g=t,this.b=r,$t.toWorkingColorSpace(this,n),this}setHSL(e,t,r,n=$t.workingColorSpace){if(e=Ba(e,1),t=Lt(t,0,1),r=Lt(r,0,1),t===0)this.r=this.g=this.b=r;else{const a=r<=.5?r*(1+t):r+t-r*t,u=2*r-a;this.r=ya(u,a,e+1/3),this.g=ya(u,a,e),this.b=ya(u,a,e-1/3)}return $t.toWorkingColorSpace(this,n),this}setStyle(e,t=Ar){function r(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const u=n[1],i=n[2];switch(u){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return r(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,t);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return r(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,t);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return r(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=n[1],u=a.length;if(u===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,t);if(u===6)return this.setHex(parseInt(a,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Ar){const r=Ps[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=mn(e.r),this.g=mn(e.g),this.b=mn(e.b),this}copyLinearToSRGB(e){return this.r=ca(e.r),this.g=ca(e.g),this.b=ca(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ar){return $t.fromWorkingColorSpace(Pt.copy(this),e),Math.round(Lt(Pt.r*255,0,255))*65536+Math.round(Lt(Pt.g*255,0,255))*256+Math.round(Lt(Pt.b*255,0,255))}getHexString(e=Ar){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=$t.workingColorSpace){$t.fromWorkingColorSpace(Pt.copy(this),t);const r=Pt.r,n=Pt.g,a=Pt.b,u=Math.max(r,n,a),i=Math.min(r,n,a);let c,v;const d=(i+u)/2;if(i===u)c=0,v=0;else{const g=u-i;switch(v=d<=.5?g/(u+i):g/(2-u-i),u){case r:c=(n-a)/g+(n<a?6:0);break;case n:c=(a-r)/g+2;break;case a:c=(r-n)/g+4;break}c/=6}return e.h=c,e.s=v,e.l=d,e}getRGB(e,t=$t.workingColorSpace){return $t.fromWorkingColorSpace(Pt.copy(this),t),e.r=Pt.r,e.g=Pt.g,e.b=Pt.b,e}getStyle(e=Ar){$t.fromWorkingColorSpace(Pt.copy(this),e);const t=Pt.r,r=Pt.g,n=Pt.b;return e!==Ar?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${n.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(r*255)},${Math.round(n*255)})`}offsetHSL(e,t,r){return this.getHSL(wr),this.setHSL(wr.h+e,wr.s+t,wr.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(wr),e.getHSL(Ei);const r=zn(wr.h,Ei.h,t),n=zn(wr.s,Ei.s,t),a=zn(wr.l,Ei.l,t);return this.setHSL(r,n,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,n=this.b,a=e.elements;return this.r=a[0]*t+a[3]*r+a[6]*n,this.g=a[1]*t+a[4]*r+a[7]*n,this.b=a[2]*t+a[5]*r+a[8]*n,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Pt=new La;La.NAMES=Ps;class Ho extends Rr{constructor(e,t,r,n,a,u,i,c,v,d){if(d=d!==void 0?d:oa,d!==oa&&d!==Za)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&d===oa&&(r=oo),r===void 0&&d===Za&&(r=uo),super(null,n,a,u,i,c,d,r,v),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=i!==void 0?i:$a,this.minFilter=c!==void 0?c:$a,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const qo=new Ho(1,1);qo.compareFunction=lo;typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:As}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=As);const ms={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},za=["x","y","z","w"];function Xo(h){let e="{";h.isNode===!0&&(e+=h.id);for(const{property:t,childNode:r}of Ea(h))e+=","+t.slice(0,-4)+":"+r.getCacheKey();return e+="}",e}function*Ea(h,e=!1){for(const t in h){if(t.startsWith("_")===!0)continue;const r=h[t];if(Array.isArray(r)===!0)for(let n=0;n<r.length;n++){const a=r[n];a&&(a.isNode===!0||e&&typeof a.toJSON=="function")&&(yield{property:t,index:n,childNode:a})}else if(r&&r.isNode===!0)yield{property:t,childNode:r};else if(typeof r=="object")for(const n in r){const a=r[n];a&&(a.isNode===!0||e&&typeof a.toJSON=="function")&&(yield{property:t,index:n,childNode:a})}}}function _a(h){if(h==null)return null;const e=typeof h;return h.isNode===!0?"node":e==="number"?"float":e==="boolean"?"bool":e==="string"?"string":e==="function"?"shader":h.isVector2===!0?"vec2":h.isVector3===!0?"vec3":h.isVector4===!0?"vec4":h.isMatrix3===!0?"mat3":h.isMatrix4===!0?"mat4":h.isColor===!0?"color":h instanceof ArrayBuffer?"ArrayBuffer":null}function Ns(h,...e){const t=h?h.slice(-4):void 0;return e.length===1&&(t==="vec2"?e=[e[0],e[0]]:t==="vec3"?e=[e[0],e[0],e[0]]:t==="vec4"&&(e=[e[0],e[0],e[0],e[0]])),h==="color"?new La(...e):t==="vec2"?new fn(...e):t==="vec3"?new gt(...e):t==="vec4"?new Oa(...e):t==="mat3"?new Pr(...e):t==="mat4"?new ir(...e):h==="bool"?e[0]||!1:h==="float"||h==="int"||h==="uint"?e[0]||0:h==="string"?e[0]||"":h==="ArrayBuffer"?Ko(e[0]):null}function Yo(h){let e="";const t=new Uint8Array(h);for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return btoa(e)}function Ko(h){return Uint8Array.from(atob(h),e=>e.charCodeAt(0)).buffer}const ys=new Map;let $o=0;class jr extends Ia{constructor(e=null){super(),this.nodeType=e,this.updateType=ms.NONE,this.updateBeforeType=ms.NONE,this.uuid=Po.generateUUID(),this.isNode=!0,Object.defineProperty(this,"id",{value:$o++})}get type(){return this.constructor.type}getSelf(){return this.self||this}setReference(){return this}isGlobal(){return!1}*getChildren(){for(const{childNode:e}of Ea(this))yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const t of this.getChildren())t.traverse(e)}getCacheKey(){return Xo(this)}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getNodeType(e){const t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}getShared(e){const t=this.getHash(e);return e.getNodeFromHash(t)||this}setup(e){const t=e.getNodeProperties(this);for(const r of this.getChildren())t["_node"+r.id]=r;return null}construct(e){return console.warn("THREE.Node: construct() is deprecated. Use setup() instead."),this.setup(e)}increaseUsage(e){const t=e.getDataFromNode(this);return t.usageCount=t.usageCount===void 0?1:t.usageCount+1,t.usageCount}analyze(e){if(this.increaseUsage(e)===1){const r=e.getNodeProperties(this);for(const n of Object.values(r))n&&n.isNode===!0&&n.build(e)}}generate(e,t){const{outputNode:r}=e.getNodeProperties(this);if(r&&r.isNode===!0)return r.build(e,t)}updateBefore(){console.warn("Abstract function.")}update(){console.warn("Abstract function.")}build(e,t=null){const r=this.getShared(e);if(this!==r)return r.build(e,t);e.addNode(this),e.addChain(this);let n=null;const a=e.getBuildStage();if(a==="setup"){this.setReference(e);const u=e.getNodeProperties(this);if(u.initialized!==!0||e.context.tempRead===!1){const i=e.stack.nodes.length;u.initialized=!0,u.outputNode=this.setup(e),u.outputNode!==null&&e.stack.nodes.length!==i&&(u.outputNode=e.stack);for(const c of Object.values(u))c&&c.isNode===!0&&c.build(e)}}else if(a==="analyze")this.analyze(e);else if(a==="generate")if(this.generate.length===1){const i=this.getNodeType(e),c=e.getDataFromNode(this);n=c.snippet,n===void 0&&(n=this.generate(e)||"",c.snippet=n),n=e.format(n,i,t)}else n=this.generate(e,t)||"";return e.removeChain(this),n}getSerializeChildren(){return Ea(this)}serialize(e){const t=this.getSerializeChildren(),r={};for(const{property:n,index:a,childNode:u}of t)a!==void 0?(r[n]===void 0&&(r[n]=Number.isInteger(a)?[]:{}),r[n][a]=u.toJSON(e.meta).uuid):r[n]=u.toJSON(e.meta).uuid;Object.keys(r).length>0&&(e.inputNodes=r)}deserialize(e){if(e.inputNodes!==void 0){const t=e.meta.nodes;for(const r in e.inputNodes)if(Array.isArray(e.inputNodes[r])){const n=[];for(const a of e.inputNodes[r])n.push(t[a]);this[r]=n}else if(typeof e.inputNodes[r]=="object"){const n={};for(const a in e.inputNodes[r]){const u=e.inputNodes[r][a];n[a]=t[u]}this[r]=n}else{const n=e.inputNodes[r];this[r]=t[n]}}}toJSON(e){const{uuid:t,type:r}=this,n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{},nodes:{}});let a=e.nodes[t];a===void 0&&(a={uuid:t,type:r,meta:e,metadata:{version:4.6,type:"Node",generator:"Node.toJSON"}},n!==!0&&(e.nodes[a.uuid]=a),this.serialize(a),delete a.meta);function u(i){const c=[];for(const v in i){const d=i[v];delete d.metadata,c.push(d)}return c}if(n){const i=u(e.textures),c=u(e.images),v=u(e.nodes);i.length>0&&(a.textures=i),c.length>0&&(a.images=c),v.length>0&&(a.nodes=v)}return a}}function qt(h,e){if(typeof e!="function"||!h)throw new Error(`Node class ${h} is not a class`);if(ys.has(h)){console.warn(`Redefinition of node class ${h}`);return}ys.set(h,e),e.type=h}class bn extends jr{constructor(e){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,t){if(e.getBuildStage()==="generate"){const n=e.getVectorType(this.getNodeType(e,t)),a=e.getDataFromNode(this);if(e.context.tempRead!==!1&&a.propertyName!==void 0)return e.format(a.propertyName,n,t);if(e.context.tempWrite!==!1&&n!=="void"&&t!=="void"&&this.hasDependencies(e)){const u=super.build(e,n),i=e.getVarFromNode(this,null,n),c=e.getPropertyName(i);return e.addLineFlowCode(`${c} = ${u}`),a.snippet=u,a.propertyName=c,e.format(a.propertyName,n,t)}}return super.build(e,t)}}qt("TempNode",bn);class Ua extends jr{constructor(e,t){super(),this.node=e,this.indexNode=t,this.isArrayElementNode=!0}getNodeType(e){return this.node.getNodeType(e)}generate(e){const t=this.node.build(e),r=this.indexNode.build(e,"uint");return`${t}[ ${r} ]`}}qt("ArrayElementNode",Ua);class ka extends jr{constructor(e,t){super(),this.node=e,this.convertTo=t}getNodeType(e){const t=this.node.getNodeType(e);let r=null;for(const n of this.convertTo.split("|"))(r===null||e.getTypeLength(t)===e.getTypeLength(n))&&(r=n);return r}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,t){const r=this.node,n=this.getNodeType(e),a=r.build(e,n);return e.format(a,n,t)}}qt("ConvertNode",ka);class Ds extends bn{constructor(e=[],t=null){super(t),this.nodes=e}getNodeType(e){return this.nodeType!==null?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((t,r)=>t+e.getTypeLength(r.getNodeType(e)),0))}generate(e,t){const r=this.getNodeType(e),n=this.nodes,a=e.getComponentType(r),u=[];for(const c of n){let v=c.build(e);const d=e.getComponentType(c.getNodeType(e));d!==a&&(v=e.format(v,d,a)),u.push(v)}const i=`${e.getType(r)}( ${u.join(", ")} )`;return e.format(i,r,t)}}qt("JoinNode",Ds);const Zo=za.join("");class wa extends jr{constructor(e,t="x"){super(),this.node=e,this.components=t,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const t of this.components)e=Math.max(za.indexOf(t)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}generate(e,t){const r=this.node,n=e.getTypeLength(r.getNodeType(e));let a=null;if(n>1){let u=null;this.getVectorLength()>=n&&(u=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const c=r.build(e,u);this.components.length===n&&this.components===Zo.slice(0,this.components.length)?a=e.format(c,u,t):a=e.format(`${c}.${this.components}`,this.getNodeType(e),t)}else a=r.build(e,t);return a}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}qt("SplitNode",wa);class Is extends bn{constructor(e,t,r){super(),this.sourceNode=e,this.components=t,this.targetNode=r}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:t,components:r,targetNode:n}=this,a=this.getNodeType(e),u=e.getTypeFromLength(r.length),i=n.build(e,u),c=t.build(e,a),v=e.getTypeLength(a),d=[];for(let g=0;g<v;g++){const _=za[g];_===r[0]?(d.push(i),g+=r.length-1):d.push(c+"."+_)}return`${e.getType(a)}( ${d.join(", ")} )`}}qt("SetNode",Is);class Bs extends jr{constructor(e,t=null){super(t),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return this.nodeType===null?_a(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=_a(this.value),e.nodeType=this.nodeType,e.valueType==="ArrayBuffer"&&(e.value=Yo(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?Ns(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){console.warn("Abstract function.")}}qt("InputNode",Bs);class Xt extends Bs{constructor(e,t=null){super(e,t),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,t){const r=this.getNodeType(e);return e.format(this.generateConst(e),r,t)}}qt("ConstNode",Xt);let Qo=null;const ln=new Map;function $(h,e){if(ln.has(h)){console.warn(`Redefinition of node element ${h}`);return}if(typeof e!="function")throw new Error(`Node element ${h} is not a function`);ln.set(h,e)}const ds=h=>h.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),Os={setup(h,e){const t=e.shift();return h(Va(t),...e)},get(h,e,t){if(typeof e=="string"&&h[e]===void 0){if(h.isStackNode!==!0&&e==="assign")return(...r)=>(Qo.assign(t,...r),t);if(ln.has(e)){const r=ln.get(e);return h.isStackNode?(...n)=>t.add(r(...n)):(...n)=>r(t,...n)}else{if(e==="self")return h;if(e.endsWith("Assign")&&ln.has(e.slice(0,e.length-6))){const r=ln.get(e.slice(0,e.length-6));return h.isStackNode?(...n)=>t.assign(n[0],r(...n)):(...n)=>t.assign(r(t,...n))}else{if(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0)return e=ds(e),ct(new wa(t,e));if(/^set[XYZWRGBASTPQ]{1,4}$/.test(e)===!0)return e=ds(e.slice(3).toLowerCase()),e=e.split("").sort().join(""),r=>ct(new Is(h,e,r));if(e==="width"||e==="height"||e==="depth")return e==="width"?e="x":e==="height"?e="y":e==="depth"&&(e="z"),ct(new wa(h,e));if(/^\d+$/.test(e)===!0)return ct(new Ua(t,new Xt(Number(e),"uint")))}}}return Reflect.get(h,e,t)},set(h,e,t,r){return typeof e=="string"&&h[e]===void 0&&(/^[xyzwrgbastpq]{1,4}$/.test(e)===!0||e==="width"||e==="height"||e==="depth"||/^\d+$/.test(e)===!0)?(r[e].assign(t),!0):Reflect.set(h,e,t,r)}},da=new WeakMap,ps=new WeakMap,Jo=function(h,e=null){const t=_a(h);if(t==="node"){let r=da.get(h);return r===void 0&&(r=new Proxy(h,Os),da.set(h,r),da.set(r,r)),r}else{if(e===null&&(t==="float"||t==="boolean")||t&&t!=="shader"&&t!=="string")return ct(Aa(h,e));if(t==="shader")return Zn(h)}return h},eu=function(h,e=null){for(const t in h)h[t]=ct(h[t],e);return h},tu=function(h,e=null){const t=h.length;for(let r=0;r<t;r++)h[r]=ct(h[r],e);return h},ru=function(h,e=null,t=null,r=null){const n=a=>ct(r!==null?Object.assign(a,r):a);return e===null?(...a)=>n(new h(...pa(a))):t!==null?(t=ct(t),(...a)=>n(new h(e,...pa(a),t))):(...a)=>n(new h(e,...pa(a)))};class nu extends jr{constructor(e,t){super(),this.shaderNode=e,this.inputNodes=t}getNodeType(e){const{outputNode:t}=e.getNodeProperties(this);return t?t.getNodeType(e):super.getNodeType(e)}call(e){const{shaderNode:t,inputNodes:r}=this;if(t.layout){let u=ps.get(e.constructor);u===void 0&&(u=new WeakMap,ps.set(e.constructor,u));let i=u.get(t);return i===void 0&&(i=ct(e.buildFunctionNode(t)),u.set(t,i)),e.currentFunctionNode!==null&&e.currentFunctionNode.includes.push(i),ct(i.call(r))}const n=t.jsFunc,a=r!==null?n(r,e.stack,e):n(e.stack,e);return ct(a)}setup(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}generate(e,t){const{outputNode:r}=e.getNodeProperties(this);return r===null?this.call(e).build(e,t):super.generate(e,t)}}class iu extends jr{constructor(e){super(),this.jsFunc=e,this.layout=null}get isArrayInput(){return/^\((\s+)?\[/.test(this.jsFunc.toString())}setLayout(e){return this.layout=e,this}call(e=null){return Va(e),ct(new nu(this,e))}setup(){return this.call()}}const au=[!1,!0],su=[0,1,2,3],ou=[-1,-2],Ls=[.5,1.5,1/3,1e-6,1e6,Math.PI,Math.PI*2,1/Math.PI,2/Math.PI,1/(Math.PI*2),Math.PI/2],Ga=new Map;for(const h of au)Ga.set(h,new Xt(h));const Wa=new Map;for(const h of su)Wa.set(h,new Xt(h,"uint"));const ja=new Map([...Wa].map(h=>new Xt(h.value,"int")));for(const h of ou)ja.set(h,new Xt(h,"int"));const ki=new Map([...ja].map(h=>new Xt(h.value)));for(const h of Ls)ki.set(h,new Xt(h));for(const h of Ls)ki.set(-h,new Xt(-h));const Gi={bool:Ga,uint:Wa,ints:ja,float:ki},vs=new Map([...Ga,...ki]),Aa=(h,e)=>vs.has(h)?vs.get(h):h.isNode===!0?h:new Xt(h,e),uu=h=>{try{return h.getNodeType()}catch{return}},it=function(h,e=null){return(...t)=>{if((t.length===0||!["bool","float","int","uint"].includes(h)&&t.every(n=>typeof n!="object"))&&(t=[Ns(h,...t)]),t.length===1&&e!==null&&e.has(t[0]))return ct(e.get(t[0]));if(t.length===1){const n=Aa(t[0],h);return uu(n)===h?ct(n):ct(new ka(n,h))}const r=t.map(n=>Aa(n));return ct(new Ds(r,h))}};function zs(h){return new Proxy(new iu(h),Os)}const ct=(h,e=null)=>Jo(h,e),Va=(h,e=null)=>new eu(h,e),pa=(h,e=null)=>new tu(h,e),he=(...h)=>new ru(...h),Zn=h=>{const e=new zs(h),t=(...r)=>{let n;return Va(r),r[0]&&r[0].isNode?n=[...r]:n=r[0],e.call(n)};return t.shaderNode=e,t.setLayout=r=>(e.setLayout(r),t),t};qt("ShaderNode",zs);function cu(h){return h}$("append",cu);const hu=new it("color"),Qn=new it("float",Gi.float),lu=new it("int",Gi.int),fu=new it("uint",Gi.uint),mu=new it("bool",Gi.bool),yu=new it("vec2"),du=new it("ivec2"),pu=new it("uvec2"),vu=new it("bvec2"),Wr=new it("vec3"),xu=new it("ivec3"),gu=new it("uvec3"),bu=new it("bvec3"),Sa=new it("vec4"),Tu=new it("ivec4"),Eu=new it("uvec4"),_u=new it("bvec4"),wu=new it("mat2"),Au=new it("imat2"),Su=new it("umat2"),Mu=new it("bmat2"),Fu=new it("mat3"),Cu=new it("imat3"),Ru=new it("umat3"),Pu=new it("bmat3"),Nu=new it("mat4"),Du=new it("imat4"),Iu=new it("umat4"),Bu=new it("bmat4"),Ou=(h="")=>ct(new Xt(h,"string")),Lu=h=>ct(new Xt(h,"ArrayBuffer"));$("color",hu);$("float",Qn);$("int",lu);$("uint",fu);$("bool",mu);$("vec2",yu);$("ivec2",du);$("uvec2",pu);$("bvec2",vu);$("vec3",Wr);$("ivec3",xu);$("uvec3",gu);$("bvec3",bu);$("vec4",Sa);$("ivec4",Tu);$("uvec4",Eu);$("bvec4",_u);$("mat2",wu);$("imat2",Au);$("umat2",Su);$("bmat2",Mu);$("mat3",Fu);$("imat3",Cu);$("umat3",Ru);$("bmat3",Pu);$("mat4",Nu);$("imat4",Du);$("umat4",Iu);$("bmat4",Bu);$("string",Ou);$("arrayBuffer",Lu);const zu=he(Ua),Uu=(h,e)=>ct(new ka(ct(h),e));$("element",zu);$("convert",Uu);class ht extends bn{constructor(e,t,r,...n){if(super(),this.op=e,n.length>0){let a=r;for(let u=0;u<n.length;u++)a=new ht(e,a,n[u]);r=a}this.aNode=t,this.bNode=r}getNodeType(e,t){const r=this.op,n=this.aNode,a=this.bNode,u=n.getNodeType(e),i=typeof a<"u"?a.getNodeType(e):null;if(u==="void"||i==="void")return"void";if(r==="%")return u;if(r==="~"||r==="&"||r==="|"||r==="^"||r===">>"||r==="<<")return e.getIntegerType(u);if(r==="!"||r==="=="||r==="&&"||r==="||"||r==="^^")return"bool";if(r==="<"||r===">"||r==="<="||r===">="){const c=t?e.getTypeLength(t):Math.max(e.getTypeLength(u),e.getTypeLength(i));return c>1?`bvec${c}`:"bool"}else return u==="float"&&e.isMatrix(i)?i:e.isMatrix(u)&&e.isVector(i)?e.getVectorFromMatrix(u):e.isVector(u)&&e.isMatrix(i)?e.getVectorFromMatrix(i):e.getTypeLength(i)>e.getTypeLength(u)?i:u}generate(e,t){const r=this.op,n=this.aNode,a=this.bNode,u=this.getNodeType(e,t);let i=null,c=null;u!=="void"?(i=n.getNodeType(e),c=typeof a<"u"?a.getNodeType(e):null,r==="<"||r===">"||r==="<="||r===">="||r==="=="?e.isVector(i)?c=i:i=c="float":r===">>"||r==="<<"?(i=u,c=e.changeComponentType(c,"uint")):e.isMatrix(i)&&e.isVector(c)?c=e.getVectorFromMatrix(i):e.isVector(i)&&e.isMatrix(c)?i=e.getVectorFromMatrix(c):i=c=u):i=c=u;const v=n.build(e,i),d=typeof a<"u"?a.build(e,c):null,g=e.getTypeLength(t),_=e.getFunctionOperator(r);if(t!=="void")return r==="<"&&g>1?e.format(`${e.getMethod("lessThan")}( ${v}, ${d} )`,u,t):r==="<="&&g>1?e.format(`${e.getMethod("lessThanEqual")}( ${v}, ${d} )`,u,t):r===">"&&g>1?e.format(`${e.getMethod("greaterThan")}( ${v}, ${d} )`,u,t):r===">="&&g>1?e.format(`${e.getMethod("greaterThanEqual")}( ${v}, ${d} )`,u,t):r==="!"||r==="~"?e.format(`(${r}${v})`,i,t):_?e.format(`${_}( ${v}, ${d} )`,u,t):e.format(`( ${v} ${r} ${d} )`,u,t);if(i!=="void")return _?e.format(`${_}( ${v}, ${d} )`,u,t):e.format(`${v} ${r} ${d}`,u,t)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const ku=he(ht,"+"),Ma=he(ht,"-"),Ha=he(ht,"*"),Us=he(ht,"/"),Gu=he(ht,"%"),Wu=he(ht,"=="),ju=he(ht,"!="),Vu=he(ht,"<"),Hu=he(ht,">"),qu=he(ht,"<="),Xu=he(ht,">="),Yu=he(ht,"&&"),Ku=he(ht,"||"),$u=he(ht,"!"),Zu=he(ht,"^^"),Qu=he(ht,"&"),Ju=he(ht,"~"),ec=he(ht,"|"),tc=he(ht,"^"),rc=he(ht,"<<"),nc=he(ht,">>");$("add",ku);$("sub",Ma);$("mul",Ha);$("div",Us);$("remainder",Gu);$("equal",Wu);$("notEqual",ju);$("lessThan",Vu);$("greaterThan",Hu);$("lessThanEqual",qu);$("greaterThanEqual",Xu);$("and",Yu);$("or",Ku);$("not",$u);$("xor",Zu);$("bitAnd",Qu);$("bitNot",Ju);$("bitOr",ec);$("bitXor",tc);$("shiftLeft",rc);$("shiftRight",nc);qt("OperatorNode",ht);class N extends bn{constructor(e,t,r=null,n=null){super(),this.method=e,this.aNode=t,this.bNode=r,this.cNode=n}getInputType(e){const t=this.aNode.getNodeType(e),r=this.bNode?this.bNode.getNodeType(e):null,n=this.cNode?this.cNode.getNodeType(e):null,a=e.isMatrix(t)?0:e.getTypeLength(t),u=e.isMatrix(r)?0:e.getTypeLength(r),i=e.isMatrix(n)?0:e.getTypeLength(n);return a>u&&a>i?t:u>i?r:i>a?n:t}getNodeType(e){const t=this.method;return t===N.LENGTH||t===N.DISTANCE||t===N.DOT?"float":t===N.CROSS?"vec3":t===N.ALL?"bool":t===N.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):t===N.MOD?this.aNode.getNodeType(e):this.getInputType(e)}generate(e,t){const r=this.method,n=this.getNodeType(e),a=this.getInputType(e),u=this.aNode,i=this.bNode,c=this.cNode,v=e.renderer.isWebGLRenderer===!0;if(r===N.TRANSFORM_DIRECTION){let d=u,g=i;e.isMatrix(d.getNodeType(e))?g=Sa(Wr(g),0):d=Sa(Wr(d),0);const _=Ha(d,g).xyz;return ks(_).build(e,t)}else{if(r===N.NEGATE)return e.format("( - "+u.build(e,a)+" )",n,t);if(r===N.ONE_MINUS)return Ma(1,u).build(e,t);if(r===N.RECIPROCAL)return Us(1,u).build(e,t);if(r===N.DIFFERENCE)return qa(Ma(u,i)).build(e,t);{const d=[];return r===N.CROSS||r===N.MOD?d.push(u.build(e,n),i.build(e,n)):r===N.STEP?d.push(u.build(e,e.getTypeLength(u.getNodeType(e))===1?"float":a),i.build(e,a)):v&&(r===N.MIN||r===N.MAX)||r===N.MOD?d.push(u.build(e,a),i.build(e,e.getTypeLength(i.getNodeType(e))===1?"float":a)):r===N.REFRACT?d.push(u.build(e,a),i.build(e,a),c.build(e,"float")):r===N.MIX?d.push(u.build(e,a),i.build(e,a),c.build(e,e.getTypeLength(c.getNodeType(e))===1?"float":a)):(d.push(u.build(e,a)),i!==null&&d.push(i.build(e,a)),c!==null&&d.push(c.build(e,a))),e.format(`${e.getMethod(r,n)}( ${d.join(", ")} )`,n,t)}}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}N.ALL="all";N.ANY="any";N.EQUALS="equals";N.RADIANS="radians";N.DEGREES="degrees";N.EXP="exp";N.EXP2="exp2";N.LOG="log";N.LOG2="log2";N.SQRT="sqrt";N.INVERSE_SQRT="inversesqrt";N.FLOOR="floor";N.CEIL="ceil";N.NORMALIZE="normalize";N.FRACT="fract";N.SIN="sin";N.COS="cos";N.TAN="tan";N.ASIN="asin";N.ACOS="acos";N.ATAN="atan";N.ABS="abs";N.SIGN="sign";N.LENGTH="length";N.NEGATE="negate";N.ONE_MINUS="oneMinus";N.DFDX="dFdx";N.DFDY="dFdy";N.ROUND="round";N.RECIPROCAL="reciprocal";N.TRUNC="trunc";N.FWIDTH="fwidth";N.BITCAST="bitcast";N.ATAN2="atan2";N.MIN="min";N.MAX="max";N.MOD="mod";N.STEP="step";N.REFLECT="reflect";N.DISTANCE="distance";N.DIFFERENCE="difference";N.DOT="dot";N.CROSS="cross";N.POW="pow";N.TRANSFORM_DIRECTION="transformDirection";N.MIX="mix";N.CLAMP="clamp";N.REFRACT="refract";N.SMOOTHSTEP="smoothstep";N.FACEFORWARD="faceforward";const ic=Qn(1e-6);Qn(1e6);Qn(Math.PI);Qn(Math.PI*2);const ac=he(N,N.ALL),sc=he(N,N.ANY),oc=he(N,N.EQUALS),uc=he(N,N.RADIANS),cc=he(N,N.DEGREES),hc=he(N,N.EXP),lc=he(N,N.EXP2),fc=he(N,N.LOG),mc=he(N,N.LOG2),yc=he(N,N.SQRT),dc=he(N,N.INVERSE_SQRT),pc=he(N,N.FLOOR),vc=he(N,N.CEIL),ks=he(N,N.NORMALIZE),xc=he(N,N.FRACT),gc=he(N,N.SIN),bc=he(N,N.COS),Tc=he(N,N.TAN),Ec=he(N,N.ASIN),_c=he(N,N.ACOS),wc=he(N,N.ATAN),qa=he(N,N.ABS),Gs=he(N,N.SIGN),Ac=he(N,N.LENGTH),Sc=he(N,N.NEGATE),Mc=he(N,N.ONE_MINUS),Fc=he(N,N.DFDX),Cc=he(N,N.DFDY),Rc=he(N,N.ROUND),Pc=he(N,N.RECIPROCAL),Nc=he(N,N.TRUNC),Dc=he(N,N.FWIDTH);he(N,N.BITCAST);const Ic=he(N,N.ATAN2),Bc=he(N,N.MIN),Oc=he(N,N.MAX),Lc=he(N,N.MOD),zc=he(N,N.STEP),Uc=he(N,N.REFLECT),kc=he(N,N.DISTANCE),Gc=he(N,N.DIFFERENCE),Ws=he(N,N.DOT),Wc=he(N,N.CROSS),js=he(N,N.POW),jc=he(N,N.POW,2),Vc=he(N,N.POW,3),Hc=he(N,N.POW,4),qc=he(N,N.TRANSFORM_DIRECTION),Xc=h=>Ha(Gs(h),js(qa(h),1/3)),Yc=h=>Ws(h,h),Kc=he(N,N.MIX),Vs=(h,e=0,t=1)=>ct(new N(N.CLAMP,ct(h),ct(e),ct(t))),$c=h=>Vs(h),Zc=he(N,N.REFRACT),Qc=he(N,N.SMOOTHSTEP),Jc=he(N,N.FACEFORWARD),eh=(h,e,t)=>Kc(e,t,h),th=(h,e,t)=>Qc(e,t,h);$("all",ac);$("any",sc);$("equals",oc);$("radians",uc);$("degrees",cc);$("exp",hc);$("exp2",lc);$("log",fc);$("log2",mc);$("sqrt",yc);$("inverseSqrt",dc);$("floor",pc);$("ceil",vc);$("normalize",ks);$("fract",xc);$("sin",gc);$("cos",bc);$("tan",Tc);$("asin",Ec);$("acos",_c);$("atan",wc);$("abs",qa);$("sign",Gs);$("length",Ac);$("lengthSq",Yc);$("negate",Sc);$("oneMinus",Mc);$("dFdx",Fc);$("dFdy",Cc);$("round",Rc);$("reciprocal",Pc);$("trunc",Nc);$("fwidth",Dc);$("atan2",Ic);$("min",Bc);$("max",Oc);$("mod",Lc);$("step",zc);$("reflect",Uc);$("distance",kc);$("dot",Ws);$("cross",Wc);$("pow",js);$("pow2",jc);$("pow3",Vc);$("pow4",Hc);$("transformDirection",qc);$("mix",eh);$("clamp",Vs);$("refract",Zc);$("smoothstep",th);$("faceForward",Jc);$("difference",Gc);$("saturate",$c);$("cbrt",Xc);qt("MathNode",N);const rh=Zn(({base:h,blend:e})=>{const t=r=>e[r].lessThan(ic).cond(e[r],h[r].oneMinus().div(e[r]).oneMinus().max(0));return Wr(t("x"),t("y"),t("z"))}).setLayout({name:"burnColor",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),nh=Zn(({base:h,blend:e})=>{const t=r=>e[r].equal(1).cond(e[r],h[r].div(e[r].oneMinus()).max(0));return Wr(t("x"),t("y"),t("z"))}).setLayout({name:"dodgeColor",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),ih=Zn(({base:h,blend:e})=>{const t=r=>h[r].oneMinus().mul(e[r].oneMinus()).oneMinus();return Wr(t("x"),t("y"),t("z"))}).setLayout({name:"screenColor",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),ah=Zn(({base:h,blend:e})=>{const t=r=>h[r].lessThan(.5).cond(h[r].mul(e[r],2),h[r].oneMinus().mul(e[r].oneMinus()).oneMinus());return Wr(t("x"),t("y"),t("z"))}).setLayout({name:"overlayColor",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]});class wt extends bn{constructor(e,t,r){super(),this.blendMode=e,this.baseNode=t,this.blendNode=r}setup(){const{blendMode:e,baseNode:t,blendNode:r}=this,n={base:t,blend:r};let a=null;return e===wt.BURN?a=rh(n):e===wt.DODGE?a=nh(n):e===wt.SCREEN?a=ih(n):e===wt.OVERLAY&&(a=ah(n)),a}}wt.BURN="burn";wt.DODGE="dodge";wt.SCREEN="screen";wt.OVERLAY="overlay";const sh=he(wt,wt.BURN),oh=he(wt,wt.DODGE),uh=he(wt,wt.OVERLAY),ch=he(wt,wt.SCREEN);$("burn",sh);$("dodge",oh);$("overlay",uh);$("screen",ch);qt("BlendModeNode",wt);var Wt,Ht,Mr,xn,Fr,Nt,Cr,dr,gn,jn,Vn,Hn,Pa,Na,qn,kr,pr,Xn,Ni,Hs,Di,qs,Ii,Xs,Yn,Fa,Bi,Ys,Oi,Ks,Kn,Ca,Li,$s;class hh{constructor(){Fe(this,Ni);Fe(this,Di);Fe(this,Ii);Fe(this,Yn);Fe(this,Bi);Fe(this,Oi);Fe(this,Kn);Fe(this,Li);Ot(this,"canvas",document.querySelector("#canvas"));Ot(this,"gl");Fe(this,Wt,new Map);Fe(this,Ht,new Map);Fe(this,Mr,void 0);Fe(this,xn,void 0);Fe(this,Fr,void 0);Fe(this,Nt,new Uint8Array(600));Fe(this,Cr,void 0);Fe(this,dr,new Uint8Array(3*40));Fe(this,gn,void 0);Fe(this,jn,document.createTextNode("0"));Fe(this,Vn,document.createTextNode("1"));Fe(this,Hn,document.createTextNode("0"));Fe(this,Pa,0);Fe(this,Na,0);Fe(this,qn,new Map);Fe(this,kr,void 0);Fe(this,pr,void 0);Fe(this,Xn,document.querySelectorAll("button"));document.querySelector("#linesCleared").appendChild(se(this,jn)),document.querySelector("#speedLevel").appendChild(se(this,Vn)),document.querySelector("#score").appendChild(se(this,Hn));const e=document.styleSheets;let t=!1;for(let g=0;g<e.length&&!t;g++)e[g].href.includes("WebTetris")&&(Je(this,kr,e[g].cssRules),t=!0);se(this,Wt).set(1,[255,0,0]),se(this,Wt).set(2,[0,255,0]),se(this,Wt).set(3,[255,255,0]),se(this,Wt).set(4,[0,0,255]),se(this,Wt).set(5,[180,90,246]),se(this,Wt).set(6,[0,255,255]),se(this,Wt).set(7,[255,140,40]),se(this,Ht).set("Z",1),se(this,Ht).set("S",2),se(this,Ht).set("O",3),se(this,Ht).set("J",4),se(this,Ht).set("T",5),se(this,Ht).set("I",6),se(this,Ht).set("L",7);let r=this.canvas.getContext("webgl");this.gl=r,r||document.body.appendChild(document.createTextNode("WebGL is not supported."));function n(g,_,b,C){return[g,_+C,g+b,_+C,g+b,_,g,_]}function a(g,_,b,C){let U=[g/2,g],ee=[],M=(300-U[1])/2,Q=(400-U[0])/2;ee.push(...n(Q,M,U[0],U[1])),ee.push(...n(Q-_-C,M,C,C));for(let J=0;J<3;J++)ee.push(...n(Q+_+U[0],M+J*(C+b),C,C));return ee}const u={a_Position:{numComponents:2,data:a(250,3,0,30)},a_GridPos:{numComponents:2,data:[0,0,10,0,10,20,0,20,0,0,4,0,4,4,0,4,0,0,4,0,4,4,0,4,0,0,4,0,4,4,0,4,0,0,4,0,4,4,0,4]},a_QueueID:{numComponents:1,data:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3]},a_ShaderID:{numComponents:1,data:[0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},indices:{numComponents:3,data:[0,1,2,2,3,0,4,5,6,6,7,4,8,9,10,10,11,8,12,13,14,14,15,12,16,17,18,18,19,16]}};Je(this,xn,Er.createBufferInfoFromArrays(r,u));let i=document.querySelector("#vertex-shader-2d").text,c=document.querySelector("#fragment-shader-2d").text;Je(this,Mr,Er.createProgramInfo(r,[i,c]));let v={src:"textures/block.png",mag:r.LINEAR};Je(this,gn,Er.createTexture(this.gl,v)),Je(this,Fr,r.createTexture()),r.bindTexture(r.TEXTURE_2D,se(this,Fr)),r.pixelStorei(r.UNPACK_ALIGNMENT,1),r.texImage2D(r.TEXTURE_2D,0,r.RGB,10,20,0,r.RGB,r.UNSIGNED_BYTE,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),Je(this,Cr,r.createTexture()),r.bindTexture(r.TEXTURE_2D,se(this,Cr)),r.pixelStorei(r.UNPACK_ALIGNMENT,1),r.texImage2D(r.TEXTURE_2D,0,r.RGB,4,2*5,0,r.RGB,r.UNSIGNED_BYTE,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.useProgram(se(this,Mr).program),Er.setBuffersAndAttributes(r,se(this,Mr),se(this,xn));let d={u_Resolution:[this.gl.canvas.width,this.gl.canvas.height],u_GridData:se(this,Fr),u_QueueData:se(this,Cr),u_BlockTexture:se(this,gn)};Er.setUniforms(se(this,Mr),d),Ke(this,Oi,Ks).call(this,"#gameSpace"),Je(this,pr,Ke(this,Kn,Ca).call(this,"button").fontSize),Je(this,pr,Number(se(this,pr).substring(0,se(this,pr).length-2)))}updateData(e){Ke(this,Ni,Hs).call(this,e),Ke(this,Ii,Xs).call(this,e),Ke(this,Bi,Ys).call(this,e)}renderGame(){Er.resizeCanvasToDisplaySize(this.gl.canvas),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),Ke(this,Li,$s).call(this);let e={u_Resolution:[this.gl.canvas.width,this.gl.canvas.height],u_GridData:se(this,Fr),u_QueueData:se(this,Cr),u_BlockTexture:se(this,gn)};Er.setUniforms(se(this,Mr),e),Er.drawBufferInfo(this.gl,se(this,xn))}}Wt=new WeakMap,Ht=new WeakMap,Mr=new WeakMap,xn=new WeakMap,Fr=new WeakMap,Nt=new WeakMap,Cr=new WeakMap,dr=new WeakMap,gn=new WeakMap,jn=new WeakMap,Vn=new WeakMap,Hn=new WeakMap,Pa=new WeakMap,Na=new WeakMap,qn=new WeakMap,kr=new WeakMap,pr=new WeakMap,Xn=new WeakMap,Ni=new WeakSet,Hs=function(e){for(let t=0;t<20;t++){let r=e.gridData[t];for(let n=0;n<10;n++){let a=Ke(this,Di,qs).call(this,r,n),u=3*(10*t+n);if(a!=0){let i=se(this,Wt).get(a);se(this,Nt)[u]=i[0],se(this,Nt)[u+1]=i[1],se(this,Nt)[u+2]=i[2]}else se(this,Nt)[u]=0,se(this,Nt)[u+1]=0,se(this,Nt)[u+2]=0}}if(e.playerPiece.active){let t=170;for(let n=0;n<4;n++){let a=3*(10*e.ghostBlocks[n][1]+e.ghostBlocks[n][0]);se(this,Nt)[a]=t,se(this,Nt)[a+1]=t,se(this,Nt)[a+2]=t}let r=e.playerPiece.shape;for(let n=0;n<4;n++){let a=se(this,Wt).get(se(this,Ht).get(r)),u=3*(10*e.playerPiece.blocks[n][1]+e.playerPiece.blocks[n][0]);se(this,Nt)[u]=a[0],se(this,Nt)[u+1]=a[1],se(this,Nt)[u+2]=a[2]}}this.gl.bindTexture(this.gl.TEXTURE_2D,se(this,Fr)),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,10,20,this.gl.RGB,this.gl.UNSIGNED_BYTE,se(this,Nt))},Di=new WeakSet,qs=function(e,t){const r=32-(3+3*t),n=7<<r;return(e&n)>>>r},Ii=new WeakSet,Xs=function(e){for(let t=0;t<se(this,dr).length;t++)se(this,dr)[t]=0;e.heldPiece!=null&&Ke(this,Yn,Fa).call(this,e.heldPiece,0);for(let t=0;t<4;t++)Ke(this,Yn,Fa).call(this,e.pieceQueue[t],24*(1+t));this.gl.bindTexture(this.gl.TEXTURE_2D,se(this,Cr)),this.gl.texSubImage2D(this.gl.TEXTURE_2D,0,0,0,4,10,this.gl.RGB,this.gl.UNSIGNED_BYTE,se(this,dr))},Yn=new WeakSet,Fa=function(e,t){let r=Sr.getBaseShape(e),n=se(this,Wt).get(se(this,Ht).get(e));for(let a=0;a<4;a++){let u=r[a],i=t+3*(u[1]*4+u[0]);se(this,dr)[i]=n[0],se(this,dr)[i+1]=n[1],se(this,dr)[i+2]=n[2]}},Bi=new WeakSet,Ys=function(e){se(this,jn).nodeValue=e.linesCleared,se(this,Vn).nodeValue=e.speedLevel==11?"MAX":e.speedLevel,se(this,Hn).nodeValue=e.score},Oi=new WeakSet,Ks=function(e){const t=document.querySelector(e),r=Ke(this,Kn,Ca).call(this,e);r!=null&&se(this,qn).set(t,r)},Kn=new WeakSet,Ca=function(e){let t=null;for(let r=0;r<se(this,kr).length&&t==null;r++)se(this,kr)[r].selectorText==e&&(t=se(this,kr)[r].style);return t},Li=new WeakSet,$s=function(){const e=this.gl.canvas.width,t=this.gl.canvas.height,r=3*e>4*t;se(this,qn).forEach(function(a,u,i){const c=a.left!="",v=a.top!="";let d=c?a.left:a.right,g=v?a.top:a.bottom,_=a.fontSize,b=a.width,C=a.height;d=Number(d.substring(0,d.length-2)),g=Number(g.substring(0,g.length-2)),b=Number(b.substring(0,b.length-2)),C=Number(C.substring(0,C.length-2)),_!=""&&(_=Number(_.substring(0,_.length-2))),r?(d=(4*t*(d-50)+150*e)/(3*e)+"vw",b=b*4*t/(3*e)+"vw",g=g+"vh",C=C+"vh"):(g=g*3*e/(4*t)+(100*t-75*e)/(2*t)+"vh",C=C*3*e/(4*t)+"vh",d=d+"vw",b=b+"vw",_!=""&&(_=_*3*e/(4*t))),_!=""&&(u.style.fontSize=_+"vh"),c?u.style.left=d:u.style.right=d,v?u.style.top=g:u.style.bottom=g,u.style.width=b,u.style.height=C});const n=r?se(this,pr):se(this,pr)*3*e/(4*t);for(let a=0;a<se(this,Xn).length;a++){let u=se(this,Xn)[a];u.style.fontSize=n+"vh"}};let Ln=null,Ra=new Map,Zs;function lh(h){h.inputKeys.forEach(function(t,r,n){localStorage.setItem(t,r)})}function fh(h){let e=[];h.inputKeys.forEach(function(t,r,n){const a=localStorage.getItem(t);a!=null&&e.push({action:t,oldKey:r,newKey:a})});for(let t=0;t<e.length;t++)h.inputKeys.delete(e[t].oldKey);for(let t=0;t<e.length;t++)h.inputKeys.set(e[t].newKey,e[t].action)}function mh(h,e){const t=document.querySelectorAll(h);for(let a=0;a<t.length;a++){let i=function(v){e.selectedKey=v.key.length>1?v.key:v.key.toUpperCase(),c()},c=function(){e.selectedKey=="Escape"||Zs.classList.contains("hide")?(e.selectedKey=e.originalKeybind,v(),Ln.textContent="Rebind canceled.",e.updateCounters()):e.rebindControl(e.selectedAction,e.selectedKey)?(Ln.textContent="Rebind successful!",v(),lh(e)):Ln.textContent="'"+e.selectedKey+"' is already in use (press another key)...";function v(){document.removeEventListener("keydown",i),e.selectedSpan.innerText=e.selectedKey,Ra.get(e.selectedAction).forEach(function(d,g,_){d.innerText=e.selectedKey}),e.selectedAction="",e.selectedKey="",e.selectedSpan.classList.add("ready"),e.selectedSpan.classList.remove("waiting"),e.selectedSpan=null}};var r=i,n=c;let u=t[a];u.classList.add("ready"),u.addEventListener("click",function(){e.selectedSpan!=null&&(e.selectedKey="Escape",c()),e.originalKeybind=u.innerText,e.selectedSpan=u,e.selectedAction=u.id.substring(2),Ln.textContent="Rebinding "+e.selectedAction+" action (press key to rebind)...",document.addEventListener("keydown",i),u.classList.remove("ready"),u.classList.add("waiting"),u.innerText="..."}),u.innerText=e.actionToKey(u.id.substring(2))}}function yh(h,e,t,r){Zs=r,Ln=t,mh(h,e),e.actionStates.forEach(function(n,a,u){Ra.set(a,document.querySelectorAll("span.cd_"+a)),Ra.get(a).forEach(function(i,c,v){i.innerText=e.actionToKey(a)})})}function dh(){let h=document.createTextNode("");document.querySelector("#debug").appendChild(h);const e=document.querySelector("#startButton");let t=new ro;fh(t),document.addEventListener("keydown",function(M){t.setInputState(M.key,!0)}),document.addEventListener("keyup",function(M){t.setInputState(M.key,!1)});let r=new va,n=new hh;const a=document.querySelector("#titleScreen"),u=document.querySelector("#pauseScreen"),i=document.querySelector("#gameOverScreen"),c=document.querySelector("#settingsScreen");let v=!0;const d=document.createTextNode("0"),g=document.createTextNode("0");document.querySelector("#finalScore").appendChild(d),document.querySelector("#finalLines").append(g);let _=0,b=0;function C(M){let Q=(M-b)*.001;b=M,_+=Q,c.classList.contains("hide")?r.gameState.gameOver?v||i.classList.contains("hide")&&(i.classList.remove("hide"),d.textContent=r.gameState.score,g.textContent=r.gameState.linesCleared):(_>=r.gameTickTime&&(_=Math.min(_-r.gameTickTime,r.gameTickTime),t.updateCounters(),r.runTick(t),t.getCounter("Pause")==1&&(r.gameState.isPaused?(r.pauseGame(!1),u.classList.add("hide")):(r.pauseGame(!0),u.classList.remove("hide")))),r.isStateChanged&&n.updateData(r.gameState)):(t.updateCounters(),t.getCounter("Pause")==1&&c.classList.add("hide")),n.renderGame(),requestAnimationFrame(C)}function U(){r.startNewGame(),n.updateData(r.gameState),n.renderGame(),document.querySelector("#titleScreen").classList.add("hide"),document.querySelector("#gameGUI").classList.remove("hide"),requestAnimationFrame(C),v=!1}e.addEventListener("click",U),document.querySelector("#heldPieceOverlay").addEventListener("click",function(){r.holdPiece()}),document.querySelector("#unpauseButton").addEventListener("click",function(){r.gameState.isPaused=!1,u.classList.add("hide")}),document.querySelector("#replayButton").addEventListener("click",function(){r.startNewGame(),n.updateData(r.gameState),n.renderGame(),i.classList.add("hide")}),document.querySelector("#returnToTitleButton").addEventListener("click",function(){a.classList.remove("hide"),i.classList.add("hide"),v=!0}),requestAnimationFrame(C);let ee=document.createTextNode("");document.querySelector("#settingsConsoleText").appendChild(ee),yh(".controlRebind",t,ee,c),document.querySelector("#exitSettingsButton").addEventListener("click",function(){c.classList.add("hide")}),document.querySelectorAll(".settingsButton").forEach(function(M,Q,J){M.addEventListener("click",function(){c.classList.remove("hide")})})}dh();
